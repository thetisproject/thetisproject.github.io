
<!DOCTYPE html>

<html>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>thetis.options &#8212; Thetis 0+untagged.1731.gc2c1691.dirty documentation</title>
    <link rel="stylesheet" type="text/css" href="../../_static/pygments.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/thetis.css" />
    <script data-url_root="../../" id="documentation_options" src="../../_static/documentation_options.js"></script>
    <script src="../../_static/jquery.js"></script>
    <script src="../../_static/underscore.js"></script>
    <script src="../../_static/doctools.js"></script>
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" />
<!--[if lte IE 6]>
<link rel="stylesheet" href="../../_static/ie6.css" type="text/css" media="screen" charset="utf-8" />
<![endif]-->

<!-- <link rel="stylesheet" href="../../_static/featured.css"> -->


<link rel="shortcut icon" href="../../_static/icon_thetis.ico" />


  </head><body>
<div class="wrapper">
  <a href="../../index.html"><img src="../../_static/banner.jpg" height="180px" alt="Thetis Project Banner" /></a>
  <div id="access">
    <div class="menu">
      <ul>
        <li class="page_item"><a href="../../documentation.html" title="Thetis documentation">Documentation</a></li>
        <li class="page_item"><a href="../../download.html" title="Install Thetis">Download</a></li>
        <li class="page_item"><a href="../../team.html" title="Development team">Team</a></li>
        <li class="page_item"><a href="../../publications.html" title="Publications">Publications</a></li>
        <li class="page_item"><a href="../../funding.html" title="Our financial supporters">Funding</a></li>
        <li class="page_item"><a href="../../contact.html" title="Getting in touch">Contact</a></li>
        <li class="page_item"><a href="https://github.com/thetisproject/thetis" title="Thetis source on GitHub">GitHub</a></li>
      </ul>
    </div><!-- .menu -->
  </div><!-- #access -->
</div><!-- #wrapper -->


    <div class="document">
    <div class="_modules/thetis/options">
      
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body" role="main">
            
  <h1>Source code for thetis.options</h1><div class="highlight"><pre>
<span></span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">Thetis options for the 2D and 3D model</span>

<span class="sd">All options are type-checked and they are stored in traitlets Configurable</span>
<span class="sd">objects.</span>
<span class="sd">&quot;&quot;&quot;</span>
<span class="kn">from</span> <span class="nn">.configuration</span> <span class="kn">import</span> <span class="o">*</span>
<span class="kn">from</span> <span class="nn">firedrake</span> <span class="kn">import</span> <span class="n">Constant</span>
<span class="kn">from</span> <span class="nn">.sediment_model</span> <span class="kn">import</span> <span class="n">SedimentModel</span>
<span class="kn">from</span> <span class="nn">collections</span> <span class="kn">import</span> <span class="n">OrderedDict</span>


<div class="viewcode-block" id="TimeStepperOptions"><a class="viewcode-back" href="../../thetis.html#thetis.options.TimeStepperOptions">[docs]</a><span class="k">class</span> <span class="nc">TimeStepperOptions</span><span class="p">(</span><span class="n">FrozenHasTraits</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Base class for all time stepper options&quot;&quot;&quot;</span>
    <span class="n">name</span> <span class="o">=</span> <span class="s1">&#39;Time stepper&#39;</span>
    <span class="n">solver_parameters</span> <span class="o">=</span> <span class="n">PETScSolverParameters</span><span class="p">({})</span><span class="o">.</span><span class="n">tag</span><span class="p">(</span><span class="n">config</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
    <span class="n">ad_block_tag</span> <span class="o">=</span> <span class="n">Unicode</span><span class="p">(</span><span class="n">default_value</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">allow_none</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">help</span><span class="o">=</span><span class="s2">&quot;&quot;&quot;</span>
<span class="s2">        Custom tag for the Pyadjoint blocks generated by</span>
<span class="s2">        this timestepper.</span>
<span class="s2">        &quot;&quot;&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">tag</span><span class="p">(</span><span class="n">config</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span></div>


<div class="viewcode-block" id="ExplicitTimeStepperOptions"><a class="viewcode-back" href="../../thetis.html#thetis.options.ExplicitTimeStepperOptions">[docs]</a><span class="k">class</span> <span class="nc">ExplicitTimeStepperOptions</span><span class="p">(</span><span class="n">TimeStepperOptions</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Options for explicit time integrator&quot;&quot;&quot;</span>
    <span class="n">use_automatic_timestep</span> <span class="o">=</span> <span class="n">Bool</span><span class="p">(</span><span class="kc">True</span><span class="p">,</span> <span class="n">help</span><span class="o">=</span><span class="s1">&#39;Set time step automatically based on local CFL conditions.&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">tag</span><span class="p">(</span><span class="n">config</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span></div>


<div class="viewcode-block" id="ExplicitTimeStepperOptions2d"><a class="viewcode-back" href="../../thetis.html#thetis.options.ExplicitTimeStepperOptions2d">[docs]</a><span class="k">class</span> <span class="nc">ExplicitTimeStepperOptions2d</span><span class="p">(</span><span class="n">ExplicitTimeStepperOptions</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Options for 2d explicit time integrator&quot;&quot;&quot;</span></div>


<div class="viewcode-block" id="SemiImplicitTimeStepperOptions2d"><a class="viewcode-back" href="../../thetis.html#thetis.options.SemiImplicitTimeStepperOptions2d">[docs]</a><span class="k">class</span> <span class="nc">SemiImplicitTimeStepperOptions2d</span><span class="p">(</span><span class="n">TimeStepperOptions</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Options for 2d semi-implicit time integrator&quot;&quot;&quot;</span>
    <span class="n">use_semi_implicit_linearization</span> <span class="o">=</span> <span class="n">Bool</span><span class="p">(</span>
        <span class="kc">False</span><span class="p">,</span> <span class="n">help</span><span class="o">=</span><span class="s2">&quot;Use linearized semi-implicit time integration&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">tag</span><span class="p">(</span><span class="n">config</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span></div>


<div class="viewcode-block" id="SemiImplicitSWETimeStepperOptions2d"><a class="viewcode-back" href="../../thetis.html#thetis.options.SemiImplicitSWETimeStepperOptions2d">[docs]</a><span class="k">class</span> <span class="nc">SemiImplicitSWETimeStepperOptions2d</span><span class="p">(</span><span class="n">SemiImplicitTimeStepperOptions2d</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Options for 2d semi-implicit time integrator</span>
<span class="sd">    applied to shallow water equations</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">solver_parameters</span> <span class="o">=</span> <span class="n">PETScSolverParameters</span><span class="p">({</span>
        <span class="s1">&#39;ksp_type&#39;</span><span class="p">:</span> <span class="s1">&#39;gmres&#39;</span><span class="p">,</span>
        <span class="s1">&#39;pc_type&#39;</span><span class="p">:</span> <span class="s1">&#39;fieldsplit&#39;</span><span class="p">,</span>
        <span class="s1">&#39;pc_fieldsplit_type&#39;</span><span class="p">:</span> <span class="s1">&#39;multiplicative&#39;</span><span class="p">,</span>
    <span class="p">})</span><span class="o">.</span><span class="n">tag</span><span class="p">(</span><span class="n">config</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span></div>


<div class="viewcode-block" id="SemiImplicitTracerTimeStepperOptions2d"><a class="viewcode-back" href="../../thetis.html#thetis.options.SemiImplicitTracerTimeStepperOptions2d">[docs]</a><span class="k">class</span> <span class="nc">SemiImplicitTracerTimeStepperOptions2d</span><span class="p">(</span><span class="n">SemiImplicitTimeStepperOptions2d</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Options for 2d semi-implicit time integrator</span>
<span class="sd">    applied to tracer equations</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">solver_parameters</span> <span class="o">=</span> <span class="n">PETScSolverParameters</span><span class="p">({</span>
        <span class="s1">&#39;ksp_type&#39;</span><span class="p">:</span> <span class="s1">&#39;gmres&#39;</span><span class="p">,</span>
        <span class="s1">&#39;pc_type&#39;</span><span class="p">:</span> <span class="s1">&#39;sor&#39;</span><span class="p">,</span>
    <span class="p">})</span><span class="o">.</span><span class="n">tag</span><span class="p">(</span><span class="n">config</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span></div>


<div class="viewcode-block" id="SteadyStateTimeStepperOptions2d"><a class="viewcode-back" href="../../thetis.html#thetis.options.SteadyStateTimeStepperOptions2d">[docs]</a><span class="k">class</span> <span class="nc">SteadyStateTimeStepperOptions2d</span><span class="p">(</span><span class="n">TimeStepperOptions</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Options for 2d steady state solver&quot;&quot;&quot;</span>
    <span class="n">solver_parameters</span> <span class="o">=</span> <span class="n">PETScSolverParameters</span><span class="p">({</span>
        <span class="s1">&#39;ksp_type&#39;</span><span class="p">:</span> <span class="s1">&#39;preonly&#39;</span><span class="p">,</span>
        <span class="s1">&#39;pc_type&#39;</span><span class="p">:</span> <span class="s1">&#39;lu&#39;</span><span class="p">,</span>
        <span class="s1">&#39;mat_type&#39;</span><span class="p">:</span> <span class="s1">&#39;aij&#39;</span>
    <span class="p">})</span><span class="o">.</span><span class="n">tag</span><span class="p">(</span><span class="n">config</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span></div>


<div class="viewcode-block" id="CrankNicolsonSWETimeStepperOptions2d"><a class="viewcode-back" href="../../thetis.html#thetis.options.CrankNicolsonSWETimeStepperOptions2d">[docs]</a><span class="k">class</span> <span class="nc">CrankNicolsonSWETimeStepperOptions2d</span><span class="p">(</span><span class="n">SemiImplicitSWETimeStepperOptions2d</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Options for 2d Crank-Nicolson time integrator</span>
<span class="sd">    applied to shallow water equations</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">implicitness_theta</span> <span class="o">=</span> <span class="n">BoundedFloat</span><span class="p">(</span>
        <span class="n">default_value</span><span class="o">=</span><span class="mf">0.5</span><span class="p">,</span> <span class="n">bounds</span><span class="o">=</span><span class="p">[</span><span class="mf">0.5</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">],</span>
        <span class="n">help</span><span class="o">=</span><span class="s1">&#39;implicitness parameter theta. Value 0.5 implies Crank-Nicolson scheme, 1.0 implies fully implicit formulation.&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">tag</span><span class="p">(</span><span class="n">config</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span></div>


<div class="viewcode-block" id="CrankNicolsonTracerTimeStepperOptions2d"><a class="viewcode-back" href="../../thetis.html#thetis.options.CrankNicolsonTracerTimeStepperOptions2d">[docs]</a><span class="k">class</span> <span class="nc">CrankNicolsonTracerTimeStepperOptions2d</span><span class="p">(</span><span class="n">SemiImplicitTracerTimeStepperOptions2d</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Options for 2d Crank-Nicolson time integrator</span>
<span class="sd">    applied to tracer equations</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">implicitness_theta</span> <span class="o">=</span> <span class="n">BoundedFloat</span><span class="p">(</span>
        <span class="n">default_value</span><span class="o">=</span><span class="mf">0.5</span><span class="p">,</span> <span class="n">bounds</span><span class="o">=</span><span class="p">[</span><span class="mf">0.5</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">],</span>
        <span class="n">help</span><span class="o">=</span><span class="s1">&#39;implicitness parameter theta. Value 0.5 implies Crank-Nicolson scheme, 1.0 implies fully implicit formulation.&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">tag</span><span class="p">(</span><span class="n">config</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span></div>


<div class="viewcode-block" id="PressureProjectionSWETimeStepperOptions2d"><a class="viewcode-back" href="../../thetis.html#thetis.options.PressureProjectionSWETimeStepperOptions2d">[docs]</a><span class="k">class</span> <span class="nc">PressureProjectionSWETimeStepperOptions2d</span><span class="p">(</span><span class="n">TimeStepperOptions</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Options for 2d pressure-projection time integrator</span>
<span class="sd">    applied to shallow water equations</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">solver_parameters_pressure</span> <span class="o">=</span> <span class="n">PETScSolverParameters</span><span class="p">({</span>
        <span class="s1">&#39;ksp_type&#39;</span><span class="p">:</span> <span class="s1">&#39;preonly&#39;</span><span class="p">,</span>  <span class="c1"># we solve the full schur complement exactly, so no need for outer krylov</span>
        <span class="s1">&#39;mat_type&#39;</span><span class="p">:</span> <span class="s1">&#39;matfree&#39;</span><span class="p">,</span>
        <span class="s1">&#39;pc_type&#39;</span><span class="p">:</span> <span class="s1">&#39;fieldsplit&#39;</span><span class="p">,</span>
        <span class="s1">&#39;pc_fieldsplit_type&#39;</span><span class="p">:</span> <span class="s1">&#39;schur&#39;</span><span class="p">,</span>
        <span class="s1">&#39;pc_fieldsplit_schur_fact_type&#39;</span><span class="p">:</span> <span class="s1">&#39;full&#39;</span><span class="p">,</span>
        <span class="c1"># velocity mass block:</span>
        <span class="s1">&#39;fieldsplit_U_2d&#39;</span><span class="p">:</span> <span class="p">{</span>
            <span class="s1">&#39;ksp_type&#39;</span><span class="p">:</span> <span class="s1">&#39;gmres&#39;</span><span class="p">,</span>
            <span class="s1">&#39;pc_type&#39;</span><span class="p">:</span> <span class="s1">&#39;python&#39;</span><span class="p">,</span>
            <span class="s1">&#39;pc_python_type&#39;</span><span class="p">:</span> <span class="s1">&#39;firedrake.AssembledPC&#39;</span><span class="p">,</span>
            <span class="s1">&#39;assembled_ksp_type&#39;</span><span class="p">:</span> <span class="s1">&#39;preonly&#39;</span><span class="p">,</span>
            <span class="s1">&#39;assembled_pc_type&#39;</span><span class="p">:</span> <span class="s1">&#39;bjacobi&#39;</span><span class="p">,</span>
            <span class="s1">&#39;assembled_sub_pc_type&#39;</span><span class="p">:</span> <span class="s1">&#39;ilu&#39;</span><span class="p">,</span>
        <span class="p">},</span>
        <span class="c1"># schur system: explicitly assemble the schur system</span>
        <span class="c1"># this only works with pressureprojectionicard if the velocity block is just the mass matrix</span>
        <span class="c1"># and if the velocity is DG so that this mass matrix can be inverted explicitly</span>
        <span class="s1">&#39;fieldsplit_H_2d&#39;</span><span class="p">:</span> <span class="p">{</span>
            <span class="s1">&#39;ksp_type&#39;</span><span class="p">:</span> <span class="s1">&#39;preonly&#39;</span><span class="p">,</span>
            <span class="s1">&#39;pc_type&#39;</span><span class="p">:</span> <span class="s1">&#39;python&#39;</span><span class="p">,</span>
            <span class="s1">&#39;pc_python_type&#39;</span><span class="p">:</span> <span class="s1">&#39;thetis.AssembledSchurPC&#39;</span><span class="p">,</span>
            <span class="s1">&#39;schur_ksp_type&#39;</span><span class="p">:</span> <span class="s1">&#39;gmres&#39;</span><span class="p">,</span>
            <span class="s1">&#39;schur_ksp_max_it&#39;</span><span class="p">:</span> <span class="mi">100</span><span class="p">,</span>
            <span class="s1">&#39;schur_pc_type&#39;</span><span class="p">:</span> <span class="s1">&#39;gamg&#39;</span><span class="p">,</span>
        <span class="p">},</span>
    <span class="p">})</span><span class="o">.</span><span class="n">tag</span><span class="p">(</span><span class="n">config</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
    <span class="n">solver_parameters_momentum</span> <span class="o">=</span> <span class="n">PETScSolverParameters</span><span class="p">({</span>
        <span class="s1">&#39;ksp_type&#39;</span><span class="p">:</span> <span class="s1">&#39;gmres&#39;</span><span class="p">,</span>
        <span class="s1">&#39;pc_type&#39;</span><span class="p">:</span> <span class="s1">&#39;bjacobi&#39;</span><span class="p">,</span>
        <span class="s1">&#39;sub_ksp_type&#39;</span><span class="p">:</span> <span class="s1">&#39;preonly&#39;</span><span class="p">,</span>
        <span class="s1">&#39;sub_pc_type&#39;</span><span class="p">:</span> <span class="s1">&#39;sor&#39;</span><span class="p">,</span>
    <span class="p">})</span><span class="o">.</span><span class="n">tag</span><span class="p">(</span><span class="n">config</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
    <span class="n">implicitness_theta</span> <span class="o">=</span> <span class="n">BoundedFloat</span><span class="p">(</span>
        <span class="n">default_value</span><span class="o">=</span><span class="mf">0.5</span><span class="p">,</span> <span class="n">bounds</span><span class="o">=</span><span class="p">[</span><span class="mf">0.5</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">],</span>
        <span class="n">help</span><span class="o">=</span><span class="s1">&#39;implicitness parameter theta. Value 0.5 implies Crank-Nicolson scheme, 1.0 implies fully implicit formulation.&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">tag</span><span class="p">(</span><span class="n">config</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
    <span class="n">use_semi_implicit_linearization</span> <span class="o">=</span> <span class="n">Bool</span><span class="p">(</span>
        <span class="kc">True</span><span class="p">,</span> <span class="n">help</span><span class="o">=</span><span class="s2">&quot;Use linearized semi-implicit time integration&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">tag</span><span class="p">(</span><span class="n">config</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
    <span class="n">picard_iterations</span> <span class="o">=</span> <span class="n">PositiveInteger</span><span class="p">(</span>
        <span class="n">default_value</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span>
        <span class="n">help</span><span class="o">=</span><span class="s1">&#39;number of Picard iterations to converge the nonlinearity in the equations.&#39;</span><span class="p">)</span></div>


<div class="viewcode-block" id="ExplicitSWETimeStepperOptions2d"><a class="viewcode-back" href="../../thetis.html#thetis.options.ExplicitSWETimeStepperOptions2d">[docs]</a><span class="k">class</span> <span class="nc">ExplicitSWETimeStepperOptions2d</span><span class="p">(</span><span class="n">ExplicitTimeStepperOptions2d</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Options for 2d explicit time integrator</span>
<span class="sd">    applied to shallow water equations</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">solver_parameters</span> <span class="o">=</span> <span class="n">PETScSolverParameters</span><span class="p">({</span>
        <span class="s1">&#39;snes_type&#39;</span><span class="p">:</span> <span class="s1">&#39;ksponly&#39;</span><span class="p">,</span>
        <span class="s1">&#39;ksp_type&#39;</span><span class="p">:</span> <span class="s1">&#39;cg&#39;</span><span class="p">,</span>
        <span class="s1">&#39;pc_type&#39;</span><span class="p">:</span> <span class="s1">&#39;bjacobi&#39;</span><span class="p">,</span>
        <span class="s1">&#39;sub_ksp_type&#39;</span><span class="p">:</span> <span class="s1">&#39;preonly&#39;</span><span class="p">,</span>
        <span class="s1">&#39;sub_pc_type&#39;</span><span class="p">:</span> <span class="s1">&#39;ilu&#39;</span><span class="p">,</span>
        <span class="s1">&#39;mat_type&#39;</span><span class="p">:</span> <span class="s1">&#39;aij&#39;</span><span class="p">,</span>
    <span class="p">})</span><span class="o">.</span><span class="n">tag</span><span class="p">(</span><span class="n">config</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span></div>


<div class="viewcode-block" id="ExplicitTracerTimeStepperOptions2d"><a class="viewcode-back" href="../../thetis.html#thetis.options.ExplicitTracerTimeStepperOptions2d">[docs]</a><span class="k">class</span> <span class="nc">ExplicitTracerTimeStepperOptions2d</span><span class="p">(</span><span class="n">ExplicitTimeStepperOptions2d</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Options for 2d explicit time integrator</span>
<span class="sd">    applied to tracer equations</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">solver_parameters</span> <span class="o">=</span> <span class="n">PETScSolverParameters</span><span class="p">({</span>
        <span class="s1">&#39;ksp_type&#39;</span><span class="p">:</span> <span class="s1">&#39;gmres&#39;</span><span class="p">,</span>
        <span class="s1">&#39;pc_type&#39;</span><span class="p">:</span> <span class="s1">&#39;sor&#39;</span><span class="p">,</span>
    <span class="p">})</span><span class="o">.</span><span class="n">tag</span><span class="p">(</span><span class="n">config</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span></div>


<div class="viewcode-block" id="IMEXSWETimeStepperOptions2d"><a class="viewcode-back" href="../../thetis.html#thetis.options.IMEXSWETimeStepperOptions2d">[docs]</a><span class="k">class</span> <span class="nc">IMEXSWETimeStepperOptions2d</span><span class="p">(</span><span class="n">SemiImplicitTimeStepperOptions2d</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Options for 2d implicit-explicit time integrators</span>
<span class="sd">    applied to shallow water equations</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="c1"># TODO: Meaningful solver parameters for DIRK</span>
    <span class="n">solver_parameters</span> <span class="o">=</span> <span class="n">PETScSolverParameters</span><span class="p">({</span>
        <span class="s1">&#39;ksp_type&#39;</span><span class="p">:</span> <span class="s1">&#39;gmres&#39;</span><span class="p">,</span>
        <span class="s1">&#39;pc_type&#39;</span><span class="p">:</span> <span class="s1">&#39;fieldsplit&#39;</span><span class="p">,</span>
        <span class="s1">&#39;pc_fieldsplit_type&#39;</span><span class="p">:</span> <span class="s1">&#39;multiplicative&#39;</span><span class="p">,</span>
    <span class="p">})</span><span class="o">.</span><span class="n">tag</span><span class="p">(</span><span class="n">config</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span></div>


<div class="viewcode-block" id="TimeStepperOptions3d"><a class="viewcode-back" href="../../thetis.html#thetis.options.TimeStepperOptions3d">[docs]</a><span class="k">class</span> <span class="nc">TimeStepperOptions3d</span><span class="p">(</span><span class="n">FrozenHasTraits</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Options for 3d explicit time integrator&quot;&quot;&quot;</span>
    <span class="n">ad_block_tag</span> <span class="o">=</span> <span class="n">Unicode</span><span class="p">(</span><span class="n">default_value</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">allow_none</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">help</span><span class="o">=</span><span class="s2">&quot;&quot;&quot;</span>
<span class="s2">        Custom tag for the Pyadjoint blocks generated by</span>
<span class="s2">        this timestepper.</span>
<span class="s2">        &quot;&quot;&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">tag</span><span class="p">(</span><span class="n">config</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span></div>


<div class="viewcode-block" id="SWETimeStepperOptions3d"><a class="viewcode-back" href="../../thetis.html#thetis.options.SWETimeStepperOptions3d">[docs]</a><span class="k">class</span> <span class="nc">SWETimeStepperOptions3d</span><span class="p">(</span><span class="n">TimeStepperOptions3d</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Options for 3d time integrator</span>
<span class="sd">    shallow water component</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">solver_parameters</span> <span class="o">=</span> <span class="n">PETScSolverParameters</span><span class="p">({</span>
        <span class="s1">&#39;ksp_type&#39;</span><span class="p">:</span> <span class="s1">&#39;gmres&#39;</span><span class="p">,</span>
        <span class="s1">&#39;pc_type&#39;</span><span class="p">:</span> <span class="s1">&#39;fieldsplit&#39;</span><span class="p">,</span>
        <span class="s1">&#39;pc_fieldsplit_type&#39;</span><span class="p">:</span> <span class="s1">&#39;multiplicative&#39;</span><span class="p">,</span>
    <span class="p">})</span><span class="o">.</span><span class="n">tag</span><span class="p">(</span><span class="n">config</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span></div>


<div class="viewcode-block" id="ImplicitSWETimeStepperOptions3d"><a class="viewcode-back" href="../../thetis.html#thetis.options.ImplicitSWETimeStepperOptions3d">[docs]</a><span class="k">class</span> <span class="nc">ImplicitSWETimeStepperOptions3d</span><span class="p">(</span><span class="n">SWETimeStepperOptions3d</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Options for 3d implicit time integrator</span>
<span class="sd">    shallow water component</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">implicitness_theta</span> <span class="o">=</span> <span class="n">BoundedFloat</span><span class="p">(</span>
        <span class="n">default_value</span><span class="o">=</span><span class="mf">0.5</span><span class="p">,</span> <span class="n">bounds</span><span class="o">=</span><span class="p">[</span><span class="mf">0.5</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">],</span>
        <span class="n">help</span><span class="o">=</span><span class="s1">&#39;implicitness parameter theta. Value 0.5 implies Crank-Nicolson scheme, 1.0 implies fully implicit formulation.&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">tag</span><span class="p">(</span><span class="n">config</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span></div>


<div class="viewcode-block" id="ExplicitMomentumTimeStepperOptions3d"><a class="viewcode-back" href="../../thetis.html#thetis.options.ExplicitMomentumTimeStepperOptions3d">[docs]</a><span class="k">class</span> <span class="nc">ExplicitMomentumTimeStepperOptions3d</span><span class="p">(</span><span class="n">TimeStepperOptions3d</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Options for 3d explicit time integrator</span>
<span class="sd">    momentum component</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">solver_parameters</span> <span class="o">=</span> <span class="n">PETScSolverParameters</span><span class="p">({</span>
        <span class="s1">&#39;snes_type&#39;</span><span class="p">:</span> <span class="s1">&#39;ksponly&#39;</span><span class="p">,</span>
        <span class="s1">&#39;ksp_type&#39;</span><span class="p">:</span> <span class="s1">&#39;cg&#39;</span><span class="p">,</span>
        <span class="s1">&#39;pc_type&#39;</span><span class="p">:</span> <span class="s1">&#39;bjacobi&#39;</span><span class="p">,</span>
        <span class="s1">&#39;sub_ksp_type&#39;</span><span class="p">:</span> <span class="s1">&#39;preonly&#39;</span><span class="p">,</span>
        <span class="s1">&#39;sub_pc_type&#39;</span><span class="p">:</span> <span class="s1">&#39;ilu&#39;</span><span class="p">,</span>
    <span class="p">})</span><span class="o">.</span><span class="n">tag</span><span class="p">(</span><span class="n">config</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span></div>


<div class="viewcode-block" id="ImplicitMomentumTimeStepperOptions3d"><a class="viewcode-back" href="../../thetis.html#thetis.options.ImplicitMomentumTimeStepperOptions3d">[docs]</a><span class="k">class</span> <span class="nc">ImplicitMomentumTimeStepperOptions3d</span><span class="p">(</span><span class="n">TimeStepperOptions3d</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Options for 3d implicit time integrator</span>
<span class="sd">    momentum component</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">solver_parameters</span> <span class="o">=</span> <span class="n">PETScSolverParameters</span><span class="p">({</span>
        <span class="s1">&#39;snes_type&#39;</span><span class="p">:</span> <span class="s1">&#39;ksponly&#39;</span><span class="p">,</span>
        <span class="s1">&#39;ksp_type&#39;</span><span class="p">:</span> <span class="s1">&#39;preonly&#39;</span><span class="p">,</span>
        <span class="s1">&#39;pc_type&#39;</span><span class="p">:</span> <span class="s1">&#39;bjacobi&#39;</span><span class="p">,</span>
        <span class="s1">&#39;sub_ksp_type&#39;</span><span class="p">:</span> <span class="s1">&#39;preonly&#39;</span><span class="p">,</span>
        <span class="s1">&#39;sub_pc_type&#39;</span><span class="p">:</span> <span class="s1">&#39;ilu&#39;</span><span class="p">,</span>
    <span class="p">})</span><span class="o">.</span><span class="n">tag</span><span class="p">(</span><span class="n">config</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span></div>


<div class="viewcode-block" id="ExplicitTracerTimeStepperOptions3d"><a class="viewcode-back" href="../../thetis.html#thetis.options.ExplicitTracerTimeStepperOptions3d">[docs]</a><span class="k">class</span> <span class="nc">ExplicitTracerTimeStepperOptions3d</span><span class="p">(</span><span class="n">TimeStepperOptions3d</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Options for 3d explicit time integrator</span>
<span class="sd">    applied to tracer equations</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">solver_parameters</span> <span class="o">=</span> <span class="n">PETScSolverParameters</span><span class="p">({</span>
        <span class="s1">&#39;snes_type&#39;</span><span class="p">:</span> <span class="s1">&#39;ksponly&#39;</span><span class="p">,</span>
        <span class="s1">&#39;ksp_type&#39;</span><span class="p">:</span> <span class="s1">&#39;cg&#39;</span><span class="p">,</span>
        <span class="s1">&#39;pc_type&#39;</span><span class="p">:</span> <span class="s1">&#39;bjacobi&#39;</span><span class="p">,</span>
        <span class="s1">&#39;sub_ksp_type&#39;</span><span class="p">:</span> <span class="s1">&#39;preonly&#39;</span><span class="p">,</span>
        <span class="s1">&#39;sub_pc_type&#39;</span><span class="p">:</span> <span class="s1">&#39;ilu&#39;</span><span class="p">,</span>
    <span class="p">})</span><span class="o">.</span><span class="n">tag</span><span class="p">(</span><span class="n">config</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span></div>


<div class="viewcode-block" id="ImplicitTracerTimeStepperOptions3d"><a class="viewcode-back" href="../../thetis.html#thetis.options.ImplicitTracerTimeStepperOptions3d">[docs]</a><span class="k">class</span> <span class="nc">ImplicitTracerTimeStepperOptions3d</span><span class="p">(</span><span class="n">TimeStepperOptions3d</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Options for 3d implicit time integrator</span>
<span class="sd">    applied to tracer equations</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">solver_parameters</span> <span class="o">=</span> <span class="n">PETScSolverParameters</span><span class="p">({</span>
        <span class="s1">&#39;snes_type&#39;</span><span class="p">:</span> <span class="s1">&#39;ksponly&#39;</span><span class="p">,</span>
        <span class="s1">&#39;ksp_type&#39;</span><span class="p">:</span> <span class="s1">&#39;preonly&#39;</span><span class="p">,</span>
        <span class="s1">&#39;pc_type&#39;</span><span class="p">:</span> <span class="s1">&#39;bjacobi&#39;</span><span class="p">,</span>
        <span class="s1">&#39;sub_ksp_type&#39;</span><span class="p">:</span> <span class="s1">&#39;preonly&#39;</span><span class="p">,</span>
        <span class="s1">&#39;sub_pc_type&#39;</span><span class="p">:</span> <span class="s1">&#39;ilu&#39;</span><span class="p">,</span>
    <span class="p">})</span><span class="o">.</span><span class="n">tag</span><span class="p">(</span><span class="n">config</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span></div>


<div class="viewcode-block" id="SSPRKTimeStepperOptions3d"><a class="viewcode-back" href="../../thetis.html#thetis.options.SSPRKTimeStepperOptions3d">[docs]</a><span class="k">class</span> <span class="nc">SSPRKTimeStepperOptions3d</span><span class="p">(</span><span class="n">TimeStepperOptions3d</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Options for 3d SSPRK coupled time integrator&quot;&quot;&quot;</span>
    <span class="n">use_automatic_timestep</span> <span class="o">=</span> <span class="n">Bool</span><span class="p">(</span><span class="kc">True</span><span class="p">,</span> <span class="n">help</span><span class="o">=</span><span class="s1">&#39;Set time step automatically based on local CFL conditions.&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">tag</span><span class="p">(</span><span class="n">config</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
    <span class="n">swe_options</span> <span class="o">=</span> <span class="n">SWETimeStepperOptions3d</span><span class="p">()</span>
    <span class="n">implicit_momentum_options</span> <span class="o">=</span> <span class="n">ImplicitMomentumTimeStepperOptions3d</span><span class="p">()</span>
    <span class="n">explicit_momentum_options</span> <span class="o">=</span> <span class="n">ExplicitMomentumTimeStepperOptions3d</span><span class="p">()</span>
    <span class="n">implicit_tracer_options</span> <span class="o">=</span> <span class="n">ImplicitTracerTimeStepperOptions3d</span><span class="p">()</span>
    <span class="n">explicit_tracer_options</span> <span class="o">=</span> <span class="n">ExplicitTracerTimeStepperOptions3d</span><span class="p">()</span></div>


<div class="viewcode-block" id="LeapFrogTimeStepperOptions3d"><a class="viewcode-back" href="../../thetis.html#thetis.options.LeapFrogTimeStepperOptions3d">[docs]</a><span class="k">class</span> <span class="nc">LeapFrogTimeStepperOptions3d</span><span class="p">(</span><span class="n">SSPRKTimeStepperOptions3d</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Options for 3d LeapFrog coupled time integrator&quot;&quot;&quot;</span>
    <span class="n">swe_options</span> <span class="o">=</span> <span class="n">ImplicitSWETimeStepperOptions3d</span><span class="p">()</span></div>


<div class="viewcode-block" id="TurbulenceModelOptions"><a class="viewcode-back" href="../../thetis.html#thetis.options.TurbulenceModelOptions">[docs]</a><span class="k">class</span> <span class="nc">TurbulenceModelOptions</span><span class="p">(</span><span class="n">FrozenHasTraits</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Abstract base class for all turbulence model options&quot;&quot;&quot;</span>
    <span class="n">name</span> <span class="o">=</span> <span class="s1">&#39;Turbulence closure model&#39;</span></div>


<div class="viewcode-block" id="PacanowskiPhilanderModelOptions"><a class="viewcode-back" href="../../thetis.html#thetis.options.PacanowskiPhilanderModelOptions">[docs]</a><span class="k">class</span> <span class="nc">PacanowskiPhilanderModelOptions</span><span class="p">(</span><span class="n">TurbulenceModelOptions</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Options for Pacanowski-Philander turbulence model&quot;&quot;&quot;</span>
    <span class="n">name</span> <span class="o">=</span> <span class="s1">&#39;Pacanowski-Philander turbulence closure model&#39;</span>
    <span class="n">max_viscosity</span> <span class="o">=</span> <span class="n">PositiveFloat</span><span class="p">(</span><span class="mf">5e-2</span><span class="p">,</span> <span class="n">help</span><span class="o">=</span><span class="sa">r</span><span class="s2">&quot;float: Constant maximum viscosity :math:`\nu_</span><span class="si">{max}</span><span class="s2">`&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">tag</span><span class="p">(</span><span class="n">config</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
    <span class="n">alpha</span> <span class="o">=</span> <span class="n">PositiveFloat</span><span class="p">(</span><span class="mf">10.0</span><span class="p">,</span> <span class="n">help</span><span class="o">=</span><span class="s2">&quot;float: Richardson number multiplier&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">tag</span><span class="p">(</span><span class="n">config</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
    <span class="n">exponent</span> <span class="o">=</span> <span class="n">PositiveFloat</span><span class="p">(</span><span class="mf">2.0</span><span class="p">,</span> <span class="n">help</span><span class="o">=</span><span class="sa">r</span><span class="s2">&quot;float: Exponent of viscosity numerator :math:`n`&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">tag</span><span class="p">(</span><span class="n">config</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span></div>


<div class="viewcode-block" id="GLSModelOptions"><a class="viewcode-back" href="../../thetis.html#thetis.options.GLSModelOptions">[docs]</a><span class="k">class</span> <span class="nc">GLSModelOptions</span><span class="p">(</span><span class="n">TurbulenceModelOptions</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Options for Generic Length Scale turbulence model&quot;&quot;&quot;</span>
    <span class="n">name</span> <span class="o">=</span> <span class="s1">&#39;Generic Length Scale turbulence closure model&#39;</span>
    <span class="n">closure_name</span> <span class="o">=</span> <span class="n">Enum</span><span class="p">(</span>
        <span class="p">[</span><span class="s1">&#39;k-epsilon&#39;</span><span class="p">,</span> <span class="s1">&#39;k-omega&#39;</span><span class="p">,</span> <span class="s1">&#39;Generic Length Scale&#39;</span><span class="p">],</span>
        <span class="n">default_value</span><span class="o">=</span><span class="s1">&#39;k-epsilon&#39;</span><span class="p">,</span>
        <span class="n">help</span><span class="o">=</span><span class="s1">&#39;Name of two-equation closure&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">tag</span><span class="p">(</span><span class="n">config</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
    <span class="n">stability_function_name</span> <span class="o">=</span> <span class="n">Enum</span><span class="p">(</span>
        <span class="p">[</span><span class="s1">&#39;Canuto A&#39;</span><span class="p">,</span> <span class="s1">&#39;Canuto B&#39;</span><span class="p">,</span> <span class="s1">&#39;Kantha-Clayson&#39;</span><span class="p">,</span> <span class="s1">&#39;Cheng&#39;</span><span class="p">],</span>
        <span class="n">default_value</span><span class="o">=</span><span class="s1">&#39;Canuto A&#39;</span><span class="p">,</span>
        <span class="n">help</span><span class="o">=</span><span class="s1">&#39;Name of stability function family&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">tag</span><span class="p">(</span><span class="n">config</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
    <span class="n">p</span> <span class="o">=</span> <span class="n">Float</span><span class="p">(</span><span class="mf">3.0</span><span class="p">,</span>
              <span class="n">help</span><span class="o">=</span><span class="s1">&#39;float: parameter p for the definition of psi&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">tag</span><span class="p">(</span><span class="n">config</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
    <span class="n">m</span> <span class="o">=</span> <span class="n">Float</span><span class="p">(</span><span class="mf">1.5</span><span class="p">,</span>
              <span class="n">help</span><span class="o">=</span><span class="s1">&#39;float: parameter m for the definition of psi&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">tag</span><span class="p">(</span><span class="n">config</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
    <span class="n">n</span> <span class="o">=</span> <span class="n">Float</span><span class="p">(</span><span class="o">-</span><span class="mf">1.0</span><span class="p">,</span>
              <span class="n">help</span><span class="o">=</span><span class="s1">&#39;float: parameter n for the definition of psi&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">tag</span><span class="p">(</span><span class="n">config</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
    <span class="n">schmidt_nb_tke</span> <span class="o">=</span> <span class="n">PositiveFloat</span><span class="p">(</span><span class="mf">1.0</span><span class="p">,</span>
                                   <span class="n">help</span><span class="o">=</span><span class="s1">&#39;float: turbulent kinetic energy Schmidt number&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">tag</span><span class="p">(</span><span class="n">config</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
    <span class="n">schmidt_nb_psi</span> <span class="o">=</span> <span class="n">PositiveFloat</span><span class="p">(</span><span class="mf">1.3</span><span class="p">,</span>
                                   <span class="n">help</span><span class="o">=</span><span class="s1">&#39;float: psi Schmidt number&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">tag</span><span class="p">(</span><span class="n">config</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
    <span class="n">cmu0</span> <span class="o">=</span> <span class="n">PositiveFloat</span><span class="p">(</span><span class="mf">0.5477</span><span class="p">,</span>
                         <span class="n">help</span><span class="o">=</span><span class="s1">&#39;float: cmu0 parameter&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">tag</span><span class="p">(</span><span class="n">config</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
    <span class="n">compute_cmu0</span> <span class="o">=</span> <span class="n">Bool</span><span class="p">(</span>
        <span class="kc">True</span><span class="p">,</span> <span class="n">help</span><span class="o">=</span><span class="s2">&quot;&quot;&quot;bool: compute cmu0 from stability function parameters</span>

<span class="s2">        If :attr:`compute_cmu0` is True, this value will be overriden&quot;&quot;&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">tag</span><span class="p">(</span><span class="n">config</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
    <span class="n">c1</span> <span class="o">=</span> <span class="n">Float</span><span class="p">(</span><span class="mf">1.44</span><span class="p">,</span> <span class="n">help</span><span class="o">=</span><span class="s1">&#39;float: c1 parameter for Psi equations&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">tag</span><span class="p">(</span><span class="n">config</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
    <span class="n">c2</span> <span class="o">=</span> <span class="n">Float</span><span class="p">(</span><span class="mf">1.92</span><span class="p">,</span> <span class="n">help</span><span class="o">=</span><span class="s1">&#39;float: c2 parameter for Psi equations&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">tag</span><span class="p">(</span><span class="n">config</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
    <span class="n">c3_minus</span> <span class="o">=</span> <span class="n">Float</span><span class="p">(</span>
        <span class="o">-</span><span class="mf">0.52</span><span class="p">,</span> <span class="n">help</span><span class="o">=</span><span class="s2">&quot;&quot;&quot;float: c3 parameter for Psi equations, stable stratification</span>

<span class="s2">        If :attr:`compute_c3_minus` is True this value will be overriden&quot;&quot;&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">tag</span><span class="p">(</span><span class="n">config</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
    <span class="n">c3_plus</span> <span class="o">=</span> <span class="n">Float</span><span class="p">(</span><span class="mf">1.0</span><span class="p">,</span>
                    <span class="n">help</span><span class="o">=</span><span class="s1">&#39;float: c3 parameter for Psi equations, unstable stratification&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">tag</span><span class="p">(</span><span class="n">config</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
    <span class="n">compute_c3_minus</span> <span class="o">=</span> <span class="n">Bool</span><span class="p">(</span><span class="kc">True</span><span class="p">,</span>
                            <span class="n">help</span><span class="o">=</span><span class="s1">&#39;bool: compute :attr:`c3_minus` from :attr:`ri_st`&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">tag</span><span class="p">(</span><span class="n">config</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
    <span class="n">f_wall</span> <span class="o">=</span> <span class="n">Float</span><span class="p">(</span><span class="mf">1.0</span><span class="p">,</span> <span class="n">help</span><span class="o">=</span><span class="s1">&#39;float: wall function parameter&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">tag</span><span class="p">(</span><span class="n">config</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
    <span class="n">ri_st</span> <span class="o">=</span> <span class="n">Float</span><span class="p">(</span><span class="mf">0.25</span><span class="p">,</span> <span class="n">help</span><span class="o">=</span><span class="s1">&#39;steady state gradient Richardson number&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">tag</span><span class="p">(</span><span class="n">config</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
    <span class="c1"># FIXME should default to physical_constants[&#39;von_karman&#39;] ??</span>
    <span class="c1"># FIXME remove the dualism of von Karman constant</span>
    <span class="n">kappa</span> <span class="o">=</span> <span class="n">Float</span><span class="p">(</span>
        <span class="mf">0.4</span><span class="p">,</span> <span class="n">help</span><span class="o">=</span><span class="s2">&quot;&quot;&quot;float: von Karman constant</span>

<span class="s2">        If :attr:`compute_kappa` is True this value will be overriden&quot;&quot;&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">tag</span><span class="p">(</span><span class="n">config</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
    <span class="n">compute_kappa</span> <span class="o">=</span> <span class="n">Bool</span><span class="p">(</span><span class="kc">False</span><span class="p">,</span>
                         <span class="n">help</span><span class="o">=</span><span class="s1">&#39;bool: compute von Karman constant from :attr:`schmidt_nb_psi`&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">tag</span><span class="p">(</span><span class="n">config</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
    <span class="n">compute_schmidt_nb_psi</span> <span class="o">=</span> <span class="n">Bool</span><span class="p">(</span><span class="kc">True</span><span class="p">,</span>
                                  <span class="n">help</span><span class="o">=</span><span class="s1">&#39;bool: compute psi Schmidt number&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">tag</span><span class="p">(</span><span class="n">config</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
    <span class="n">k_min</span> <span class="o">=</span> <span class="n">PositiveFloat</span><span class="p">(</span><span class="mf">1.0e-6</span><span class="p">,</span>
                          <span class="n">help</span><span class="o">=</span><span class="s1">&#39;float: minimum value for turbulent kinetic energy&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">tag</span><span class="p">(</span><span class="n">config</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
    <span class="n">psi_min</span> <span class="o">=</span> <span class="n">PositiveFloat</span><span class="p">(</span><span class="mf">1.0e-14</span><span class="p">,</span> <span class="n">help</span><span class="o">=</span><span class="s1">&#39;float: minimum value for psi&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">tag</span><span class="p">(</span><span class="n">config</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
    <span class="n">eps_min</span> <span class="o">=</span> <span class="n">PositiveFloat</span><span class="p">(</span><span class="mf">1.0e-14</span><span class="p">,</span> <span class="n">help</span><span class="o">=</span><span class="s1">&#39;float: minimum value for epsilon&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">tag</span><span class="p">(</span><span class="n">config</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
    <span class="n">len_min</span> <span class="o">=</span> <span class="n">PositiveFloat</span><span class="p">(</span><span class="mf">1.0e-12</span><span class="p">,</span>
                            <span class="n">help</span><span class="o">=</span><span class="s1">&#39;float: minimum value for turbulent length scale&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">tag</span><span class="p">(</span><span class="n">config</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
    <span class="n">compute_galperin_clim</span> <span class="o">=</span> <span class="n">Bool</span><span class="p">(</span><span class="kc">True</span><span class="p">,</span>
                                 <span class="n">help</span><span class="o">=</span><span class="s1">&#39;bool: compute c_lim length scale limiting factor&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">tag</span><span class="p">(</span><span class="n">config</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
    <span class="n">compute_len_min</span> <span class="o">=</span> <span class="n">Bool</span><span class="p">(</span><span class="kc">False</span><span class="p">,</span>
                           <span class="n">help</span><span class="o">=</span><span class="s1">&#39;bool: compute min_len from k_min and psi_min&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">tag</span><span class="p">(</span><span class="n">config</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
    <span class="n">compute_psi_min</span> <span class="o">=</span> <span class="n">Bool</span><span class="p">(</span><span class="kc">False</span><span class="p">,</span>
                           <span class="n">help</span><span class="o">=</span><span class="s1">&#39;bool: compute psi_len from k_min and eps_min&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">tag</span><span class="p">(</span><span class="n">config</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
    <span class="n">visc_min</span> <span class="o">=</span> <span class="n">PositiveFloat</span><span class="p">(</span><span class="mf">1.0e-8</span><span class="p">,</span>
                             <span class="n">help</span><span class="o">=</span><span class="s1">&#39;float: minimum value for eddy viscosity&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">tag</span><span class="p">(</span><span class="n">config</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
    <span class="n">diff_min</span> <span class="o">=</span> <span class="n">PositiveFloat</span><span class="p">(</span><span class="mf">1.0e-8</span><span class="p">,</span>
                             <span class="n">help</span><span class="o">=</span><span class="s1">&#39;float: minimum value for eddy diffusivity&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">tag</span><span class="p">(</span><span class="n">config</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
    <span class="n">galperin_clim</span> <span class="o">=</span> <span class="n">PositiveFloat</span><span class="p">(</span><span class="mf">0.30</span><span class="p">,</span>
                                  <span class="n">help</span><span class="o">=</span><span class="s1">&#39;float: Galperin length scale limitation parameter&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">tag</span><span class="p">(</span><span class="n">config</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

    <span class="n">limit_len</span> <span class="o">=</span> <span class="n">Bool</span><span class="p">(</span><span class="kc">False</span><span class="p">,</span> <span class="n">help</span><span class="o">=</span><span class="s1">&#39;bool: apply Galperin length scale limit&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">tag</span><span class="p">(</span><span class="n">config</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
    <span class="n">limit_psi</span> <span class="o">=</span> <span class="n">Bool</span><span class="p">(</span><span class="kc">True</span><span class="p">,</span>
                     <span class="n">help</span><span class="o">=</span><span class="s1">&#39;bool: apply Galperin length scale limit on psi&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">tag</span><span class="p">(</span><span class="n">config</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
    <span class="n">limit_eps</span> <span class="o">=</span> <span class="n">Bool</span><span class="p">(</span><span class="kc">False</span><span class="p">,</span>
                     <span class="n">help</span><span class="o">=</span><span class="s1">&#39;bool: apply Galperin length scale limit on epsilon&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">tag</span><span class="p">(</span><span class="n">config</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
    <span class="n">limit_len_min</span> <span class="o">=</span> <span class="n">Bool</span><span class="p">(</span><span class="kc">True</span><span class="p">,</span>
                         <span class="n">help</span><span class="o">=</span><span class="s1">&#39;bool: limit minimum turbulent length scale to len_min&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">tag</span><span class="p">(</span><span class="n">config</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

<div class="viewcode-block" id="GLSModelOptions.apply_defaults"><a class="viewcode-back" href="../../thetis.html#thetis.options.GLSModelOptions.apply_defaults">[docs]</a>    <span class="k">def</span> <span class="nf">apply_defaults</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">closure_name</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Applies default parameters for given closure name</span>

<span class="sd">        :arg closure_name: name of the turbulence closure model</span>
<span class="sd">        :type closure_name: string</span>

<span class="sd">        Sets default values for parameters p, m, n, schmidt_nb_tke,</span>
<span class="sd">        schmidt_nb_psi, c1, c2, c3_plus, c3_minus,</span>
<span class="sd">        f_wall, k_min, psi_min</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="n">kepsilon</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;p&#39;</span><span class="p">:</span> <span class="mi">3</span><span class="p">,</span>
                    <span class="s1">&#39;m&#39;</span><span class="p">:</span> <span class="mf">1.5</span><span class="p">,</span>
                    <span class="s1">&#39;n&#39;</span><span class="p">:</span> <span class="o">-</span><span class="mf">1.0</span><span class="p">,</span>
                    <span class="s1">&#39;cmu0&#39;</span><span class="p">:</span> <span class="mf">0.5477</span><span class="p">,</span>
                    <span class="s1">&#39;schmidt_nb_tke&#39;</span><span class="p">:</span> <span class="mf">1.0</span><span class="p">,</span>
                    <span class="s1">&#39;schmidt_nb_psi&#39;</span><span class="p">:</span> <span class="mf">1.3</span><span class="p">,</span>
                    <span class="s1">&#39;c1&#39;</span><span class="p">:</span> <span class="mf">1.44</span><span class="p">,</span>
                    <span class="s1">&#39;c2&#39;</span><span class="p">:</span> <span class="mf">1.92</span><span class="p">,</span>
                    <span class="s1">&#39;c3_plus&#39;</span><span class="p">:</span> <span class="mf">1.0</span><span class="p">,</span>
                    <span class="s1">&#39;c3_minus&#39;</span><span class="p">:</span> <span class="o">-</span><span class="mf">0.52</span><span class="p">,</span>
                    <span class="s1">&#39;f_wall&#39;</span><span class="p">:</span> <span class="mf">1.0</span><span class="p">,</span>
                    <span class="s1">&#39;k_min&#39;</span><span class="p">:</span> <span class="mf">1.0e-6</span><span class="p">,</span>
                    <span class="s1">&#39;eps_min&#39;</span><span class="p">:</span> <span class="mf">1.0e-14</span><span class="p">,</span>
                    <span class="s1">&#39;psi_min&#39;</span><span class="p">:</span> <span class="mf">1.0e-14</span><span class="p">,</span>
                    <span class="s1">&#39;closure_name&#39;</span><span class="p">:</span> <span class="s1">&#39;k-epsilon&#39;</span><span class="p">,</span>
                    <span class="p">}</span>
        <span class="c1"># k-epsilon defaults, from tables 1 and 2 in [3]</span>
        <span class="n">komega</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;p&#39;</span><span class="p">:</span> <span class="o">-</span><span class="mf">1.0</span><span class="p">,</span>
                  <span class="s1">&#39;m&#39;</span><span class="p">:</span> <span class="mf">0.5</span><span class="p">,</span>
                  <span class="s1">&#39;n&#39;</span><span class="p">:</span> <span class="o">-</span><span class="mf">1.0</span><span class="p">,</span>
                  <span class="s1">&#39;cmu0&#39;</span><span class="p">:</span> <span class="mf">0.5477</span><span class="p">,</span>
                  <span class="s1">&#39;schmidt_nb_tke&#39;</span><span class="p">:</span> <span class="mf">2.0</span><span class="p">,</span>
                  <span class="s1">&#39;schmidt_nb_psi&#39;</span><span class="p">:</span> <span class="mf">2.0</span><span class="p">,</span>
                  <span class="s1">&#39;c1&#39;</span><span class="p">:</span> <span class="mf">0.555</span><span class="p">,</span>
                  <span class="s1">&#39;c2&#39;</span><span class="p">:</span> <span class="mf">0.833</span><span class="p">,</span>
                  <span class="s1">&#39;c3_plus&#39;</span><span class="p">:</span> <span class="mf">1.0</span><span class="p">,</span>
                  <span class="s1">&#39;c3_minus&#39;</span><span class="p">:</span> <span class="o">-</span><span class="mf">0.52</span><span class="p">,</span>
                  <span class="s1">&#39;f_wall&#39;</span><span class="p">:</span> <span class="mf">1.0</span><span class="p">,</span>
                  <span class="s1">&#39;k_min&#39;</span><span class="p">:</span> <span class="mf">7.6e-6</span><span class="p">,</span>
                  <span class="s1">&#39;eps_min&#39;</span><span class="p">:</span> <span class="mf">1.0e-14</span><span class="p">,</span>
                  <span class="s1">&#39;psi_min&#39;</span><span class="p">:</span> <span class="mf">1.0e-14</span><span class="p">,</span>
                  <span class="s1">&#39;closure_name&#39;</span><span class="p">:</span> <span class="s1">&#39;k-omega&#39;</span><span class="p">,</span>
                  <span class="p">}</span>
        <span class="c1"># k-omega defaults, from tables 1 and 2 in [3]</span>
        <span class="n">gen</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;p&#39;</span><span class="p">:</span> <span class="mf">2.0</span><span class="p">,</span>
               <span class="s1">&#39;m&#39;</span><span class="p">:</span> <span class="mf">1.0</span><span class="p">,</span>
               <span class="s1">&#39;n&#39;</span><span class="p">:</span> <span class="o">-</span><span class="mf">0.67</span><span class="p">,</span>
               <span class="s1">&#39;cmu0&#39;</span><span class="p">:</span> <span class="mf">0.5477</span><span class="p">,</span>
               <span class="s1">&#39;schmidt_nb_tke&#39;</span><span class="p">:</span> <span class="mf">0.8</span><span class="p">,</span>
               <span class="s1">&#39;schmidt_nb_psi&#39;</span><span class="p">:</span> <span class="mf">1.07</span><span class="p">,</span>
               <span class="s1">&#39;c1&#39;</span><span class="p">:</span> <span class="mf">1.0</span><span class="p">,</span>
               <span class="s1">&#39;c2&#39;</span><span class="p">:</span> <span class="mf">1.22</span><span class="p">,</span>
               <span class="s1">&#39;c3_plus&#39;</span><span class="p">:</span> <span class="mf">1.0</span><span class="p">,</span>
               <span class="s1">&#39;c3_minus&#39;</span><span class="p">:</span> <span class="mf">0.05</span><span class="p">,</span>
               <span class="s1">&#39;f_wall&#39;</span><span class="p">:</span> <span class="mf">1.0</span><span class="p">,</span>
               <span class="s1">&#39;k_min&#39;</span><span class="p">:</span> <span class="mf">1.0e-6</span><span class="p">,</span>
               <span class="s1">&#39;eps_min&#39;</span><span class="p">:</span> <span class="mf">1.0e-14</span><span class="p">,</span>
               <span class="s1">&#39;psi_min&#39;</span><span class="p">:</span> <span class="mf">1.0e-14</span><span class="p">,</span>
               <span class="s1">&#39;closure_name&#39;</span><span class="p">:</span> <span class="s1">&#39;Generic Length Scale&#39;</span><span class="p">,</span>
               <span class="p">}</span>
        <span class="c1"># GLS model A defaults, from tables 1 and 2 in [3]</span>

        <span class="k">if</span> <span class="n">closure_name</span> <span class="o">==</span> <span class="s1">&#39;k-epsilon&#39;</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="n">kepsilon</span><span class="p">)</span>
        <span class="k">elif</span> <span class="n">closure_name</span> <span class="o">==</span> <span class="s1">&#39;k-omega&#39;</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="n">komega</span><span class="p">)</span>
        <span class="k">elif</span> <span class="n">closure_name</span> <span class="o">==</span> <span class="s1">&#39;Generic Length Scale&#39;</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="n">gen</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s1">&#39;Unknown closure name &quot;</span><span class="si">{:}</span><span class="s1">&quot;&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">closure_name</span><span class="p">))</span></div></div>


<div class="viewcode-block" id="EquationOfStateOptions"><a class="viewcode-back" href="../../thetis.html#thetis.options.EquationOfStateOptions">[docs]</a><span class="k">class</span> <span class="nc">EquationOfStateOptions</span><span class="p">(</span><span class="n">FrozenHasTraits</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Base class of equation of state options&quot;&quot;&quot;</span>
    <span class="n">name</span> <span class="o">=</span> <span class="s1">&#39;Equation of State&#39;</span></div>


<div class="viewcode-block" id="LinearEquationOfStateOptions"><a class="viewcode-back" href="../../thetis.html#thetis.options.LinearEquationOfStateOptions">[docs]</a><span class="k">class</span> <span class="nc">LinearEquationOfStateOptions</span><span class="p">(</span><span class="n">EquationOfStateOptions</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Linear equation of state options&quot;&quot;&quot;</span>
    <span class="c1"># TODO more human readable parameter names</span>
    <span class="c1"># TODO document the actual equation somewhere</span>
    <span class="n">name</span> <span class="o">=</span> <span class="s1">&#39;Linear Equation of State&#39;</span>
    <span class="n">rho_ref</span> <span class="o">=</span> <span class="n">NonNegativeFloat</span><span class="p">(</span><span class="mf">1000.0</span><span class="p">,</span> <span class="n">help</span><span class="o">=</span><span class="s1">&#39;Reference water density&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">tag</span><span class="p">(</span><span class="n">config</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
    <span class="n">s_ref</span> <span class="o">=</span> <span class="n">NonNegativeFloat</span><span class="p">(</span><span class="mf">35.0</span><span class="p">,</span> <span class="n">help</span><span class="o">=</span><span class="s1">&#39;Reference water salinity&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">tag</span><span class="p">(</span><span class="n">config</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
    <span class="n">th_ref</span> <span class="o">=</span> <span class="n">Float</span><span class="p">(</span><span class="mf">15.0</span><span class="p">,</span> <span class="n">help</span><span class="o">=</span><span class="s1">&#39;Reference water temperature&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">tag</span><span class="p">(</span><span class="n">config</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
    <span class="n">alpha</span> <span class="o">=</span> <span class="n">Float</span><span class="p">(</span><span class="mf">0.2</span><span class="p">,</span> <span class="n">help</span><span class="o">=</span><span class="s1">&#39;Thermal expansion coefficient of ocean water&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">tag</span><span class="p">(</span><span class="n">config</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
    <span class="n">beta</span> <span class="o">=</span> <span class="n">Float</span><span class="p">(</span><span class="mf">0.77</span><span class="p">,</span> <span class="n">help</span><span class="o">=</span><span class="s1">&#39;Saline contraction coefficient of ocean water&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">tag</span><span class="p">(</span><span class="n">config</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span></div>


<div class="viewcode-block" id="TidalTurbineOptions"><a class="viewcode-back" href="../../thetis.html#thetis.options.TidalTurbineOptions">[docs]</a><span class="k">class</span> <span class="nc">TidalTurbineOptions</span><span class="p">(</span><span class="n">FrozenHasTraits</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Tidal turbine parameters&quot;&quot;&quot;</span>
    <span class="n">thrust_coefficient</span> <span class="o">=</span> <span class="n">PositiveFloat</span><span class="p">(</span>
        <span class="mf">0.8</span><span class="p">,</span> <span class="n">help</span><span class="o">=</span><span class="s1">&#39;Thrust coefficient C_T&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">tag</span><span class="p">(</span><span class="n">config</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
    <span class="n">diameter</span> <span class="o">=</span> <span class="n">PositiveFloat</span><span class="p">(</span>
        <span class="mf">18.</span><span class="p">,</span> <span class="n">help</span><span class="o">=</span><span class="s1">&#39;Turbine diameter&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">tag</span><span class="p">(</span><span class="n">config</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span></div>


<div class="viewcode-block" id="TidalTurbineFarmOptions"><a class="viewcode-back" href="../../thetis.html#thetis.options.TidalTurbineFarmOptions">[docs]</a><span class="k">class</span> <span class="nc">TidalTurbineFarmOptions</span><span class="p">(</span><span class="n">FrozenHasTraits</span><span class="p">,</span> <span class="n">TraitType</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Tidal turbine farm options&quot;&quot;&quot;</span>
    <span class="n">name</span> <span class="o">=</span> <span class="s1">&#39;Farm options&#39;</span>
    <span class="n">turbine_options</span> <span class="o">=</span> <span class="n">TidalTurbineOptions</span><span class="p">()</span>
    <span class="n">turbine_density</span> <span class="o">=</span> <span class="n">FiredrakeScalarExpression</span><span class="p">(</span>
        <span class="n">Constant</span><span class="p">(</span><span class="mf">0.0</span><span class="p">),</span> <span class="n">help</span><span class="o">=</span><span class="s1">&#39;Density of turbines within the farm&#39;</span><span class="p">)</span>
    <span class="n">break_even_wattage</span> <span class="o">=</span> <span class="n">NonNegativeFloat</span><span class="p">(</span>
        <span class="mf">0.0</span><span class="p">,</span> <span class="n">help</span><span class="o">=</span><span class="s1">&#39;Average power production per turbine required to break even&#39;</span><span class="p">)</span></div>


<div class="viewcode-block" id="TracerFieldOptions"><a class="viewcode-back" href="../../thetis.html#thetis.options.TracerFieldOptions">[docs]</a><span class="k">class</span> <span class="nc">TracerFieldOptions</span><span class="p">(</span><span class="n">FrozenHasTraits</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Tracer field options&quot;&quot;&quot;</span>
    <span class="n">name</span> <span class="o">=</span> <span class="s1">&#39;Tracer options&#39;</span>
    <span class="n">function</span> <span class="o">=</span> <span class="n">FiredrakeScalarExpression</span><span class="p">(</span>
        <span class="kc">None</span><span class="p">,</span> <span class="n">allow_none</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">help</span><span class="o">=</span><span class="s1">&#39;Firedrake Function representing the tracer&#39;</span><span class="p">)</span>
    <span class="n">source</span> <span class="o">=</span> <span class="n">FiredrakeScalarExpression</span><span class="p">(</span>
        <span class="kc">None</span><span class="p">,</span> <span class="n">allow_none</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">help</span><span class="o">=</span><span class="s1">&#39;Source term for the tracer equation&#39;</span><span class="p">)</span>
    <span class="n">diffusivity</span> <span class="o">=</span> <span class="n">FiredrakeScalarExpression</span><span class="p">(</span>
        <span class="kc">None</span><span class="p">,</span> <span class="n">allow_none</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">help</span><span class="o">=</span><span class="s1">&#39;Diffusion coefficient for the tracer equation&#39;</span><span class="p">)</span>
    <span class="n">use_conservative_form</span> <span class="o">=</span> <span class="n">Bool</span><span class="p">(</span>
        <span class="kc">False</span><span class="p">,</span> <span class="n">help</span><span class="o">=</span><span class="s1">&#39;Should the tracer equation be solved in conservative form?&#39;</span><span class="p">)</span>
    <span class="n">metadata</span> <span class="o">=</span> <span class="n">Dict</span><span class="p">({</span>
        <span class="s1">&#39;label&#39;</span><span class="p">:</span> <span class="s1">&#39;tracer_2d&#39;</span><span class="p">,</span>
        <span class="s1">&#39;name&#39;</span><span class="p">:</span> <span class="s1">&#39;Depth averaged tracer&#39;</span><span class="p">,</span>
        <span class="s1">&#39;filename&#39;</span><span class="p">:</span> <span class="s1">&#39;Tracer2d&#39;</span><span class="p">,</span>
        <span class="s1">&#39;shortname&#39;</span><span class="p">:</span> <span class="s1">&#39;Tracer&#39;</span><span class="p">,</span>
        <span class="s1">&#39;unit&#39;</span><span class="p">:</span> <span class="s1">&#39;-&#39;</span><span class="p">,</span>
    <span class="p">},</span> <span class="n">help</span><span class="o">=</span><span class="s1">&#39;Dictionary of metadata for the tracer field&#39;</span><span class="p">)</span></div>


<div class="viewcode-block" id="NonhydrostaticModelOptions"><a class="viewcode-back" href="../../thetis.html#thetis.options.NonhydrostaticModelOptions">[docs]</a><span class="nd">@attach_paired_options</span><span class="p">(</span><span class="s2">&quot;free_surface_timestepper_type&quot;</span><span class="p">,</span>
                       <span class="n">PairedEnum</span><span class="p">([(</span><span class="s1">&#39;SSPRK33&#39;</span><span class="p">,</span> <span class="n">ExplicitTracerTimeStepperOptions2d</span><span class="p">),</span>
                                   <span class="p">(</span><span class="s1">&#39;ForwardEuler&#39;</span><span class="p">,</span> <span class="n">ExplicitTracerTimeStepperOptions2d</span><span class="p">),</span>
                                   <span class="p">(</span><span class="s1">&#39;BackwardEuler&#39;</span><span class="p">,</span> <span class="n">SemiImplicitTracerTimeStepperOptions2d</span><span class="p">),</span>
                                   <span class="p">(</span><span class="s1">&#39;CrankNicolson&#39;</span><span class="p">,</span> <span class="n">CrankNicolsonTracerTimeStepperOptions2d</span><span class="p">),</span>
                                   <span class="p">(</span><span class="s1">&#39;DIRK22&#39;</span><span class="p">,</span> <span class="n">SemiImplicitTracerTimeStepperOptions2d</span><span class="p">),</span>
                                   <span class="p">(</span><span class="s1">&#39;DIRK33&#39;</span><span class="p">,</span> <span class="n">SemiImplicitTracerTimeStepperOptions2d</span><span class="p">),</span>
                                   <span class="p">],</span>
                                  <span class="s2">&quot;free_surface_timestepper_options&quot;</span><span class="p">,</span>
                                  <span class="n">default_value</span><span class="o">=</span><span class="s1">&#39;CrankNicolson&#39;</span><span class="p">,</span>
                                  <span class="n">help</span><span class="o">=</span><span class="s1">&#39;Name of the free surface time integrator&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">tag</span><span class="p">(</span><span class="n">config</span><span class="o">=</span><span class="kc">True</span><span class="p">),</span>
                       <span class="n">Instance</span><span class="p">(</span><span class="n">TimeStepperOptions</span><span class="p">,</span> <span class="n">args</span><span class="o">=</span><span class="p">())</span><span class="o">.</span><span class="n">tag</span><span class="p">(</span><span class="n">config</span><span class="o">=</span><span class="kc">True</span><span class="p">))</span>
<span class="k">class</span> <span class="nc">NonhydrostaticModelOptions</span><span class="p">(</span><span class="n">FrozenHasTraits</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Options for non-hydrostatic models&quot;&quot;&quot;</span>
    <span class="n">name</span> <span class="o">=</span> <span class="s1">&#39;Non-hydrostatic 2D/3D models&#39;</span>
    <span class="n">solve_nonhydrostatic_pressure</span> <span class="o">=</span> <span class="n">Bool</span><span class="p">(</span><span class="kc">False</span><span class="p">,</span> <span class="n">help</span><span class="o">=</span><span class="s1">&#39;Solve equations with the non-hydrostatic pressure&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">tag</span><span class="p">(</span><span class="n">config</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
    <span class="n">q_degree</span> <span class="o">=</span> <span class="n">NonNegativeInteger</span><span class="p">(</span>
        <span class="kc">None</span><span class="p">,</span> <span class="n">allow_none</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">help</span><span class="o">=</span><span class="s2">&quot;Polynomial degree of the non-hydrostatic pressure space&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">tag</span><span class="p">(</span><span class="n">config</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
    <span class="n">update_free_surface</span> <span class="o">=</span> <span class="n">Bool</span><span class="p">(</span><span class="kc">True</span><span class="p">,</span> <span class="n">help</span><span class="o">=</span><span class="s1">&#39;Update free surface elevation after pressure projection/correction step&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">tag</span><span class="p">(</span><span class="n">config</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
    <span class="n">solver_parameters</span> <span class="o">=</span> <span class="n">PETScSolverParameters</span><span class="p">({</span>
        <span class="s1">&#39;snes_type&#39;</span><span class="p">:</span> <span class="s1">&#39;ksponly&#39;</span><span class="p">,</span>
        <span class="s1">&#39;ksp_type&#39;</span><span class="p">:</span> <span class="s1">&#39;preonly&#39;</span><span class="p">,</span>
        <span class="s1">&#39;mat_type&#39;</span><span class="p">:</span> <span class="s1">&#39;aij&#39;</span><span class="p">,</span>
        <span class="s1">&#39;pc_type&#39;</span><span class="p">:</span> <span class="s1">&#39;lu&#39;</span><span class="p">,</span>
        <span class="s1">&#39;pc_factor_mat_solver_type&#39;</span><span class="p">:</span> <span class="s1">&#39;mumps&#39;</span><span class="p">,</span>
        <span class="s1">&#39;mat_mumps_icntl_14&#39;</span><span class="p">:</span> <span class="mi">200</span><span class="p">,</span>
    <span class="p">})</span><span class="o">.</span><span class="n">tag</span><span class="p">(</span><span class="n">config</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span></div>


<div class="viewcode-block" id="CommonModelOptions"><a class="viewcode-back" href="../../thetis.html#thetis.options.CommonModelOptions">[docs]</a><span class="k">class</span> <span class="nc">CommonModelOptions</span><span class="p">(</span><span class="n">FrozenConfigurable</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Options that are common for both 2d and 3d models&quot;&quot;&quot;</span>
    <span class="n">name</span> <span class="o">=</span> <span class="s1">&#39;Model options&#39;</span>
    <span class="n">nh_model_options</span> <span class="o">=</span> <span class="n">Instance</span><span class="p">(</span><span class="n">NonhydrostaticModelOptions</span><span class="p">,</span> <span class="n">args</span><span class="o">=</span><span class="p">())</span><span class="o">.</span><span class="n">tag</span><span class="p">(</span><span class="n">config</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
    <span class="n">polynomial_degree</span> <span class="o">=</span> <span class="n">NonNegativeInteger</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">help</span><span class="o">=</span><span class="s1">&#39;Polynomial degree of elements&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">tag</span><span class="p">(</span><span class="n">config</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
    <span class="n">element_family</span> <span class="o">=</span> <span class="n">Enum</span><span class="p">(</span>
        <span class="p">[</span><span class="s1">&#39;dg-dg&#39;</span><span class="p">,</span> <span class="s1">&#39;rt-dg&#39;</span><span class="p">,</span> <span class="s1">&#39;bdm-dg&#39;</span><span class="p">,</span> <span class="s1">&#39;dg-cg&#39;</span><span class="p">],</span>
        <span class="n">default_value</span><span class="o">=</span><span class="s1">&#39;dg-dg&#39;</span><span class="p">,</span>
        <span class="n">help</span><span class="o">=</span><span class="s2">&quot;&quot;&quot;Finite element family</span>

<span class="s2">        2D solver supports &#39;dg-dg&#39;, &#39;rt-dg&#39;, &#39;bdm-dg&#39;, or &#39;dg-cg&#39; velocity-pressure pairs.</span>
<span class="s2">        3D solver supports &#39;dg-dg&#39;, &#39;rt-dg&#39;, or &#39;bdm-dg&#39; velocity-pressure pairs.&quot;&quot;&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">tag</span><span class="p">(</span><span class="n">config</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

    <span class="n">use_nonlinear_equations</span> <span class="o">=</span> <span class="n">Bool</span><span class="p">(</span><span class="kc">True</span><span class="p">,</span> <span class="n">help</span><span class="o">=</span><span class="s1">&#39;Use nonlinear shallow water equations&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">tag</span><span class="p">(</span><span class="n">config</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
    <span class="n">use_grad_div_viscosity_term</span> <span class="o">=</span> <span class="n">Bool</span><span class="p">(</span>
        <span class="kc">False</span><span class="p">,</span>
        <span class="n">help</span><span class="o">=</span><span class="sa">r</span><span class="s2">&quot;&quot;&quot;Include :math:`\nabla (\nu_h \nabla \cdot \bar{\textbf</span><span class="si">{u}</span><span class="s2">})` term in the depth-averaged viscosity</span>

<span class="s2">        See :class:`.shallowwater_eq.HorizontalViscosityTerm` for details.&quot;&quot;&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">tag</span><span class="p">(</span><span class="n">config</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
    <span class="n">use_grad_depth_viscosity_term</span> <span class="o">=</span> <span class="n">Bool</span><span class="p">(</span>
        <span class="kc">True</span><span class="p">,</span>
        <span class="n">help</span><span class="o">=</span><span class="sa">r</span><span class="s2">&quot;&quot;&quot;Include :math:`\nabla H` term in the depth-averaged viscosity</span>

<span class="s2">        See :class:`.shallowwater_eq.HorizontalViscosityTerm` for details.&quot;&quot;&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">tag</span><span class="p">(</span><span class="n">config</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

    <span class="n">use_lax_friedrichs_velocity</span> <span class="o">=</span> <span class="n">Bool</span><span class="p">(</span>
        <span class="kc">True</span><span class="p">,</span> <span class="n">help</span><span class="o">=</span><span class="s2">&quot;use Lax Friedrichs stabilisation in horizontal momentum advection.&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">tag</span><span class="p">(</span><span class="n">config</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
    <span class="n">lax_friedrichs_velocity_scaling_factor</span> <span class="o">=</span> <span class="n">FiredrakeConstantTraitlet</span><span class="p">(</span>
        <span class="n">Constant</span><span class="p">(</span><span class="mf">1.0</span><span class="p">),</span> <span class="n">help</span><span class="o">=</span><span class="s2">&quot;Scaling factor for Lax Friedrichs stabilisation term in horizontal momentum advection.&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">tag</span><span class="p">(</span><span class="n">config</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
    <span class="n">use_lax_friedrichs_tracer</span> <span class="o">=</span> <span class="n">Bool</span><span class="p">(</span>
        <span class="kc">False</span><span class="p">,</span> <span class="n">help</span><span class="o">=</span><span class="s2">&quot;Use Lax Friedrichs stabilisation in tracer advection.&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">tag</span><span class="p">(</span><span class="n">config</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
    <span class="n">lax_friedrichs_tracer_scaling_factor</span> <span class="o">=</span> <span class="n">FiredrakeConstantTraitlet</span><span class="p">(</span>
        <span class="n">Constant</span><span class="p">(</span><span class="mf">1.0</span><span class="p">),</span> <span class="n">help</span><span class="o">=</span><span class="s2">&quot;Scaling factor for tracer Lax Friedrichs stability term.&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">tag</span><span class="p">(</span><span class="n">config</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
    <span class="n">use_limiter_for_tracers</span> <span class="o">=</span> <span class="n">Bool</span><span class="p">(</span>
        <span class="kc">True</span><span class="p">,</span> <span class="n">help</span><span class="o">=</span><span class="s2">&quot;Apply P1DG limiter for tracer fields&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">tag</span><span class="p">(</span><span class="n">config</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

    <span class="n">check_volume_conservation_2d</span> <span class="o">=</span> <span class="n">Bool</span><span class="p">(</span>
        <span class="kc">False</span><span class="p">,</span> <span class="n">help</span><span class="o">=</span><span class="s2">&quot;&quot;&quot;</span>
<span class="s2">        Compute volume of the 2D mode at every export</span>

<span class="s2">        2D volume is defined as the integral of the water elevation field.</span>
<span class="s2">        Prints deviation from the initial volume to stdout.</span>
<span class="s2">        &quot;&quot;&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">tag</span><span class="p">(</span><span class="n">config</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
    <span class="n">log_output</span> <span class="o">=</span> <span class="n">Bool</span><span class="p">(</span>
        <span class="kc">True</span><span class="p">,</span> <span class="n">help</span><span class="o">=</span><span class="s2">&quot;Redirect all output to log file in output directory&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">tag</span><span class="p">(</span><span class="n">config</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
    <span class="n">timestep</span> <span class="o">=</span> <span class="n">PositiveFloat</span><span class="p">(</span>
        <span class="mf">10.0</span><span class="p">,</span> <span class="n">help</span><span class="o">=</span><span class="s2">&quot;Time step&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">tag</span><span class="p">(</span><span class="n">config</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
    <span class="n">cfl_2d</span> <span class="o">=</span> <span class="n">PositiveFloat</span><span class="p">(</span>
        <span class="mf">1.0</span><span class="p">,</span> <span class="n">help</span><span class="o">=</span><span class="s2">&quot;Factor to scale the 2d time step OBSOLETE&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">tag</span><span class="p">(</span><span class="n">config</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>  <span class="c1"># TODO OBSOLETE</span>
    <span class="n">cfl_3d</span> <span class="o">=</span> <span class="n">PositiveFloat</span><span class="p">(</span>
        <span class="mf">1.0</span><span class="p">,</span> <span class="n">help</span><span class="o">=</span><span class="s2">&quot;Factor to scale the 2d time step OBSOLETE&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">tag</span><span class="p">(</span><span class="n">config</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>  <span class="c1"># TODO OBSOLETE</span>
    <span class="n">simulation_export_time</span> <span class="o">=</span> <span class="n">PositiveFloat</span><span class="p">(</span>
        <span class="mf">100.0</span><span class="p">,</span> <span class="n">help</span><span class="o">=</span><span class="s2">&quot;&quot;&quot;</span>
<span class="s2">        Export interval in seconds</span>

<span class="s2">        All fields in fields_to_export list will be stored to disk and</span>
<span class="s2">        diagnostics will be computed</span>
<span class="s2">        &quot;&quot;&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">tag</span><span class="p">(</span><span class="n">config</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
    <span class="n">simulation_end_time</span> <span class="o">=</span> <span class="n">PositiveFloat</span><span class="p">(</span>
        <span class="mf">1000.0</span><span class="p">,</span> <span class="n">help</span><span class="o">=</span><span class="s2">&quot;Simulation duration in seconds&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">tag</span><span class="p">(</span><span class="n">config</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
    <span class="n">horizontal_velocity_scale</span> <span class="o">=</span> <span class="n">FiredrakeConstantTraitlet</span><span class="p">(</span>
        <span class="n">Constant</span><span class="p">(</span><span class="mf">0.1</span><span class="p">),</span> <span class="n">help</span><span class="o">=</span><span class="s2">&quot;&quot;&quot;</span>
<span class="s2">        Maximum horizontal velocity magnitude</span>

<span class="s2">        Used to compute max stable advection time step.</span>
<span class="s2">        &quot;&quot;&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">tag</span><span class="p">(</span><span class="n">config</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
    <span class="n">horizontal_viscosity_scale</span> <span class="o">=</span> <span class="n">FiredrakeConstantTraitlet</span><span class="p">(</span>
        <span class="n">Constant</span><span class="p">(</span><span class="mf">1.0</span><span class="p">),</span> <span class="n">help</span><span class="o">=</span><span class="s2">&quot;&quot;&quot;</span>
<span class="s2">        Maximum horizontal viscosity</span>

<span class="s2">        Used to compute max stable diffusion time step.</span>
<span class="s2">        &quot;&quot;&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">tag</span><span class="p">(</span><span class="n">config</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
    <span class="n">horizontal_diffusivity_scale</span> <span class="o">=</span> <span class="n">FiredrakeConstantTraitlet</span><span class="p">(</span>
        <span class="n">Constant</span><span class="p">(</span><span class="mf">1.0</span><span class="p">),</span> <span class="n">help</span><span class="o">=</span><span class="s2">&quot;&quot;&quot;</span>
<span class="s2">        Maximum horizontal diffusivity</span>

<span class="s2">        Used to compute the mesh Peclet number in</span>
<span class="s2">        the 2D tracer SUPG stabilization scheme.</span>
<span class="s2">        &quot;&quot;&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">tag</span><span class="p">(</span><span class="n">config</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
    <span class="n">output_directory</span> <span class="o">=</span> <span class="n">Unicode</span><span class="p">(</span>
        <span class="s1">&#39;outputs&#39;</span><span class="p">,</span> <span class="n">help</span><span class="o">=</span><span class="s2">&quot;Directory where model output files are stored&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">tag</span><span class="p">(</span><span class="n">config</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
    <span class="n">no_exports</span> <span class="o">=</span> <span class="n">Bool</span><span class="p">(</span>
        <span class="kc">False</span><span class="p">,</span> <span class="n">help</span><span class="o">=</span><span class="s2">&quot;&quot;&quot;</span>
<span class="s2">        Do not store any outputs to disk</span>

<span class="s2">        Disables VTK and HDF5 field outputs. and HDF5 diagnostic outputs.</span>
<span class="s2">        Used in CI test suite.</span>
<span class="s2">        &quot;&quot;&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">tag</span><span class="p">(</span><span class="n">config</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
    <span class="n">export_diagnostics</span> <span class="o">=</span> <span class="n">Bool</span><span class="p">(</span>
        <span class="kc">True</span><span class="p">,</span> <span class="n">help</span><span class="o">=</span><span class="s2">&quot;Store diagnostic variables to disk in HDF5 format&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">tag</span><span class="p">(</span><span class="n">config</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
    <span class="n">fields_to_export</span> <span class="o">=</span> <span class="n">List</span><span class="p">(</span>
        <span class="n">trait</span><span class="o">=</span><span class="n">Unicode</span><span class="p">(),</span>
        <span class="n">default_value</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;elev_2d&#39;</span><span class="p">,</span> <span class="s1">&#39;uv_2d&#39;</span><span class="p">,</span> <span class="s1">&#39;uv_3d&#39;</span><span class="p">,</span> <span class="s1">&#39;w_3d&#39;</span><span class="p">],</span>
        <span class="n">help</span><span class="o">=</span><span class="s2">&quot;Fields to export in VTK format&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">tag</span><span class="p">(</span><span class="n">config</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
    <span class="n">fields_to_export_hdf5</span> <span class="o">=</span> <span class="n">List</span><span class="p">(</span>
        <span class="n">trait</span><span class="o">=</span><span class="n">Unicode</span><span class="p">(),</span>
        <span class="n">default_value</span><span class="o">=</span><span class="p">[],</span>
        <span class="n">help</span><span class="o">=</span><span class="s2">&quot;Fields to export in HDF5 format&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">tag</span><span class="p">(</span><span class="n">config</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
    <span class="n">verbose</span> <span class="o">=</span> <span class="n">Integer</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">help</span><span class="o">=</span><span class="s2">&quot;Verbosity level&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">tag</span><span class="p">(</span><span class="n">config</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
    <span class="n">linear_drag_coefficient</span> <span class="o">=</span> <span class="n">FiredrakeScalarExpression</span><span class="p">(</span>
        <span class="kc">None</span><span class="p">,</span> <span class="n">allow_none</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">help</span><span class="o">=</span><span class="sa">r</span><span class="s2">&quot;&quot;&quot;</span>
<span class="s2">        2D linear drag parameter :math:`L`</span>

<span class="s2">        Bottom stress is :math:`\tau_b/\rho_0 = -L \mathbf</span><span class="si">{u}</span><span class="s2"> H`</span>
<span class="s2">        &quot;&quot;&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">tag</span><span class="p">(</span><span class="n">config</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
    <span class="n">quadratic_drag_coefficient</span> <span class="o">=</span> <span class="n">FiredrakeScalarExpression</span><span class="p">(</span>
        <span class="kc">None</span><span class="p">,</span> <span class="n">allow_none</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">help</span><span class="o">=</span><span class="sa">r</span><span class="s2">&quot;&quot;&quot;</span>
<span class="s2">        Dimensionless 2D quadratic drag parameter :math:`C_D`</span>

<span class="s2">        Bottom stress is :math:`\tau_b/\rho_0 = -C_D |\mathbf</span><span class="si">{u}</span><span class="s2">|\mathbf</span><span class="si">{u}</span><span class="s2">`</span>
<span class="s2">        &quot;&quot;&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">tag</span><span class="p">(</span><span class="n">config</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
    <span class="n">manning_drag_coefficient</span> <span class="o">=</span> <span class="n">FiredrakeScalarExpression</span><span class="p">(</span>
        <span class="kc">None</span><span class="p">,</span> <span class="n">allow_none</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">help</span><span class="o">=</span><span class="sa">r</span><span class="s2">&quot;&quot;&quot;</span>
<span class="s2">        Manning-Strickler 2D quadratic drag parameter :math:`\mu`</span>

<span class="s2">        Bottom stress is :math:`\tau_b/\rho_0 = -g \mu^2 |\mathbf</span><span class="si">{u}</span><span class="s2">|\mathbf</span><span class="si">{u}</span><span class="s2">/H^{1/3}`</span>
<span class="s2">        &quot;&quot;&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">tag</span><span class="p">(</span><span class="n">config</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
    <span class="n">nikuradse_bed_roughness</span> <span class="o">=</span> <span class="n">FiredrakeScalarExpression</span><span class="p">(</span>
        <span class="kc">None</span><span class="p">,</span> <span class="n">allow_none</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">help</span><span class="o">=</span><span class="sa">r</span><span class="s2">&quot;&quot;&quot;</span>
<span class="s2">        Nikuradse bed roughness length used to construct the 2D quadratic drag parameter :math:`C_D`.</span>

<span class="s2">        In sediment transport this term is usually three times the average sediment diameter size.</span>
<span class="s2">        &quot;&quot;&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">tag</span><span class="p">(</span><span class="n">config</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
    <span class="n">norm_smoother</span> <span class="o">=</span> <span class="n">FiredrakeConstantTraitlet</span><span class="p">(</span>
        <span class="n">Constant</span><span class="p">(</span><span class="mf">0.0</span><span class="p">),</span> <span class="n">help</span><span class="o">=</span><span class="sa">r</span><span class="s2">&quot;&quot;&quot;</span>
<span class="s2">        Coefficient used to avoid non-differentiable functions in the continuous formulation of the velocity norm in</span>
<span class="s2">        the quadratic bottom drag term in the momentum equation. This replaces the velocity norm in the quadratic</span>
<span class="s2">        bottom drag term with :math:`\|u\| \approx \sqrt{\|u\|^2 + \alpha^2}`</span>
<span class="s2">        &quot;&quot;&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">tag</span><span class="p">(</span><span class="n">config</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
    <span class="n">horizontal_viscosity</span> <span class="o">=</span> <span class="n">FiredrakeScalarExpression</span><span class="p">(</span>
        <span class="kc">None</span><span class="p">,</span> <span class="n">allow_none</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">help</span><span class="o">=</span><span class="s2">&quot;Horizontal viscosity&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">tag</span><span class="p">(</span><span class="n">config</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
    <span class="n">coriolis_frequency</span> <span class="o">=</span> <span class="n">FiredrakeScalarExpression</span><span class="p">(</span>
        <span class="kc">None</span><span class="p">,</span> <span class="n">allow_none</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">help</span><span class="o">=</span><span class="s2">&quot;2D Coriolis parameter&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">tag</span><span class="p">(</span><span class="n">config</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
    <span class="n">wind_stress</span> <span class="o">=</span> <span class="n">FiredrakeVectorExpression</span><span class="p">(</span>
        <span class="kc">None</span><span class="p">,</span> <span class="n">allow_none</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">help</span><span class="o">=</span><span class="s2">&quot;Stress at free surface (2D vector function)&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">tag</span><span class="p">(</span><span class="n">config</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
    <span class="n">atmospheric_pressure</span> <span class="o">=</span> <span class="n">FiredrakeScalarExpression</span><span class="p">(</span>
        <span class="kc">None</span><span class="p">,</span> <span class="n">allow_none</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">help</span><span class="o">=</span><span class="s2">&quot;Atmospheric pressure at free surface, in pascals&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">tag</span><span class="p">(</span><span class="n">config</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
    <span class="n">momentum_source_2d</span> <span class="o">=</span> <span class="n">FiredrakeVectorExpression</span><span class="p">(</span>
        <span class="kc">None</span><span class="p">,</span> <span class="n">allow_none</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">help</span><span class="o">=</span><span class="s2">&quot;Source term for 2D momentum equation&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">tag</span><span class="p">(</span><span class="n">config</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
    <span class="n">volume_source_2d</span> <span class="o">=</span> <span class="n">FiredrakeScalarExpression</span><span class="p">(</span>
        <span class="kc">None</span><span class="p">,</span> <span class="n">allow_none</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">help</span><span class="o">=</span><span class="s2">&quot;Source term for 2D continuity equation&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">tag</span><span class="p">(</span><span class="n">config</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
    <span class="n">sipg_factor</span> <span class="o">=</span> <span class="n">FiredrakeScalarExpression</span><span class="p">(</span>
        <span class="n">Constant</span><span class="p">(</span><span class="mf">1.0</span><span class="p">),</span> <span class="n">help</span><span class="o">=</span><span class="s2">&quot;Penalty parameter scaling factor for horizontal viscosity terms.&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">tag</span><span class="p">(</span><span class="n">config</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
    <span class="n">sipg_factor_tracer</span> <span class="o">=</span> <span class="n">FiredrakeScalarExpression</span><span class="p">(</span>
        <span class="n">Constant</span><span class="p">(</span><span class="mf">1.0</span><span class="p">),</span> <span class="n">help</span><span class="o">=</span><span class="s2">&quot;Penalty parameter scaling factor for horizontal diffusivity terms.&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">tag</span><span class="p">(</span><span class="n">config</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span></div>


<div class="viewcode-block" id="SedimentModelOptions"><a class="viewcode-back" href="../../thetis.html#thetis.options.SedimentModelOptions">[docs]</a><span class="nd">@attach_paired_options</span><span class="p">(</span><span class="s2">&quot;sediment_timestepper_type&quot;</span><span class="p">,</span>
                       <span class="n">PairedEnum</span><span class="p">([(</span><span class="s1">&#39;SSPRK33&#39;</span><span class="p">,</span> <span class="n">ExplicitTracerTimeStepperOptions2d</span><span class="p">),</span>
                                   <span class="p">(</span><span class="s1">&#39;ForwardEuler&#39;</span><span class="p">,</span> <span class="n">ExplicitTracerTimeStepperOptions2d</span><span class="p">),</span>
                                   <span class="p">(</span><span class="s1">&#39;BackwardEuler&#39;</span><span class="p">,</span> <span class="n">SemiImplicitTracerTimeStepperOptions2d</span><span class="p">),</span>
                                   <span class="p">(</span><span class="s1">&#39;CrankNicolson&#39;</span><span class="p">,</span> <span class="n">CrankNicolsonTracerTimeStepperOptions2d</span><span class="p">),</span>
                                   <span class="p">(</span><span class="s1">&#39;DIRK22&#39;</span><span class="p">,</span> <span class="n">SemiImplicitTracerTimeStepperOptions2d</span><span class="p">),</span>
                                   <span class="p">(</span><span class="s1">&#39;DIRK33&#39;</span><span class="p">,</span> <span class="n">SemiImplicitTracerTimeStepperOptions2d</span><span class="p">),</span>
                                   <span class="p">],</span>
                                  <span class="s2">&quot;sediment_timestepper_options&quot;</span><span class="p">,</span>
                                  <span class="n">default_value</span><span class="o">=</span><span class="s1">&#39;CrankNicolson&#39;</span><span class="p">,</span>
                                  <span class="n">help</span><span class="o">=</span><span class="s1">&#39;Name of the sediment time integrator&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">tag</span><span class="p">(</span><span class="n">config</span><span class="o">=</span><span class="kc">True</span><span class="p">),</span>
                       <span class="n">Instance</span><span class="p">(</span><span class="n">TimeStepperOptions</span><span class="p">,</span> <span class="n">args</span><span class="o">=</span><span class="p">())</span><span class="o">.</span><span class="n">tag</span><span class="p">(</span><span class="n">config</span><span class="o">=</span><span class="kc">True</span><span class="p">))</span>
<span class="nd">@attach_paired_options</span><span class="p">(</span><span class="s2">&quot;exner_timestepper_type&quot;</span><span class="p">,</span>
                       <span class="n">PairedEnum</span><span class="p">([(</span><span class="s1">&#39;SSPRK33&#39;</span><span class="p">,</span> <span class="n">ExplicitTracerTimeStepperOptions2d</span><span class="p">),</span>
                                   <span class="p">(</span><span class="s1">&#39;ForwardEuler&#39;</span><span class="p">,</span> <span class="n">ExplicitTracerTimeStepperOptions2d</span><span class="p">),</span>
                                   <span class="p">(</span><span class="s1">&#39;BackwardEuler&#39;</span><span class="p">,</span> <span class="n">SemiImplicitTracerTimeStepperOptions2d</span><span class="p">),</span>
                                   <span class="p">(</span><span class="s1">&#39;CrankNicolson&#39;</span><span class="p">,</span> <span class="n">CrankNicolsonTracerTimeStepperOptions2d</span><span class="p">),</span>
                                   <span class="p">(</span><span class="s1">&#39;DIRK22&#39;</span><span class="p">,</span> <span class="n">SemiImplicitTracerTimeStepperOptions2d</span><span class="p">),</span>
                                   <span class="p">(</span><span class="s1">&#39;DIRK33&#39;</span><span class="p">,</span> <span class="n">SemiImplicitTracerTimeStepperOptions2d</span><span class="p">),</span>
                                   <span class="p">],</span>
                                  <span class="s2">&quot;exner_timestepper_options&quot;</span><span class="p">,</span>
                                  <span class="n">default_value</span><span class="o">=</span><span class="s1">&#39;CrankNicolson&#39;</span><span class="p">,</span>
                                  <span class="n">help</span><span class="o">=</span><span class="s1">&#39;Name of the exner time integrator&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">tag</span><span class="p">(</span><span class="n">config</span><span class="o">=</span><span class="kc">True</span><span class="p">),</span>
                       <span class="n">Instance</span><span class="p">(</span><span class="n">TimeStepperOptions</span><span class="p">,</span> <span class="n">args</span><span class="o">=</span><span class="p">())</span><span class="o">.</span><span class="n">tag</span><span class="p">(</span><span class="n">config</span><span class="o">=</span><span class="kc">True</span><span class="p">))</span>
<span class="k">class</span> <span class="nc">SedimentModelOptions</span><span class="p">(</span><span class="n">FrozenHasTraits</span><span class="p">):</span>
    <span class="n">solve_exner</span> <span class="o">=</span> <span class="n">Bool</span><span class="p">(</span><span class="kc">False</span><span class="p">,</span> <span class="n">help</span><span class="o">=</span><span class="s1">&#39;Solve exner equation for bed morphology&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">tag</span><span class="p">(</span><span class="n">config</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
    <span class="n">solve_suspended_sediment</span> <span class="o">=</span> <span class="n">Bool</span><span class="p">(</span><span class="kc">False</span><span class="p">,</span> <span class="n">help</span><span class="o">=</span><span class="s1">&#39;Solve suspended sediment transport equation&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">tag</span><span class="p">(</span><span class="n">config</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
    <span class="n">use_sediment_conservative_form</span> <span class="o">=</span> <span class="n">Bool</span><span class="p">(</span><span class="kc">False</span><span class="p">,</span> <span class="n">help</span><span class="o">=</span><span class="s1">&#39;Solve 2D sediment transport in the conservative form&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">tag</span><span class="p">(</span><span class="n">config</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
    <span class="n">use_bedload</span> <span class="o">=</span> <span class="n">Bool</span><span class="p">(</span><span class="kc">False</span><span class="p">,</span> <span class="n">help</span><span class="o">=</span><span class="s1">&#39;Use bedload transport in sediment model&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">tag</span><span class="p">(</span><span class="n">config</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
    <span class="n">use_sediment_slide</span> <span class="o">=</span> <span class="n">Bool</span><span class="p">(</span><span class="kc">False</span><span class="p">,</span> <span class="n">help</span><span class="o">=</span><span class="s1">&#39;Use sediment slide mechanism in sediment model&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">tag</span><span class="p">(</span><span class="n">config</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
    <span class="n">horizontal_diffusivity</span> <span class="o">=</span> <span class="n">FiredrakeCoefficient</span><span class="p">(</span>
        <span class="kc">None</span><span class="p">,</span> <span class="n">allow_none</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">help</span><span class="o">=</span><span class="s2">&quot;Horizontal diffusivity for sediment&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">tag</span><span class="p">(</span><span class="n">config</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
    <span class="n">use_angle_correction</span> <span class="o">=</span> <span class="n">Bool</span><span class="p">(</span><span class="kc">True</span><span class="p">,</span> <span class="n">help</span><span class="o">=</span><span class="s1">&#39;Switch to use slope effect angle correction&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">tag</span><span class="p">(</span><span class="n">config</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
    <span class="n">use_slope_mag_correction</span> <span class="o">=</span> <span class="n">Bool</span><span class="p">(</span><span class="kc">True</span><span class="p">,</span> <span class="n">help</span><span class="o">=</span><span class="s1">&#39;Switch to use slope effect magnitude correction&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">tag</span><span class="p">(</span><span class="n">config</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
    <span class="n">use_secondary_current</span> <span class="o">=</span> <span class="n">Bool</span><span class="p">(</span><span class="kc">False</span><span class="p">,</span> <span class="n">help</span><span class="o">=</span><span class="s1">&#39;Switch to use secondary current for helical flow effect&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">tag</span><span class="p">(</span><span class="n">config</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
    <span class="n">average_sediment_size</span> <span class="o">=</span> <span class="n">FiredrakeScalarExpression</span><span class="p">(</span><span class="kc">None</span><span class="p">,</span> <span class="n">allow_none</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">help</span><span class="o">=</span><span class="s1">&#39;Average sediment size&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">tag</span><span class="p">(</span><span class="n">config</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
    <span class="n">slide_region</span> <span class="o">=</span> <span class="n">FiredrakeScalarExpression</span><span class="p">(</span><span class="kc">None</span><span class="p">,</span> <span class="n">allow_none</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">help</span><span class="o">=</span><span class="s2">&quot;&quot;&quot;Region where sediment slide occurs.</span>

<span class="s2">                                             If None then sediment slide is applied over whole domain.</span>
<span class="s2">                                             &quot;&quot;&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">tag</span><span class="p">(</span><span class="n">config</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
    <span class="n">bed_reference_height</span> <span class="o">=</span> <span class="n">FiredrakeScalarExpression</span><span class="p">(</span><span class="kc">None</span><span class="p">,</span> <span class="n">allow_none</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">help</span><span class="o">=</span><span class="s1">&#39;Bottom bed reference height&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">tag</span><span class="p">(</span><span class="n">config</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
    <span class="n">use_advective_velocity_correction</span> <span class="o">=</span> <span class="n">Bool</span><span class="p">(</span><span class="kc">True</span><span class="p">,</span> <span class="n">help</span><span class="o">=</span><span class="s2">&quot;&quot;&quot;</span>
<span class="s2">        Switch to apply correction to advective velocity used in sediment equation</span>

<span class="s2">        Accounts for mismatch between depth-averaged product of velocity with sediment</span>
<span class="s2">        and product of depth-averaged velocity with depth-averaged sediment</span>
<span class="s2">        &quot;&quot;&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">tag</span><span class="p">(</span><span class="n">config</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
    <span class="n">porosity</span> <span class="o">=</span> <span class="n">FiredrakeCoefficient</span><span class="p">(</span>
        <span class="n">Constant</span><span class="p">(</span><span class="mf">0.4</span><span class="p">),</span> <span class="n">help</span><span class="o">=</span><span class="s2">&quot;Bed porosity for exner equation&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">tag</span><span class="p">(</span><span class="n">config</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
    <span class="n">max_angle</span> <span class="o">=</span> <span class="n">FiredrakeConstantTraitlet</span><span class="p">(</span>
        <span class="n">Constant</span><span class="p">(</span><span class="mi">32</span><span class="p">),</span> <span class="n">help</span><span class="o">=</span><span class="s2">&quot;Angle of repose for sediment slide mechanism in degrees&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">tag</span><span class="p">(</span><span class="n">config</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
    <span class="n">sed_slide_length_scale</span> <span class="o">=</span> <span class="n">FiredrakeConstantTraitlet</span><span class="p">(</span>
        <span class="n">Constant</span><span class="p">(</span><span class="mi">0</span><span class="p">),</span> <span class="n">help</span><span class="o">=</span><span class="s2">&quot;&quot;&quot;Length scale for sediment slide mechanism.</span>

<span class="s2">                           This should normally be the average meshgrid size.</span>
<span class="s2">                           &quot;&quot;&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">tag</span><span class="p">(</span><span class="n">config</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
    <span class="n">morphological_acceleration_factor</span> <span class="o">=</span> <span class="n">FiredrakeConstantTraitlet</span><span class="p">(</span>
        <span class="n">Constant</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span> <span class="n">help</span><span class="o">=</span><span class="s2">&quot;&quot;&quot;Rate at which timestep in exner equation is accelerated compared to timestep for model</span>

<span class="s2">        timestep in exner = morphological_acceleration_factor * timestep</span>
<span class="s2">        &quot;&quot;&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">tag</span><span class="p">(</span><span class="n">config</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
    <span class="n">morphological_viscosity</span> <span class="o">=</span> <span class="n">FiredrakeScalarExpression</span><span class="p">(</span>
        <span class="kc">None</span><span class="p">,</span> <span class="n">allow_none</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">help</span><span class="o">=</span><span class="s2">&quot;&quot;&quot;Viscosity used to derive morphology terms.</span>

<span class="s2">        Usually equal to horizontal viscosity but can be set to have a different value&quot;&quot;&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">tag</span><span class="p">(</span><span class="n">config</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
    <span class="n">sediment_density</span> <span class="o">=</span> <span class="n">FiredrakeScalarExpression</span><span class="p">(</span>
        <span class="n">Constant</span><span class="p">(</span><span class="mi">2650</span><span class="p">),</span> <span class="n">help</span><span class="o">=</span><span class="s1">&#39;Density of sediment&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">tag</span><span class="p">(</span><span class="n">config</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
    <span class="n">secondary_current_parameter</span> <span class="o">=</span> <span class="n">FiredrakeConstantTraitlet</span><span class="p">(</span>
        <span class="n">Constant</span><span class="p">(</span><span class="mf">0.75</span><span class="p">),</span> <span class="n">help</span><span class="o">=</span><span class="s1">&#39;Parameter controlling secondary current&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">tag</span><span class="p">(</span><span class="n">config</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
    <span class="n">slope_effect_parameter</span> <span class="o">=</span> <span class="n">FiredrakeConstantTraitlet</span><span class="p">(</span>
        <span class="n">Constant</span><span class="p">(</span><span class="mf">1.3</span><span class="p">),</span> <span class="n">help</span><span class="o">=</span><span class="s1">&#39;Parameter controlling magnitude of slope effect&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">tag</span><span class="p">(</span><span class="n">config</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
    <span class="n">slope_effect_angle_parameter</span> <span class="o">=</span> <span class="n">FiredrakeConstantTraitlet</span><span class="p">(</span>
        <span class="n">Constant</span><span class="p">(</span><span class="mi">2</span><span class="o">/</span><span class="mi">3</span><span class="p">),</span> <span class="n">help</span><span class="o">=</span><span class="s1">&#39;Parameter controlling angle of slope effect&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">tag</span><span class="p">(</span><span class="n">config</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
    <span class="n">check_sediment_conservation</span> <span class="o">=</span> <span class="n">Bool</span><span class="p">(</span>
        <span class="kc">False</span><span class="p">,</span> <span class="n">help</span><span class="o">=</span><span class="s2">&quot;&quot;&quot;</span>
<span class="s2">        Compute total sediment mass at every export</span>

<span class="s2">        Prints deviation from the initial mass to stdout.</span>
<span class="s2">        &quot;&quot;&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">tag</span><span class="p">(</span><span class="n">config</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
    <span class="n">check_sediment_overshoot</span> <span class="o">=</span> <span class="n">Bool</span><span class="p">(</span>
        <span class="kc">False</span><span class="p">,</span> <span class="n">help</span><span class="o">=</span><span class="s2">&quot;&quot;&quot;</span>
<span class="s2">        Compute sediment overshoots at every export</span>

<span class="s2">        Prints overshoot values that exceed the initial range to stdout.</span>
<span class="s2">        &quot;&quot;&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">tag</span><span class="p">(</span><span class="n">config</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
    <span class="n">sediment_model_class</span> <span class="o">=</span> <span class="n">Type</span><span class="p">(</span><span class="n">SedimentModel</span><span class="p">,</span> <span class="n">help</span><span class="o">=</span><span class="s2">&quot;&quot;&quot;Class used to define the sediment model</span>

<span class="s2">    This option can be used to provide a user-defined sediment model class that should</span>
<span class="s2">    be a subclass of SedimentModel. For example:</span>

<span class="s2">    .. code-block:: python</span>

<span class="s2">        class UserSedimentModel(SedimentModel):</span>
<span class="s2">           def __init__(options, mesh2d, uv, elev, depth, extra_term):</span>
<span class="s2">              super().__init__(options, mesh2d, uv, elev, depth)</span>
<span class="s2">              self.extra_term = extra_term</span>

<span class="s2">           def get_bedloadterm(self, bathymetry):</span>
<span class="s2">              return super().get_bedloadterm(bathymetry) + self.term</span>
<span class="s2">    &quot;&quot;&quot;</span><span class="p">)</span></div>


<div class="viewcode-block" id="ModelOptions2d"><a class="viewcode-back" href="../../thetis.html#thetis.options.ModelOptions2d">[docs]</a><span class="nd">@attach_paired_options</span><span class="p">(</span><span class="s2">&quot;swe_timestepper_type&quot;</span><span class="p">,</span>
                       <span class="n">PairedEnum</span><span class="p">([(</span><span class="s1">&#39;SSPRK33&#39;</span><span class="p">,</span> <span class="n">ExplicitSWETimeStepperOptions2d</span><span class="p">),</span>
                                   <span class="p">(</span><span class="s1">&#39;ForwardEuler&#39;</span><span class="p">,</span> <span class="n">ExplicitSWETimeStepperOptions2d</span><span class="p">),</span>
                                   <span class="p">(</span><span class="s1">&#39;BackwardEuler&#39;</span><span class="p">,</span> <span class="n">SemiImplicitSWETimeStepperOptions2d</span><span class="p">),</span>
                                   <span class="p">(</span><span class="s1">&#39;CrankNicolson&#39;</span><span class="p">,</span> <span class="n">CrankNicolsonSWETimeStepperOptions2d</span><span class="p">),</span>
                                   <span class="p">(</span><span class="s1">&#39;DIRK22&#39;</span><span class="p">,</span> <span class="n">SemiImplicitSWETimeStepperOptions2d</span><span class="p">),</span>
                                   <span class="p">(</span><span class="s1">&#39;DIRK33&#39;</span><span class="p">,</span> <span class="n">SemiImplicitSWETimeStepperOptions2d</span><span class="p">),</span>
                                   <span class="p">(</span><span class="s1">&#39;SteadyState&#39;</span><span class="p">,</span> <span class="n">SteadyStateTimeStepperOptions2d</span><span class="p">),</span>
                                   <span class="p">(</span><span class="s1">&#39;PressureProjectionPicard&#39;</span><span class="p">,</span> <span class="n">PressureProjectionSWETimeStepperOptions2d</span><span class="p">),</span>
                                   <span class="p">(</span><span class="s1">&#39;SSPIMEX&#39;</span><span class="p">,</span> <span class="n">IMEXSWETimeStepperOptions2d</span><span class="p">),</span>
                                   <span class="p">],</span>
                                  <span class="s2">&quot;swe_timestepper_options&quot;</span><span class="p">,</span>
                                  <span class="n">default_value</span><span class="o">=</span><span class="s1">&#39;CrankNicolson&#39;</span><span class="p">,</span>
                                  <span class="n">help</span><span class="o">=</span><span class="s1">&#39;Name of the time integrator&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">tag</span><span class="p">(</span><span class="n">config</span><span class="o">=</span><span class="kc">True</span><span class="p">),</span>
                       <span class="n">Instance</span><span class="p">(</span><span class="n">TimeStepperOptions</span><span class="p">,</span> <span class="n">args</span><span class="o">=</span><span class="p">())</span><span class="o">.</span><span class="n">tag</span><span class="p">(</span><span class="n">config</span><span class="o">=</span><span class="kc">True</span><span class="p">))</span>
<span class="nd">@attach_paired_options</span><span class="p">(</span><span class="s2">&quot;tracer_timestepper_type&quot;</span><span class="p">,</span>
                       <span class="n">PairedEnum</span><span class="p">([(</span><span class="s1">&#39;SSPRK33&#39;</span><span class="p">,</span> <span class="n">ExplicitTracerTimeStepperOptions2d</span><span class="p">),</span>
                                   <span class="p">(</span><span class="s1">&#39;ForwardEuler&#39;</span><span class="p">,</span> <span class="n">ExplicitTracerTimeStepperOptions2d</span><span class="p">),</span>
                                   <span class="p">(</span><span class="s1">&#39;BackwardEuler&#39;</span><span class="p">,</span> <span class="n">SemiImplicitTracerTimeStepperOptions2d</span><span class="p">),</span>
                                   <span class="p">(</span><span class="s1">&#39;CrankNicolson&#39;</span><span class="p">,</span> <span class="n">CrankNicolsonTracerTimeStepperOptions2d</span><span class="p">),</span>
                                   <span class="p">(</span><span class="s1">&#39;DIRK22&#39;</span><span class="p">,</span> <span class="n">SemiImplicitTracerTimeStepperOptions2d</span><span class="p">),</span>
                                   <span class="p">(</span><span class="s1">&#39;DIRK33&#39;</span><span class="p">,</span> <span class="n">SemiImplicitTracerTimeStepperOptions2d</span><span class="p">),</span>
                                   <span class="p">(</span><span class="s1">&#39;SteadyState&#39;</span><span class="p">,</span> <span class="n">SteadyStateTimeStepperOptions2d</span><span class="p">),</span>
                                   <span class="p">],</span>
                                  <span class="s2">&quot;tracer_timestepper_options&quot;</span><span class="p">,</span>
                                  <span class="n">default_value</span><span class="o">=</span><span class="s1">&#39;CrankNicolson&#39;</span><span class="p">,</span>
                                  <span class="n">help</span><span class="o">=</span><span class="s1">&#39;Name of the tracer time integrator&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">tag</span><span class="p">(</span><span class="n">config</span><span class="o">=</span><span class="kc">True</span><span class="p">),</span>
                       <span class="n">Instance</span><span class="p">(</span><span class="n">TimeStepperOptions</span><span class="p">,</span> <span class="n">args</span><span class="o">=</span><span class="p">())</span><span class="o">.</span><span class="n">tag</span><span class="p">(</span><span class="n">config</span><span class="o">=</span><span class="kc">True</span><span class="p">))</span>
<span class="k">class</span> <span class="nc">ModelOptions2d</span><span class="p">(</span><span class="n">CommonModelOptions</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Options for 2D depth-averaged shallow water model&quot;&quot;&quot;</span>
    <span class="n">name</span> <span class="o">=</span> <span class="s1">&#39;Depth-averaged 2D model&#39;</span>
    <span class="n">sediment_model_options</span> <span class="o">=</span> <span class="n">Instance</span><span class="p">(</span><span class="n">SedimentModelOptions</span><span class="p">,</span> <span class="n">args</span><span class="o">=</span><span class="p">())</span><span class="o">.</span><span class="n">tag</span><span class="p">(</span><span class="n">config</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
    <span class="n">use_tracer_conservative_form</span> <span class="o">=</span> <span class="n">Bool</span><span class="p">(</span><span class="kc">False</span><span class="p">,</span> <span class="n">help</span><span class="o">=</span><span class="s1">&#39;Solve 2D tracer transport in the conservative form&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">tag</span><span class="p">(</span><span class="n">config</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
    <span class="n">use_wetting_and_drying</span> <span class="o">=</span> <span class="n">Bool</span><span class="p">(</span>
        <span class="kc">False</span><span class="p">,</span> <span class="n">help</span><span class="o">=</span><span class="sa">r</span><span class="s2">&quot;&quot;&quot;bool: Turn on wetting and drying</span>

<span class="s2">        Uses the wetting and drying scheme from Karna et al (2011).</span>
<span class="s2">        If ``True``, one should also set :attr:`wetting_and_drying_alpha` to control the bathymetry displacement.</span>
<span class="s2">        &quot;&quot;&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">tag</span><span class="p">(</span><span class="n">config</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
    <span class="n">wetting_and_drying_alpha</span> <span class="o">=</span> <span class="n">FiredrakeScalarExpression</span><span class="p">(</span>
        <span class="n">Constant</span><span class="p">(</span><span class="mf">0.5</span><span class="p">),</span> <span class="n">help</span><span class="o">=</span><span class="sa">r</span><span class="s2">&quot;&quot;&quot;</span>
<span class="s2">        Coefficient: Wetting and drying parameter :math:`\alpha`.</span>

<span class="s2">        Used in bathymetry displacement function that ensures positive water depths. Unit is meters.</span>
<span class="s2">        &quot;&quot;&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">tag</span><span class="p">(</span><span class="n">config</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
    <span class="n">use_automatic_wetting_and_drying_alpha</span> <span class="o">=</span> <span class="n">Bool</span><span class="p">(</span><span class="kc">False</span><span class="p">,</span> <span class="n">help</span><span class="o">=</span><span class="sa">r</span><span class="s2">&quot;&quot;&quot;</span>
<span class="s2">        Toggle automatic computation of the alpha parameter used in wetting and drying schemes.</span>

<span class="s2">        By default, this parameter is set to 0.5.</span>

<span class="s2">        For problems whose bathymetry varies wildly in coastal regions, it is advisable to use the</span>
<span class="s2">        automatic wetting and drying parameter, rather than the default.</span>
<span class="s2">        &quot;&quot;&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">tag</span><span class="p">(</span><span class="n">config</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
    <span class="n">wetting_and_drying_alpha_min</span> <span class="o">=</span> <span class="n">FiredrakeScalarExpression</span><span class="p">(</span>
        <span class="kc">None</span><span class="p">,</span> <span class="n">allow_none</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">help</span><span class="o">=</span><span class="sa">r</span><span class="s2">&quot;&quot;&quot;</span>
<span class="s2">        Minimum value to be taken by wetting and drying parameter :math:`\alpha`.</span>

<span class="s2">        Note this is only relevant if `use_automatic_wetting_and_drying_alpha` is set to ``True``.</span>
<span class="s2">        &quot;&quot;&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">tag</span><span class="p">(</span><span class="n">config</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
    <span class="n">wetting_and_drying_alpha_max</span> <span class="o">=</span> <span class="n">FiredrakeScalarExpression</span><span class="p">(</span>
        <span class="n">Constant</span><span class="p">(</span><span class="mf">2.0</span><span class="p">),</span> <span class="n">allow_none</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">help</span><span class="o">=</span><span class="sa">r</span><span class="s2">&quot;&quot;&quot;</span>
<span class="s2">        Maximum value to be taken by wetting and drying parameter :math:`\alpha`.</span>

<span class="s2">        Note this is only relevant if `use_automatic_wetting_and_drying_alpha` is set to ``True``.</span>
<span class="s2">        &quot;&quot;&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">tag</span><span class="p">(</span><span class="n">config</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
    <span class="n">tidal_turbine_farms</span> <span class="o">=</span> <span class="n">Dict</span><span class="p">(</span><span class="n">trait</span><span class="o">=</span><span class="n">TidalTurbineFarmOptions</span><span class="p">(),</span>
                               <span class="n">default_value</span><span class="o">=</span><span class="p">{},</span> <span class="n">help</span><span class="o">=</span><span class="s1">&#39;Dictionary mapping subdomain ids to the options of the corresponding farm&#39;</span><span class="p">)</span>
    <span class="n">check_tracer_conservation</span> <span class="o">=</span> <span class="n">Bool</span><span class="p">(</span>
        <span class="kc">False</span><span class="p">,</span> <span class="n">help</span><span class="o">=</span><span class="s2">&quot;&quot;&quot;</span>
<span class="s2">        Compute total tracer mass at every export</span>

<span class="s2">        Prints deviation from the initial mass to stdout.</span>
<span class="s2">        &quot;&quot;&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">tag</span><span class="p">(</span><span class="n">config</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
    <span class="n">tracer_advective_velocity_factor</span> <span class="o">=</span> <span class="n">FiredrakeScalarExpression</span><span class="p">(</span>
        <span class="n">Constant</span><span class="p">(</span><span class="mf">1.0</span><span class="p">),</span> <span class="n">help</span><span class="o">=</span><span class="s2">&quot;&quot;&quot;</span>
<span class="s2">        Custom factor multiplied to the velocity variable in tracer advection equation.</span>

<span class="s2">        Used to account for mismatch between depth-averaged product of velocity with tracer</span>
<span class="s2">        and product of depth-averaged velocity with depth-averaged tracer</span>
<span class="s2">        &quot;&quot;&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">tag</span><span class="p">(</span><span class="n">config</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
    <span class="n">check_tracer_overshoot</span> <span class="o">=</span> <span class="n">Bool</span><span class="p">(</span>
        <span class="kc">False</span><span class="p">,</span> <span class="n">help</span><span class="o">=</span><span class="s2">&quot;&quot;&quot;</span>
<span class="s2">        Compute tracer overshoots at every export</span>

<span class="s2">        Prints overshoot values that exceed the initial range to stdout.</span>
<span class="s2">        &quot;&quot;&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">tag</span><span class="p">(</span><span class="n">config</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
    <span class="n">tracer_only</span> <span class="o">=</span> <span class="n">Bool</span><span class="p">(</span>
        <span class="kc">False</span><span class="p">,</span> <span class="n">help</span><span class="o">=</span><span class="s2">&quot;&quot;&quot;Hold shallow water variables in initial state</span>

<span class="s2">        Advects tracer in the associated (constant) velocity field.</span>
<span class="s2">        &quot;&quot;&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">tag</span><span class="p">(</span><span class="n">config</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
    <span class="n">tracer_element_family</span> <span class="o">=</span> <span class="n">Enum</span><span class="p">(</span>
        <span class="p">[</span><span class="s1">&#39;dg&#39;</span><span class="p">,</span> <span class="s1">&#39;cg&#39;</span><span class="p">],</span>
        <span class="n">default_value</span><span class="o">=</span><span class="s1">&#39;dg&#39;</span><span class="p">,</span>
        <span class="n">help</span><span class="o">=</span><span class="s2">&quot;&quot;&quot;Finite element family for tracer transport</span>

<span class="s2">        2D solver supports &#39;dg&#39; or &#39;cg&#39;.&quot;&quot;&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">tag</span><span class="p">(</span><span class="n">config</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
    <span class="n">use_supg_tracer</span> <span class="o">=</span> <span class="n">Bool</span><span class="p">(</span>
        <span class="kc">False</span><span class="p">,</span> <span class="n">help</span><span class="o">=</span><span class="s2">&quot;Use SUPG stabilisation in tracer advection&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">tag</span><span class="p">(</span><span class="n">config</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
    <span class="n">tracer_picard_iterations</span> <span class="o">=</span> <span class="n">PositiveInteger</span><span class="p">(</span>
        <span class="mi">1</span><span class="p">,</span> <span class="n">help</span><span class="o">=</span><span class="s2">&quot;Number of Picard iterations taken for tracer equations.&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">tag</span><span class="p">(</span><span class="n">config</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">tracer</span> <span class="o">=</span> <span class="n">OrderedDict</span><span class="p">()</span>
        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>

<div class="viewcode-block" id="ModelOptions2d.add_tracer_2d"><a class="viewcode-back" href="../../thetis.html#thetis.options.ModelOptions2d.add_tracer_2d">[docs]</a>    <span class="k">def</span> <span class="nf">add_tracer_2d</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">label</span><span class="p">,</span> <span class="n">name</span><span class="p">,</span> <span class="n">filename</span><span class="p">,</span> <span class="n">shortname</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">unit</span><span class="o">=</span><span class="s1">&#39;-&#39;</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Add a 2D tracer field to :attr:`tracer`.</span>

<span class="sd">        Note that the tracer equations will be solved in the order in which they are added.</span>

<span class="sd">        :arg label: field label used internally by Thetis, e.g. &#39;tracer_2d&#39;</span>
<span class="sd">        :arg name: human readable name for the tracer field, e.g. &#39;Depth averaged tracer&#39;</span>
<span class="sd">        :arg filename: file name for outputs, e.g. &#39;Tracer2d&#39;</span>
<span class="sd">        :kwarg shortname: short version of name, e.g. &#39;Tracer&#39;</span>
<span class="sd">        :kwarg unit: units for field, e.g. &#39;-&#39;</span>
<span class="sd">        :kwarg function: :class:`Function` to use for the tracer</span>
<span class="sd">        :kwarg source: associated source term</span>
<span class="sd">        :kwarg diffusivity: associated diffusivity coefficient</span>
<span class="sd">        :kwarg use_conservative_form: should the tracer equation be solved in conservative form?</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">assert</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">label</span><span class="p">,</span> <span class="nb">str</span><span class="p">)</span>
        <span class="k">assert</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">name</span><span class="p">,</span> <span class="nb">str</span><span class="p">)</span>
        <span class="k">assert</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">filename</span><span class="p">,</span> <span class="nb">str</span><span class="p">)</span>
        <span class="k">assert</span> <span class="n">shortname</span> <span class="ow">is</span> <span class="kc">None</span> <span class="ow">or</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">shortname</span><span class="p">,</span> <span class="nb">str</span><span class="p">)</span>
        <span class="k">assert</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">unit</span><span class="p">,</span> <span class="nb">str</span><span class="p">)</span>
        <span class="k">assert</span> <span class="n">label</span> <span class="ow">not</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">tracer</span><span class="p">,</span> <span class="sa">f</span><span class="s2">&quot;Field &#39;</span><span class="si">{</span><span class="n">label</span><span class="si">}</span><span class="s2">&#39; already exists.&quot;</span>
        <span class="k">assert</span> <span class="s1">&#39; &#39;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">label</span><span class="p">,</span> <span class="s2">&quot;Labels cannot contain spaces&quot;</span>
        <span class="k">assert</span> <span class="s1">&#39; &#39;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">filename</span><span class="p">,</span> <span class="s2">&quot;Filenames cannot contain spaces&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">tracer</span><span class="p">[</span><span class="n">label</span><span class="p">]</span> <span class="o">=</span> <span class="n">TracerFieldOptions</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">tracer</span><span class="p">[</span><span class="n">label</span><span class="p">]</span><span class="o">.</span><span class="n">metadata</span> <span class="o">=</span> <span class="p">{</span>
            <span class="s1">&#39;name&#39;</span><span class="p">:</span> <span class="n">name</span><span class="p">,</span>
            <span class="s1">&#39;shortname&#39;</span><span class="p">:</span> <span class="n">shortname</span> <span class="ow">or</span> <span class="n">name</span><span class="p">,</span>
            <span class="s1">&#39;unit&#39;</span><span class="p">:</span> <span class="n">unit</span><span class="p">,</span>
            <span class="s1">&#39;filename&#39;</span><span class="p">:</span> <span class="n">filename</span><span class="p">,</span>
        <span class="p">}</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">tracer</span><span class="p">[</span><span class="n">label</span><span class="p">]</span><span class="o">.</span><span class="n">function</span> <span class="o">=</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;function&#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">tracer</span><span class="p">[</span><span class="n">label</span><span class="p">]</span><span class="o">.</span><span class="n">source</span> <span class="o">=</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;source&#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">tracer</span><span class="p">[</span><span class="n">label</span><span class="p">]</span><span class="o">.</span><span class="n">diffusivity</span> <span class="o">=</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;diffusivity&#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">tracer</span><span class="p">[</span><span class="n">label</span><span class="p">]</span><span class="o">.</span><span class="n">use_conservative_form</span> <span class="o">=</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;use_conservative_form&#39;</span><span class="p">,</span> <span class="kc">False</span><span class="p">)</span></div>

<div class="viewcode-block" id="ModelOptions2d.set_timestepper_type"><a class="viewcode-back" href="../../thetis.html#thetis.options.ModelOptions2d.set_timestepper_type">[docs]</a>    <span class="k">def</span> <span class="nf">set_timestepper_type</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">timestepper_type</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Set the same timestepper type for all components.</span>

<span class="sd">        Any keyword arguments are passed through to the</span>
<span class="sd">        associated :class:`TimeStepperOptions` object.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">swe_timestepper_type</span> <span class="o">=</span> <span class="n">timestepper_type</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">tracer_timestepper_type</span> <span class="o">=</span> <span class="n">timestepper_type</span>
        <span class="n">options</span> <span class="o">=</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">swe_timestepper_options</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">tracer_timestepper_options</span><span class="p">)</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">sediment_model_options</span><span class="o">.</span><span class="n">solve_suspended_sediment</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">sediment_model_options</span><span class="o">.</span><span class="n">sediment_timestepper_type</span> <span class="o">=</span> <span class="n">timestepper_type</span>
            <span class="n">options</span> <span class="o">+=</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">sediment_model_options</span><span class="o">.</span><span class="n">sediment_timestepper_options</span><span class="p">,)</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">sediment_model_options</span><span class="o">.</span><span class="n">solve_exner</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">sediment_model_options</span><span class="o">.</span><span class="n">exner_timestepper_type</span> <span class="o">=</span> <span class="n">timestepper_type</span>
            <span class="n">options</span> <span class="o">+=</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">sediment_model_options</span><span class="o">.</span><span class="n">exner_timestepper_options</span><span class="p">,)</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">nh_model_options</span><span class="o">.</span><span class="n">solve_nonhydrostatic_pressure</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">nh_model_options</span><span class="o">.</span><span class="n">free_surface_timestepper_type</span> <span class="o">=</span> <span class="n">timestepper_type</span>
            <span class="n">options</span> <span class="o">+=</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">nh_model_options</span><span class="o">.</span><span class="n">free_surface_timestepper_options</span><span class="p">,)</span>
        <span class="k">for</span> <span class="n">key</span><span class="p">,</span> <span class="n">value</span> <span class="ow">in</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
            <span class="k">for</span> <span class="n">option</span> <span class="ow">in</span> <span class="n">options</span><span class="p">:</span>
                <span class="nb">setattr</span><span class="p">(</span><span class="n">option</span><span class="p">,</span> <span class="n">key</span><span class="p">,</span> <span class="n">value</span><span class="p">)</span></div></div>


<div class="viewcode-block" id="ModelOptions3d"><a class="viewcode-back" href="../../thetis.html#thetis.options.ModelOptions3d">[docs]</a><span class="nd">@attach_paired_options</span><span class="p">(</span><span class="s2">&quot;timestepper_type&quot;</span><span class="p">,</span>
                       <span class="n">PairedEnum</span><span class="p">([(</span><span class="s1">&#39;LeapFrog&#39;</span><span class="p">,</span> <span class="n">LeapFrogTimeStepperOptions3d</span><span class="p">),</span>
                                   <span class="p">(</span><span class="s1">&#39;SSPRK22&#39;</span><span class="p">,</span> <span class="n">SSPRKTimeStepperOptions3d</span><span class="p">),</span>
                                   <span class="p">],</span>
                                  <span class="s2">&quot;timestepper_options&quot;</span><span class="p">,</span>
                                  <span class="n">default_value</span><span class="o">=</span><span class="s1">&#39;SSPRK22&#39;</span><span class="p">,</span>
                                  <span class="n">help</span><span class="o">=</span><span class="s1">&#39;Name of the 3D time integrator&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">tag</span><span class="p">(</span><span class="n">config</span><span class="o">=</span><span class="kc">True</span><span class="p">),</span>
                       <span class="n">Instance</span><span class="p">(</span><span class="n">TimeStepperOptions3d</span><span class="p">,</span> <span class="n">args</span><span class="o">=</span><span class="p">())</span><span class="o">.</span><span class="n">tag</span><span class="p">(</span><span class="n">config</span><span class="o">=</span><span class="kc">True</span><span class="p">))</span>
<span class="nd">@attach_paired_options</span><span class="p">(</span><span class="s2">&quot;turbulence_model_type&quot;</span><span class="p">,</span>
                       <span class="n">PairedEnum</span><span class="p">([(</span><span class="s1">&#39;gls&#39;</span><span class="p">,</span> <span class="n">GLSModelOptions</span><span class="p">),</span>
                                   <span class="p">(</span><span class="s1">&#39;pacanowski&#39;</span><span class="p">,</span> <span class="n">PacanowskiPhilanderModelOptions</span><span class="p">)</span>
                                   <span class="p">],</span>
                                  <span class="s2">&quot;turbulence_model_options&quot;</span><span class="p">,</span>
                                  <span class="n">default_value</span><span class="o">=</span><span class="s1">&#39;gls&#39;</span><span class="p">,</span>
                                  <span class="n">help</span><span class="o">=</span><span class="s1">&#39;Type of vertical turbulence model&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">tag</span><span class="p">(</span><span class="n">config</span><span class="o">=</span><span class="kc">True</span><span class="p">),</span>
                       <span class="n">Instance</span><span class="p">(</span><span class="n">TurbulenceModelOptions</span><span class="p">,</span> <span class="n">args</span><span class="o">=</span><span class="p">())</span><span class="o">.</span><span class="n">tag</span><span class="p">(</span><span class="n">config</span><span class="o">=</span><span class="kc">True</span><span class="p">))</span>
<span class="nd">@attach_paired_options</span><span class="p">(</span><span class="s2">&quot;equation_of_state_type&quot;</span><span class="p">,</span>
                       <span class="n">PairedEnum</span><span class="p">([(</span><span class="s1">&#39;full&#39;</span><span class="p">,</span> <span class="n">EquationOfStateOptions</span><span class="p">),</span>
                                   <span class="p">(</span><span class="s1">&#39;linear&#39;</span><span class="p">,</span> <span class="n">LinearEquationOfStateOptions</span><span class="p">)],</span>
                                  <span class="s2">&quot;equation_of_state_options&quot;</span><span class="p">,</span>
                                  <span class="n">default_value</span><span class="o">=</span><span class="s1">&#39;full&#39;</span><span class="p">,</span>
                                  <span class="n">help</span><span class="o">=</span><span class="s1">&#39;Type of equation of state&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">tag</span><span class="p">(</span><span class="n">config</span><span class="o">=</span><span class="kc">True</span><span class="p">),</span>
                       <span class="n">Instance</span><span class="p">(</span><span class="n">EquationOfStateOptions</span><span class="p">,</span> <span class="n">args</span><span class="o">=</span><span class="p">())</span><span class="o">.</span><span class="n">tag</span><span class="p">(</span><span class="n">config</span><span class="o">=</span><span class="kc">True</span><span class="p">))</span>
<span class="k">class</span> <span class="nc">ModelOptions3d</span><span class="p">(</span><span class="n">CommonModelOptions</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Options for 3D hydrostatic model&quot;&quot;&quot;</span>
    <span class="n">name</span> <span class="o">=</span> <span class="s1">&#39;3D hydrostatic model&#39;</span>
    <span class="n">solve_salinity</span> <span class="o">=</span> <span class="n">Bool</span><span class="p">(</span><span class="kc">True</span><span class="p">,</span> <span class="n">help</span><span class="o">=</span><span class="s1">&#39;Solve salinity transport&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">tag</span><span class="p">(</span><span class="n">config</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
    <span class="n">solve_temperature</span> <span class="o">=</span> <span class="n">Bool</span><span class="p">(</span><span class="kc">True</span><span class="p">,</span> <span class="n">help</span><span class="o">=</span><span class="s1">&#39;Solve temperature transport&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">tag</span><span class="p">(</span><span class="n">config</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
    <span class="n">use_implicit_vertical_diffusion</span> <span class="o">=</span> <span class="n">Bool</span><span class="p">(</span><span class="kc">True</span><span class="p">,</span> <span class="n">help</span><span class="o">=</span><span class="s1">&#39;Solve vertical diffusion and viscosity implicitly&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">tag</span><span class="p">(</span><span class="n">config</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
    <span class="n">use_bottom_friction</span> <span class="o">=</span> <span class="n">Bool</span><span class="p">(</span><span class="kc">True</span><span class="p">,</span> <span class="n">help</span><span class="o">=</span><span class="s1">&#39;Apply log layer bottom stress in the 3D model&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">tag</span><span class="p">(</span><span class="n">config</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
    <span class="n">use_ale_moving_mesh</span> <span class="o">=</span> <span class="n">Bool</span><span class="p">(</span>
        <span class="kc">True</span><span class="p">,</span> <span class="n">help</span><span class="o">=</span><span class="s2">&quot;Use ALE formulation where 3D mesh tracks free surface&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">tag</span><span class="p">(</span><span class="n">config</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
    <span class="n">use_baroclinic_formulation</span> <span class="o">=</span> <span class="n">Bool</span><span class="p">(</span>
        <span class="kc">False</span><span class="p">,</span> <span class="n">help</span><span class="o">=</span><span class="s2">&quot;Compute internal pressure gradient in momentum equation&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">tag</span><span class="p">(</span><span class="n">config</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
    <span class="n">use_turbulence</span> <span class="o">=</span> <span class="n">Bool</span><span class="p">(</span>
        <span class="kc">False</span><span class="p">,</span> <span class="n">help</span><span class="o">=</span><span class="s2">&quot;Activate turbulence model in the 3D model&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">tag</span><span class="p">(</span><span class="n">config</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
    <span class="n">use_turbulence_advection</span> <span class="o">=</span> <span class="n">Bool</span><span class="p">(</span>
        <span class="kc">False</span><span class="p">,</span> <span class="n">help</span><span class="o">=</span><span class="s2">&quot;Advect TKE and Psi in the GLS turbulence model&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">tag</span><span class="p">(</span><span class="n">config</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
    <span class="n">use_smagorinsky_viscosity</span> <span class="o">=</span> <span class="n">Bool</span><span class="p">(</span>
        <span class="kc">False</span><span class="p">,</span> <span class="n">help</span><span class="o">=</span><span class="s2">&quot;Use Smagorinsky horisontal viscosity parametrization&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">tag</span><span class="p">(</span><span class="n">config</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
    <span class="n">smagorinsky_coefficient</span> <span class="o">=</span> <span class="n">FiredrakeConstantTraitlet</span><span class="p">(</span>
        <span class="n">Constant</span><span class="p">(</span><span class="mf">0.1</span><span class="p">),</span>
        <span class="n">help</span><span class="o">=</span><span class="s2">&quot;&quot;&quot;Smagorinsky viscosity coefficient :math:`C_S`</span>

<span class="s2">        See :class:`.SmagorinskyViscosity`.&quot;&quot;&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">tag</span><span class="p">(</span><span class="n">config</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

    <span class="n">use_limiter_for_velocity</span> <span class="o">=</span> <span class="n">Bool</span><span class="p">(</span>
        <span class="kc">True</span><span class="p">,</span> <span class="n">help</span><span class="o">=</span><span class="s2">&quot;Apply P1DG limiter for 3D horizontal velocity field&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">tag</span><span class="p">(</span><span class="n">config</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
    <span class="n">check_volume_conservation_3d</span> <span class="o">=</span> <span class="n">Bool</span><span class="p">(</span>
        <span class="kc">False</span><span class="p">,</span> <span class="n">help</span><span class="o">=</span><span class="s2">&quot;&quot;&quot;</span>
<span class="s2">        Compute volume of the 3D domain at every export</span>

<span class="s2">        Prints deviation from the initial volume to stdout.</span>
<span class="s2">        &quot;&quot;&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">tag</span><span class="p">(</span><span class="n">config</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
    <span class="n">check_salinity_conservation</span> <span class="o">=</span> <span class="n">Bool</span><span class="p">(</span>
        <span class="kc">False</span><span class="p">,</span> <span class="n">help</span><span class="o">=</span><span class="s2">&quot;&quot;&quot;</span>
<span class="s2">        Compute total salinity mass at every export</span>

<span class="s2">        Prints deviation from the initial mass to stdout.</span>
<span class="s2">        &quot;&quot;&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">tag</span><span class="p">(</span><span class="n">config</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
    <span class="n">check_salinity_overshoot</span> <span class="o">=</span> <span class="n">Bool</span><span class="p">(</span>
        <span class="kc">False</span><span class="p">,</span> <span class="n">help</span><span class="o">=</span><span class="s2">&quot;&quot;&quot;</span>
<span class="s2">        Compute salinity overshoots at every export</span>

<span class="s2">        Prints overshoot values that exceed the initial range to stdout.</span>
<span class="s2">        &quot;&quot;&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">tag</span><span class="p">(</span><span class="n">config</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
    <span class="n">check_temperature_conservation</span> <span class="o">=</span> <span class="n">Bool</span><span class="p">(</span>
        <span class="kc">False</span><span class="p">,</span> <span class="n">help</span><span class="o">=</span><span class="s2">&quot;&quot;&quot;</span>
<span class="s2">        Compute total temperature mass at every export</span>

<span class="s2">        Prints deviation from the initial mass to stdout.</span>
<span class="s2">        &quot;&quot;&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">tag</span><span class="p">(</span><span class="n">config</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
    <span class="n">check_temperature_overshoot</span> <span class="o">=</span> <span class="n">Bool</span><span class="p">(</span>
        <span class="kc">False</span><span class="p">,</span> <span class="n">help</span><span class="o">=</span><span class="s2">&quot;&quot;&quot;</span>
<span class="s2">        Compute temperature overshoots at every export</span>

<span class="s2">        Prints overshoot values that exceed the initial range to stdout.</span>
<span class="s2">        &quot;&quot;&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">tag</span><span class="p">(</span><span class="n">config</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
    <span class="n">timestep_2d</span> <span class="o">=</span> <span class="n">PositiveFloat</span><span class="p">(</span>
        <span class="mf">10.0</span><span class="p">,</span> <span class="n">help</span><span class="o">=</span><span class="s2">&quot;&quot;&quot;</span>
<span class="s2">        Time step of the 2d mode</span>

<span class="s2">        This option is only used in the 3d solver, if 2d mode is solved</span>
<span class="s2">        explicitly.</span>
<span class="s2">        &quot;&quot;&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">tag</span><span class="p">(</span><span class="n">config</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
    <span class="n">vertical_velocity_scale</span> <span class="o">=</span> <span class="n">FiredrakeConstantTraitlet</span><span class="p">(</span>
        <span class="n">Constant</span><span class="p">(</span><span class="mf">1e-4</span><span class="p">),</span> <span class="n">help</span><span class="o">=</span><span class="s2">&quot;&quot;&quot;</span>
<span class="s2">        Maximum vertical velocity magnitude</span>

<span class="s2">        Used to compute max stable advection time step.</span>
<span class="s2">        &quot;&quot;&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">tag</span><span class="p">(</span><span class="n">config</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
    <span class="n">use_quadratic_pressure</span> <span class="o">=</span> <span class="n">Bool</span><span class="p">(</span>
        <span class="kc">False</span><span class="p">,</span> <span class="n">help</span><span class="o">=</span><span class="s2">&quot;&quot;&quot;</span>
<span class="s2">        Use P2DGxP2 space for baroclinic head.</span>

<span class="s2">        If element_family=&#39;dg-dg&#39;, P2DGxP1DG space is also used for the internal</span>
<span class="s2">        pressure gradient.</span>

<span class="s2">        This is useful to alleviate bathymetry-induced pressure gradient errors.</span>
<span class="s2">        If False, the baroclinic head is in the tracer space, and internal</span>
<span class="s2">        pressure gradient is in the velocity space.</span>
<span class="s2">        &quot;&quot;&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">tag</span><span class="p">(</span><span class="n">config</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
    <span class="n">use_quadratic_density</span> <span class="o">=</span> <span class="n">Bool</span><span class="p">(</span>
        <span class="kc">False</span><span class="p">,</span> <span class="n">help</span><span class="o">=</span><span class="s2">&quot;&quot;&quot;</span>
<span class="s2">        Water density is projected to P2DGxP2 space.</span>

<span class="s2">        This reduces pressure gradient errors associated with nonlinear</span>
<span class="s2">        equation of state.</span>
<span class="s2">        If False, density is computed point-wise in the tracer space.</span>
<span class="s2">        &quot;&quot;&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">tag</span><span class="p">(</span><span class="n">config</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
    <span class="n">bottom_roughness</span> <span class="o">=</span> <span class="n">FiredrakeScalarExpression</span><span class="p">(</span>
        <span class="kc">None</span><span class="p">,</span> <span class="n">allow_none</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">help</span><span class="o">=</span><span class="s2">&quot;Bottom roughness length in meters.&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">tag</span><span class="p">(</span><span class="n">config</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
    <span class="n">horizontal_diffusivity</span> <span class="o">=</span> <span class="n">FiredrakeScalarExpression</span><span class="p">(</span>
        <span class="kc">None</span><span class="p">,</span> <span class="n">allow_none</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">help</span><span class="o">=</span><span class="s2">&quot;Horizontal diffusivity for tracers&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">tag</span><span class="p">(</span><span class="n">config</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
    <span class="n">vertical_diffusivity</span> <span class="o">=</span> <span class="n">FiredrakeScalarExpression</span><span class="p">(</span>
        <span class="kc">None</span><span class="p">,</span> <span class="n">allow_none</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">help</span><span class="o">=</span><span class="s2">&quot;Vertical diffusivity for tracers&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">tag</span><span class="p">(</span><span class="n">config</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
    <span class="n">vertical_viscosity</span> <span class="o">=</span> <span class="n">FiredrakeScalarExpression</span><span class="p">(</span>
        <span class="kc">None</span><span class="p">,</span> <span class="n">allow_none</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">help</span><span class="o">=</span><span class="s2">&quot;Vertical viscosity&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">tag</span><span class="p">(</span><span class="n">config</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
    <span class="n">momentum_source_3d</span> <span class="o">=</span> <span class="n">FiredrakeVectorExpression</span><span class="p">(</span>
        <span class="kc">None</span><span class="p">,</span> <span class="n">allow_none</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">help</span><span class="o">=</span><span class="s2">&quot;Source term for 3D momentum equation&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">tag</span><span class="p">(</span><span class="n">config</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
    <span class="n">salinity_source_3d</span> <span class="o">=</span> <span class="n">FiredrakeScalarExpression</span><span class="p">(</span>
        <span class="kc">None</span><span class="p">,</span> <span class="n">allow_none</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">help</span><span class="o">=</span><span class="s2">&quot;Source term for salinity equation&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">tag</span><span class="p">(</span><span class="n">config</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
    <span class="n">temperature_source_3d</span> <span class="o">=</span> <span class="n">FiredrakeScalarExpression</span><span class="p">(</span>
        <span class="kc">None</span><span class="p">,</span> <span class="n">allow_none</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">help</span><span class="o">=</span><span class="s2">&quot;Source term for temperature equation&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">tag</span><span class="p">(</span><span class="n">config</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
    <span class="n">constant_temperature</span> <span class="o">=</span> <span class="n">FiredrakeConstantTraitlet</span><span class="p">(</span>
        <span class="n">Constant</span><span class="p">(</span><span class="mf">10.0</span><span class="p">),</span> <span class="n">help</span><span class="o">=</span><span class="s2">&quot;Constant temperature if temperature is not solved&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">tag</span><span class="p">(</span><span class="n">config</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
    <span class="n">constant_salinity</span> <span class="o">=</span> <span class="n">FiredrakeConstantTraitlet</span><span class="p">(</span>
        <span class="n">Constant</span><span class="p">(</span><span class="mf">0.0</span><span class="p">),</span> <span class="n">help</span><span class="o">=</span><span class="s2">&quot;Constant salinity if salinity is not solved&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">tag</span><span class="p">(</span><span class="n">config</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
    <span class="n">sipg_factor_vertical</span> <span class="o">=</span> <span class="n">FiredrakeScalarExpression</span><span class="p">(</span>
        <span class="n">Constant</span><span class="p">(</span><span class="mf">1.0</span><span class="p">),</span> <span class="n">help</span><span class="o">=</span><span class="s2">&quot;Penalty parameter scaling factor for vertical viscosity terms.&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">tag</span><span class="p">(</span><span class="n">config</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
    <span class="n">sipg_factor_vertical_tracer</span> <span class="o">=</span> <span class="n">FiredrakeScalarExpression</span><span class="p">(</span>
        <span class="n">Constant</span><span class="p">(</span><span class="mf">1.0</span><span class="p">),</span> <span class="n">help</span><span class="o">=</span><span class="s2">&quot;Penalty parameter scaling factor for vertical diffusivity terms.&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">tag</span><span class="p">(</span><span class="n">config</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
    <span class="n">sipg_factor_turb</span> <span class="o">=</span> <span class="n">FiredrakeScalarExpression</span><span class="p">(</span>
        <span class="n">Constant</span><span class="p">(</span><span class="mf">1.0</span><span class="p">),</span> <span class="n">help</span><span class="o">=</span><span class="s2">&quot;Penalty parameter scaling factor for horizontal diffusivity terms of the turbulence model.&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">tag</span><span class="p">(</span><span class="n">config</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
    <span class="n">sipg_factor_vertical_turb</span> <span class="o">=</span> <span class="n">FiredrakeScalarExpression</span><span class="p">(</span>
        <span class="n">Constant</span><span class="p">(</span><span class="mf">1.0</span><span class="p">),</span> <span class="n">help</span><span class="o">=</span><span class="s2">&quot;Penalty parameter scaling factor for vertical diffusivity terms of the turbulence model.&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">tag</span><span class="p">(</span><span class="n">config</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
    <span class="n">internal_pg_scalar</span> <span class="o">=</span> <span class="n">FiredrakeConstantTraitlet</span><span class="p">(</span>
        <span class="kc">None</span><span class="p">,</span> <span class="n">allow_none</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">help</span><span class="o">=</span><span class="s2">&quot;A constant to scale the internal pressure gradient. Used to ramp up the model.&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">tag</span><span class="p">(</span><span class="n">config</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span></div>
</pre></div>

            <div class="clearer"></div>
          </div>
        </div>
      </div>
    </div>
      <div class="clearer"></div>
    </div>
    <div class="footer" role="contentinfo">
        &#169; Copyright 2016-2021, Tuomas Krn et al..
      Created using <a href="https://www.sphinx-doc.org/">Sphinx</a> 4.1.2.
    </div>
  </body>
</html>