<!DOCTYPE html>

<html lang="en" data-content_root="./">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="viewport" content="width=device-width, initial-scale=1" />

    <title>3D model options &#8212; Thetis 0+untagged.2082.gf1a0bbb documentation</title>
    <link rel="stylesheet" type="text/css" href="_static/pygments.css?v=03e43079" />
    <link rel="stylesheet" type="text/css" href="_static/thetis.css?v=0f3339d6" />
    <script src="_static/documentation_options.js?v=ccd1159c"></script>
    <script src="_static/doctools.js?v=9bcbadda"></script>
    <script src="_static/sphinx_highlight.js?v=dc90522c"></script>
    <script async="async" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
<!--[if lte IE 6]>
<link rel="stylesheet" href="_static/ie6.css" type="text/css" media="screen" charset="utf-8" />
<![endif]-->

<!-- <link rel="stylesheet" href="_static/featured.css"> -->


<link rel="shortcut icon" href="_static/icon_thetis.ico" />


  </head><body>
<div class="wrapper">
  <a href="index.html"><img src="_static/banner.jpg" height="180px" alt="Thetis Project Banner" /></a>
  <div id="access">
    <div class="menu">
      <ul>
        <li class="page_item"><a href="documentation.html" title="Thetis documentation">Documentation</a></li>
        <li class="page_item"><a href="download.html" title="Install Thetis">Download</a></li>
        <li class="page_item"><a href="team.html" title="Development team">Team</a></li>
        <li class="page_item"><a href="publications.html" title="Publications">Publications</a></li>
        <li class="page_item"><a href="funding.html" title="Our financial supporters">Funding</a></li>
        <li class="page_item"><a href="contact.html" title="Getting in touch">Contact</a></li>
        <li class="page_item"><a href="https://github.com/thetisproject/thetis" title="Thetis source on GitHub">GitHub</a></li>
      </ul>
    </div><!-- .menu -->
  </div><!-- #access -->
</div><!-- #wrapper -->


    <div class="document">
    <div class="model_options_3d">
      
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body" role="main">
            
  <section id="d-model-options">
<span id="model-options-3d"></span><h1>3D model options<a class="headerlink" href="#d-model-options" title="Link to this heading">¶</a></h1>
<p>This page lists all available options for the 3D model.</p>
<p>See also <a class="reference internal" href="turbulence_options.html#turbulence-options"><span class="std std-ref">Turbulence model options</span></a> and <a class="reference internal" href="eos_options.html#eos-options"><span class="std std-ref">Equation of State options</span></a>.</p>
<dl>
<dt>CommonModelOptions.<strong>atmospheric_pressure</strong><span class="classifier">FiredrakeScalarExpression</span></dt><dd><p>Atmospheric pressure at free surface, in pascals</p>
<p>Default:</p>
<p>UFL scalar expression</p>
</dd>
<dt>CommonModelOptions.<strong>cfl_2d</strong><span class="classifier">PositiveFloat</span></dt><dd><p>Factor to scale the 2d time step OBSOLETE</p>
<p>Default:</p>
<p>1.0</p>
</dd>
<dt>CommonModelOptions.<strong>cfl_3d</strong><span class="classifier">PositiveFloat</span></dt><dd><p>Factor to scale the 2d time step OBSOLETE</p>
<p>Default:</p>
<p>1.0</p>
</dd>
<dt>CommonModelOptions.<strong>check_volume_conservation_2d</strong><span class="classifier">Bool</span></dt><dd><p>Compute volume of the 2D mode at every export</p>
<blockquote>
<div><p>2D volume is defined as the integral of the water elevation field.
Prints deviation from the initial volume to stdout.</p>
</div></blockquote>
<p>Default:</p>
<p>False</p>
</dd>
<dt>CommonModelOptions.<strong>coriolis_frequency</strong><span class="classifier">FiredrakeScalarExpression</span></dt><dd><p>2D Coriolis parameter</p>
<p>Default:</p>
<p>UFL scalar expression</p>
</dd>
<dt>CommonModelOptions.<strong>element_family</strong><span class="classifier">‘dg-dg’|’rt-dg’|’bdm-dg’|’dg-cg’</span></dt><dd><p>Finite element family</p>
<blockquote>
<div><p>2D solver supports ‘dg-dg’, ‘rt-dg’, ‘bdm-dg’, or ‘dg-cg’ velocity-pressure pairs.
3D solver supports ‘dg-dg’, ‘rt-dg’, or ‘bdm-dg’ velocity-pressure pairs.</p>
</div></blockquote>
<p>Default:</p>
<p>‘dg-dg’</p>
</dd>
<dt>CommonModelOptions.<strong>export_diagnostics</strong><span class="classifier">Bool</span></dt><dd><p>Store diagnostic variables to disk in HDF5 format</p>
<p>Default:</p>
<p>True</p>
</dd>
<dt>CommonModelOptions.<strong>fields_to_export</strong><span class="classifier">List</span></dt><dd><p>Fields to export in VTK format</p>
<p>Default:</p>
<p>[‘elev_2d’, ‘uv_2d’, ‘uv_3d’, ‘w_3d’]</p>
</dd>
<dt>CommonModelOptions.<strong>fields_to_export_hdf5</strong><span class="classifier">List</span></dt><dd><p>Fields to export in HDF5 format</p>
<p>Default:</p>
<p>[]</p>
</dd>
<dt>CommonModelOptions.<strong>horizontal_diffusivity_scale</strong><span class="classifier">FiredrakeConstantTraitlet</span></dt><dd><p>Maximum horizontal diffusivity</p>
<blockquote>
<div><p>Used to compute the mesh Peclet number in
the 2D tracer SUPG stabilization scheme.</p>
</div></blockquote>
<p>Default:</p>
<p>Constant(1.0)</p>
</dd>
<dt>CommonModelOptions.<strong>horizontal_velocity_scale</strong><span class="classifier">FiredrakeConstantTraitlet</span></dt><dd><p>Maximum horizontal velocity magnitude</p>
<blockquote>
<div><p>Used to compute max stable advection time step.</p>
</div></blockquote>
<p>Default:</p>
<p>Constant(0.1)</p>
</dd>
<dt>CommonModelOptions.<strong>horizontal_viscosity</strong><span class="classifier">FiredrakeScalarExpression</span></dt><dd><p>Horizontal viscosity</p>
<p>Default:</p>
<p>UFL scalar expression</p>
</dd>
<dt>CommonModelOptions.<strong>horizontal_viscosity_scale</strong><span class="classifier">FiredrakeConstantTraitlet</span></dt><dd><p>Maximum horizontal viscosity</p>
<blockquote>
<div><p>Used to compute max stable diffusion time step.</p>
</div></blockquote>
<p>Default:</p>
<p>Constant(1.0)</p>
</dd>
<dt>CommonModelOptions.<strong>lax_friedrichs_tracer_scaling_factor</strong><span class="classifier">FiredrakeConstantTraitlet</span></dt><dd><p>Scaling factor for tracer Lax Friedrichs stability term.</p>
<p>Default:</p>
<p>Constant(1.0)</p>
</dd>
<dt>CommonModelOptions.<strong>lax_friedrichs_velocity_scaling_factor</strong><span class="classifier">FiredrakeConstantTraitlet</span></dt><dd><p>Scaling factor for Lax Friedrichs stabilisation term in horizontal momentum advection.</p>
<p>Default:</p>
<p>Constant(1.0)</p>
</dd>
<dt>CommonModelOptions.<strong>linear_drag_coefficient</strong><span class="classifier">FiredrakeScalarExpression</span></dt><dd><p>2D linear drag parameter <span class="math notranslate nohighlight">\(L\)</span></p>
<blockquote>
<div><p>Bottom stress is <span class="math notranslate nohighlight">\(\tau_b/\rho_0 = -L \mathbf{u} H\)</span></p>
</div></blockquote>
<p>Default:</p>
<p>UFL scalar expression</p>
</dd>
<dt>CommonModelOptions.<strong>log_output</strong><span class="classifier">Bool</span></dt><dd><p>Redirect all output to log file in output directory</p>
<p>Default:</p>
<p>True</p>
</dd>
<dt>CommonModelOptions.<strong>manning_drag_coefficient</strong><span class="classifier">FiredrakeScalarExpression</span></dt><dd><p>Manning-Strickler 2D quadratic drag parameter <span class="math notranslate nohighlight">\(\mu\)</span></p>
<blockquote>
<div><p>Bottom stress is <span class="math notranslate nohighlight">\(\tau_b/\rho_0 = -g \mu^2 |\mathbf{u}|\mathbf{u}/H^{1/3}\)</span></p>
</div></blockquote>
<p>Default:</p>
<p>UFL scalar expression</p>
</dd>
<dt>CommonModelOptions.<strong>momentum_source_2d</strong><span class="classifier">FiredrakeVectorExpression</span></dt><dd><p>Source term for 2D momentum equation</p>
<p>Default:</p>
<p>UFL vector expression</p>
</dd>
<dt>CommonModelOptions.<strong>nh_model_options</strong><span class="classifier">Instance</span></dt><dd><p>No description</p>
<p>Default:</p>
<p>&lt;thetis.options.NonhydrostaticModelOptions object at 0x739c381adc40&gt;</p>
</dd>
<dt>CommonModelOptions.<strong>nikuradse_bed_roughness</strong><span class="classifier">FiredrakeScalarExpression</span></dt><dd><p>Nikuradse bed roughness length used to construct the 2D quadratic drag parameter <span class="math notranslate nohighlight">\(C_D\)</span>.</p>
<blockquote>
<div><p>In sediment transport this term is usually three times the average sediment diameter size.</p>
</div></blockquote>
<p>Default:</p>
<p>UFL scalar expression</p>
</dd>
<dt>CommonModelOptions.<strong>no_exports</strong><span class="classifier">Bool</span></dt><dd><p>Do not store any outputs to disk</p>
<blockquote>
<div><p>Disables VTK and HDF5 field outputs. and HDF5 diagnostic outputs.
Used in CI test suite.</p>
</div></blockquote>
<p>Default:</p>
<p>False</p>
</dd>
<dt>CommonModelOptions.<strong>norm_smoother</strong><span class="classifier">FiredrakeConstantTraitlet</span></dt><dd><dl class="simple">
<dt>Coefficient used to avoid non-differentiable functions in the continuous formulation of the velocity norm in</dt><dd><p>the quadratic bottom drag term in the momentum equation. This replaces the velocity norm in the quadratic
bottom drag term with <span class="math notranslate nohighlight">\(\|u\| \approx \sqrt{\|u\|^2 + \alpha^2}\)</span></p>
</dd>
</dl>
<p>Default:</p>
<p>Constant(0.0)</p>
</dd>
<dt>CommonModelOptions.<strong>output_directory</strong><span class="classifier">Unicode</span></dt><dd><p>Directory where model output files are stored</p>
<p>Default:</p>
<p>‘outputs’</p>
</dd>
<dt>CommonModelOptions.<strong>polynomial_degree</strong><span class="classifier">NonNegativeInteger</span></dt><dd><p>Polynomial degree of elements</p>
<p>Default:</p>
<p>1</p>
</dd>
<dt>CommonModelOptions.<strong>quadratic_drag_coefficient</strong><span class="classifier">FiredrakeScalarExpression</span></dt><dd><p>Dimensionless 2D quadratic drag parameter <span class="math notranslate nohighlight">\(C_D\)</span></p>
<blockquote>
<div><p>Bottom stress is <span class="math notranslate nohighlight">\(\tau_b/\rho_0 = -C_D |\mathbf{u}|\mathbf{u}\)</span></p>
</div></blockquote>
<p>Default:</p>
<p>UFL scalar expression</p>
</dd>
<dt>CommonModelOptions.<strong>simulation_end_date</strong><span class="classifier">DatetimeTraitlet</span></dt><dd><p>Simulation end date</p>
<p>Default:</p>
<p>None</p>
</dd>
<dt>CommonModelOptions.<strong>simulation_end_time</strong><span class="classifier">PositiveFloat</span></dt><dd><p>Simulation duration in seconds</p>
<p>Default:</p>
<p>None</p>
</dd>
<dt>CommonModelOptions.<strong>simulation_export_time</strong><span class="classifier">PositiveFloat</span></dt><dd><p>Export interval in seconds</p>
<blockquote>
<div><p>All fields in fields_to_export list will be stored to disk and
diagnostics will be computed</p>
</div></blockquote>
<p>Default:</p>
<p>100.0</p>
</dd>
<dt>CommonModelOptions.<strong>simulation_initial_date</strong><span class="classifier">DatetimeTraitlet</span></dt><dd><p>Model initialization date. Corresponds to zero in simulation time.</p>
<p>Default:</p>
<p>None</p>
</dd>
<dt>CommonModelOptions.<strong>sipg_factor</strong><span class="classifier">FiredrakeScalarExpression</span></dt><dd><p>Penalty parameter scaling factor for horizontal viscosity terms.</p>
<p>Default:</p>
<p>Constant(1.0)</p>
</dd>
<dt>CommonModelOptions.<strong>sipg_factor_tracer</strong><span class="classifier">FiredrakeScalarExpression</span></dt><dd><p>Penalty parameter scaling factor for horizontal diffusivity terms.</p>
<p>Default:</p>
<p>Constant(1.0)</p>
</dd>
<dt>CommonModelOptions.<strong>timestep</strong><span class="classifier">PositiveFloat</span></dt><dd><p>Time step</p>
<p>Default:</p>
<p>10.0</p>
</dd>
<dt>CommonModelOptions.<strong>use_grad_depth_viscosity_term</strong><span class="classifier">Bool</span></dt><dd><p>Include <span class="math notranslate nohighlight">\(\nabla H\)</span> term in the depth-averaged viscosity</p>
<blockquote>
<div><p>See <a class="reference internal" href="thetis.html#thetis.shallowwater_eq.HorizontalViscosityTerm" title="thetis.shallowwater_eq.HorizontalViscosityTerm"><code class="xref py py-class docutils literal notranslate"><span class="pre">shallowwater_eq.HorizontalViscosityTerm</span></code></a> for details.</p>
</div></blockquote>
<p>Default:</p>
<p>True</p>
</dd>
<dt>CommonModelOptions.<strong>use_grad_div_viscosity_term</strong><span class="classifier">Bool</span></dt><dd><p>Include <span class="math notranslate nohighlight">\(\nabla (\nu_h \nabla \cdot \bar{\textbf{u}})\)</span> term in the depth-averaged viscosity</p>
<blockquote>
<div><p>See <a class="reference internal" href="thetis.html#thetis.shallowwater_eq.HorizontalViscosityTerm" title="thetis.shallowwater_eq.HorizontalViscosityTerm"><code class="xref py py-class docutils literal notranslate"><span class="pre">shallowwater_eq.HorizontalViscosityTerm</span></code></a> for details.</p>
</div></blockquote>
<p>Default:</p>
<p>False</p>
</dd>
<dt>CommonModelOptions.<strong>use_lax_friedrichs_tracer</strong><span class="classifier">Bool</span></dt><dd><p>Use Lax Friedrichs stabilisation in tracer advection.</p>
<p>Default:</p>
<p>False</p>
</dd>
<dt>CommonModelOptions.<strong>use_lax_friedrichs_velocity</strong><span class="classifier">Bool</span></dt><dd><p>use Lax Friedrichs stabilisation in horizontal momentum advection.</p>
<p>Default:</p>
<p>True</p>
</dd>
<dt>CommonModelOptions.<strong>use_limiter_for_tracers</strong><span class="classifier">Bool</span></dt><dd><p>Apply P1DG limiter for tracer fields</p>
<p>Default:</p>
<p>True</p>
</dd>
<dt>CommonModelOptions.<strong>use_nonlinear_equations</strong><span class="classifier">Bool</span></dt><dd><p>Use nonlinear shallow water equations</p>
<p>Default:</p>
<p>True</p>
</dd>
<dt>CommonModelOptions.<strong>verbose</strong><span class="classifier">Int</span></dt><dd><p>Verbosity level</p>
<p>Default:</p>
<p>0</p>
</dd>
<dt>CommonModelOptions.<strong>volume_source_2d</strong><span class="classifier">FiredrakeScalarExpression</span></dt><dd><p>Source term for 2D continuity equation</p>
<p>Default:</p>
<p>UFL scalar expression</p>
</dd>
<dt>CommonModelOptions.<strong>wind_stress</strong><span class="classifier">FiredrakeVectorExpression</span></dt><dd><p>Stress at free surface (2D vector function)</p>
<p>Default:</p>
<p>UFL vector expression</p>
</dd>
<dt>ModelOptions3d.<strong>bottom_roughness</strong><span class="classifier">FiredrakeScalarExpression</span></dt><dd><p>Bottom roughness length in meters.</p>
<p>Default:</p>
<p>UFL scalar expression</p>
</dd>
<dt>ModelOptions3d.<strong>check_salinity_conservation</strong><span class="classifier">Bool</span></dt><dd><p>Compute total salinity mass at every export</p>
<blockquote>
<div><p>Prints deviation from the initial mass to stdout.</p>
</div></blockquote>
<p>Default:</p>
<p>False</p>
</dd>
<dt>ModelOptions3d.<strong>check_salinity_overshoot</strong><span class="classifier">Bool</span></dt><dd><p>Compute salinity overshoots at every export</p>
<blockquote>
<div><p>Prints overshoot values that exceed the initial range to stdout.</p>
</div></blockquote>
<p>Default:</p>
<p>False</p>
</dd>
<dt>ModelOptions3d.<strong>check_temperature_conservation</strong><span class="classifier">Bool</span></dt><dd><p>Compute total temperature mass at every export</p>
<blockquote>
<div><p>Prints deviation from the initial mass to stdout.</p>
</div></blockquote>
<p>Default:</p>
<p>False</p>
</dd>
<dt>ModelOptions3d.<strong>check_temperature_overshoot</strong><span class="classifier">Bool</span></dt><dd><p>Compute temperature overshoots at every export</p>
<blockquote>
<div><p>Prints overshoot values that exceed the initial range to stdout.</p>
</div></blockquote>
<p>Default:</p>
<p>False</p>
</dd>
<dt>ModelOptions3d.<strong>check_volume_conservation_3d</strong><span class="classifier">Bool</span></dt><dd><p>Compute volume of the 3D domain at every export</p>
<blockquote>
<div><p>Prints deviation from the initial volume to stdout.</p>
</div></blockquote>
<p>Default:</p>
<p>False</p>
</dd>
<dt>ModelOptions3d.<strong>constant_salinity</strong><span class="classifier">FiredrakeConstantTraitlet</span></dt><dd><p>Constant salinity if salinity is not solved</p>
<p>Default:</p>
<p>Constant(0.0)</p>
</dd>
<dt>ModelOptions3d.<strong>constant_temperature</strong><span class="classifier">FiredrakeConstantTraitlet</span></dt><dd><p>Constant temperature if temperature is not solved</p>
<p>Default:</p>
<p>Constant(10.0)</p>
</dd>
<dt>ModelOptions3d.<strong>equation_of_state_type</strong><span class="classifier">‘full’|’linear’</span></dt><dd><p>Type of equation of state</p>
<p>Default:</p>
<p>‘full’</p>
<p>Setting value implies configuration of sub-tree ModelOptions3d.equation_of_state_options:</p>
<p>‘full’:</p>
<p>‘linear’:</p>
<blockquote>
<div><dl>
<dt>ModelOptions3d.equation_of_state_options.<strong>alpha</strong><span class="classifier">Float</span></dt><dd><p>Thermal expansion coefficient of ocean water</p>
<p>Default:</p>
<p>0.2</p>
</dd>
<dt>ModelOptions3d.equation_of_state_options.<strong>beta</strong><span class="classifier">Float</span></dt><dd><p>Saline contraction coefficient of ocean water</p>
<p>Default:</p>
<p>0.77</p>
</dd>
<dt>ModelOptions3d.equation_of_state_options.<strong>rho_ref</strong><span class="classifier">NonNegativeFloat</span></dt><dd><p>Reference water density</p>
<p>Default:</p>
<p>1000.0</p>
</dd>
<dt>ModelOptions3d.equation_of_state_options.<strong>s_ref</strong><span class="classifier">NonNegativeFloat</span></dt><dd><p>Reference water salinity</p>
<p>Default:</p>
<p>35.0</p>
</dd>
<dt>ModelOptions3d.equation_of_state_options.<strong>th_ref</strong><span class="classifier">Float</span></dt><dd><p>Reference water temperature</p>
<p>Default:</p>
<p>15.0</p>
</dd>
</dl>
</div></blockquote>
</dd>
<dt>ModelOptions3d.<strong>horizontal_diffusivity</strong><span class="classifier">FiredrakeScalarExpression</span></dt><dd><p>Horizontal diffusivity for tracers</p>
<p>Default:</p>
<p>UFL scalar expression</p>
</dd>
<dt>ModelOptions3d.<strong>internal_pg_scalar</strong><span class="classifier">FiredrakeConstantTraitlet</span></dt><dd><p>A constant to scale the internal pressure gradient. Used to ramp up the model.</p>
<p>Default:</p>
<p>None</p>
</dd>
<dt>ModelOptions3d.<strong>momentum_source_3d</strong><span class="classifier">FiredrakeVectorExpression</span></dt><dd><p>Source term for 3D momentum equation</p>
<p>Default:</p>
<p>UFL vector expression</p>
</dd>
<dt>ModelOptions3d.<strong>salinity_source_3d</strong><span class="classifier">FiredrakeScalarExpression</span></dt><dd><p>Source term for salinity equation</p>
<p>Default:</p>
<p>UFL scalar expression</p>
</dd>
<dt>ModelOptions3d.<strong>sipg_factor_turb</strong><span class="classifier">FiredrakeScalarExpression</span></dt><dd><p>Penalty parameter scaling factor for horizontal diffusivity terms of the turbulence model.</p>
<p>Default:</p>
<p>Constant(1.0)</p>
</dd>
<dt>ModelOptions3d.<strong>sipg_factor_vertical</strong><span class="classifier">FiredrakeScalarExpression</span></dt><dd><p>Penalty parameter scaling factor for vertical viscosity terms.</p>
<p>Default:</p>
<p>Constant(1.0)</p>
</dd>
<dt>ModelOptions3d.<strong>sipg_factor_vertical_tracer</strong><span class="classifier">FiredrakeScalarExpression</span></dt><dd><p>Penalty parameter scaling factor for vertical diffusivity terms.</p>
<p>Default:</p>
<p>Constant(1.0)</p>
</dd>
<dt>ModelOptions3d.<strong>sipg_factor_vertical_turb</strong><span class="classifier">FiredrakeScalarExpression</span></dt><dd><p>Penalty parameter scaling factor for vertical diffusivity terms of the turbulence model.</p>
<p>Default:</p>
<p>Constant(1.0)</p>
</dd>
<dt>ModelOptions3d.<strong>smagorinsky_coefficient</strong><span class="classifier">FiredrakeConstantTraitlet</span></dt><dd><p>Smagorinsky viscosity coefficient <span class="math notranslate nohighlight">\(C_S\)</span></p>
<blockquote>
<div><p>See <a class="reference internal" href="thetis.html#thetis.utility3d.SmagorinskyViscosity" title="thetis.utility3d.SmagorinskyViscosity"><code class="xref py py-class docutils literal notranslate"><span class="pre">SmagorinskyViscosity</span></code></a>.</p>
</div></blockquote>
<p>Default:</p>
<p>Constant(0.1)</p>
</dd>
<dt>ModelOptions3d.<strong>solve_salinity</strong><span class="classifier">Bool</span></dt><dd><p>Solve salinity transport</p>
<p>Default:</p>
<p>True</p>
</dd>
<dt>ModelOptions3d.<strong>solve_temperature</strong><span class="classifier">Bool</span></dt><dd><p>Solve temperature transport</p>
<p>Default:</p>
<p>True</p>
</dd>
<dt>ModelOptions3d.<strong>temperature_source_3d</strong><span class="classifier">FiredrakeScalarExpression</span></dt><dd><p>Source term for temperature equation</p>
<p>Default:</p>
<p>UFL scalar expression</p>
</dd>
<dt>ModelOptions3d.<strong>timestep_2d</strong><span class="classifier">PositiveFloat</span></dt><dd><p>Time step of the 2d mode</p>
<blockquote>
<div><p>This option is only used in the 3d solver, if 2d mode is solved
explicitly.</p>
</div></blockquote>
<p>Default:</p>
<p>10.0</p>
</dd>
<dt>ModelOptions3d.<strong>timestepper_type</strong><span class="classifier">‘LeapFrog’|’SSPRK22’</span></dt><dd><p>Name of the 3D time integrator</p>
<p>Default:</p>
<p>‘SSPRK22’</p>
<p>Setting value implies configuration of sub-tree ModelOptions3d.timestepper_options:</p>
<p>‘LeapFrog’:</p>
<p>‘SSPRK22’:</p>
<blockquote>
<div><dl>
<dt>ModelOptions3d.timestepper_options.<strong>use_automatic_timestep</strong><span class="classifier">Bool</span></dt><dd><p>Set time step automatically based on local CFL conditions.</p>
<p>Default:</p>
<p>True</p>
</dd>
</dl>
</div></blockquote>
</dd>
<dt>ModelOptions3d.<strong>turbulence_model_type</strong><span class="classifier">‘gls’|’pacanowski’</span></dt><dd><p>Type of vertical turbulence model</p>
<p>Default:</p>
<p>‘gls’</p>
<p>Setting value implies configuration of sub-tree ModelOptions3d.turbulence_model_options:</p>
<p>‘gls’:</p>
<blockquote>
<div><dl>
<dt>ModelOptions3d.turbulence_model_options.<strong>c1</strong><span class="classifier">Float</span></dt><dd><p>float: c1 parameter for Psi equations</p>
<p>Default:</p>
<p>1.44</p>
</dd>
<dt>ModelOptions3d.turbulence_model_options.<strong>c2</strong><span class="classifier">Float</span></dt><dd><p>float: c2 parameter for Psi equations</p>
<p>Default:</p>
<p>1.92</p>
</dd>
<dt>ModelOptions3d.turbulence_model_options.<strong>c3_minus</strong><span class="classifier">Float</span></dt><dd><p>float: c3 parameter for Psi equations, stable stratification</p>
<blockquote>
<div><p>If <code class="xref py py-attr docutils literal notranslate"><span class="pre">compute_c3_minus</span></code> is True this value will be overriden</p>
</div></blockquote>
<p>Default:</p>
<p>-0.52</p>
</dd>
<dt>ModelOptions3d.turbulence_model_options.<strong>c3_plus</strong><span class="classifier">Float</span></dt><dd><p>float: c3 parameter for Psi equations, unstable stratification</p>
<p>Default:</p>
<p>1.0</p>
</dd>
<dt>ModelOptions3d.turbulence_model_options.<strong>closure_name</strong><span class="classifier">‘k-epsilon’|’k-omega’|’Generic Length Scale’</span></dt><dd><p>Name of two-equation closure</p>
<p>Default:</p>
<p>‘k-epsilon’</p>
</dd>
<dt>ModelOptions3d.turbulence_model_options.<strong>cmu0</strong><span class="classifier">PositiveFloat</span></dt><dd><p>float: cmu0 parameter</p>
<p>Default:</p>
<p>0.5477</p>
</dd>
<dt>ModelOptions3d.turbulence_model_options.<strong>compute_c3_minus</strong><span class="classifier">Bool</span></dt><dd><p>bool: compute <code class="xref py py-attr docutils literal notranslate"><span class="pre">c3_minus</span></code> from <code class="xref py py-attr docutils literal notranslate"><span class="pre">ri_st</span></code></p>
<p>Default:</p>
<p>True</p>
</dd>
<dt>ModelOptions3d.turbulence_model_options.<strong>compute_cmu0</strong><span class="classifier">Bool</span></dt><dd><p>bool: compute cmu0 from stability function parameters</p>
<blockquote>
<div><p>If <code class="xref py py-attr docutils literal notranslate"><span class="pre">compute_cmu0</span></code> is True, this value will be overriden</p>
</div></blockquote>
<p>Default:</p>
<p>True</p>
</dd>
<dt>ModelOptions3d.turbulence_model_options.<strong>compute_galperin_clim</strong><span class="classifier">Bool</span></dt><dd><p>bool: compute c_lim length scale limiting factor</p>
<p>Default:</p>
<p>True</p>
</dd>
<dt>ModelOptions3d.turbulence_model_options.<strong>compute_kappa</strong><span class="classifier">Bool</span></dt><dd><p>bool: compute von Karman constant from <code class="xref py py-attr docutils literal notranslate"><span class="pre">schmidt_nb_psi</span></code></p>
<p>Default:</p>
<p>False</p>
</dd>
<dt>ModelOptions3d.turbulence_model_options.<strong>compute_len_min</strong><span class="classifier">Bool</span></dt><dd><p>bool: compute min_len from k_min and psi_min</p>
<p>Default:</p>
<p>False</p>
</dd>
<dt>ModelOptions3d.turbulence_model_options.<strong>compute_psi_min</strong><span class="classifier">Bool</span></dt><dd><p>bool: compute psi_len from k_min and eps_min</p>
<p>Default:</p>
<p>False</p>
</dd>
<dt>ModelOptions3d.turbulence_model_options.<strong>compute_schmidt_nb_psi</strong><span class="classifier">Bool</span></dt><dd><p>bool: compute psi Schmidt number</p>
<p>Default:</p>
<p>True</p>
</dd>
<dt>ModelOptions3d.turbulence_model_options.<strong>diff_min</strong><span class="classifier">PositiveFloat</span></dt><dd><p>float: minimum value for eddy diffusivity</p>
<p>Default:</p>
<p>1e-08</p>
</dd>
<dt>ModelOptions3d.turbulence_model_options.<strong>eps_min</strong><span class="classifier">PositiveFloat</span></dt><dd><p>float: minimum value for epsilon</p>
<p>Default:</p>
<p>1e-14</p>
</dd>
<dt>ModelOptions3d.turbulence_model_options.<strong>f_wall</strong><span class="classifier">Float</span></dt><dd><p>float: wall function parameter</p>
<p>Default:</p>
<p>1.0</p>
</dd>
<dt>ModelOptions3d.turbulence_model_options.<strong>galperin_clim</strong><span class="classifier">PositiveFloat</span></dt><dd><p>float: Galperin length scale limitation parameter</p>
<p>Default:</p>
<p>0.3</p>
</dd>
<dt>ModelOptions3d.turbulence_model_options.<strong>k_min</strong><span class="classifier">PositiveFloat</span></dt><dd><p>float: minimum value for turbulent kinetic energy</p>
<p>Default:</p>
<p>1e-06</p>
</dd>
<dt>ModelOptions3d.turbulence_model_options.<strong>kappa</strong><span class="classifier">Float</span></dt><dd><p>float: von Karman constant</p>
<blockquote>
<div><p>If <code class="xref py py-attr docutils literal notranslate"><span class="pre">compute_kappa</span></code> is True this value will be overriden</p>
</div></blockquote>
<p>Default:</p>
<p>0.4</p>
</dd>
<dt>ModelOptions3d.turbulence_model_options.<strong>len_min</strong><span class="classifier">PositiveFloat</span></dt><dd><p>float: minimum value for turbulent length scale</p>
<p>Default:</p>
<p>1e-12</p>
</dd>
<dt>ModelOptions3d.turbulence_model_options.<strong>limit_eps</strong><span class="classifier">Bool</span></dt><dd><p>bool: apply Galperin length scale limit on epsilon</p>
<p>Default:</p>
<p>False</p>
</dd>
<dt>ModelOptions3d.turbulence_model_options.<strong>limit_len</strong><span class="classifier">Bool</span></dt><dd><p>bool: apply Galperin length scale limit</p>
<p>Default:</p>
<p>False</p>
</dd>
<dt>ModelOptions3d.turbulence_model_options.<strong>limit_len_min</strong><span class="classifier">Bool</span></dt><dd><p>bool: limit minimum turbulent length scale to len_min</p>
<p>Default:</p>
<p>True</p>
</dd>
<dt>ModelOptions3d.turbulence_model_options.<strong>limit_psi</strong><span class="classifier">Bool</span></dt><dd><p>bool: apply Galperin length scale limit on psi</p>
<p>Default:</p>
<p>True</p>
</dd>
<dt>ModelOptions3d.turbulence_model_options.<strong>m</strong><span class="classifier">Float</span></dt><dd><p>float: parameter m for the definition of psi</p>
<p>Default:</p>
<p>1.5</p>
</dd>
<dt>ModelOptions3d.turbulence_model_options.<strong>n</strong><span class="classifier">Float</span></dt><dd><p>float: parameter n for the definition of psi</p>
<p>Default:</p>
<p>-1.0</p>
</dd>
<dt>ModelOptions3d.turbulence_model_options.<strong>p</strong><span class="classifier">Float</span></dt><dd><p>float: parameter p for the definition of psi</p>
<p>Default:</p>
<p>3.0</p>
</dd>
<dt>ModelOptions3d.turbulence_model_options.<strong>psi_min</strong><span class="classifier">PositiveFloat</span></dt><dd><p>float: minimum value for psi</p>
<p>Default:</p>
<p>1e-14</p>
</dd>
<dt>ModelOptions3d.turbulence_model_options.<strong>ri_st</strong><span class="classifier">Float</span></dt><dd><p>steady state gradient Richardson number</p>
<p>Default:</p>
<p>0.25</p>
</dd>
<dt>ModelOptions3d.turbulence_model_options.<strong>schmidt_nb_psi</strong><span class="classifier">PositiveFloat</span></dt><dd><p>float: psi Schmidt number</p>
<p>Default:</p>
<p>1.3</p>
</dd>
<dt>ModelOptions3d.turbulence_model_options.<strong>schmidt_nb_tke</strong><span class="classifier">PositiveFloat</span></dt><dd><p>float: turbulent kinetic energy Schmidt number</p>
<p>Default:</p>
<p>1.0</p>
</dd>
<dt>ModelOptions3d.turbulence_model_options.<strong>stability_function_name</strong><span class="classifier">‘Canuto A’|’Canuto B’|’Kantha-Clayson’|’Cheng’</span></dt><dd><p>Name of stability function family</p>
<p>Default:</p>
<p>‘Canuto A’</p>
</dd>
<dt>ModelOptions3d.turbulence_model_options.<strong>visc_min</strong><span class="classifier">PositiveFloat</span></dt><dd><p>float: minimum value for eddy viscosity</p>
<p>Default:</p>
<p>1e-08</p>
</dd>
</dl>
</div></blockquote>
<p>‘pacanowski’:</p>
<blockquote>
<div><dl>
<dt>ModelOptions3d.turbulence_model_options.<strong>alpha</strong><span class="classifier">PositiveFloat</span></dt><dd><p>float: Richardson number multiplier</p>
<p>Default:</p>
<p>10.0</p>
</dd>
<dt>ModelOptions3d.turbulence_model_options.<strong>exponent</strong><span class="classifier">PositiveFloat</span></dt><dd><p>float: Exponent of viscosity numerator <span class="math notranslate nohighlight">\(n\)</span></p>
<p>Default:</p>
<p>2.0</p>
</dd>
<dt>ModelOptions3d.turbulence_model_options.<strong>max_viscosity</strong><span class="classifier">PositiveFloat</span></dt><dd><p>float: Constant maximum viscosity <span class="math notranslate nohighlight">\(\nu_{max}\)</span></p>
<p>Default:</p>
<p>0.05</p>
</dd>
</dl>
</div></blockquote>
</dd>
<dt>ModelOptions3d.<strong>use_ale_moving_mesh</strong><span class="classifier">Bool</span></dt><dd><p>Use ALE formulation where 3D mesh tracks free surface</p>
<p>Default:</p>
<p>True</p>
</dd>
<dt>ModelOptions3d.<strong>use_baroclinic_formulation</strong><span class="classifier">Bool</span></dt><dd><p>Compute internal pressure gradient in momentum equation</p>
<p>Default:</p>
<p>False</p>
</dd>
<dt>ModelOptions3d.<strong>use_bottom_friction</strong><span class="classifier">Bool</span></dt><dd><p>Apply log layer bottom stress in the 3D model</p>
<p>Default:</p>
<p>True</p>
</dd>
<dt>ModelOptions3d.<strong>use_implicit_vertical_diffusion</strong><span class="classifier">Bool</span></dt><dd><p>Solve vertical diffusion and viscosity implicitly</p>
<p>Default:</p>
<p>True</p>
</dd>
<dt>ModelOptions3d.<strong>use_limiter_for_velocity</strong><span class="classifier">Bool</span></dt><dd><p>Apply P1DG limiter for 3D horizontal velocity field</p>
<p>Default:</p>
<p>True</p>
</dd>
<dt>ModelOptions3d.<strong>use_quadratic_density</strong><span class="classifier">Bool</span></dt><dd><p>Water density is projected to P2DGxP2 space.</p>
<blockquote>
<div><p>This reduces pressure gradient errors associated with nonlinear
equation of state.
If False, density is computed point-wise in the tracer space.</p>
</div></blockquote>
<p>Default:</p>
<p>False</p>
</dd>
<dt>ModelOptions3d.<strong>use_quadratic_pressure</strong><span class="classifier">Bool</span></dt><dd><p>Use P2DGxP2 space for baroclinic head.</p>
<blockquote>
<div><p>If element_family=’dg-dg’, P2DGxP1DG space is also used for the internal
pressure gradient.</p>
<p>This is useful to alleviate bathymetry-induced pressure gradient errors.
If False, the baroclinic head is in the tracer space, and internal
pressure gradient is in the velocity space.</p>
</div></blockquote>
<p>Default:</p>
<p>False</p>
</dd>
<dt>ModelOptions3d.<strong>use_smagorinsky_viscosity</strong><span class="classifier">Bool</span></dt><dd><p>Use Smagorinsky horisontal viscosity parametrization</p>
<p>Default:</p>
<p>False</p>
</dd>
<dt>ModelOptions3d.<strong>use_turbulence</strong><span class="classifier">Bool</span></dt><dd><p>Activate turbulence model in the 3D model</p>
<p>Default:</p>
<p>False</p>
</dd>
<dt>ModelOptions3d.<strong>use_turbulence_advection</strong><span class="classifier">Bool</span></dt><dd><p>Advect TKE and Psi in the GLS turbulence model</p>
<p>Default:</p>
<p>False</p>
</dd>
<dt>ModelOptions3d.<strong>vertical_diffusivity</strong><span class="classifier">FiredrakeScalarExpression</span></dt><dd><p>Vertical diffusivity for tracers</p>
<p>Default:</p>
<p>UFL scalar expression</p>
</dd>
<dt>ModelOptions3d.<strong>vertical_velocity_scale</strong><span class="classifier">FiredrakeConstantTraitlet</span></dt><dd><p>Maximum vertical velocity magnitude</p>
<blockquote>
<div><p>Used to compute max stable advection time step.</p>
</div></blockquote>
<p>Default:</p>
<p>Constant(0.0001)</p>
</dd>
<dt>ModelOptions3d.<strong>vertical_viscosity</strong><span class="classifier">FiredrakeScalarExpression</span></dt><dd><p>Vertical viscosity</p>
<p>Default:</p>
<p>UFL scalar expression</p>
</dd>
</dl>
</section>


            <div class="clearer"></div>
          </div>
        </div>
      </div>
    </div>
      <div class="clearer"></div>
    </div>
    <div class="footer" role="contentinfo">
    &#169; Copyright 2016-2025, Tuomas Kärnä et al..
      Created using <a href="https://www.sphinx-doc.org/">Sphinx</a> 8.1.3.
    </div>
  </body>
</html>