<!DOCTYPE html>

<html lang="en" data-content_root="./">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="viewport" content="width=device-width, initial-scale=1" />

    <title>thetis package &#8212; Thetis 0+untagged.2082.gf1a0bbb documentation</title>
    <link rel="stylesheet" type="text/css" href="_static/pygments.css?v=03e43079" />
    <link rel="stylesheet" type="text/css" href="_static/thetis.css?v=0f3339d6" />
    <script src="_static/documentation_options.js?v=ccd1159c"></script>
    <script src="_static/doctools.js?v=9bcbadda"></script>
    <script src="_static/sphinx_highlight.js?v=dc90522c"></script>
    <script async="async" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
<!--[if lte IE 6]>
<link rel="stylesheet" href="_static/ie6.css" type="text/css" media="screen" charset="utf-8" />
<![endif]-->

<!-- <link rel="stylesheet" href="_static/featured.css"> -->


<link rel="shortcut icon" href="_static/icon_thetis.ico" />


  </head><body>
<div class="wrapper">
  <a href="index.html"><img src="_static/banner.jpg" height="180px" alt="Thetis Project Banner" /></a>
  <div id="access">
    <div class="menu">
      <ul>
        <li class="page_item"><a href="documentation.html" title="Thetis documentation">Documentation</a></li>
        <li class="page_item"><a href="download.html" title="Install Thetis">Download</a></li>
        <li class="page_item"><a href="team.html" title="Development team">Team</a></li>
        <li class="page_item"><a href="publications.html" title="Publications">Publications</a></li>
        <li class="page_item"><a href="funding.html" title="Our financial supporters">Funding</a></li>
        <li class="page_item"><a href="contact.html" title="Getting in touch">Contact</a></li>
        <li class="page_item"><a href="https://github.com/thetisproject/thetis" title="Thetis source on GitHub">GitHub</a></li>
      </ul>
    </div><!-- .menu -->
  </div><!-- #access -->
</div><!-- #wrapper -->


    <div class="document">
    <div class="thetis">
      
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body" role="main">
            
  <section id="thetis-package">
<h1>thetis package<a class="headerlink" href="#thetis-package" title="Link to this heading">¶</a></h1>
<section id="submodules">
<h2>Submodules<a class="headerlink" href="#submodules" title="Link to this heading">¶</a></h2>
</section>
<section id="module-thetis.assembledschur">
<span id="thetis-assembledschur-module"></span><h2>thetis.assembledschur module<a class="headerlink" href="#module-thetis.assembledschur" title="Link to this heading">¶</a></h2>
<dl class="py class">
<dt class="sig sig-object py" id="thetis.assembledschur.AssembledSchurPC">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">thetis.assembledschur.</span></span><span class="sig-name descname"><span class="pre">AssembledSchurPC</span></span><a class="reference internal" href="_modules/thetis/assembledschur.html#AssembledSchurPC"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#thetis.assembledschur.AssembledSchurPC" title="Link to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference external" href="https://www.firedrakeproject.org/firedrake.preconditioners.html#firedrake.preconditioners.base.PCBase" title="(in Firedrake v0.12)"><code class="xref py py-class docutils literal notranslate"><span class="pre">PCBase</span></code></a></p>
<p>Preconditioner for the Schur complement</p>
<p>The preconditioner matrix is assembled by explicitly matrix multiplying
<span class="math notranslate nohighlight">\(A10*Minv*A10\)</span>.</p>
<p>Here:</p>
<ul class="simple">
<li><dl class="simple">
<dt><span class="math notranslate nohighlight">\(A01\)</span>, <span class="math notranslate nohighlight">\(A10\)</span> are the assembled sub-blocks of the saddle point</dt><dd><p>system. The form of this system needs to be supplied in the
<code class="code docutils literal notranslate"><span class="pre">appctx</span></code> argument to the solver as <code class="code docutils literal notranslate"><span class="pre">appctx['a']</span></code>.</p>
</dd>
</dl>
</li>
<li><dl class="simple">
<dt><span class="math notranslate nohighlight">\(Minv\)</span> is the inverse of the mass-matrix which is assembled as</dt><dd><p><code class="code docutils literal notranslate"><span class="pre">assemble(Tensor(v*u*dx).inv)</span></code>, i.e. the element-wise inverse,
where <span class="math notranslate nohighlight">\(v\)</span> and <span class="math notranslate nohighlight">\(u\)</span> are the test and trial of the <span class="math notranslate nohighlight">\(A00\)</span>
block. This gives the exact inverse of the mass matrix for a DG
discretisation.</p>
</dd>
</dl>
</li>
</ul>
<p>Create a PC context suitable for PETSc.</p>
<p>Matrix free preconditioners should inherit from this class and
implement:</p>
<ul class="simple">
<li><p><code class="xref py py-meth docutils literal notranslate"><span class="pre">initialize()</span></code></p></li>
<li><p><code class="xref py py-meth docutils literal notranslate"><span class="pre">update()</span></code></p></li>
<li><p><code class="xref py py-meth docutils literal notranslate"><span class="pre">apply()</span></code></p></li>
<li><p><code class="xref py py-meth docutils literal notranslate"><span class="pre">applyTranspose()</span></code></p></li>
</ul>
<dl class="py method">
<dt class="sig sig-object py" id="thetis.assembledschur.AssembledSchurPC.apply">
<span class="sig-name descname"><span class="pre">apply</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">pc</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">X</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">Y</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/assembledschur.html#AssembledSchurPC.apply"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#thetis.assembledschur.AssembledSchurPC.apply" title="Link to this definition">¶</a></dt>
<dd><p>Apply the preconditioner to X, putting the result in Y.</p>
<p>Both X and Y are PETSc Vecs, Y is not guaranteed to be zero on entry.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="thetis.assembledschur.AssembledSchurPC.applyTranspose">
<span class="sig-name descname"><span class="pre">applyTranspose</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">pc</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">X</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">Y</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/assembledschur.html#AssembledSchurPC.applyTranspose"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#thetis.assembledschur.AssembledSchurPC.applyTranspose" title="Link to this definition">¶</a></dt>
<dd><p>Apply the transpose of the preconditioner to X, putting the result in Y.</p>
<p>Both X and Y are PETSc Vecs, Y is not guaranteed to be zero on entry.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="thetis.assembledschur.AssembledSchurPC.initialize">
<span class="sig-name descname"><span class="pre">initialize</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">pc</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/assembledschur.html#AssembledSchurPC.initialize"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#thetis.assembledschur.AssembledSchurPC.initialize" title="Link to this definition">¶</a></dt>
<dd><p>Initialize any state in this preconditioner.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="thetis.assembledschur.AssembledSchurPC.update">
<span class="sig-name descname"><span class="pre">update</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">pc</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/assembledschur.html#AssembledSchurPC.update"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#thetis.assembledschur.AssembledSchurPC.update" title="Link to this definition">¶</a></dt>
<dd><p>Update any state in this preconditioner.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="thetis.assembledschur.AssembledSchurPC.view">
<span class="sig-name descname"><span class="pre">view</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">pc</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">viewer</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/assembledschur.html#AssembledSchurPC.view"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#thetis.assembledschur.AssembledSchurPC.view" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

</dd></dl>

</section>
<section id="module-thetis.callback">
<span id="thetis-callback-module"></span><h2>thetis.callback module<a class="headerlink" href="#module-thetis.callback" title="Link to this heading">¶</a></h2>
<p>Defines custom callback functions used to compute various metrics at runtime.</p>
<dl class="py class">
<dt class="sig sig-object py" id="thetis.callback.AccumulatorCallback">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">thetis.callback.</span></span><span class="sig-name descname"><span class="pre">AccumulatorCallback</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">scalar_callback</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">solver_obj</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/callback.html#AccumulatorCallback"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#thetis.callback.AccumulatorCallback" title="Link to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#thetis.callback.DiagnosticCallback" title="thetis.callback.DiagnosticCallback"><code class="xref py py-class docutils literal notranslate"><span class="pre">DiagnosticCallback</span></code></a></p>
<p>Callback that evaluates a (scalar) functional involving integrals in both
time and space.</p>
<p>This callback can also be used to assemble time dependent objective
functionals for adjoint simulations. Time integration is achieved using
the trapezium rule.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>scalar_callback</strong> – Python function that returns a list of values of an objective functional.</p></li>
<li><p><strong>solver_obj</strong> – Thetis solver object</p></li>
<li><p><strong>kwargs</strong> – any additional keyword arguments, see DiagnosticCallback</p></li>
</ul>
</dd>
</dl>
<dl class="py method">
<dt class="sig sig-object py" id="thetis.callback.AccumulatorCallback.get_val">
<span class="sig-name descname"><span class="pre">get_val</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/callback.html#AccumulatorCallback.get_val"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#thetis.callback.AccumulatorCallback.get_val" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="thetis.callback.AccumulatorCallback.message_str">
<span class="sig-name descname"><span class="pre">message_str</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/callback.html#AccumulatorCallback.message_str"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#thetis.callback.AccumulatorCallback.message_str" title="Link to this definition">¶</a></dt>
<dd><p>A string representation.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>args</strong> – If provided, these will be the return value from
<code class="xref py py-meth docutils literal notranslate"><span class="pre">__call__()</span></code>.</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="thetis.callback.AccumulatorCallback.variable_names">
<span class="sig-name descname"><span class="pre">variable_names</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">['spatial</span> <span class="pre">integral</span> <span class="pre">at</span> <span class="pre">current</span> <span class="pre">timestep']</span></em><a class="headerlink" href="#thetis.callback.AccumulatorCallback.variable_names" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="thetis.callback.CallbackManager">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">thetis.callback.</span></span><span class="sig-name descname"><span class="pre">CallbackManager</span></span><a class="reference internal" href="_modules/thetis/callback.html#CallbackManager"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#thetis.callback.CallbackManager" title="Link to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference external" href="https://docs.python.org/2.7/library/collections.html#collections.defaultdict" title="(in Python v2.7)"><code class="xref py py-class docutils literal notranslate"><span class="pre">defaultdict</span></code></a></p>
<p>Stores callbacks in different categories and provides methods for
evaluating them.</p>
<p>Create callbacks and register them under <code class="docutils literal notranslate"><span class="pre">'export'</span></code> mode</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">cb1</span> <span class="o">=</span> <span class="n">VolumeConservation3DCallback</span><span class="p">(</span><span class="o">...</span><span class="p">)</span>
<span class="n">cb2</span> <span class="o">=</span> <span class="n">TracerMassConservationCallback</span><span class="p">(</span><span class="o">...</span><span class="p">)</span>
<span class="n">cm</span> <span class="o">=</span> <span class="n">CallbackManager</span><span class="p">()</span>
<span class="n">cm</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">cb1</span><span class="p">,</span> <span class="s1">&#39;export&#39;</span><span class="p">)</span>
<span class="n">cm</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">cb2</span><span class="p">,</span> <span class="s1">&#39;export&#39;</span><span class="p">)</span>
</pre></div>
</div>
<p>Evaluate callbacks, calls <a class="reference internal" href="#thetis.callback.CallbackManager.evaluate" title="thetis.callback.CallbackManager.evaluate"><code class="xref py py-func docutils literal notranslate"><span class="pre">evaluate()</span></code></a> method of all callbacks
registered in the given mode.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">cm</span><span class="o">.</span><span class="n">evaluate</span><span class="p">(</span><span class="s1">&#39;export&#39;</span><span class="p">)</span>
</pre></div>
</div>
<dl class="py method">
<dt class="sig sig-object py" id="thetis.callback.CallbackManager.add">
<span class="sig-name descname"><span class="pre">add</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">callback</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mode</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/callback.html#CallbackManager.add"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#thetis.callback.CallbackManager.add" title="Link to this definition">¶</a></dt>
<dd><p>Add a callback under the given mode</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>callback</strong> – a <a class="reference internal" href="#thetis.callback.DiagnosticCallback" title="thetis.callback.DiagnosticCallback"><code class="xref py py-class docutils literal notranslate"><span class="pre">DiagnosticCallback</span></code></a> object</p></li>
<li><p><strong>mode</strong> (<a class="reference external" href="https://docs.python.org/2.7/library/functions.html#str" title="(in Python v2.7)"><em>str</em></a>) – register callback under this mode</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="thetis.callback.CallbackManager.evaluate">
<span class="sig-name descname"><span class="pre">evaluate</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">mode</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">index</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/callback.html#CallbackManager.evaluate"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#thetis.callback.CallbackManager.evaluate" title="Link to this definition">¶</a></dt>
<dd><p>Evaluate all callbacks registered under the given mode</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>mode</strong> (<a class="reference external" href="https://docs.python.org/2.7/library/functions.html#str" title="(in Python v2.7)"><em>str</em></a>) – evaluate all callbacks under this mode</p></li>
<li><p><strong>index</strong> (<a class="reference external" href="https://docs.python.org/2.7/library/functions.html#int" title="(in Python v2.7)"><em>int</em></a>) – if provided, sets the export index. Default behavior
is to append to the file or stream.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="thetis.callback.ConservativeTracerMassConservation2DCallback">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">thetis.callback.</span></span><span class="sig-name descname"><span class="pre">ConservativeTracerMassConservation2DCallback</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">tracer_name</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">solver_obj</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/callback.html#ConservativeTracerMassConservation2DCallback"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#thetis.callback.ConservativeTracerMassConservation2DCallback" title="Link to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#thetis.callback.ScalarConservationCallback" title="thetis.callback.ScalarConservationCallback"><code class="xref py py-class docutils literal notranslate"><span class="pre">ScalarConservationCallback</span></code></a></p>
<p>Checks conservation of conservative tracer mass which is depth integrated.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>tracer_name</strong> – Name of the tracer. Use canonical field names as in
<a class="reference internal" href="#thetis.utility.FieldDict" title="thetis.utility.FieldDict"><code class="xref py py-class docutils literal notranslate"><span class="pre">FieldDict</span></code></a>.</p></li>
<li><p><strong>solver_obj</strong> – Thetis solver object</p></li>
<li><p><strong>kwargs</strong> – any additional keyword arguments, see
<a class="reference internal" href="#thetis.callback.DiagnosticCallback" title="thetis.callback.DiagnosticCallback"><code class="xref py py-class docutils literal notranslate"><span class="pre">DiagnosticCallback</span></code></a>.</p></li>
</ul>
</dd>
</dl>
<dl class="py attribute">
<dt class="sig sig-object py" id="thetis.callback.ConservativeTracerMassConservation2DCallback.name">
<span class="sig-name descname"><span class="pre">name</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">'tracer</span> <span class="pre">mass'</span></em><a class="headerlink" href="#thetis.callback.ConservativeTracerMassConservation2DCallback.name" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="thetis.callback.DetectorsCallback">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">thetis.callback.</span></span><span class="sig-name descname"><span class="pre">DetectorsCallback</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">solver_obj</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">detector_locations</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">field_names</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">name</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">detector_names</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/callback.html#DetectorsCallback"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#thetis.callback.DetectorsCallback" title="Link to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#thetis.callback.DiagnosticCallback" title="thetis.callback.DiagnosticCallback"><code class="xref py py-class docutils literal notranslate"><span class="pre">DiagnosticCallback</span></code></a></p>
<p>Callback that evaluates the specified fields at the specified locations</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>solver_obj</strong> – Thetis solver object</p></li>
<li><p><strong>detector_locations</strong> – List of x, y locations in which fields are to
be interpolated.</p></li>
<li><p><strong>field_names</strong> – List of fields to be interpolated.</p></li>
<li><p><strong>name</strong> – Unique name for this callback and its associated set of
detectors. This determines the name of the output h5 file
(prefixed with <cite>diagnostic_</cite>).</p></li>
<li><p><strong>detector_names</strong> – List of names for each of the detectors. If not
provided automatic names of the form <cite>detectorNNN</cite> are created
where NNN is the (0-padded) detector number.</p></li>
<li><p><strong>kwargs</strong> – any additional keyword arguments, see
<a class="reference internal" href="#thetis.callback.DiagnosticCallback" title="thetis.callback.DiagnosticCallback"><code class="xref py py-class docutils literal notranslate"><span class="pre">DiagnosticCallback</span></code></a>.</p></li>
</ul>
</dd>
</dl>
<dl class="py method">
<dt class="sig sig-object py" id="thetis.callback.DetectorsCallback.message_str">
<span class="sig-name descname"><span class="pre">message_str</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/callback.html#DetectorsCallback.message_str"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#thetis.callback.DetectorsCallback.message_str" title="Link to this definition">¶</a></dt>
<dd><p>A string representation.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>args</strong> – If provided, these will be the return value from
<code class="xref py py-meth docutils literal notranslate"><span class="pre">__call__()</span></code>.</p>
</dd>
</dl>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="thetis.callback.DetectorsCallback.name">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">name</span></span><a class="headerlink" href="#thetis.callback.DetectorsCallback.name" title="Link to this definition">¶</a></dt>
<dd><p>The name of the diagnostic</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="thetis.callback.DetectorsCallback.variable_names">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">variable_names</span></span><a class="headerlink" href="#thetis.callback.DetectorsCallback.variable_names" title="Link to this definition">¶</a></dt>
<dd><p>Names of all scalar values</p>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="thetis.callback.DiagnosticCallback">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">thetis.callback.</span></span><span class="sig-name descname"><span class="pre">DiagnosticCallback</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">solver_obj</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">array_dim</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">attrs</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">outputdir</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">export_to_hdf5</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">append_to_log</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">include_time</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">hdf5_dtype</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'d'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">start_time</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">end_time</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/callback.html#DiagnosticCallback"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#thetis.callback.DiagnosticCallback" title="Link to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">ABC</span></code></p>
<p>A base class for all Callback classes</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>solver_obj</strong> – Thetis solver object</p></li>
<li><p><strong>outputdir</strong> (<a class="reference external" href="https://docs.python.org/2.7/library/functions.html#str" title="(in Python v2.7)"><em>str</em></a>) – Custom directory where hdf5 files will be stored.
By default solver’s output directory is used.</p></li>
<li><p><strong>array_dim</strong> – Dimension of the output array.
Can be a tuple for multi-dimensional output. Use “1” for scalars.</p></li>
<li><p><strong>attrs</strong> (<a class="reference external" href="https://docs.python.org/2.7/library/stdtypes.html#dict" title="(in Python v2.7)"><em>dict</em></a>) – Global attributes to be saved in the hdf5 file.</p></li>
<li><p><strong>export_to_hdf5</strong> (<a class="reference external" href="https://docs.python.org/2.7/library/functions.html#bool" title="(in Python v2.7)"><em>bool</em></a>) – If True, diagnostics will be stored in hdf5
format</p></li>
<li><p><strong>append_to_log</strong> (<a class="reference external" href="https://docs.python.org/2.7/library/functions.html#bool" title="(in Python v2.7)"><em>bool</em></a>) – If True, callback output messages will be
printed in log</p></li>
<li><p><strong>include_time</strong> (<a class="reference external" href="https://docs.python.org/2.7/library/functions.html#bool" title="(in Python v2.7)"><em>bool</em></a>) – whether to include time in the hdf5 file</p></li>
<li><p><strong>hdf5_dtype</strong> – Precision to use in hdf5 output: <cite>d</cite> for double
precision (default), and <cite>f</cite> for single precision</p></li>
<li><p><strong>start_time</strong> – Optional start time for callback evaluation</p></li>
<li><p><strong>end_time</strong> – Optional end time for callback evaluation</p></li>
</ul>
</dd>
</dl>
<dl class="py method">
<dt class="sig sig-object py" id="thetis.callback.DiagnosticCallback.evaluate">
<span class="sig-name descname"><span class="pre">evaluate</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">index</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/callback.html#DiagnosticCallback.evaluate"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#thetis.callback.DiagnosticCallback.evaluate" title="Link to this definition">¶</a></dt>
<dd><p>Evaluates callback and pushes values to log and hdf file (if enabled)</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="thetis.callback.DiagnosticCallback.message_str">
<em class="property"><span class="pre">abstract</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">message_str</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/callback.html#DiagnosticCallback.message_str"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#thetis.callback.DiagnosticCallback.message_str" title="Link to this definition">¶</a></dt>
<dd><p>A string representation.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>args</strong> – If provided, these will be the return value from
<code class="xref py py-meth docutils literal notranslate"><span class="pre">__call__()</span></code>.</p>
</dd>
</dl>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="thetis.callback.DiagnosticCallback.name">
<em class="property"><span class="pre">abstract</span><span class="w"> </span><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">name</span></span><a class="headerlink" href="#thetis.callback.DiagnosticCallback.name" title="Link to this definition">¶</a></dt>
<dd><p>The name of the diagnostic</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="thetis.callback.DiagnosticCallback.push_to_hdf5">
<span class="sig-name descname"><span class="pre">push_to_hdf5</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">time</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">args</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">index</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/callback.html#DiagnosticCallback.push_to_hdf5"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#thetis.callback.DiagnosticCallback.push_to_hdf5" title="Link to this definition">¶</a></dt>
<dd><p>Append values to HDF5 file.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>time</strong> – time stamp of entry</p></li>
<li><p><strong>args</strong> – the return value from <code class="xref py py-meth docutils literal notranslate"><span class="pre">__call__()</span></code>.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="thetis.callback.DiagnosticCallback.push_to_log">
<span class="sig-name descname"><span class="pre">push_to_log</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">time</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">args</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/callback.html#DiagnosticCallback.push_to_log"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#thetis.callback.DiagnosticCallback.push_to_log" title="Link to this definition">¶</a></dt>
<dd><p>Push callback status message to log</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>time</strong> – time stamp of entry</p></li>
<li><p><strong>args</strong> – the return value from <code class="xref py py-meth docutils literal notranslate"><span class="pre">__call__()</span></code>.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="thetis.callback.DiagnosticCallback.set_write_mode">
<span class="sig-name descname"><span class="pre">set_write_mode</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">mode</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/callback.html#DiagnosticCallback.set_write_mode"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#thetis.callback.DiagnosticCallback.set_write_mode" title="Link to this definition">¶</a></dt>
<dd><p>Define whether to create a new hdf5 file or append to an existing one</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>mode</strong> (<a class="reference external" href="https://docs.python.org/2.7/library/functions.html#str" title="(in Python v2.7)"><em>str</em></a>) – Either ‘create’ (default) or ‘append’</p>
</dd>
</dl>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="thetis.callback.DiagnosticCallback.variable_names">
<em class="property"><span class="pre">abstract</span><span class="w"> </span><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">variable_names</span></span><a class="headerlink" href="#thetis.callback.DiagnosticCallback.variable_names" title="Link to this definition">¶</a></dt>
<dd><p>Names of all scalar values</p>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="thetis.callback.DiagnosticHDF5">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">thetis.callback.</span></span><span class="sig-name descname"><span class="pre">DiagnosticHDF5</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">filename</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">varnames</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">array_dim=1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">attrs=None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">var_attrs=None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">comm=&lt;mpi4py.MPI.Intracomm</span> <span class="pre">object&gt;</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">new_file=True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dtype='d'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">include_time=True</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/callback.html#DiagnosticHDF5"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#thetis.callback.DiagnosticHDF5" title="Link to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference external" href="https://docs.python.org/2.7/library/functions.html#object" title="(in Python v2.7)"><code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></a></p>
<p>A HDF5 file for storing diagnostic time series arrays.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>filename</strong> (<a class="reference external" href="https://docs.python.org/2.7/library/functions.html#str" title="(in Python v2.7)"><em>str</em></a>) – Full filename of the HDF5 file.</p></li>
<li><p><strong>varnames</strong> – List of variable names that the diagnostic callback
provides</p></li>
<li><p><strong>array_dim</strong> – Dimension of the output array.
Can be a tuple for multi-dimensional output. Use “1” for scalars.</p></li>
<li><p><strong>attrs</strong> (<a class="reference external" href="https://docs.python.org/2.7/library/stdtypes.html#dict" title="(in Python v2.7)"><em>dict</em></a>) – Global attributes to be saved in the hdf5 file.</p></li>
<li><p><strong>var_attrs</strong> (<a class="reference external" href="https://docs.python.org/2.7/library/stdtypes.html#dict" title="(in Python v2.7)"><em>dict</em></a>) – nested dict of variable specific attributes,
e.g. {‘time’: {‘units’: ‘seconds since 1950-01-01’}}</p></li>
<li><p><strong>comm</strong> – MPI communicator</p></li>
<li><p><strong>new_file</strong> (<a class="reference external" href="https://docs.python.org/2.7/library/functions.html#bool" title="(in Python v2.7)"><em>bool</em></a>) – Define whether to create a new hdf5 file or
append to an existing one (if any)</p></li>
<li><p><strong>dtype</strong> – array datatype</p></li>
<li><p><strong>include_time</strong> – whether to include time array in the file</p></li>
</ul>
</dd>
</dl>
<dl class="py method">
<dt class="sig sig-object py" id="thetis.callback.DiagnosticHDF5.export">
<span class="sig-name descname"><span class="pre">export</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">variables</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">time</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">index</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/callback.html#DiagnosticHDF5.export"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#thetis.callback.DiagnosticHDF5.export" title="Link to this definition">¶</a></dt>
<dd><p>Appends a new entry of (time, variables) to the file.</p>
<p>The HDF5 is updated immediately.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>variables</strong> (<em>tuple</em><em> of </em><a class="reference external" href="https://docs.python.org/2.7/library/functions.html#float" title="(in Python v2.7)"><em>float</em></a>) – values of entry</p></li>
<li><p><strong>time</strong> (<a class="reference external" href="https://docs.python.org/2.7/library/functions.html#float" title="(in Python v2.7)"><em>float</em></a>) – time stamp of entry</p></li>
<li><p><strong>index</strong> (<a class="reference external" href="https://docs.python.org/2.7/library/functions.html#int" title="(in Python v2.7)"><em>int</em></a>) – If provided, defines the time index in the file</p></li>
</ul>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="thetis.callback.MinMaxConservationCallback">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">thetis.callback.</span></span><span class="sig-name descname"><span class="pre">MinMaxConservationCallback</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">minmax_callback</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">solver_obj</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/callback.html#MinMaxConservationCallback"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#thetis.callback.MinMaxConservationCallback" title="Link to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#thetis.callback.DiagnosticCallback" title="thetis.callback.DiagnosticCallback"><code class="xref py py-class docutils literal notranslate"><span class="pre">DiagnosticCallback</span></code></a></p>
<p>Base class for callbacks that check conservation of a minimum/maximum</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>minmax_callback</strong> – Python function that takes the solver object as
an argument and returns a (min, max) value tuple</p></li>
<li><p><strong>solver_obj</strong> – Thetis solver object</p></li>
<li><p><strong>kwargs</strong> – any additional keyword arguments, see
<a class="reference internal" href="#thetis.callback.DiagnosticCallback" title="thetis.callback.DiagnosticCallback"><code class="xref py py-class docutils literal notranslate"><span class="pre">DiagnosticCallback</span></code></a>.</p></li>
</ul>
</dd>
</dl>
<dl class="py method">
<dt class="sig sig-object py" id="thetis.callback.MinMaxConservationCallback.message_str">
<span class="sig-name descname"><span class="pre">message_str</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/callback.html#MinMaxConservationCallback.message_str"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#thetis.callback.MinMaxConservationCallback.message_str" title="Link to this definition">¶</a></dt>
<dd><p>A string representation.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>args</strong> – If provided, these will be the return value from
<code class="xref py py-meth docutils literal notranslate"><span class="pre">__call__()</span></code>.</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="thetis.callback.MinMaxConservationCallback.variable_names">
<span class="sig-name descname"><span class="pre">variable_names</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">['min_value',</span> <span class="pre">'max_value',</span> <span class="pre">'undershoot',</span> <span class="pre">'overshoot']</span></em><a class="headerlink" href="#thetis.callback.MinMaxConservationCallback.variable_names" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="thetis.callback.ScalarConservationCallback">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">thetis.callback.</span></span><span class="sig-name descname"><span class="pre">ScalarConservationCallback</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">scalar_callback</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">solver_obj</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/callback.html#ScalarConservationCallback"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#thetis.callback.ScalarConservationCallback" title="Link to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#thetis.callback.DiagnosticCallback" title="thetis.callback.DiagnosticCallback"><code class="xref py py-class docutils literal notranslate"><span class="pre">DiagnosticCallback</span></code></a></p>
<p>Base class for callbacks that check conservation of a scalar quantity</p>
<p>Creates scalar conservation check callback object</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>scalar_callback</strong> – Python function that takes the solver object as
an argument and returns a scalar quantity of interest</p></li>
<li><p><strong>solver_obj</strong> – Thetis solver object</p></li>
<li><p><strong>kwargs</strong> – any additional keyword arguments, see
<a class="reference internal" href="#thetis.callback.DiagnosticCallback" title="thetis.callback.DiagnosticCallback"><code class="xref py py-class docutils literal notranslate"><span class="pre">DiagnosticCallback</span></code></a>.</p></li>
</ul>
</dd>
</dl>
<dl class="py method">
<dt class="sig sig-object py" id="thetis.callback.ScalarConservationCallback.message_str">
<span class="sig-name descname"><span class="pre">message_str</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/callback.html#ScalarConservationCallback.message_str"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#thetis.callback.ScalarConservationCallback.message_str" title="Link to this definition">¶</a></dt>
<dd><p>A string representation.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>args</strong> – If provided, these will be the return value from
<code class="xref py py-meth docutils literal notranslate"><span class="pre">__call__()</span></code>.</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="thetis.callback.ScalarConservationCallback.variable_names">
<span class="sig-name descname"><span class="pre">variable_names</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">['integral',</span> <span class="pre">'relative_difference']</span></em><a class="headerlink" href="#thetis.callback.ScalarConservationCallback.variable_names" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="thetis.callback.TimeSeriesCallback2D">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">thetis.callback.</span></span><span class="sig-name descname"><span class="pre">TimeSeriesCallback2D</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">solver_obj</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fieldnames</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">x</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">location_name</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">z</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">outputdir</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">export_to_hdf5</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">append_to_log</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">tolerance</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.001</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">eval_func</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">start_time</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">end_time</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/callback.html#TimeSeriesCallback2D"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#thetis.callback.TimeSeriesCallback2D" title="Link to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#thetis.callback.DiagnosticCallback" title="thetis.callback.DiagnosticCallback"><code class="xref py py-class docutils literal notranslate"><span class="pre">DiagnosticCallback</span></code></a></p>
<p>Extract a time series of a 2D field at a given (x,y) location</p>
<p>Currently implemented only for the 3D model.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>solver_obj</strong> – Thetis <code class="xref py py-class docutils literal notranslate"><span class="pre">FlowSolver</span></code> object</p></li>
<li><p><strong>fieldnames</strong> – List of fields to extract</p></li>
<li><p><strong>y</strong> (<em>x</em><em>,</em>) – location coordinates in model coordinate system.</p></li>
<li><p><strong>location_name</strong> – Unique name for this location. This
determines the name of the output h5 file (prefixed with
<cite>diagnostic_</cite>).</p></li>
<li><p><strong>outputdir</strong> (<a class="reference external" href="https://docs.python.org/2.7/library/functions.html#str" title="(in Python v2.7)"><em>str</em></a>) – Custom directory where hdf5 files will be stored.
By default solver’s output directory is used.</p></li>
<li><p><strong>export_to_hdf5</strong> (<a class="reference external" href="https://docs.python.org/2.7/library/functions.html#bool" title="(in Python v2.7)"><em>bool</em></a>) – If True, diagnostics will be stored in hdf5
format</p></li>
<li><p><strong>append_to_log</strong> (<a class="reference external" href="https://docs.python.org/2.7/library/functions.html#bool" title="(in Python v2.7)"><em>bool</em></a>) – If True, callback output messages will be
printed in log</p></li>
<li><p><strong>start_time</strong> – Optional start time for timeseries extraction</p></li>
<li><p><strong>end_time</strong> – Optional end time for timeseries extraction</p></li>
</ul>
</dd>
</dl>
<dl class="py method">
<dt class="sig sig-object py" id="thetis.callback.TimeSeriesCallback2D.message_str">
<span class="sig-name descname"><span class="pre">message_str</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/callback.html#TimeSeriesCallback2D.message_str"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#thetis.callback.TimeSeriesCallback2D.message_str" title="Link to this definition">¶</a></dt>
<dd><p>A string representation.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>args</strong> – If provided, these will be the return value from
<code class="xref py py-meth docutils literal notranslate"><span class="pre">__call__()</span></code>.</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="thetis.callback.TimeSeriesCallback2D.name">
<span class="sig-name descname"><span class="pre">name</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">'timeseries'</span></em><a class="headerlink" href="#thetis.callback.TimeSeriesCallback2D.name" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="thetis.callback.TimeSeriesCallback2D.variable_names">
<span class="sig-name descname"><span class="pre">variable_names</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">['value']</span></em><a class="headerlink" href="#thetis.callback.TimeSeriesCallback2D.variable_names" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="thetis.callback.TimeSeriesCallback3D">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">thetis.callback.</span></span><span class="sig-name descname"><span class="pre">TimeSeriesCallback3D</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">solver_obj</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fieldnames</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">x</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">z</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">location_name</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">outputdir</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">export_to_hdf5</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">append_to_log</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">start_time</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">end_time</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/callback.html#TimeSeriesCallback3D"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#thetis.callback.TimeSeriesCallback3D" title="Link to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#thetis.callback.DiagnosticCallback" title="thetis.callback.DiagnosticCallback"><code class="xref py py-class docutils literal notranslate"><span class="pre">DiagnosticCallback</span></code></a></p>
<p>Extract a time series of a 3D field at a given (x,y,z) location</p>
<p>Currently implemented only for the 3D model.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>solver_obj</strong> – Thetis <code class="xref py py-class docutils literal notranslate"><span class="pre">FlowSolver</span></code> object</p></li>
<li><p><strong>fieldnames</strong> – List of fields to extract</p></li>
<li><p><strong>z</strong> (<em>x</em><em>, </em><em>y</em><em>,</em>) – location coordinates in model coordinate system.</p></li>
<li><p><strong>location_name</strong> – Unique name for this location. This
determines the name of the output h5 file (prefixed with
<cite>diagnostic_</cite>).</p></li>
<li><p><strong>outputdir</strong> (<a class="reference external" href="https://docs.python.org/2.7/library/functions.html#str" title="(in Python v2.7)"><em>str</em></a>) – Custom directory where hdf5 files will be stored.
By default solver’s output directory is used.</p></li>
<li><p><strong>export_to_hdf5</strong> (<a class="reference external" href="https://docs.python.org/2.7/library/functions.html#bool" title="(in Python v2.7)"><em>bool</em></a>) – If True, diagnostics will be stored in hdf5
format</p></li>
<li><p><strong>append_to_log</strong> (<a class="reference external" href="https://docs.python.org/2.7/library/functions.html#bool" title="(in Python v2.7)"><em>bool</em></a>) – If True, callback output messages will be
printed in log</p></li>
<li><p><strong>start_time</strong> – Optional start time for timeseries extraction</p></li>
<li><p><strong>end_time</strong> – Optional end time for timeseries extraction</p></li>
</ul>
</dd>
</dl>
<dl class="py method">
<dt class="sig sig-object py" id="thetis.callback.TimeSeriesCallback3D.message_str">
<span class="sig-name descname"><span class="pre">message_str</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/callback.html#TimeSeriesCallback3D.message_str"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#thetis.callback.TimeSeriesCallback3D.message_str" title="Link to this definition">¶</a></dt>
<dd><p>A string representation.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>args</strong> – If provided, these will be the return value from
<code class="xref py py-meth docutils literal notranslate"><span class="pre">__call__()</span></code>.</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="thetis.callback.TimeSeriesCallback3D.name">
<span class="sig-name descname"><span class="pre">name</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">'timeseries'</span></em><a class="headerlink" href="#thetis.callback.TimeSeriesCallback3D.name" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="thetis.callback.TimeSeriesCallback3D.variable_names">
<span class="sig-name descname"><span class="pre">variable_names</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">['value']</span></em><a class="headerlink" href="#thetis.callback.TimeSeriesCallback3D.variable_names" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="thetis.callback.TracerMassConservation2DCallback">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">thetis.callback.</span></span><span class="sig-name descname"><span class="pre">TracerMassConservation2DCallback</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">tracer_name</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">solver_obj</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/callback.html#TracerMassConservation2DCallback"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#thetis.callback.TracerMassConservation2DCallback" title="Link to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#thetis.callback.ScalarConservationCallback" title="thetis.callback.ScalarConservationCallback"><code class="xref py py-class docutils literal notranslate"><span class="pre">ScalarConservationCallback</span></code></a></p>
<p>Checks conservation of depth-averaged tracer mass</p>
<p>Depth-averaged tracer mass is defined as the integral of 2D tracer
multiplied by total depth.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>tracer_name</strong> – Name of the tracer. Use canonical field names as in
<a class="reference internal" href="#thetis.utility.FieldDict" title="thetis.utility.FieldDict"><code class="xref py py-class docutils literal notranslate"><span class="pre">FieldDict</span></code></a>.</p></li>
<li><p><strong>solver_obj</strong> – Thetis solver object</p></li>
<li><p><strong>kwargs</strong> – any additional keyword arguments, see
<a class="reference internal" href="#thetis.callback.DiagnosticCallback" title="thetis.callback.DiagnosticCallback"><code class="xref py py-class docutils literal notranslate"><span class="pre">DiagnosticCallback</span></code></a>.</p></li>
</ul>
</dd>
</dl>
<dl class="py attribute">
<dt class="sig sig-object py" id="thetis.callback.TracerMassConservation2DCallback.name">
<span class="sig-name descname"><span class="pre">name</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">'tracer</span> <span class="pre">mass'</span></em><a class="headerlink" href="#thetis.callback.TracerMassConservation2DCallback.name" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="thetis.callback.TracerMassConservationCallback">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">thetis.callback.</span></span><span class="sig-name descname"><span class="pre">TracerMassConservationCallback</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">tracer_name</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">solver_obj</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/callback.html#TracerMassConservationCallback"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#thetis.callback.TracerMassConservationCallback" title="Link to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#thetis.callback.ScalarConservationCallback" title="thetis.callback.ScalarConservationCallback"><code class="xref py py-class docutils literal notranslate"><span class="pre">ScalarConservationCallback</span></code></a></p>
<p>Checks conservation of total tracer mass</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>tracer_name</strong> – Name of the tracer. Use canonical field names as in
<a class="reference internal" href="#thetis.utility.FieldDict" title="thetis.utility.FieldDict"><code class="xref py py-class docutils literal notranslate"><span class="pre">FieldDict</span></code></a>.</p></li>
<li><p><strong>solver_obj</strong> – Thetis solver object</p></li>
<li><p><strong>kwargs</strong> – any additional keyword arguments, see
<a class="reference internal" href="#thetis.callback.DiagnosticCallback" title="thetis.callback.DiagnosticCallback"><code class="xref py py-class docutils literal notranslate"><span class="pre">DiagnosticCallback</span></code></a>.</p></li>
</ul>
</dd>
</dl>
<dl class="py attribute">
<dt class="sig sig-object py" id="thetis.callback.TracerMassConservationCallback.name">
<span class="sig-name descname"><span class="pre">name</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">'tracer</span> <span class="pre">mass'</span></em><a class="headerlink" href="#thetis.callback.TracerMassConservationCallback.name" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="thetis.callback.TracerOvershootCallBack">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">thetis.callback.</span></span><span class="sig-name descname"><span class="pre">TracerOvershootCallBack</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">tracer_name</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">solver_obj</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/callback.html#TracerOvershootCallBack"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#thetis.callback.TracerOvershootCallBack" title="Link to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#thetis.callback.MinMaxConservationCallback" title="thetis.callback.MinMaxConservationCallback"><code class="xref py py-class docutils literal notranslate"><span class="pre">MinMaxConservationCallback</span></code></a></p>
<p>Checks overshoots of the given tracer field.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>tracer_name</strong> – Name of the tracer. Use canonical field names as in
<a class="reference internal" href="#thetis.utility.FieldDict" title="thetis.utility.FieldDict"><code class="xref py py-class docutils literal notranslate"><span class="pre">FieldDict</span></code></a>.</p></li>
<li><p><strong>solver_obj</strong> – Thetis solver object</p></li>
<li><p><strong>kwargs</strong> – any additional keyword arguments, see
<a class="reference internal" href="#thetis.callback.DiagnosticCallback" title="thetis.callback.DiagnosticCallback"><code class="xref py py-class docutils literal notranslate"><span class="pre">DiagnosticCallback</span></code></a>.</p></li>
</ul>
</dd>
</dl>
<dl class="py attribute">
<dt class="sig sig-object py" id="thetis.callback.TracerOvershootCallBack.name">
<span class="sig-name descname"><span class="pre">name</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">'tracer</span> <span class="pre">overshoot'</span></em><a class="headerlink" href="#thetis.callback.TracerOvershootCallBack.name" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="thetis.callback.TransectCallback">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">thetis.callback.</span></span><span class="sig-name descname"><span class="pre">TransectCallback</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">solver_obj</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fieldnames</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">x</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">location_name</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n_points_z</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">48</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">z_min</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">z_max</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">outputdir</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">export_to_hdf5</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">append_to_log</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/callback.html#TransectCallback"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#thetis.callback.TransectCallback" title="Link to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#thetis.callback.DiagnosticCallback" title="thetis.callback.DiagnosticCallback"><code class="xref py py-class docutils literal notranslate"><span class="pre">DiagnosticCallback</span></code></a></p>
<p>Extract a vertical transect of a 3D field at a given (x,y) locations.</p>
<p>Only for the 3D model.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>solver_obj</strong> – Thetis <code class="xref py py-class docutils literal notranslate"><span class="pre">FlowSolver</span></code> object</p></li>
<li><p><strong>fieldnames</strong> – List of fields to extract</p></li>
<li><p><strong>y</strong> (<em>x</em><em>,</em>) – location coordinates in model coordinate system.</p></li>
<li><p><strong>location_name</strong> – Unique name for this location. This
determines the name of the output h5 file (prefixed with
<cite>diagnostic_</cite>).</p></li>
<li><p><strong>n_points_z</strong> (<a class="reference external" href="https://docs.python.org/2.7/library/functions.html#int" title="(in Python v2.7)"><em>int</em></a>) – Number of points along the vertical axis. The 3D
field will be interpolated on these points, ranging from the bottom
to the (time dependent) free surface.</p></li>
<li><p><strong>zmax</strong> (<em>float z_min</em><em>,</em>) – Force min/max value of z coordinate extent.
By default, transect will cover entire depth from bed to surface.</p></li>
<li><p><strong>outputdir</strong> (<a class="reference external" href="https://docs.python.org/2.7/library/functions.html#str" title="(in Python v2.7)"><em>str</em></a>) – Custom directory where hdf5 files will be stored.
By default solver’s output directory is used.</p></li>
<li><p><strong>export_to_hdf5</strong> (<a class="reference external" href="https://docs.python.org/2.7/library/functions.html#bool" title="(in Python v2.7)"><em>bool</em></a>) – If True, diagnostics will be stored in hdf5
format</p></li>
<li><p><strong>append_to_log</strong> (<a class="reference external" href="https://docs.python.org/2.7/library/functions.html#bool" title="(in Python v2.7)"><em>bool</em></a>) – If True, will print extracted min/max values
of each field to log</p></li>
</ul>
</dd>
</dl>
<dl class="py method">
<dt class="sig sig-object py" id="thetis.callback.TransectCallback.message_str">
<span class="sig-name descname"><span class="pre">message_str</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/callback.html#TransectCallback.message_str"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#thetis.callback.TransectCallback.message_str" title="Link to this definition">¶</a></dt>
<dd><p>A string representation.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>args</strong> – If provided, these will be the return value from
<code class="xref py py-meth docutils literal notranslate"><span class="pre">__call__()</span></code>.</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="thetis.callback.TransectCallback.name">
<span class="sig-name descname"><span class="pre">name</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">'transect'</span></em><a class="headerlink" href="#thetis.callback.TransectCallback.name" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="thetis.callback.TransectCallback.variable_names">
<span class="sig-name descname"><span class="pre">variable_names</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">['z_coord',</span> <span class="pre">'value']</span></em><a class="headerlink" href="#thetis.callback.TransectCallback.variable_names" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="thetis.callback.VerticalProfileCallback">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">thetis.callback.</span></span><span class="sig-name descname"><span class="pre">VerticalProfileCallback</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">solver_obj</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fieldnames</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">x</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">location_name</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">npoints</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">48</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">outputdir</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">export_to_hdf5</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">append_to_log</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/callback.html#VerticalProfileCallback"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#thetis.callback.VerticalProfileCallback" title="Link to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#thetis.callback.DiagnosticCallback" title="thetis.callback.DiagnosticCallback"><code class="xref py py-class docutils literal notranslate"><span class="pre">DiagnosticCallback</span></code></a></p>
<p>Extract a vertical profile of a 3D field at a given (x,y) location</p>
<p>Only for the 3D model.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>solver_obj</strong> – Thetis <code class="xref py py-class docutils literal notranslate"><span class="pre">FlowSolver</span></code> object</p></li>
<li><p><strong>fieldnames</strong> – List of fields to extract</p></li>
<li><p><strong>y</strong> (<em>x</em><em>,</em>) – location coordinates in model coordinate system.</p></li>
<li><p><strong>location_name</strong> – Unique name for this location. This
determines the name of the output h5 file (prefixed with
<cite>diagnostic_</cite>).</p></li>
<li><p><strong>npoints</strong> (<a class="reference external" href="https://docs.python.org/2.7/library/functions.html#int" title="(in Python v2.7)"><em>int</em></a>) – Number of points along the vertical axis. The 3D
field will be interpolated on these points, ranging from the bottom
to the (time dependent) free surface.</p></li>
<li><p><strong>outputdir</strong> (<a class="reference external" href="https://docs.python.org/2.7/library/functions.html#str" title="(in Python v2.7)"><em>str</em></a>) – Custom directory where hdf5 files will be stored.
By default solver’s output directory is used.</p></li>
<li><p><strong>export_to_hdf5</strong> (<a class="reference external" href="https://docs.python.org/2.7/library/functions.html#bool" title="(in Python v2.7)"><em>bool</em></a>) – If True, diagnostics will be stored in hdf5
format</p></li>
<li><p><strong>append_to_log</strong> (<a class="reference external" href="https://docs.python.org/2.7/library/functions.html#bool" title="(in Python v2.7)"><em>bool</em></a>) – If True, callback output messages will be
printed in log</p></li>
</ul>
</dd>
</dl>
<dl class="py method">
<dt class="sig sig-object py" id="thetis.callback.VerticalProfileCallback.message_str">
<span class="sig-name descname"><span class="pre">message_str</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/callback.html#VerticalProfileCallback.message_str"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#thetis.callback.VerticalProfileCallback.message_str" title="Link to this definition">¶</a></dt>
<dd><p>A string representation.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>args</strong> – If provided, these will be the return value from
<code class="xref py py-meth docutils literal notranslate"><span class="pre">__call__()</span></code>.</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="thetis.callback.VerticalProfileCallback.name">
<span class="sig-name descname"><span class="pre">name</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">'vertprofile'</span></em><a class="headerlink" href="#thetis.callback.VerticalProfileCallback.name" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="thetis.callback.VerticalProfileCallback.variable_names">
<span class="sig-name descname"><span class="pre">variable_names</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">['z_coord',</span> <span class="pre">'value']</span></em><a class="headerlink" href="#thetis.callback.VerticalProfileCallback.variable_names" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="thetis.callback.VolumeConservation2DCallback">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">thetis.callback.</span></span><span class="sig-name descname"><span class="pre">VolumeConservation2DCallback</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">solver_obj</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/callback.html#VolumeConservation2DCallback"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#thetis.callback.VolumeConservation2DCallback" title="Link to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#thetis.callback.ScalarConservationCallback" title="thetis.callback.ScalarConservationCallback"><code class="xref py py-class docutils literal notranslate"><span class="pre">ScalarConservationCallback</span></code></a></p>
<p>Checks conservation of 2D volume (integral of water elevation field)</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>solver_obj</strong> – Thetis solver object</p></li>
<li><p><strong>kwargs</strong> – any additional keyword arguments, see
<a class="reference internal" href="#thetis.callback.DiagnosticCallback" title="thetis.callback.DiagnosticCallback"><code class="xref py py-class docutils literal notranslate"><span class="pre">DiagnosticCallback</span></code></a>.</p></li>
</ul>
</dd>
</dl>
<dl class="py attribute">
<dt class="sig sig-object py" id="thetis.callback.VolumeConservation2DCallback.name">
<span class="sig-name descname"><span class="pre">name</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">'volume2d'</span></em><a class="headerlink" href="#thetis.callback.VolumeConservation2DCallback.name" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="thetis.callback.VolumeConservation3DCallback">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">thetis.callback.</span></span><span class="sig-name descname"><span class="pre">VolumeConservation3DCallback</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">solver_obj</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/callback.html#VolumeConservation3DCallback"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#thetis.callback.VolumeConservation3DCallback" title="Link to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#thetis.callback.ScalarConservationCallback" title="thetis.callback.ScalarConservationCallback"><code class="xref py py-class docutils literal notranslate"><span class="pre">ScalarConservationCallback</span></code></a></p>
<p>Checks conservation of 3D volume (volume of 3D mesh)</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>solver_obj</strong> – Thetis solver object</p></li>
<li><p><strong>kwargs</strong> – any additional keyword arguments, see
<a class="reference internal" href="#thetis.callback.DiagnosticCallback" title="thetis.callback.DiagnosticCallback"><code class="xref py py-class docutils literal notranslate"><span class="pre">DiagnosticCallback</span></code></a>.</p></li>
</ul>
</dd>
</dl>
<dl class="py attribute">
<dt class="sig sig-object py" id="thetis.callback.VolumeConservation3DCallback.name">
<span class="sig-name descname"><span class="pre">name</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">'volume3d'</span></em><a class="headerlink" href="#thetis.callback.VolumeConservation3DCallback.name" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

</dd></dl>

</section>
<section id="module-thetis.configuration">
<span id="thetis-configuration-module"></span><h2>thetis.configuration module<a class="headerlink" href="#module-thetis.configuration" title="Link to this heading">¶</a></h2>
<p>Utility function and extensions to traitlets used for specifying Thetis options</p>
<dl class="py class">
<dt class="sig sig-object py" id="thetis.configuration.ABCMetaHasTraits">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">thetis.configuration.</span></span><span class="sig-name descname"><span class="pre">ABCMetaHasTraits</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">name</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">bases</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">namespace</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">/</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/configuration.html#ABCMetaHasTraits"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#thetis.configuration.ABCMetaHasTraits" title="Link to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference external" href="https://docs.python.org/2.7/library/abc.html#abc.ABCMeta" title="(in Python v2.7)"><code class="xref py py-class docutils literal notranslate"><span class="pre">ABCMeta</span></code></a>, <code class="xref py py-class docutils literal notranslate"><span class="pre">MetaHasTraits</span></code></p>
<p>Combined metaclass of ABCMeta and MetaHasTraits</p>
<p>Finish initializing the HasDescriptors class.</p>
</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="thetis.configuration.BoundedFloat">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">thetis.configuration.</span></span><span class="sig-name descname"><span class="pre">BoundedFloat</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">default_value</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">traitlets.Undefined</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">bounds</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/configuration.html#BoundedFloat"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#thetis.configuration.BoundedFloat" title="Link to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">Float</span></code></p>
<p>Declare a traitlet.</p>
<p>If <em>allow_none</em> is True, None is a valid value in addition to any
values that are normally valid. The default is up to the subclass.
For most trait types, the default value for <code class="docutils literal notranslate"><span class="pre">allow_none</span></code> is False.</p>
<p>If <em>read_only</em> is True, attempts to directly modify a trait attribute raises a TraitError.</p>
<p>If <em>help</em> is a string, it documents the attribute’s purpose.</p>
<p>Extra metadata can be associated with the traitlet using the .tag() convenience method
or by using the traitlet instance’s .metadata dictionary.</p>
<dl class="py method">
<dt class="sig sig-object py" id="thetis.configuration.BoundedFloat.info">
<span class="sig-name descname"><span class="pre">info</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/configuration.html#BoundedFloat.info"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#thetis.configuration.BoundedFloat.info" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="thetis.configuration.BoundedFloat.validate">
<span class="sig-name descname"><span class="pre">validate</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">obj</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">proposal</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/configuration.html#BoundedFloat.validate"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#thetis.configuration.BoundedFloat.validate" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="thetis.configuration.BoundedInteger">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">thetis.configuration.</span></span><span class="sig-name descname"><span class="pre">BoundedInteger</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">default_value</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">traitlets.Undefined</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">bounds</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/configuration.html#BoundedInteger"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#thetis.configuration.BoundedInteger" title="Link to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">Int</span></code></p>
<p>Declare a traitlet.</p>
<p>If <em>allow_none</em> is True, None is a valid value in addition to any
values that are normally valid. The default is up to the subclass.
For most trait types, the default value for <code class="docutils literal notranslate"><span class="pre">allow_none</span></code> is False.</p>
<p>If <em>read_only</em> is True, attempts to directly modify a trait attribute raises a TraitError.</p>
<p>If <em>help</em> is a string, it documents the attribute’s purpose.</p>
<p>Extra metadata can be associated with the traitlet using the .tag() convenience method
or by using the traitlet instance’s .metadata dictionary.</p>
<dl class="py method">
<dt class="sig sig-object py" id="thetis.configuration.BoundedInteger.info">
<span class="sig-name descname"><span class="pre">info</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/configuration.html#BoundedInteger.info"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#thetis.configuration.BoundedInteger.info" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="thetis.configuration.BoundedInteger.validate">
<span class="sig-name descname"><span class="pre">validate</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">obj</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">proposal</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/configuration.html#BoundedInteger.validate"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#thetis.configuration.BoundedInteger.validate" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="thetis.configuration.DatetimeTraitlet">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">thetis.configuration.</span></span><span class="sig-name descname"><span class="pre">DatetimeTraitlet</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">default_value</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Any</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">traitlets.Undefined</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">allow_none</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/2.7/library/functions.html#bool" title="(in Python v2.7)"><span class="pre">bool</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">read_only</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/2.7/library/functions.html#bool" title="(in Python v2.7)"><span class="pre">bool</span></a><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/2.7/library/constants.html#None" title="(in Python v2.7)"><span class="pre">None</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">help</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/2.7/library/functions.html#str" title="(in Python v2.7)"><span class="pre">str</span></a><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/2.7/library/constants.html#None" title="(in Python v2.7)"><span class="pre">None</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">config</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Any</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Any</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/configuration.html#DatetimeTraitlet"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#thetis.configuration.DatetimeTraitlet" title="Link to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">TraitType</span></code></p>
<p>Declare a traitlet.</p>
<p>If <em>allow_none</em> is True, None is a valid value in addition to any
values that are normally valid. The default is up to the subclass.
For most trait types, the default value for <code class="docutils literal notranslate"><span class="pre">allow_none</span></code> is False.</p>
<p>If <em>read_only</em> is True, attempts to directly modify a trait attribute raises a TraitError.</p>
<p>If <em>help</em> is a string, it documents the attribute’s purpose.</p>
<p>Extra metadata can be associated with the traitlet using the .tag() convenience method
or by using the traitlet instance’s .metadata dictionary.</p>
<dl class="py attribute">
<dt class="sig sig-object py" id="thetis.configuration.DatetimeTraitlet.default_value">
<span class="sig-name descname"><span class="pre">default_value</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">t.Any</span></em><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">None</span></em><a class="headerlink" href="#thetis.configuration.DatetimeTraitlet.default_value" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="thetis.configuration.DatetimeTraitlet.info_text">
<span class="sig-name descname"><span class="pre">info_text</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/2.7/library/functions.html#str" title="(in Python v2.7)"><span class="pre">str</span></a></em><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">'a</span> <span class="pre">timezone-aware</span> <span class="pre">datetime</span> <span class="pre">object'</span></em><a class="headerlink" href="#thetis.configuration.DatetimeTraitlet.info_text" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="thetis.configuration.DatetimeTraitlet.validate">
<span class="sig-name descname"><span class="pre">validate</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">obj</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">value</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/configuration.html#DatetimeTraitlet.validate"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#thetis.configuration.DatetimeTraitlet.validate" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="thetis.configuration.FiredrakeCoefficient">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">thetis.configuration.</span></span><span class="sig-name descname"><span class="pre">FiredrakeCoefficient</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">default_value</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Any</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">traitlets.Undefined</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">allow_none</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/2.7/library/functions.html#bool" title="(in Python v2.7)"><span class="pre">bool</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">read_only</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/2.7/library/functions.html#bool" title="(in Python v2.7)"><span class="pre">bool</span></a><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/2.7/library/constants.html#None" title="(in Python v2.7)"><span class="pre">None</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">help</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/2.7/library/functions.html#str" title="(in Python v2.7)"><span class="pre">str</span></a><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/2.7/library/constants.html#None" title="(in Python v2.7)"><span class="pre">None</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">config</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Any</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Any</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/configuration.html#FiredrakeCoefficient"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#thetis.configuration.FiredrakeCoefficient" title="Link to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">TraitType</span></code></p>
<p>Declare a traitlet.</p>
<p>If <em>allow_none</em> is True, None is a valid value in addition to any
values that are normally valid. The default is up to the subclass.
For most trait types, the default value for <code class="docutils literal notranslate"><span class="pre">allow_none</span></code> is False.</p>
<p>If <em>read_only</em> is True, attempts to directly modify a trait attribute raises a TraitError.</p>
<p>If <em>help</em> is a string, it documents the attribute’s purpose.</p>
<p>Extra metadata can be associated with the traitlet using the .tag() convenience method
or by using the traitlet instance’s .metadata dictionary.</p>
<dl class="py attribute">
<dt class="sig sig-object py" id="thetis.configuration.FiredrakeCoefficient.default_value">
<span class="sig-name descname"><span class="pre">default_value</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">t.Any</span></em><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">None</span></em><a class="headerlink" href="#thetis.configuration.FiredrakeCoefficient.default_value" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="thetis.configuration.FiredrakeCoefficient.default_value_repr">
<span class="sig-name descname"><span class="pre">default_value_repr</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/configuration.html#FiredrakeCoefficient.default_value_repr"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#thetis.configuration.FiredrakeCoefficient.default_value_repr" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="thetis.configuration.FiredrakeCoefficient.info_text">
<span class="sig-name descname"><span class="pre">info_text</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/2.7/library/functions.html#str" title="(in Python v2.7)"><span class="pre">str</span></a></em><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">'a</span> <span class="pre">Firedrake</span> <span class="pre">Constant</span> <span class="pre">or</span> <span class="pre">Function'</span></em><a class="headerlink" href="#thetis.configuration.FiredrakeCoefficient.info_text" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="thetis.configuration.FiredrakeCoefficient.validate">
<span class="sig-name descname"><span class="pre">validate</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">obj</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">value</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/configuration.html#FiredrakeCoefficient.validate"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#thetis.configuration.FiredrakeCoefficient.validate" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="thetis.configuration.FiredrakeConstantTraitlet">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">thetis.configuration.</span></span><span class="sig-name descname"><span class="pre">FiredrakeConstantTraitlet</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">default_value</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Any</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">traitlets.Undefined</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">allow_none</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/2.7/library/functions.html#bool" title="(in Python v2.7)"><span class="pre">bool</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">read_only</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/2.7/library/functions.html#bool" title="(in Python v2.7)"><span class="pre">bool</span></a><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/2.7/library/constants.html#None" title="(in Python v2.7)"><span class="pre">None</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">help</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/2.7/library/functions.html#str" title="(in Python v2.7)"><span class="pre">str</span></a><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/2.7/library/constants.html#None" title="(in Python v2.7)"><span class="pre">None</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">config</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Any</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Any</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/configuration.html#FiredrakeConstantTraitlet"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#thetis.configuration.FiredrakeConstantTraitlet" title="Link to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">TraitType</span></code></p>
<p>Declare a traitlet.</p>
<p>If <em>allow_none</em> is True, None is a valid value in addition to any
values that are normally valid. The default is up to the subclass.
For most trait types, the default value for <code class="docutils literal notranslate"><span class="pre">allow_none</span></code> is False.</p>
<p>If <em>read_only</em> is True, attempts to directly modify a trait attribute raises a TraitError.</p>
<p>If <em>help</em> is a string, it documents the attribute’s purpose.</p>
<p>Extra metadata can be associated with the traitlet using the .tag() convenience method
or by using the traitlet instance’s .metadata dictionary.</p>
<dl class="py attribute">
<dt class="sig sig-object py" id="thetis.configuration.FiredrakeConstantTraitlet.default_value">
<span class="sig-name descname"><span class="pre">default_value</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">t.Any</span></em><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">None</span></em><a class="headerlink" href="#thetis.configuration.FiredrakeConstantTraitlet.default_value" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="thetis.configuration.FiredrakeConstantTraitlet.default_value_repr">
<span class="sig-name descname"><span class="pre">default_value_repr</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/configuration.html#FiredrakeConstantTraitlet.default_value_repr"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#thetis.configuration.FiredrakeConstantTraitlet.default_value_repr" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="thetis.configuration.FiredrakeConstantTraitlet.info_text">
<span class="sig-name descname"><span class="pre">info_text</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/2.7/library/functions.html#str" title="(in Python v2.7)"><span class="pre">str</span></a></em><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">'a</span> <span class="pre">Firedrake</span> <span class="pre">Constant'</span></em><a class="headerlink" href="#thetis.configuration.FiredrakeConstantTraitlet.info_text" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="thetis.configuration.FiredrakeConstantTraitlet.validate">
<span class="sig-name descname"><span class="pre">validate</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">obj</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">value</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/configuration.html#FiredrakeConstantTraitlet.validate"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#thetis.configuration.FiredrakeConstantTraitlet.validate" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="thetis.configuration.FiredrakeScalarExpression">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">thetis.configuration.</span></span><span class="sig-name descname"><span class="pre">FiredrakeScalarExpression</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">default_value</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Any</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">traitlets.Undefined</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">allow_none</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/2.7/library/functions.html#bool" title="(in Python v2.7)"><span class="pre">bool</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">read_only</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/2.7/library/functions.html#bool" title="(in Python v2.7)"><span class="pre">bool</span></a><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/2.7/library/constants.html#None" title="(in Python v2.7)"><span class="pre">None</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">help</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/2.7/library/functions.html#str" title="(in Python v2.7)"><span class="pre">str</span></a><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/2.7/library/constants.html#None" title="(in Python v2.7)"><span class="pre">None</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">config</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Any</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Any</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/configuration.html#FiredrakeScalarExpression"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#thetis.configuration.FiredrakeScalarExpression" title="Link to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">TraitType</span></code></p>
<p>Declare a traitlet.</p>
<p>If <em>allow_none</em> is True, None is a valid value in addition to any
values that are normally valid. The default is up to the subclass.
For most trait types, the default value for <code class="docutils literal notranslate"><span class="pre">allow_none</span></code> is False.</p>
<p>If <em>read_only</em> is True, attempts to directly modify a trait attribute raises a TraitError.</p>
<p>If <em>help</em> is a string, it documents the attribute’s purpose.</p>
<p>Extra metadata can be associated with the traitlet using the .tag() convenience method
or by using the traitlet instance’s .metadata dictionary.</p>
<dl class="py attribute">
<dt class="sig sig-object py" id="thetis.configuration.FiredrakeScalarExpression.default_value">
<span class="sig-name descname"><span class="pre">default_value</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">t.Any</span></em><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">None</span></em><a class="headerlink" href="#thetis.configuration.FiredrakeScalarExpression.default_value" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="thetis.configuration.FiredrakeScalarExpression.default_value_repr">
<span class="sig-name descname"><span class="pre">default_value_repr</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/configuration.html#FiredrakeScalarExpression.default_value_repr"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#thetis.configuration.FiredrakeScalarExpression.default_value_repr" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="thetis.configuration.FiredrakeScalarExpression.info_text">
<span class="sig-name descname"><span class="pre">info_text</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/2.7/library/functions.html#str" title="(in Python v2.7)"><span class="pre">str</span></a></em><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">'a</span> <span class="pre">scalar</span> <span class="pre">UFL</span> <span class="pre">expression'</span></em><a class="headerlink" href="#thetis.configuration.FiredrakeScalarExpression.info_text" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="thetis.configuration.FiredrakeScalarExpression.validate">
<span class="sig-name descname"><span class="pre">validate</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">obj</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">value</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/configuration.html#FiredrakeScalarExpression.validate"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#thetis.configuration.FiredrakeScalarExpression.validate" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="thetis.configuration.FiredrakeVectorExpression">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">thetis.configuration.</span></span><span class="sig-name descname"><span class="pre">FiredrakeVectorExpression</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">default_value</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Any</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">traitlets.Undefined</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">allow_none</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/2.7/library/functions.html#bool" title="(in Python v2.7)"><span class="pre">bool</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">read_only</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/2.7/library/functions.html#bool" title="(in Python v2.7)"><span class="pre">bool</span></a><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/2.7/library/constants.html#None" title="(in Python v2.7)"><span class="pre">None</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">help</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/2.7/library/functions.html#str" title="(in Python v2.7)"><span class="pre">str</span></a><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/2.7/library/constants.html#None" title="(in Python v2.7)"><span class="pre">None</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">config</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Any</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Any</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/configuration.html#FiredrakeVectorExpression"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#thetis.configuration.FiredrakeVectorExpression" title="Link to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">TraitType</span></code></p>
<p>Declare a traitlet.</p>
<p>If <em>allow_none</em> is True, None is a valid value in addition to any
values that are normally valid. The default is up to the subclass.
For most trait types, the default value for <code class="docutils literal notranslate"><span class="pre">allow_none</span></code> is False.</p>
<p>If <em>read_only</em> is True, attempts to directly modify a trait attribute raises a TraitError.</p>
<p>If <em>help</em> is a string, it documents the attribute’s purpose.</p>
<p>Extra metadata can be associated with the traitlet using the .tag() convenience method
or by using the traitlet instance’s .metadata dictionary.</p>
<dl class="py attribute">
<dt class="sig sig-object py" id="thetis.configuration.FiredrakeVectorExpression.default_value">
<span class="sig-name descname"><span class="pre">default_value</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">t.Any</span></em><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">None</span></em><a class="headerlink" href="#thetis.configuration.FiredrakeVectorExpression.default_value" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="thetis.configuration.FiredrakeVectorExpression.default_value_repr">
<span class="sig-name descname"><span class="pre">default_value_repr</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/configuration.html#FiredrakeVectorExpression.default_value_repr"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#thetis.configuration.FiredrakeVectorExpression.default_value_repr" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="thetis.configuration.FiredrakeVectorExpression.info_text">
<span class="sig-name descname"><span class="pre">info_text</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/2.7/library/functions.html#str" title="(in Python v2.7)"><span class="pre">str</span></a></em><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">'a</span> <span class="pre">vector</span> <span class="pre">UFL</span> <span class="pre">expression'</span></em><a class="headerlink" href="#thetis.configuration.FiredrakeVectorExpression.info_text" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="thetis.configuration.FiredrakeVectorExpression.validate">
<span class="sig-name descname"><span class="pre">validate</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">obj</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">value</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/configuration.html#FiredrakeVectorExpression.validate"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#thetis.configuration.FiredrakeVectorExpression.validate" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="thetis.configuration.FrozenConfigurable">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">thetis.configuration.</span></span><span class="sig-name descname"><span class="pre">FrozenConfigurable</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Any</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/configuration.html#FrozenConfigurable"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#thetis.configuration.FrozenConfigurable" title="Link to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#thetis.configuration.OptionsBase" title="thetis.configuration.OptionsBase"><code class="xref py py-class docutils literal notranslate"><span class="pre">OptionsBase</span></code></a>, <code class="xref py py-class docutils literal notranslate"><span class="pre">Configurable</span></code></p>
<p>A Configurable class that only allows adding new attributes in the class
definition or when  self._isfrozen is False.</p>
</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="thetis.configuration.FrozenHasTraits">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">thetis.configuration.</span></span><span class="sig-name descname"><span class="pre">FrozenHasTraits</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Any</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/configuration.html#FrozenHasTraits"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#thetis.configuration.FrozenHasTraits" title="Link to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#thetis.configuration.OptionsBase" title="thetis.configuration.OptionsBase"><code class="xref py py-class docutils literal notranslate"><span class="pre">OptionsBase</span></code></a>, <code class="xref py py-class docutils literal notranslate"><span class="pre">HasTraits</span></code></p>
</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="thetis.configuration.NonNegativeFloat">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">thetis.configuration.</span></span><span class="sig-name descname"><span class="pre">NonNegativeFloat</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">default_value</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/2.7/library/functions.html#float" title="(in Python v2.7)"><span class="pre">float</span></a><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">Sentinel</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">...</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">allow_none</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Literal</span><span class="p"><span class="pre">[</span></span><span class="k"><span class="pre">False</span></span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">...</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">read_only</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/2.7/library/functions.html#bool" title="(in Python v2.7)"><span class="pre">bool</span></a><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/2.7/library/constants.html#None" title="(in Python v2.7)"><span class="pre">None</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">...</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">help</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/2.7/library/functions.html#str" title="(in Python v2.7)"><span class="pre">str</span></a><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/2.7/library/constants.html#None" title="(in Python v2.7)"><span class="pre">None</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">...</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">config</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Any</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/2.7/library/constants.html#None" title="(in Python v2.7)"><span class="pre">None</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">...</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Any</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/configuration.html#NonNegativeFloat"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#thetis.configuration.NonNegativeFloat" title="Link to this definition">¶</a></dt>
<dt class="sig sig-object py">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">thetis.configuration.</span></span><span class="sig-name descname"><span class="pre">NonNegativeFloat</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">default_value</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/2.7/library/functions.html#float" title="(in Python v2.7)"><span class="pre">float</span></a><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">Sentinel</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/2.7/library/constants.html#None" title="(in Python v2.7)"><span class="pre">None</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">...</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">allow_none</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Literal</span><span class="p"><span class="pre">[</span></span><span class="k"><span class="pre">True</span></span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">...</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">read_only</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/2.7/library/functions.html#bool" title="(in Python v2.7)"><span class="pre">bool</span></a><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/2.7/library/constants.html#None" title="(in Python v2.7)"><span class="pre">None</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">...</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">help</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/2.7/library/functions.html#str" title="(in Python v2.7)"><span class="pre">str</span></a><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/2.7/library/constants.html#None" title="(in Python v2.7)"><span class="pre">None</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">...</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">config</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Any</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/2.7/library/constants.html#None" title="(in Python v2.7)"><span class="pre">None</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">...</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Any</span></span></em><span class="sig-paren">)</span></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">Float</span></code></p>
<p>Declare a traitlet.</p>
<p>If <em>allow_none</em> is True, None is a valid value in addition to any
values that are normally valid. The default is up to the subclass.
For most trait types, the default value for <code class="docutils literal notranslate"><span class="pre">allow_none</span></code> is False.</p>
<p>If <em>read_only</em> is True, attempts to directly modify a trait attribute raises a TraitError.</p>
<p>If <em>help</em> is a string, it documents the attribute’s purpose.</p>
<p>Extra metadata can be associated with the traitlet using the .tag() convenience method
or by using the traitlet instance’s .metadata dictionary.</p>
<dl class="py method">
<dt class="sig sig-object py" id="thetis.configuration.NonNegativeFloat.info">
<span class="sig-name descname"><span class="pre">info</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/configuration.html#NonNegativeFloat.info"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#thetis.configuration.NonNegativeFloat.info" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="thetis.configuration.NonNegativeFloat.validate">
<span class="sig-name descname"><span class="pre">validate</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">obj</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">proposal</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/configuration.html#NonNegativeFloat.validate"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#thetis.configuration.NonNegativeFloat.validate" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="thetis.configuration.NonNegativeInteger">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">thetis.configuration.</span></span><span class="sig-name descname"><span class="pre">NonNegativeInteger</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">default_value</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/2.7/library/functions.html#int" title="(in Python v2.7)"><span class="pre">int</span></a><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">Sentinel</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">...</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">allow_none</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Literal</span><span class="p"><span class="pre">[</span></span><span class="k"><span class="pre">False</span></span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">...</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">read_only</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/2.7/library/functions.html#bool" title="(in Python v2.7)"><span class="pre">bool</span></a><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/2.7/library/constants.html#None" title="(in Python v2.7)"><span class="pre">None</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">...</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">help</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/2.7/library/functions.html#str" title="(in Python v2.7)"><span class="pre">str</span></a><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/2.7/library/constants.html#None" title="(in Python v2.7)"><span class="pre">None</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">...</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">config</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Any</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/2.7/library/constants.html#None" title="(in Python v2.7)"><span class="pre">None</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">...</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Any</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/configuration.html#NonNegativeInteger"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#thetis.configuration.NonNegativeInteger" title="Link to this definition">¶</a></dt>
<dt class="sig sig-object py">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">thetis.configuration.</span></span><span class="sig-name descname"><span class="pre">NonNegativeInteger</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">default_value</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/2.7/library/functions.html#int" title="(in Python v2.7)"><span class="pre">int</span></a><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">Sentinel</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/2.7/library/constants.html#None" title="(in Python v2.7)"><span class="pre">None</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">...</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">allow_none</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Literal</span><span class="p"><span class="pre">[</span></span><span class="k"><span class="pre">True</span></span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">...</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">read_only</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/2.7/library/functions.html#bool" title="(in Python v2.7)"><span class="pre">bool</span></a><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/2.7/library/constants.html#None" title="(in Python v2.7)"><span class="pre">None</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">...</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">help</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/2.7/library/functions.html#str" title="(in Python v2.7)"><span class="pre">str</span></a><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/2.7/library/constants.html#None" title="(in Python v2.7)"><span class="pre">None</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">...</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">config</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Any</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/2.7/library/constants.html#None" title="(in Python v2.7)"><span class="pre">None</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">...</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Any</span></span></em><span class="sig-paren">)</span></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">Int</span></code></p>
<p>Declare a traitlet.</p>
<p>If <em>allow_none</em> is True, None is a valid value in addition to any
values that are normally valid. The default is up to the subclass.
For most trait types, the default value for <code class="docutils literal notranslate"><span class="pre">allow_none</span></code> is False.</p>
<p>If <em>read_only</em> is True, attempts to directly modify a trait attribute raises a TraitError.</p>
<p>If <em>help</em> is a string, it documents the attribute’s purpose.</p>
<p>Extra metadata can be associated with the traitlet using the .tag() convenience method
or by using the traitlet instance’s .metadata dictionary.</p>
<dl class="py method">
<dt class="sig sig-object py" id="thetis.configuration.NonNegativeInteger.info">
<span class="sig-name descname"><span class="pre">info</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/configuration.html#NonNegativeInteger.info"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#thetis.configuration.NonNegativeInteger.info" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="thetis.configuration.NonNegativeInteger.validate">
<span class="sig-name descname"><span class="pre">validate</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">obj</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">proposal</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/configuration.html#NonNegativeInteger.validate"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#thetis.configuration.NonNegativeInteger.validate" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="thetis.configuration.OptionsBase">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">thetis.configuration.</span></span><span class="sig-name descname"><span class="pre">OptionsBase</span></span><a class="reference internal" href="_modules/thetis/configuration.html#OptionsBase"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#thetis.configuration.OptionsBase" title="Link to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference external" href="https://docs.python.org/2.7/library/functions.html#object" title="(in Python v2.7)"><code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></a></p>
<p>Abstract base class for all options classes</p>
<dl class="py property">
<dt class="sig sig-object py" id="thetis.configuration.OptionsBase.name">
<em class="property"><span class="pre">abstract</span><span class="w"> </span><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">name</span></span><a class="headerlink" href="#thetis.configuration.OptionsBase.name" title="Link to this definition">¶</a></dt>
<dd><p>Human readable name of the configurable object</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="thetis.configuration.OptionsBase.update">
<span class="sig-name descname"><span class="pre">update</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">options</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/configuration.html#OptionsBase.update"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#thetis.configuration.OptionsBase.update" title="Link to this definition">¶</a></dt>
<dd><p>Assign options from another container</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>options</strong> – Either a dictionary of options or another
HasTraits object</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="thetis.configuration.PETScSolverParameters">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">thetis.configuration.</span></span><span class="sig-name descname"><span class="pre">PETScSolverParameters</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">value_trait</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">TraitType</span><span class="p"><span class="pre">[</span></span><span class="pre">t.Any</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">t.Any</span><span class="p"><span class="pre">]</span></span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/2.7/library/stdtypes.html#dict" title="(in Python v2.7)"><span class="pre">dict</span></a><span class="p"><span class="pre">[</span></span><span class="pre">K</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">V</span><span class="p"><span class="pre">]</span></span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">Sentinel</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/2.7/library/constants.html#None" title="(in Python v2.7)"><span class="pre">None</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">per_key_traits</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">t.Any</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">key_trait</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">TraitType</span><span class="p"><span class="pre">[</span></span><span class="pre">t.Any</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">t.Any</span><span class="p"><span class="pre">]</span></span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/2.7/library/constants.html#None" title="(in Python v2.7)"><span class="pre">None</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">default_value</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/2.7/library/stdtypes.html#dict" title="(in Python v2.7)"><span class="pre">dict</span></a><span class="p"><span class="pre">[</span></span><span class="pre">K</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">V</span><span class="p"><span class="pre">]</span></span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">Sentinel</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/2.7/library/constants.html#None" title="(in Python v2.7)"><span class="pre">None</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">traitlets.Undefined</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">t.Any</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/configuration.html#PETScSolverParameters"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#thetis.configuration.PETScSolverParameters" title="Link to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">Dict</span></code></p>
<p>PETSc solver options dictionary</p>
<p>Create a dict trait type from a Python dict.</p>
<p>The default value is created by doing <code class="docutils literal notranslate"><span class="pre">dict(default_value)</span></code>,
which creates a copy of the <code class="docutils literal notranslate"><span class="pre">default_value</span></code>.</p>
<section id="parameters">
<h3>Parameters<a class="headerlink" href="#parameters" title="Link to this heading">¶</a></h3>
<dl class="simple">
<dt>value_trait<span class="classifier">TraitType [ optional ]</span></dt><dd><p>The specified trait type to check and use to restrict the values of
the dict. If unspecified, values are not checked.</p>
</dd>
<dt>per_key_traits<span class="classifier">Dictionary of {keys:trait types} [ optional, keyword-only ]</span></dt><dd><p>A Python dictionary containing the types that are valid for
restricting the values of the dict on a per-key basis.
Each value in this dict should be a Trait for validating</p>
</dd>
<dt>key_trait<span class="classifier">TraitType [ optional, keyword-only ]</span></dt><dd><p>The type for restricting the keys of the dict. If
unspecified, the types of the keys are not checked.</p>
</dd>
<dt>default_value<span class="classifier">SequenceType [ optional, keyword-only ]</span></dt><dd><p>The default value for the Dict.  Must be dict, tuple, or None, and
will be cast to a dict if not None. If any key or value traits are specified,
the <cite>default_value</cite> must conform to the constraints.</p>
</dd>
</dl>
</section>
<section id="examples">
<h3>Examples<a class="headerlink" href="#examples" title="Link to this heading">¶</a></h3>
<p>a dict whose values must be text
&gt;&gt;&gt; d = Dict(Unicode())</p>
<p>d2[‘n’] must be an integer
d2[‘s’] must be text
&gt;&gt;&gt; d2 = Dict(per_key_traits={“n”: Integer(), “s”: Unicode()})</p>
<p>d3’s keys must be text
d3’s values must be integers
&gt;&gt;&gt; d3 = Dict(value_trait=Integer(), key_trait=Unicode())</p>
<dl class="py attribute">
<dt class="sig sig-object py" id="thetis.configuration.PETScSolverParameters.info_text">
<span class="sig-name descname"><span class="pre">info_text</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/2.7/library/functions.html#str" title="(in Python v2.7)"><span class="pre">str</span></a></em><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">'a</span> <span class="pre">PETSc</span> <span class="pre">solver</span> <span class="pre">options</span> <span class="pre">dictionary'</span></em><a class="headerlink" href="#thetis.configuration.PETScSolverParameters.info_text" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="thetis.configuration.PETScSolverParameters.validate">
<span class="sig-name descname"><span class="pre">validate</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">obj</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">value</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/configuration.html#PETScSolverParameters.validate"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#thetis.configuration.PETScSolverParameters.validate" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

</section>
</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="thetis.configuration.PairedEnum">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">thetis.configuration.</span></span><span class="sig-name descname"><span class="pre">PairedEnum</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">values</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">paired_name</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">default_value</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">traitlets.Undefined</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/configuration.html#PairedEnum"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#thetis.configuration.PairedEnum" title="Link to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">Enum</span></code></p>
<p>A enum whose value must be in a given sequence.</p>
<p>This enum controls a slaved option, with default values provided here.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>values</strong> – iterable of (value, HasTraits class) pairs.
The HasTraits class will be called (with no arguments) to
create default values if necessary.</p></li>
<li><p><strong>paired_name</strong> – trait name this enum is paired with.</p></li>
<li><p><strong>default_value</strong> – default value.</p></li>
</ul>
</dd>
</dl>
<p>Declare a traitlet.</p>
<p>If <em>allow_none</em> is True, None is a valid value in addition to any
values that are normally valid. The default is up to the subclass.
For most trait types, the default value for <code class="docutils literal notranslate"><span class="pre">allow_none</span></code> is False.</p>
<p>If <em>read_only</em> is True, attempts to directly modify a trait attribute raises a TraitError.</p>
<p>If <em>help</em> is a string, it documents the attribute’s purpose.</p>
<p>Extra metadata can be associated with the traitlet using the .tag() convenience method
or by using the traitlet instance’s .metadata dictionary.</p>
<dl class="py method">
<dt class="sig sig-object py" id="thetis.configuration.PairedEnum.info">
<span class="sig-name descname"><span class="pre">info</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/configuration.html#PairedEnum.info"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#thetis.configuration.PairedEnum.info" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="thetis.configuration.PositiveFloat">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">thetis.configuration.</span></span><span class="sig-name descname"><span class="pre">PositiveFloat</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">default_value</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/2.7/library/functions.html#float" title="(in Python v2.7)"><span class="pre">float</span></a><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">Sentinel</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">...</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">allow_none</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Literal</span><span class="p"><span class="pre">[</span></span><span class="k"><span class="pre">False</span></span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">...</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">read_only</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/2.7/library/functions.html#bool" title="(in Python v2.7)"><span class="pre">bool</span></a><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/2.7/library/constants.html#None" title="(in Python v2.7)"><span class="pre">None</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">...</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">help</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/2.7/library/functions.html#str" title="(in Python v2.7)"><span class="pre">str</span></a><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/2.7/library/constants.html#None" title="(in Python v2.7)"><span class="pre">None</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">...</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">config</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Any</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/2.7/library/constants.html#None" title="(in Python v2.7)"><span class="pre">None</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">...</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Any</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/configuration.html#PositiveFloat"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#thetis.configuration.PositiveFloat" title="Link to this definition">¶</a></dt>
<dt class="sig sig-object py">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">thetis.configuration.</span></span><span class="sig-name descname"><span class="pre">PositiveFloat</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">default_value</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/2.7/library/functions.html#float" title="(in Python v2.7)"><span class="pre">float</span></a><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">Sentinel</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/2.7/library/constants.html#None" title="(in Python v2.7)"><span class="pre">None</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">...</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">allow_none</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Literal</span><span class="p"><span class="pre">[</span></span><span class="k"><span class="pre">True</span></span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">...</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">read_only</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/2.7/library/functions.html#bool" title="(in Python v2.7)"><span class="pre">bool</span></a><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/2.7/library/constants.html#None" title="(in Python v2.7)"><span class="pre">None</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">...</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">help</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/2.7/library/functions.html#str" title="(in Python v2.7)"><span class="pre">str</span></a><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/2.7/library/constants.html#None" title="(in Python v2.7)"><span class="pre">None</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">...</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">config</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Any</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/2.7/library/constants.html#None" title="(in Python v2.7)"><span class="pre">None</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">...</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Any</span></span></em><span class="sig-paren">)</span></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">Float</span></code></p>
<p>Declare a traitlet.</p>
<p>If <em>allow_none</em> is True, None is a valid value in addition to any
values that are normally valid. The default is up to the subclass.
For most trait types, the default value for <code class="docutils literal notranslate"><span class="pre">allow_none</span></code> is False.</p>
<p>If <em>read_only</em> is True, attempts to directly modify a trait attribute raises a TraitError.</p>
<p>If <em>help</em> is a string, it documents the attribute’s purpose.</p>
<p>Extra metadata can be associated with the traitlet using the .tag() convenience method
or by using the traitlet instance’s .metadata dictionary.</p>
<dl class="py method">
<dt class="sig sig-object py" id="thetis.configuration.PositiveFloat.info">
<span class="sig-name descname"><span class="pre">info</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/configuration.html#PositiveFloat.info"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#thetis.configuration.PositiveFloat.info" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="thetis.configuration.PositiveFloat.validate">
<span class="sig-name descname"><span class="pre">validate</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">obj</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">proposal</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/configuration.html#PositiveFloat.validate"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#thetis.configuration.PositiveFloat.validate" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="thetis.configuration.PositiveInteger">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">thetis.configuration.</span></span><span class="sig-name descname"><span class="pre">PositiveInteger</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">default_value</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/2.7/library/functions.html#int" title="(in Python v2.7)"><span class="pre">int</span></a><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">Sentinel</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">...</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">allow_none</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Literal</span><span class="p"><span class="pre">[</span></span><span class="k"><span class="pre">False</span></span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">...</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">read_only</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/2.7/library/functions.html#bool" title="(in Python v2.7)"><span class="pre">bool</span></a><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/2.7/library/constants.html#None" title="(in Python v2.7)"><span class="pre">None</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">...</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">help</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/2.7/library/functions.html#str" title="(in Python v2.7)"><span class="pre">str</span></a><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/2.7/library/constants.html#None" title="(in Python v2.7)"><span class="pre">None</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">...</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">config</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Any</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/2.7/library/constants.html#None" title="(in Python v2.7)"><span class="pre">None</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">...</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Any</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/configuration.html#PositiveInteger"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#thetis.configuration.PositiveInteger" title="Link to this definition">¶</a></dt>
<dt class="sig sig-object py">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">thetis.configuration.</span></span><span class="sig-name descname"><span class="pre">PositiveInteger</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">default_value</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/2.7/library/functions.html#int" title="(in Python v2.7)"><span class="pre">int</span></a><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">Sentinel</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/2.7/library/constants.html#None" title="(in Python v2.7)"><span class="pre">None</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">...</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">allow_none</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Literal</span><span class="p"><span class="pre">[</span></span><span class="k"><span class="pre">True</span></span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">...</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">read_only</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/2.7/library/functions.html#bool" title="(in Python v2.7)"><span class="pre">bool</span></a><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/2.7/library/constants.html#None" title="(in Python v2.7)"><span class="pre">None</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">...</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">help</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/2.7/library/functions.html#str" title="(in Python v2.7)"><span class="pre">str</span></a><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/2.7/library/constants.html#None" title="(in Python v2.7)"><span class="pre">None</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">...</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">config</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Any</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/2.7/library/constants.html#None" title="(in Python v2.7)"><span class="pre">None</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">...</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Any</span></span></em><span class="sig-paren">)</span></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">Int</span></code></p>
<p>Declare a traitlet.</p>
<p>If <em>allow_none</em> is True, None is a valid value in addition to any
values that are normally valid. The default is up to the subclass.
For most trait types, the default value for <code class="docutils literal notranslate"><span class="pre">allow_none</span></code> is False.</p>
<p>If <em>read_only</em> is True, attempts to directly modify a trait attribute raises a TraitError.</p>
<p>If <em>help</em> is a string, it documents the attribute’s purpose.</p>
<p>Extra metadata can be associated with the traitlet using the .tag() convenience method
or by using the traitlet instance’s .metadata dictionary.</p>
<dl class="py method">
<dt class="sig sig-object py" id="thetis.configuration.PositiveInteger.info">
<span class="sig-name descname"><span class="pre">info</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/configuration.html#PositiveInteger.info"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#thetis.configuration.PositiveInteger.info" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="thetis.configuration.PositiveInteger.validate">
<span class="sig-name descname"><span class="pre">validate</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">obj</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">proposal</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/configuration.html#PositiveInteger.validate"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#thetis.configuration.PositiveInteger.validate" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="thetis.configuration.attach_paired_options">
<span class="sig-prename descclassname"><span class="pre">thetis.configuration.</span></span><span class="sig-name descname"><span class="pre">attach_paired_options</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">name</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">name_trait</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">value_trait</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/configuration.html#attach_paired_options"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#thetis.configuration.attach_paired_options" title="Link to this definition">¶</a></dt>
<dd><p>Attach paired options to a Configurable object.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>name</strong> – the name of the enum trait</p></li>
<li><p><strong>name_trait</strong> – the enum trait (a PairedEnum)</p></li>
<li><p><strong>value_trait</strong> – the slaved value trait.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="thetis.configuration.indent">
<span class="sig-prename descclassname"><span class="pre">thetis.configuration.</span></span><span class="sig-name descname"><span class="pre">indent</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">s</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nspaces</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/configuration.html#indent"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#thetis.configuration.indent" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="thetis.configuration.rst_all_options">
<span class="sig-prename descclassname"><span class="pre">thetis.configuration.</span></span><span class="sig-name descname"><span class="pre">rst_all_options</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">cls</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nspace</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">prefix</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/configuration.html#rst_all_options"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#thetis.configuration.rst_all_options" title="Link to this definition">¶</a></dt>
<dd><p>Recursively generate rST for a provided Configurable class.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>cls</strong> – The Configurable class.</p></li>
<li><p><strong>nspace</strong> – Indentation level.</p></li>
<li><p><strong>prefix</strong> – Prefix to use for new traits.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

</section>
<section id="module-thetis.coordsys">
<span id="thetis-coordsys-module"></span><h2>thetis.coordsys module<a class="headerlink" href="#module-thetis.coordsys" title="Link to this heading">¶</a></h2>
<p>Generic methods for converting data between different spatial coordinate systems.
Uses pyproj library.</p>
<dl class="py class">
<dt class="sig sig-object py" id="thetis.coordsys.CoordinateSystem">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">thetis.coordsys.</span></span><span class="sig-name descname"><span class="pre">CoordinateSystem</span></span><a class="reference internal" href="_modules/thetis/coordsys.html#CoordinateSystem"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#thetis.coordsys.CoordinateSystem" title="Link to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">ABC</span></code></p>
<p>Base class for horizontal coordinate systems</p>
<p>Provides methods for coordinate transformations etc.</p>
<dl class="py method">
<dt class="sig sig-object py" id="thetis.coordsys.CoordinateSystem.get_vector_rotator">
<em class="property"><span class="pre">abstract</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">get_vector_rotator</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/coordsys.html#CoordinateSystem.get_vector_rotator"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#thetis.coordsys.CoordinateSystem.get_vector_rotator" title="Link to this definition">¶</a></dt>
<dd><p>Returns a vector rotator object.</p>
<p>The rotator converst vector-valued data to/from longitude, latitude
coordinates.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="thetis.coordsys.CoordinateSystem.to_lonlat">
<em class="property"><span class="pre">abstract</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">to_lonlat</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/coordsys.html#CoordinateSystem.to_lonlat"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#thetis.coordsys.CoordinateSystem.to_lonlat" title="Link to this definition">¶</a></dt>
<dd><p>Convert coordinates to latitude and longitude</p>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="thetis.coordsys.UTMCoordinateSystem">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">thetis.coordsys.</span></span><span class="sig-name descname"><span class="pre">UTMCoordinateSystem</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">utm_zone</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">south</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/coordsys.html#UTMCoordinateSystem"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#thetis.coordsys.UTMCoordinateSystem" title="Link to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#thetis.coordsys.CoordinateSystem" title="thetis.coordsys.CoordinateSystem"><code class="xref py py-class docutils literal notranslate"><span class="pre">CoordinateSystem</span></code></a></p>
<p>Represents Universal Transverse Mercator coordinate systems</p>
<dl class="py method">
<dt class="sig sig-object py" id="thetis.coordsys.UTMCoordinateSystem.get_mesh_lonlat_function">
<span class="sig-name descname"><span class="pre">get_mesh_lonlat_function</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">mesh2d</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/coordsys.html#UTMCoordinateSystem.get_mesh_lonlat_function"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#thetis.coordsys.UTMCoordinateSystem.get_mesh_lonlat_function" title="Link to this definition">¶</a></dt>
<dd><p>Construct a <code class="xref py py-class docutils literal notranslate"><span class="pre">Function</span></code> holding the mesh coordinates in
longitude-latitude coordinates.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>mesh2d</strong> – the 2D mesh</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="thetis.coordsys.UTMCoordinateSystem.get_vector_rotator">
<span class="sig-name descname"><span class="pre">get_vector_rotator</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">lon</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">lat</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/coordsys.html#UTMCoordinateSystem.get_vector_rotator"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#thetis.coordsys.UTMCoordinateSystem.get_vector_rotator" title="Link to this definition">¶</a></dt>
<dd><p>Returns a vector rotator object.</p>
<p>The rotator converts vector-valued data from longitude, latitude
coordinates to mesh coordinate system.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="thetis.coordsys.UTMCoordinateSystem.to_lonlat">
<span class="sig-name descname"><span class="pre">to_lonlat</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">positive_lon</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/coordsys.html#UTMCoordinateSystem.to_lonlat"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#thetis.coordsys.UTMCoordinateSystem.to_lonlat" title="Link to this definition">¶</a></dt>
<dd><p>Convert (x, y) coordinates to (latitude, longitude)</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>x</strong> (<a class="reference external" href="https://docs.python.org/2.7/library/functions.html#float" title="(in Python v2.7)"><em>float</em></a><em> or </em><em>numpy.array_like</em>) – x coordinate</p></li>
<li><p><strong>y</strong> (<a class="reference external" href="https://docs.python.org/2.7/library/functions.html#float" title="(in Python v2.7)"><em>float</em></a><em> or </em><em>numpy.array_like</em>) – y coordinate</p></li>
<li><p><strong>positive_lon</strong> – should positive longitude be enforced?</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>longitude, latitude coordinates</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="thetis.coordsys.UTMCoordinateSystem.to_xy">
<span class="sig-name descname"><span class="pre">to_xy</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">lon</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">lat</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/coordsys.html#UTMCoordinateSystem.to_xy"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#thetis.coordsys.UTMCoordinateSystem.to_xy" title="Link to this definition">¶</a></dt>
<dd><p>Convert (latitude, longitude) coordinates to (x, y)</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>lon</strong> – longitude coordinate</p></li>
<li><p><strong>lat</strong> – latitude coordinate</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>x, y coordinates</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="thetis.coordsys.VectorCoordSysRotation">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">thetis.coordsys.</span></span><span class="sig-name descname"><span class="pre">VectorCoordSysRotation</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">trans</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">x</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/coordsys.html#VectorCoordSysRotation"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#thetis.coordsys.VectorCoordSysRotation" title="Link to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference external" href="https://docs.python.org/2.7/library/functions.html#object" title="(in Python v2.7)"><code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></a></p>
<p>Rotates vectors defined in source_sys coordinates to a different coordinate
system.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>trans</strong> – pyproj.Transformer object, maps from source to destination system</p></li>
<li><p><strong>y</strong> (<em>x</em><em>,</em>) – coordinates in the source coordinate system</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="thetis.coordsys.get_vector_rotation_matrix">
<span class="sig-prename descclassname"><span class="pre">thetis.coordsys.</span></span><span class="sig-name descname"><span class="pre">get_vector_rotation_matrix</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">trans</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">x</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">delta</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/coordsys.html#get_vector_rotation_matrix"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#thetis.coordsys.get_vector_rotation_matrix" title="Link to this definition">¶</a></dt>
<dd><p>Estimate rotation matrix that converts vectors defined in source_sys to
target_sys. Conversion is carried out by the given <cite>trans</cite> object.</p>
<p>Assume that we have a vector field defined in source_sys: vectors located at
(x, y) define the x and y components. We can then rotate the vectors to
represent x2 and y2 components of the target_sys by applying a local
rotation:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">trans</span> <span class="o">=</span> <span class="n">pyproj</span><span class="o">.</span><span class="n">Transformer</span><span class="o">.</span><span class="n">from_crs</span><span class="p">(</span><span class="n">source_sys</span><span class="p">,</span> <span class="n">target_sys</span><span class="p">)</span>
<span class="n">R</span><span class="p">,</span> <span class="n">theta</span> <span class="o">=</span> <span class="n">get_vector_rotation_matrix</span><span class="p">(</span><span class="n">trans</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">)</span>
<span class="n">v_xy</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span><span class="n">v_x</span><span class="p">],</span> <span class="p">[</span><span class="n">v_y</span><span class="p">]])</span>
<span class="n">v_new</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">matmul</span><span class="p">(</span><span class="n">R</span><span class="p">,</span> <span class="n">v_xy</span><span class="p">)</span>
<span class="n">v_x2</span><span class="p">,</span> <span class="n">v_y2</span> <span class="o">=</span> <span class="n">v_new</span>
</pre></div>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="thetis.coordsys.proj_transform">
<span class="sig-prename descclassname"><span class="pre">thetis.coordsys.</span></span><span class="sig-name descname"><span class="pre">proj_transform</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">trans</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/coordsys.html#proj_transform"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#thetis.coordsys.proj_transform" title="Link to this definition">¶</a></dt>
<dd><p>Transform coordinates from source to target system.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>x</strong><strong>,</strong><strong>y</strong> – coordinates, float or numpy.array_like</p></li>
<li><p><strong>trans</strong> – pyproj Transformer object</p></li>
</ul>
</dd>
</dl>
</dd></dl>

</section>
<section id="module-thetis.coupled_timeintegrator">
<span id="thetis-coupled-timeintegrator-module"></span><h2>thetis.coupled_timeintegrator module<a class="headerlink" href="#module-thetis.coupled_timeintegrator" title="Link to this heading">¶</a></h2>
<p>Time integrators for solving coupled 2D-3D system of equations.</p>
<dl class="py class">
<dt class="sig sig-object py" id="thetis.coupled_timeintegrator.CoupledLeapFrogAM3">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">thetis.coupled_timeintegrator.</span></span><span class="sig-name descname"><span class="pre">CoupledLeapFrogAM3</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">solver</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/coupled_timeintegrator.html#CoupledLeapFrogAM3"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#thetis.coupled_timeintegrator.CoupledLeapFrogAM3" title="Link to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#thetis.coupled_timeintegrator.CoupledTimeIntegrator" title="thetis.coupled_timeintegrator.CoupledTimeIntegrator"><code class="xref py py-class docutils literal notranslate"><span class="pre">CoupledTimeIntegrator</span></code></a></p>
<p>Leap-Frog Adams-Moulton 3 time integrator for coupled 2D-3D problem</p>
<p>This is an ALE time integrator.
Implementation follows the SLIM time integrator by Karna et al (2013)</p>
<p>Karna, et al. (2013). A baroclinic discontinuous Galerkin finite element
model for coastal flows. Ocean Modelling, 61(0):1-20.
<a class="reference external" href="http://dx.doi.org/10.1016/j.ocemod.2012.09.009">http://dx.doi.org/10.1016/j.ocemod.2012.09.009</a></p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>solver</strong> – <a class="reference internal" href="#thetis.solver.FlowSolver" title="thetis.solver.FlowSolver"><code class="xref py py-class docutils literal notranslate"><span class="pre">FlowSolver</span></code></a> object</p>
</dd>
</dl>
<dl class="py method">
<dt class="sig sig-object py" id="thetis.coupled_timeintegrator.CoupledLeapFrogAM3.advance">
<span class="sig-name descname"><span class="pre">advance</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">t</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">update_forcings</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">update_forcings3d</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/coupled_timeintegrator.html#CoupledLeapFrogAM3.advance"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#thetis.coupled_timeintegrator.CoupledLeapFrogAM3.advance" title="Link to this definition">¶</a></dt>
<dd><p>Advances the equations for one time step</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>t</strong> (<a class="reference external" href="https://docs.python.org/2.7/library/functions.html#float" title="(in Python v2.7)"><em>float</em></a>) – simulation time</p></li>
<li><p><strong>update_forcings</strong> – Optional user-defined function that takes
simulation time and updates time-dependent boundary conditions of
the 2D equations.</p></li>
<li><p><strong>update_forcings3d</strong> – Optional user defined function that updates
boundary conditions of the 3D equations</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="thetis.coupled_timeintegrator.CoupledLeapFrogAM3.integrator_2d">
<span class="sig-name descname"><span class="pre">integrator_2d</span></span><a class="headerlink" href="#thetis.coupled_timeintegrator.CoupledLeapFrogAM3.integrator_2d" title="Link to this definition">¶</a></dt>
<dd><p>alias of <a class="reference internal" href="#thetis.rungekutta.DIRK22" title="thetis.rungekutta.DIRK22"><code class="xref py py-class docutils literal notranslate"><span class="pre">DIRK22</span></code></a></p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="thetis.coupled_timeintegrator.CoupledLeapFrogAM3.integrator_3d">
<span class="sig-name descname"><span class="pre">integrator_3d</span></span><a class="headerlink" href="#thetis.coupled_timeintegrator.CoupledLeapFrogAM3.integrator_3d" title="Link to this definition">¶</a></dt>
<dd><p>alias of <a class="reference internal" href="#thetis.timeintegrator.LeapFrogAM3" title="thetis.timeintegrator.LeapFrogAM3"><code class="xref py py-class docutils literal notranslate"><span class="pre">LeapFrogAM3</span></code></a></p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="thetis.coupled_timeintegrator.CoupledLeapFrogAM3.integrator_vert_3d">
<span class="sig-name descname"><span class="pre">integrator_vert_3d</span></span><a class="headerlink" href="#thetis.coupled_timeintegrator.CoupledLeapFrogAM3.integrator_vert_3d" title="Link to this definition">¶</a></dt>
<dd><p>alias of <a class="reference internal" href="#thetis.rungekutta.BackwardEuler" title="thetis.rungekutta.BackwardEuler"><code class="xref py py-class docutils literal notranslate"><span class="pre">BackwardEuler</span></code></a></p>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="thetis.coupled_timeintegrator.CoupledTimeIntegrator">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">thetis.coupled_timeintegrator.</span></span><span class="sig-name descname"><span class="pre">CoupledTimeIntegrator</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">solver</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/coupled_timeintegrator.html#CoupledTimeIntegrator"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#thetis.coupled_timeintegrator.CoupledTimeIntegrator" title="Link to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#thetis.coupled_timeintegrator.CoupledTimeIntegratorBase" title="thetis.coupled_timeintegrator.CoupledTimeIntegratorBase"><code class="xref py py-class docutils literal notranslate"><span class="pre">CoupledTimeIntegratorBase</span></code></a>, <code class="xref py py-class docutils literal notranslate"><span class="pre">ABC</span></code></p>
<p>Base class of mode-split time integrators that use 2D, 3D and implicit 3D
time integrators.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>solver</strong> – <a class="reference internal" href="#thetis.solver.FlowSolver" title="thetis.solver.FlowSolver"><code class="xref py py-class docutils literal notranslate"><span class="pre">FlowSolver</span></code></a> object</p>
</dd>
</dl>
<dl class="py method">
<dt class="sig sig-object py" id="thetis.coupled_timeintegrator.CoupledTimeIntegrator.initialize">
<span class="sig-name descname"><span class="pre">initialize</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/coupled_timeintegrator.html#CoupledTimeIntegrator.initialize"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#thetis.coupled_timeintegrator.CoupledTimeIntegrator.initialize" title="Link to this definition">¶</a></dt>
<dd><p>Assign initial conditions to all necessary fields</p>
<p>Initial conditions are read from <code class="xref py py-attr docutils literal notranslate"><span class="pre">fields</span></code> dictionary.</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="thetis.coupled_timeintegrator.CoupledTimeIntegrator.integrator_2d">
<em class="property"><span class="pre">abstract</span><span class="w"> </span><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">integrator_2d</span></span><a class="headerlink" href="#thetis.coupled_timeintegrator.CoupledTimeIntegrator.integrator_2d" title="Link to this definition">¶</a></dt>
<dd><p>time integrator for 2D equations</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="thetis.coupled_timeintegrator.CoupledTimeIntegrator.integrator_3d">
<em class="property"><span class="pre">abstract</span><span class="w"> </span><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">integrator_3d</span></span><a class="headerlink" href="#thetis.coupled_timeintegrator.CoupledTimeIntegrator.integrator_3d" title="Link to this definition">¶</a></dt>
<dd><p>time integrator for explicit 3D equations (momentum, tracers)</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="thetis.coupled_timeintegrator.CoupledTimeIntegrator.integrator_vert_3d">
<em class="property"><span class="pre">abstract</span><span class="w"> </span><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">integrator_vert_3d</span></span><a class="headerlink" href="#thetis.coupled_timeintegrator.CoupledTimeIntegrator.integrator_vert_3d" title="Link to this definition">¶</a></dt>
<dd><p>time integrator for implicit 3D equations (vertical diffusion)</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="thetis.coupled_timeintegrator.CoupledTimeIntegrator.set_dt">
<span class="sig-name descname"><span class="pre">set_dt</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">dt</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dt_2d</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/coupled_timeintegrator.html#CoupledTimeIntegrator.set_dt"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#thetis.coupled_timeintegrator.CoupledTimeIntegrator.set_dt" title="Link to this definition">¶</a></dt>
<dd><p>Set time step for the coupled time integrator</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>dt</strong> (<a class="reference external" href="https://docs.python.org/2.7/library/functions.html#float" title="(in Python v2.7)"><em>float</em></a>) – Time step. This is the master (macro) time step used to
march the 3D equations.</p></li>
<li><p><strong>dt_2d</strong> (<a class="reference external" href="https://docs.python.org/2.7/library/functions.html#float" title="(in Python v2.7)"><em>float</em></a>) – Time step for 2D equations. For consistency
<code class="xref py py-attr docutils literal notranslate"><span class="pre">dt_2d</span></code> must be an integer fraction of <code class="xref py py-attr docutils literal notranslate"><span class="pre">dt</span></code>.
If 2D solver is implicit set <code class="xref py py-attr docutils literal notranslate"><span class="pre">dt_2d</span></code> equal to <code class="xref py py-attr docutils literal notranslate"><span class="pre">dt</span></code>.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="thetis.coupled_timeintegrator.CoupledTimeIntegratorBase">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">thetis.coupled_timeintegrator.</span></span><span class="sig-name descname"><span class="pre">CoupledTimeIntegratorBase</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">solver</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/coupled_timeintegrator.html#CoupledTimeIntegratorBase"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#thetis.coupled_timeintegrator.CoupledTimeIntegratorBase" title="Link to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#thetis.timeintegrator.TimeIntegratorBase" title="thetis.timeintegrator.TimeIntegratorBase"><code class="xref py py-class docutils literal notranslate"><span class="pre">TimeIntegratorBase</span></code></a></p>
<p>Base class for coupled 2D-3D time integrators</p>
<p>Provides common functionality for updating diagnostic fields etc.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>solver</strong> – <a class="reference internal" href="#thetis.solver.FlowSolver" title="thetis.solver.FlowSolver"><code class="xref py py-class docutils literal notranslate"><span class="pre">FlowSolver</span></code></a> object</p>
</dd>
</dl>
</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="thetis.coupled_timeintegrator.CoupledTwoStageRK">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">thetis.coupled_timeintegrator.</span></span><span class="sig-name descname"><span class="pre">CoupledTwoStageRK</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">solver</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/coupled_timeintegrator.html#CoupledTwoStageRK"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#thetis.coupled_timeintegrator.CoupledTwoStageRK" title="Link to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#thetis.coupled_timeintegrator.CoupledTimeIntegrator" title="thetis.coupled_timeintegrator.CoupledTimeIntegrator"><code class="xref py py-class docutils literal notranslate"><span class="pre">CoupledTimeIntegrator</span></code></a></p>
<p>Coupled time integrator based on SSPRK(2,2) scheme</p>
<p>This ALE time integration method uses SSPRK(2,2) scheme to advance the 3D
equations and a compatible implicit Trapezoid method to advance the 2D
equations. Backward Euler scheme is used for vertical diffusion.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>solver</strong> – <a class="reference internal" href="#thetis.solver.FlowSolver" title="thetis.solver.FlowSolver"><code class="xref py py-class docutils literal notranslate"><span class="pre">FlowSolver</span></code></a> object</p>
</dd>
</dl>
<dl class="py method">
<dt class="sig sig-object py" id="thetis.coupled_timeintegrator.CoupledTwoStageRK.advance">
<span class="sig-name descname"><span class="pre">advance</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">t</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">update_forcings</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">update_forcings3d</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/coupled_timeintegrator.html#CoupledTwoStageRK.advance"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#thetis.coupled_timeintegrator.CoupledTwoStageRK.advance" title="Link to this definition">¶</a></dt>
<dd><p>Advances the equations for one time step</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>t</strong> (<a class="reference external" href="https://docs.python.org/2.7/library/functions.html#float" title="(in Python v2.7)"><em>float</em></a>) – simulation time</p></li>
<li><p><strong>update_forcings</strong> – Optional user-defined function that takes
simulation time and updates time-dependent boundary conditions of
the 2D equations.</p></li>
<li><p><strong>update_forcings3d</strong> – Optional user defined function that updates
boundary conditions of the 3D equations</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="thetis.coupled_timeintegrator.CoupledTwoStageRK.compute_mesh_velocity">
<span class="sig-name descname"><span class="pre">compute_mesh_velocity</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">istage</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/coupled_timeintegrator.html#CoupledTwoStageRK.compute_mesh_velocity"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#thetis.coupled_timeintegrator.CoupledTwoStageRK.compute_mesh_velocity" title="Link to this definition">¶</a></dt>
<dd><p>Computes mesh velocity for stage i</p>
<p>Must be called after updating the 2D mode.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>istage</strong> (<a class="reference external" href="https://docs.python.org/2.7/library/functions.html#int" title="(in Python v2.7)"><em>int</em></a>) – stage of the Runge-Kutta iteration</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="thetis.coupled_timeintegrator.CoupledTwoStageRK.integrator_2d">
<span class="sig-name descname"><span class="pre">integrator_2d</span></span><a class="headerlink" href="#thetis.coupled_timeintegrator.CoupledTwoStageRK.integrator_2d" title="Link to this definition">¶</a></dt>
<dd><p>alias of <a class="reference internal" href="#thetis.rungekutta.ESDIRKTrapezoid" title="thetis.rungekutta.ESDIRKTrapezoid"><code class="xref py py-class docutils literal notranslate"><span class="pre">ESDIRKTrapezoid</span></code></a></p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="thetis.coupled_timeintegrator.CoupledTwoStageRK.integrator_3d">
<span class="sig-name descname"><span class="pre">integrator_3d</span></span><a class="headerlink" href="#thetis.coupled_timeintegrator.CoupledTwoStageRK.integrator_3d" title="Link to this definition">¶</a></dt>
<dd><p>alias of <a class="reference internal" href="#thetis.timeintegrator.SSPRK22ALE" title="thetis.timeintegrator.SSPRK22ALE"><code class="xref py py-class docutils literal notranslate"><span class="pre">SSPRK22ALE</span></code></a></p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="thetis.coupled_timeintegrator.CoupledTwoStageRK.integrator_vert_3d">
<span class="sig-name descname"><span class="pre">integrator_vert_3d</span></span><a class="headerlink" href="#thetis.coupled_timeintegrator.CoupledTwoStageRK.integrator_vert_3d" title="Link to this definition">¶</a></dt>
<dd><p>alias of <a class="reference internal" href="#thetis.rungekutta.BackwardEuler" title="thetis.rungekutta.BackwardEuler"><code class="xref py py-class docutils literal notranslate"><span class="pre">BackwardEuler</span></code></a></p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="thetis.coupled_timeintegrator.CoupledTwoStageRK.store_elevation">
<span class="sig-name descname"><span class="pre">store_elevation</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">istage</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/coupled_timeintegrator.html#CoupledTwoStageRK.store_elevation"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#thetis.coupled_timeintegrator.CoupledTwoStageRK.store_elevation" title="Link to this definition">¶</a></dt>
<dd><p>Store current elevation field for computing mesh velocity</p>
<p>Must be called before updating the 2D mode.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>istage</strong> (<a class="reference external" href="https://docs.python.org/2.7/library/functions.html#int" title="(in Python v2.7)"><em>int</em></a>) – stage of the Runge-Kutta iteration</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

</section>
<section id="module-thetis.coupled_timeintegrator_2d">
<span id="thetis-coupled-timeintegrator-2d-module"></span><h2>thetis.coupled_timeintegrator_2d module<a class="headerlink" href="#module-thetis.coupled_timeintegrator_2d" title="Link to this heading">¶</a></h2>
<p>Time integrators for solving coupled shallow water equations with one tracer or sediment.</p>
<dl class="py class">
<dt class="sig sig-object py" id="thetis.coupled_timeintegrator_2d.CoupledTimeIntegrator2D">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">thetis.coupled_timeintegrator_2d.</span></span><span class="sig-name descname"><span class="pre">CoupledTimeIntegrator2D</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">solver</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/coupled_timeintegrator_2d.html#CoupledTimeIntegrator2D"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#thetis.coupled_timeintegrator_2d.CoupledTimeIntegrator2D" title="Link to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#thetis.timeintegrator.TimeIntegratorBase" title="thetis.timeintegrator.TimeIntegratorBase"><code class="xref py py-class docutils literal notranslate"><span class="pre">TimeIntegratorBase</span></code></a>, <code class="xref py py-class docutils literal notranslate"><span class="pre">ABC</span></code></p>
<p>Base class of time integrator for coupled shallow water and tracer/sediment equations and exner equation</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>solver</strong> – <a class="reference internal" href="#thetis.solver.FlowSolver" title="thetis.solver.FlowSolver"><code class="xref py py-class docutils literal notranslate"><span class="pre">FlowSolver</span></code></a> object</p>
</dd>
</dl>
<dl class="py method">
<dt class="sig sig-object py" id="thetis.coupled_timeintegrator_2d.CoupledTimeIntegrator2D.advance">
<span class="sig-name descname"><span class="pre">advance</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">t</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">update_forcings</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/coupled_timeintegrator_2d.html#CoupledTimeIntegrator2D.advance"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#thetis.coupled_timeintegrator_2d.CoupledTimeIntegrator2D.advance" title="Link to this definition">¶</a></dt>
<dd><p>Advances equations for one time step</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>t</strong> (<a class="reference external" href="https://docs.python.org/2.7/library/functions.html#float" title="(in Python v2.7)"><em>float</em></a>) – simulation time</p></li>
<li><p><strong>update_forcings</strong> – user-defined function that takes the simulation
time and updates any time-dependent boundary conditions</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="thetis.coupled_timeintegrator_2d.CoupledTimeIntegrator2D.advance_picard">
<span class="sig-name descname"><span class="pre">advance_picard</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">t</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">update_forcings</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/coupled_timeintegrator_2d.html#CoupledTimeIntegrator2D.advance_picard"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#thetis.coupled_timeintegrator_2d.CoupledTimeIntegrator2D.advance_picard" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="thetis.coupled_timeintegrator_2d.CoupledTimeIntegrator2D.exner_integrator">
<span class="sig-name descname"><span class="pre">exner_integrator</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/coupled_timeintegrator_2d.html#CoupledTimeIntegrator2D.exner_integrator"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#thetis.coupled_timeintegrator_2d.CoupledTimeIntegrator2D.exner_integrator" title="Link to this definition">¶</a></dt>
<dd><p>time integrator for the exner equation</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="thetis.coupled_timeintegrator_2d.CoupledTimeIntegrator2D.initialize">
<span class="sig-name descname"><span class="pre">initialize</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">solution2d</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/coupled_timeintegrator_2d.html#CoupledTimeIntegrator2D.initialize"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#thetis.coupled_timeintegrator_2d.CoupledTimeIntegrator2D.initialize" title="Link to this definition">¶</a></dt>
<dd><p>Assign initial conditions to all necessary fields</p>
<p>Initial conditions are read from <code class="xref py py-attr docutils literal notranslate"><span class="pre">fields</span></code> dictionary.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="thetis.coupled_timeintegrator_2d.CoupledTimeIntegrator2D.set_dt">
<span class="sig-name descname"><span class="pre">set_dt</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">dt</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/coupled_timeintegrator_2d.html#CoupledTimeIntegrator2D.set_dt"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#thetis.coupled_timeintegrator_2d.CoupledTimeIntegrator2D.set_dt" title="Link to this definition">¶</a></dt>
<dd><p>Set time step for the coupled time integrator</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>dt</strong> (<a class="reference external" href="https://docs.python.org/2.7/library/functions.html#float" title="(in Python v2.7)"><em>float</em></a>) – Time step.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="thetis.coupled_timeintegrator_2d.CoupledTimeIntegrator2D.swe_integrator">
<span class="sig-name descname"><span class="pre">swe_integrator</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/coupled_timeintegrator_2d.html#CoupledTimeIntegrator2D.swe_integrator"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#thetis.coupled_timeintegrator_2d.CoupledTimeIntegrator2D.swe_integrator" title="Link to this definition">¶</a></dt>
<dd><p>time integrator for the shallow water equations</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="thetis.coupled_timeintegrator_2d.CoupledTimeIntegrator2D.tracer_integrator">
<span class="sig-name descname"><span class="pre">tracer_integrator</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/coupled_timeintegrator_2d.html#CoupledTimeIntegrator2D.tracer_integrator"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#thetis.coupled_timeintegrator_2d.CoupledTimeIntegrator2D.tracer_integrator" title="Link to this definition">¶</a></dt>
<dd><p>time integrator for the tracer equation</p>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="thetis.coupled_timeintegrator_2d.GeneralCoupledTimeIntegrator2D">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">thetis.coupled_timeintegrator_2d.</span></span><span class="sig-name descname"><span class="pre">GeneralCoupledTimeIntegrator2D</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">solver</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">integrators</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/coupled_timeintegrator_2d.html#GeneralCoupledTimeIntegrator2D"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#thetis.coupled_timeintegrator_2d.GeneralCoupledTimeIntegrator2D" title="Link to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#thetis.coupled_timeintegrator_2d.CoupledTimeIntegrator2D" title="thetis.coupled_timeintegrator_2d.CoupledTimeIntegrator2D"><code class="xref py py-class docutils literal notranslate"><span class="pre">CoupledTimeIntegrator2D</span></code></a></p>
<p>A <a class="reference internal" href="#thetis.coupled_timeintegrator_2d.CoupledTimeIntegrator2D" title="thetis.coupled_timeintegrator_2d.CoupledTimeIntegrator2D"><code class="xref py py-class docutils literal notranslate"><span class="pre">CoupledTimeIntegrator2D</span></code></a> which supports
a general set of time integrators for the different
components.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>solver</strong> – the <code class="xref py py-class docutils literal notranslate"><span class="pre">FlowSolver2d</span></code> object</p></li>
<li><p><strong>integrators</strong> – dictionary of time integrators
to be used for each equation</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="thetis.coupled_timeintegrator_2d.NonHydrostaticTimeIntegrator2D">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">thetis.coupled_timeintegrator_2d.</span></span><span class="sig-name descname"><span class="pre">NonHydrostaticTimeIntegrator2D</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">solver</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">swe_integrator</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fs_integrator</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/coupled_timeintegrator_2d.html#NonHydrostaticTimeIntegrator2D"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#thetis.coupled_timeintegrator_2d.NonHydrostaticTimeIntegrator2D" title="Link to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#thetis.coupled_timeintegrator_2d.CoupledTimeIntegrator2D" title="thetis.coupled_timeintegrator_2d.CoupledTimeIntegrator2D"><code class="xref py py-class docutils literal notranslate"><span class="pre">CoupledTimeIntegrator2D</span></code></a></p>
<p>2D non-hydrostatic time integrator based on Shallow Water time integrator</p>
<p>This time integration method uses SWE time integrator to advance
the hydrostatic equations, depth-integrated Poisson solver to be
solved for NH pressure, and a free surface integrator to advance
the free surface correction. Advancing in serial or in a whole
time stepping depends on the selection of time integrators.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>solver</strong> – <a class="reference internal" href="#thetis.solver.FlowSolver" title="thetis.solver.FlowSolver"><code class="xref py py-class docutils literal notranslate"><span class="pre">FlowSolver</span></code></a> object</p>
</dd>
</dl>
<dl class="py method">
<dt class="sig sig-object py" id="thetis.coupled_timeintegrator_2d.NonHydrostaticTimeIntegrator2D.advance">
<span class="sig-name descname"><span class="pre">advance</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">t</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">update_forcings</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/coupled_timeintegrator_2d.html#NonHydrostaticTimeIntegrator2D.advance"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#thetis.coupled_timeintegrator_2d.NonHydrostaticTimeIntegrator2D.advance" title="Link to this definition">¶</a></dt>
<dd><p>Advances equations for one time step.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="thetis.coupled_timeintegrator_2d.NonHydrostaticTimeIntegrator2D.initialize">
<span class="sig-name descname"><span class="pre">initialize</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">solution2d</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/coupled_timeintegrator_2d.html#NonHydrostaticTimeIntegrator2D.initialize"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#thetis.coupled_timeintegrator_2d.NonHydrostaticTimeIntegrator2D.initialize" title="Link to this definition">¶</a></dt>
<dd><p>Assign initial conditions to all necessary fields</p>
<p>Initial conditions are read from <code class="xref py py-attr docutils literal notranslate"><span class="pre">fields</span></code> dictionary.</p>
</dd></dl>

</dd></dl>

</section>
<section id="module-thetis.diagnostics">
<span id="thetis-diagnostics-module"></span><h2>thetis.diagnostics module<a class="headerlink" href="#module-thetis.diagnostics" title="Link to this heading">¶</a></h2>
<p>Classes for computing diagnostics.</p>
<dl class="py class">
<dt class="sig sig-object py" id="thetis.diagnostics.GradientRecoverer2D">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">thetis.diagnostics.</span></span><span class="sig-name descname"><span class="pre">GradientRecoverer2D</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Any</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/diagnostics.html#GradientRecoverer2D"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#thetis.diagnostics.GradientRecoverer2D" title="Link to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">DiagnosticCalculator</span></code></p>
<p>Gradient recovery via L2 projection.</p>
<dl class="py attribute">
<dt class="sig sig-object py" id="thetis.diagnostics.GradientRecoverer2D.field_2d">
<span class="sig-name descname"><span class="pre">field_2d</span></span><a class="headerlink" href="#thetis.diagnostics.GradientRecoverer2D.field_2d" title="Link to this definition">¶</a></dt>
<dd><p>Field to recover the gradient of</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="thetis.diagnostics.GradientRecoverer2D.solve">
<span class="sig-name descname"><span class="pre">solve</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/diagnostics.html#GradientRecoverer2D.solve"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#thetis.diagnostics.GradientRecoverer2D.solve" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="thetis.diagnostics.HessianRecoverer2D">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">thetis.diagnostics.</span></span><span class="sig-name descname"><span class="pre">HessianRecoverer2D</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Any</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/diagnostics.html#HessianRecoverer2D"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#thetis.diagnostics.HessianRecoverer2D" title="Link to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">DiagnosticCalculator</span></code></p>
<p>Linear solver for recovering Hessians.</p>
<p>Hessians are recoved using double <span class="math notranslate nohighlight">\(L^2\)</span>
projection, which is implemented using a
mixed finite element method.</p>
<p>It is recommended that gradients and Hessians
are sought in <span class="math notranslate nohighlight">\(\mathbb P1\)</span> space of
appropriate dimension.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>field_2d</strong> – scalar expression to recover the Hessian of.</p></li>
<li><p><strong>hessian_2d</strong> – <code class="xref py py-class docutils literal notranslate"><span class="pre">Function</span></code> to hold recovered Hessian.</p></li>
<li><p><strong>gradient_2d</strong> – <code class="xref py py-class docutils literal notranslate"><span class="pre">Function</span></code> to hold recovered gradient.</p></li>
</ul>
</dd>
<dt class="field-even">Kwargs<span class="colon">:</span></dt>
<dd class="field-even"><p>to be passed to the <code class="xref py py-class docutils literal notranslate"><span class="pre">LinearVariationalSolver</span></code>.</p>
</dd>
</dl>
<dl class="py attribute">
<dt class="sig sig-object py" id="thetis.diagnostics.HessianRecoverer2D.field_2d">
<span class="sig-name descname"><span class="pre">field_2d</span></span><a class="headerlink" href="#thetis.diagnostics.HessianRecoverer2D.field_2d" title="Link to this definition">¶</a></dt>
<dd><p>Field to be recovered</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="thetis.diagnostics.HessianRecoverer2D.solve">
<span class="sig-name descname"><span class="pre">solve</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/diagnostics.html#HessianRecoverer2D.solve"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#thetis.diagnostics.HessianRecoverer2D.solve" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="thetis.diagnostics.KineticEnergyCalculator">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">thetis.diagnostics.</span></span><span class="sig-name descname"><span class="pre">KineticEnergyCalculator</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Any</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/diagnostics.html#KineticEnergyCalculator"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#thetis.diagnostics.KineticEnergyCalculator" title="Link to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">DiagnosticCalculator</span></code></p>
<p>Class for calculating dynamic pressure (i.e. kinetic energy),</p>
<div class="math notranslate nohighlight">
\[E_K = \frac12 \rho \|\mathbf{u}\|^2,\]</div>
<p>where <span class="math notranslate nohighlight">\(\rho\)</span> is the water density and <span class="math notranslate nohighlight">\(\mathbf{u}\)</span>
is the velocity.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>uv</strong> – scalar expression for the fluid velocity.</p></li>
<li><p><strong>ke</strong> – <code class="xref py py-class docutils literal notranslate"><span class="pre">Function</span></code> to hold calculated kinetic energy.</p></li>
<li><p><strong>density</strong> – fluid density.</p></li>
<li><p><strong>horizontal</strong> – consider the horizontal components of velocity only?</p></li>
<li><p><strong>project</strong> – project, rather than interpolate?</p></li>
</ul>
</dd>
</dl>
<dl class="py attribute">
<dt class="sig sig-object py" id="thetis.diagnostics.KineticEnergyCalculator.density">
<span class="sig-name descname"><span class="pre">density</span></span><a class="headerlink" href="#thetis.diagnostics.KineticEnergyCalculator.density" title="Link to this definition">¶</a></dt>
<dd><p>Fluid density</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="thetis.diagnostics.KineticEnergyCalculator.solve">
<span class="sig-name descname"><span class="pre">solve</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/diagnostics.html#KineticEnergyCalculator.solve"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#thetis.diagnostics.KineticEnergyCalculator.solve" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="thetis.diagnostics.ShallowWaterDualWeightedResidual2D">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">thetis.diagnostics.</span></span><span class="sig-name descname"><span class="pre">ShallowWaterDualWeightedResidual2D</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Any</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/diagnostics.html#ShallowWaterDualWeightedResidual2D"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#thetis.diagnostics.ShallowWaterDualWeightedResidual2D" title="Link to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">DualWeightedResidual2D</span></code></p>
<p>Class for computing dual weighted residual contributions
for the shallow water equations.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>solver_obj</strong> – <code class="xref py py-class docutils literal notranslate"><span class="pre">FlowSolver2d</span></code> instance</p></li>
<li><p><strong>dual</strong> – a <code class="xref py py-class docutils literal notranslate"><span class="pre">Function</span></code> that approximates the true adjoint solution,
which will replace the test function</p></li>
</ul>
</dd>
</dl>
<dl class="py property">
<dt class="sig sig-object py" id="thetis.diagnostics.ShallowWaterDualWeightedResidual2D.form">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">form</span></span><a class="headerlink" href="#thetis.diagnostics.ShallowWaterDualWeightedResidual2D.form" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="thetis.diagnostics.ShallowWaterDualWeightedResidual2D.space">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">space</span></span><a class="headerlink" href="#thetis.diagnostics.ShallowWaterDualWeightedResidual2D.space" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="thetis.diagnostics.TracerDualWeightedResidual2D">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">thetis.diagnostics.</span></span><span class="sig-name descname"><span class="pre">TracerDualWeightedResidual2D</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Any</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/diagnostics.html#TracerDualWeightedResidual2D"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#thetis.diagnostics.TracerDualWeightedResidual2D" title="Link to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">DualWeightedResidual2D</span></code></p>
<p>Class for computing dual weighted residual contributions
for 2D tracer transport problems.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>solver_obj</strong> – <code class="xref py py-class docutils literal notranslate"><span class="pre">FlowSolver2d</span></code> instance</p></li>
<li><p><strong>dual</strong> – a <code class="xref py py-class docutils literal notranslate"><span class="pre">Function</span></code> that approximates the true adjoint solution,
which will replace the test function</p></li>
</ul>
</dd>
</dl>
<dl class="py property">
<dt class="sig sig-object py" id="thetis.diagnostics.TracerDualWeightedResidual2D.form">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">form</span></span><a class="headerlink" href="#thetis.diagnostics.TracerDualWeightedResidual2D.form" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="thetis.diagnostics.TracerDualWeightedResidual2D.space">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">space</span></span><a class="headerlink" href="#thetis.diagnostics.TracerDualWeightedResidual2D.space" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="thetis.diagnostics.VorticityCalculator2D">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">thetis.diagnostics.</span></span><span class="sig-name descname"><span class="pre">VorticityCalculator2D</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Any</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/diagnostics.html#VorticityCalculator2D"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#thetis.diagnostics.VorticityCalculator2D" title="Link to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">DiagnosticCalculator</span></code></p>
<p>Linear solver for recovering fluid vorticity,
interpreted as a scalar field:</p>
<div class="math notranslate nohighlight">
\[\omega = -v_x + u_y,\]</div>
<p>for a velocity field <span class="math notranslate nohighlight">\(\mathbf{u} = (u, v)\)</span>.</p>
<p>It is recommended that the vorticity is sought
in <span class="math notranslate nohighlight">\(\mathbb P1\)</span> space.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>uv_2d</strong> – vector expression for the horizontal velocity.</p></li>
<li><p><strong>vorticity_2d</strong> – <code class="xref py py-class docutils literal notranslate"><span class="pre">Function</span></code> to hold calculated vorticity.</p></li>
</ul>
</dd>
<dt class="field-even">Kwargs<span class="colon">:</span></dt>
<dd class="field-even"><p>to be passed to the <code class="xref py py-class docutils literal notranslate"><span class="pre">LinearVariationalSolver</span></code>.</p>
</dd>
</dl>
<dl class="py method">
<dt class="sig sig-object py" id="thetis.diagnostics.VorticityCalculator2D.solve">
<span class="sig-name descname"><span class="pre">solve</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/diagnostics.html#VorticityCalculator2D.solve"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#thetis.diagnostics.VorticityCalculator2D.solve" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="thetis.diagnostics.VorticityCalculator2D.uv_2d">
<span class="sig-name descname"><span class="pre">uv_2d</span></span><a class="headerlink" href="#thetis.diagnostics.VorticityCalculator2D.uv_2d" title="Link to this definition">¶</a></dt>
<dd><p>Horizontal velocity</p>
</dd></dl>

</dd></dl>

</section>
<section id="module-thetis.equation">
<span id="thetis-equation-module"></span><h2>thetis.equation module<a class="headerlink" href="#module-thetis.equation" title="Link to this heading">¶</a></h2>
<p>Implements Equation and Term classes.</p>
<dl class="py class">
<dt class="sig sig-object py" id="thetis.equation.Equation">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">thetis.equation.</span></span><span class="sig-name descname"><span class="pre">Equation</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">function_space</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/equation.html#Equation"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#thetis.equation.Equation" title="Link to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference external" href="https://docs.python.org/2.7/library/functions.html#object" title="(in Python v2.7)"><code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></a></p>
<p>Implements an equation, made out of terms.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>function_space</strong> – the <code class="xref py py-class docutils literal notranslate"><span class="pre">FunctionSpace</span></code> the solution belongs to</p>
</dd>
</dl>
<dl class="py attribute">
<dt class="sig sig-object py" id="thetis.equation.Equation.SUPPORTED_LABELS">
<span class="sig-name descname"><span class="pre">SUPPORTED_LABELS</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">frozenset({'explicit',</span> <span class="pre">'implicit',</span> <span class="pre">'nonlinear',</span> <span class="pre">'source'})</span></em><a class="headerlink" href="#thetis.equation.Equation.SUPPORTED_LABELS" title="Link to this definition">¶</a></dt>
<dd><p>Valid labels for terms, indicating how they should be treated in the time
integrator.</p>
<dl class="simple">
<dt>source</dt><dd><p>The term is a source term, i.e. does not depend on the solution.</p>
</dd>
<dt>explicit</dt><dd><p>The term should be treated explicitly</p>
</dd>
<dt>implicit</dt><dd><p>The term should be treated implicitly</p>
</dd>
<dt>nonlinear</dt><dd><p>The term is nonlinear and should be treated fully implicitly</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="thetis.equation.Equation.add_term">
<span class="sig-name descname"><span class="pre">add_term</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">term</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">label</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">suffix</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/equation.html#Equation.add_term"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#thetis.equation.Equation.add_term" title="Link to this definition">¶</a></dt>
<dd><p>Adds a term in the equation</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>term</strong> – <a class="reference internal" href="#thetis.equation.Term" title="thetis.equation.Term"><code class="xref py py-class docutils literal notranslate"><span class="pre">Term</span></code></a> object to add_term</p></li>
<li><p><strong>label</strong> (<em>string</em>) – Assign a label to the term. Valid labels are given by
<a class="reference internal" href="#thetis.equation.Equation.SUPPORTED_LABELS" title="thetis.equation.Equation.SUPPORTED_LABELS"><code class="xref py py-attr docutils literal notranslate"><span class="pre">SUPPORTED_LABELS</span></code></a>.</p></li>
<li><p><strong>suffix</strong> – optional custom key suffix</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="thetis.equation.Equation.jacobian">
<span class="sig-name descname"><span class="pre">jacobian</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">label</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">solution</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">solution_old</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fields</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fields_old</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">bnd_conditions</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/equation.html#Equation.jacobian"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#thetis.equation.Equation.jacobian" title="Link to this definition">¶</a></dt>
<dd><p>Returns an UFL form of the Jacobian by summing up all the Jacobians of the terms.</p>
<p>Sign convention: all terms are assumed to be on the right hand side of the equation: d(u)/dt = term.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>label</strong> – string defining the type of terms to sum up. Currently one of
‘source’|’explicit’|’implicit’|’nonlinear’. Can be a list of multiple labels, or ‘all’ in which
case all defined terms are summed.</p></li>
<li><p><strong>solution</strong> – solution <code class="xref py py-class docutils literal notranslate"><span class="pre">Function</span></code> of the corresponding equation</p></li>
<li><p><strong>solution_old</strong> – a time lagged solution <code class="xref py py-class docutils literal notranslate"><span class="pre">Function</span></code></p></li>
<li><p><strong>fields</strong> – a dictionary that provides all the remaining fields that the term depends on.
The keys of the dictionary should standard field names in <cite>field_metadata</cite></p></li>
<li><p><strong>fields_old</strong> – Time lagged dictionary of fields</p></li>
<li><p><strong>bnd_conditions</strong> – A dictionary describing boundary conditions.
E.g. {3: {‘elev_2d’: Constant(1.0)}} replaces elev_2d function by a constant on boundary ID 3.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="thetis.equation.Equation.label_term">
<span class="sig-name descname"><span class="pre">label_term</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">term</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">label</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/equation.html#Equation.label_term"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#thetis.equation.Equation.label_term" title="Link to this definition">¶</a></dt>
<dd><p>Assings a label to the given term(s).</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>term</strong> – <a class="reference internal" href="#thetis.equation.Term" title="thetis.equation.Term"><code class="xref py py-class docutils literal notranslate"><span class="pre">Term</span></code></a> object, or a tuple of terms</p></li>
<li><p><strong>label</strong> – string label to assign</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="thetis.equation.Equation.mass_term">
<span class="sig-name descname"><span class="pre">mass_term</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">solution</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/equation.html#Equation.mass_term"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#thetis.equation.Equation.mass_term" title="Link to this definition">¶</a></dt>
<dd><p>Returns default mass matrix term for the solution function space.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>UFL form of the mass term</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="thetis.equation.Equation.residual">
<span class="sig-name descname"><span class="pre">residual</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">label</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">solution</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">solution_old</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fields</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fields_old</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">bnd_conditions</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/equation.html#Equation.residual"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#thetis.equation.Equation.residual" title="Link to this definition">¶</a></dt>
<dd><p>Returns an UFL form of the residual by summing up all the terms with the desired label.</p>
<p>Sign convention: all terms are assumed to be on the right hand side of the equation: d(u)/dt = term.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>label</strong> – string defining the type of terms to sum up. Currently one of
‘source’|’explicit’|’implicit’|’nonlinear’. Can be a list of multiple labels, or ‘all’ in which
case all defined terms are summed.</p></li>
<li><p><strong>solution</strong> – solution <code class="xref py py-class docutils literal notranslate"><span class="pre">Function</span></code> of the corresponding equation</p></li>
<li><p><strong>solution_old</strong> – a time lagged solution <code class="xref py py-class docutils literal notranslate"><span class="pre">Function</span></code></p></li>
<li><p><strong>fields</strong> – a dictionary that provides all the remaining fields that the term depends on.
The keys of the dictionary should standard field names in <cite>field_metadata</cite></p></li>
<li><p><strong>fields_old</strong> – Time lagged dictionary of fields</p></li>
<li><p><strong>bnd_conditions</strong> – A dictionary describing boundary conditions.
E.g. {3: {‘elev_2d’: Constant(1.0)}} replaces elev_2d function by a constant on boundary ID 3.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="thetis.equation.Equation.select_terms">
<span class="sig-name descname"><span class="pre">select_terms</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">label</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/equation.html#Equation.select_terms"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#thetis.equation.Equation.select_terms" title="Link to this definition">¶</a></dt>
<dd><p>Generator function that selects terms by label(s).</p>
<p>label can be a single label (e.g. ‘explicit’), ‘all’ or a tuple of
labels.</p>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="thetis.equation.Term">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">thetis.equation.</span></span><span class="sig-name descname"><span class="pre">Term</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">function_space</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">test_function</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">trial_function</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/equation.html#Term"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#thetis.equation.Term" title="Link to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference external" href="https://docs.python.org/2.7/library/functions.html#object" title="(in Python v2.7)"><code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></a></p>
<p>Implements a single term of an equation.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Sign convention: all terms are assumed to be on the right hand side of the equation: d(u)/dt = term.</p>
</div>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>function_space</strong> – the <code class="xref py py-class docutils literal notranslate"><span class="pre">FunctionSpace</span></code> the solution belongs to</p></li>
<li><p><strong>test_function</strong> – custom <code class="xref py py-class docutils literal notranslate"><span class="pre">TestFunction</span></code>.</p></li>
<li><p><strong>trial_function</strong> – custom <code class="xref py py-class docutils literal notranslate"><span class="pre">TrialFunction</span></code>.</p></li>
</ul>
</dd>
</dl>
<dl class="py method">
<dt class="sig sig-object py" id="thetis.equation.Term.jacobian">
<span class="sig-name descname"><span class="pre">jacobian</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">solution</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">solution_old</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fields</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fields_old</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">bnd_conditions</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/equation.html#Term.jacobian"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#thetis.equation.Term.jacobian" title="Link to this definition">¶</a></dt>
<dd><p>Returns an UFL form of the Jacobian of the term.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>solution</strong> – solution <code class="xref py py-class docutils literal notranslate"><span class="pre">Function</span></code> of the corresponding equation</p></li>
<li><p><strong>solution_old</strong> – a time lagged solution <code class="xref py py-class docutils literal notranslate"><span class="pre">Function</span></code></p></li>
<li><p><strong>fields</strong> – a dictionary that provides all the remaining fields that the term depends on.
The keys of the dictionary should standard field names in <cite>field_metadata</cite></p></li>
<li><p><strong>fields_old</strong> – Time lagged dictionary of fields</p></li>
<li><p><strong>bnd_conditions</strong> – A dictionary describing boundary conditions.
E.g. {3: {‘elev_2d’: Constant(1.0)}} replaces elev_2d function by a constant on boundary ID 3.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="thetis.equation.Term.residual">
<span class="sig-name descname"><span class="pre">residual</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">solution</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">solution_old</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fields</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fields_old</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">bnd_conditions</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/equation.html#Term.residual"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#thetis.equation.Term.residual" title="Link to this definition">¶</a></dt>
<dd><p>Returns an UFL form of the term.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>solution</strong> – solution <code class="xref py py-class docutils literal notranslate"><span class="pre">Function</span></code> of the corresponding equation</p></li>
<li><p><strong>solution_old</strong> – a time lagged solution <code class="xref py py-class docutils literal notranslate"><span class="pre">Function</span></code></p></li>
<li><p><strong>fields</strong> – a dictionary that provides all the remaining fields that the term depends on.
The keys of the dictionary should standard field names in <cite>field_metadata</cite></p></li>
<li><p><strong>fields_old</strong> – Time lagged dictionary of fields</p></li>
<li><p><strong>bnd_conditions</strong> – A dictionary describing boundary conditions.
E.g. {3: {‘elev_2d’: Constant(1.0)}} replaces elev_2d function by a constant on boundary ID 3.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

</dd></dl>

</section>
<section id="module-thetis.exner_eq">
<span id="thetis-exner-eq-module"></span><h2>thetis.exner_eq module<a class="headerlink" href="#module-thetis.exner_eq" title="Link to this heading">¶</a></h2>
<p>Exner equation</p>
<p>2D conservation of mass equation describing bed evolution due to sediment transport</p>
<p>The equation reads</p>
<div class="math notranslate nohighlight" id="equation-exner-eq">
<span class="eqno">(1)<a class="headerlink" href="#equation-exner-eq" title="Link to this equation">¶</a></span>\[\frac{\partial z_b}{\partial t} + (m/(1-p)) \nabla_h \cdot \textbf{Q_b}
= (m/(1-p)) H ((F_{sink} S) - F_{source})\]</div>
<p>where <span class="math notranslate nohighlight">\(z_b\)</span> is the bedlevel, <span class="math notranslate nohighlight">\(S\)</span> is <span class="math notranslate nohighlight">\(HT\)</span> for conservative (where H is depth
and T is the sediment field) and <span class="math notranslate nohighlight">\(T\)</span> for non-conservative (where T is the sediment field),
<span class="math notranslate nohighlight">\(\nabla_h\)</span> denotes horizontal gradient, <span class="math notranslate nohighlight">\(m\)</span> is the morphological scale factor,
<span class="math notranslate nohighlight">\(p\)</span> is the porosity and <span class="math notranslate nohighlight">\(\textbf{Q_b}\)</span> is the bedload transport vector</p>
<dl class="py class">
<dt class="sig sig-object py" id="thetis.exner_eq.ExnerBedloadTerm">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">thetis.exner_eq.</span></span><span class="sig-name descname"><span class="pre">ExnerBedloadTerm</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">function_space</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">depth</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sediment_model</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">depth_integrated_sediment</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/exner_eq.html#ExnerBedloadTerm"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#thetis.exner_eq.ExnerBedloadTerm" title="Link to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#thetis.exner_eq.ExnerTerm" title="thetis.exner_eq.ExnerTerm"><code class="xref py py-class docutils literal notranslate"><span class="pre">ExnerTerm</span></code></a></p>
<p>Bedload transport term, nabla_h cdot textbf{Q_b}</p>
<p>The weak form is</p>
<div class="math notranslate nohighlight">
\[\int_\Omega  \nabla_h \cdot \textbf{Q_b} \psi  dx
= - \int_\Omega (\textbf{Q_b} \cdot \nabla) \psi dx
+ \int_\Gamma \psi \textbf{Q_b} \cdot \textbf{n} dS\]</div>
<p>where <span class="math notranslate nohighlight">\(\textbf{n}\)</span> is the unit normal of the element interfaces.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>function_space</strong> – <code class="xref py py-class docutils literal notranslate"><span class="pre">FunctionSpace</span></code> where the solution belongs</p></li>
<li><p><strong>depth</strong> – <code class="xref py py-class docutils literal notranslate"><span class="pre">DepthExpression</span></code> containing depth info</p></li>
<li><p><strong>sediment_model</strong> – <code class="xref py py-class docutils literal notranslate"><span class="pre">SedimentModel</span></code> containing sediment info</p></li>
<li><p><strong>depth_integrated_sediment</strong> (<a class="reference external" href="https://docs.python.org/2.7/library/functions.html#bool" title="(in Python v2.7)"><em>bool</em></a>) – whether the sediment field is depth-integrated</p></li>
</ul>
</dd>
</dl>
<dl class="py method">
<dt class="sig sig-object py" id="thetis.exner_eq.ExnerBedloadTerm.residual">
<span class="sig-name descname"><span class="pre">residual</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">solution</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">solution_old</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fields</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fields_old</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">bnd_conditions</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/exner_eq.html#ExnerBedloadTerm.residual"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#thetis.exner_eq.ExnerBedloadTerm.residual" title="Link to this definition">¶</a></dt>
<dd><p>Returns an UFL form of the term.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>solution</strong> – solution <code class="xref py py-class docutils literal notranslate"><span class="pre">Function</span></code> of the corresponding equation</p></li>
<li><p><strong>solution_old</strong> – a time lagged solution <code class="xref py py-class docutils literal notranslate"><span class="pre">Function</span></code></p></li>
<li><p><strong>fields</strong> – a dictionary that provides all the remaining fields that the term depends on.
The keys of the dictionary should standard field names in <cite>field_metadata</cite></p></li>
<li><p><strong>fields_old</strong> – Time lagged dictionary of fields</p></li>
<li><p><strong>bnd_conditions</strong> – A dictionary describing boundary conditions.
E.g. {3: {‘elev_2d’: Constant(1.0)}} replaces elev_2d function by a constant on boundary ID 3.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="thetis.exner_eq.ExnerEquation">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">thetis.exner_eq.</span></span><span class="sig-name descname"><span class="pre">ExnerEquation</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">function_space</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">depth</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sediment_model</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">depth_integrated_sediment</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/exner_eq.html#ExnerEquation"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#thetis.exner_eq.ExnerEquation" title="Link to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#thetis.equation.Equation" title="thetis.equation.Equation"><code class="xref py py-class docutils literal notranslate"><span class="pre">Equation</span></code></a></p>
<p>Exner equation</p>
<p>2D conservation of mass equation describing bed evolution due to sediment transport</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>function_space</strong> – <code class="xref py py-class docutils literal notranslate"><span class="pre">FunctionSpace</span></code> where the solution belongs</p></li>
<li><p><strong>depth</strong> – <dl class="field-list simple">
<dt class="field-odd">class<span class="colon">:</span></dt>
<dd class="field-odd"><p><cite>DepthExpression</cite> containing depth info</p>
</dd>
</dl>
</p></li>
<li><p><strong>sediment_model</strong> – <dl class="field-list simple">
<dt class="field-odd">class<span class="colon">:</span></dt>
<dd class="field-odd"><p><cite>SedimentModel</cite> containing sediment info</p>
</dd>
</dl>
</p></li>
<li><p><strong>depth_integrated_sediment</strong> (<a class="reference external" href="https://docs.python.org/2.7/library/functions.html#bool" title="(in Python v2.7)"><em>bool</em></a>) – whether to use conservative tracer</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="thetis.exner_eq.ExnerSourceTerm">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">thetis.exner_eq.</span></span><span class="sig-name descname"><span class="pre">ExnerSourceTerm</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">function_space</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">depth</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sediment_model</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">depth_integrated_sediment</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/exner_eq.html#ExnerSourceTerm"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#thetis.exner_eq.ExnerSourceTerm" title="Link to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#thetis.exner_eq.ExnerTerm" title="thetis.exner_eq.ExnerTerm"><code class="xref py py-class docutils literal notranslate"><span class="pre">ExnerTerm</span></code></a></p>
<p>Source term accounting for suspended sediment transport</p>
<p>The weak form reads</p>
<div class="math notranslate nohighlight">
\[F_s = \int_\Omega (\sigma - sediment * \phi) * depth \psi dx\]</div>
<p>where <span class="math notranslate nohighlight">\(\sigma\)</span> is a user defined source scalar field <code class="xref py py-class docutils literal notranslate"><span class="pre">Function</span></code>
and <span class="math notranslate nohighlight">\(\phi\)</span> is a user defined source scalar field <code class="xref py py-class docutils literal notranslate"><span class="pre">Function</span></code>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>function_space</strong> – <code class="xref py py-class docutils literal notranslate"><span class="pre">FunctionSpace</span></code> where the solution belongs</p></li>
<li><p><strong>depth</strong> – <code class="xref py py-class docutils literal notranslate"><span class="pre">DepthExpression</span></code> containing depth info</p></li>
<li><p><strong>sediment_model</strong> – <code class="xref py py-class docutils literal notranslate"><span class="pre">SedimentModel</span></code> containing sediment info</p></li>
<li><p><strong>depth_integrated_sediment</strong> (<a class="reference external" href="https://docs.python.org/2.7/library/functions.html#bool" title="(in Python v2.7)"><em>bool</em></a>) – whether the sediment field is depth-integrated</p></li>
</ul>
</dd>
</dl>
<dl class="py method">
<dt class="sig sig-object py" id="thetis.exner_eq.ExnerSourceTerm.residual">
<span class="sig-name descname"><span class="pre">residual</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">solution</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">solution_old</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fields</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fields_old</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">bnd_conditions</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/exner_eq.html#ExnerSourceTerm.residual"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#thetis.exner_eq.ExnerSourceTerm.residual" title="Link to this definition">¶</a></dt>
<dd><p>Returns an UFL form of the term.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>solution</strong> – solution <code class="xref py py-class docutils literal notranslate"><span class="pre">Function</span></code> of the corresponding equation</p></li>
<li><p><strong>solution_old</strong> – a time lagged solution <code class="xref py py-class docutils literal notranslate"><span class="pre">Function</span></code></p></li>
<li><p><strong>fields</strong> – a dictionary that provides all the remaining fields that the term depends on.
The keys of the dictionary should standard field names in <cite>field_metadata</cite></p></li>
<li><p><strong>fields_old</strong> – Time lagged dictionary of fields</p></li>
<li><p><strong>bnd_conditions</strong> – A dictionary describing boundary conditions.
E.g. {3: {‘elev_2d’: Constant(1.0)}} replaces elev_2d function by a constant on boundary ID 3.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="thetis.exner_eq.ExnerTerm">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">thetis.exner_eq.</span></span><span class="sig-name descname"><span class="pre">ExnerTerm</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">function_space</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">depth</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sediment_model</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">depth_integrated_sediment</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/exner_eq.html#ExnerTerm"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#thetis.exner_eq.ExnerTerm" title="Link to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#thetis.equation.Term" title="thetis.equation.Term"><code class="xref py py-class docutils literal notranslate"><span class="pre">Term</span></code></a></p>
<p>Generic term in the Exner equations that provides commonly used members
There are no boundary conditions for the Exner equation.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>function_space</strong> – <code class="xref py py-class docutils literal notranslate"><span class="pre">FunctionSpace</span></code> where the solution belongs</p></li>
<li><p><strong>depth</strong> – <code class="xref py py-class docutils literal notranslate"><span class="pre">DepthExpression</span></code> containing depth info</p></li>
<li><p><strong>sediment_model</strong> – <code class="xref py py-class docutils literal notranslate"><span class="pre">SedimentModel</span></code> containing sediment info</p></li>
<li><p><strong>depth_integrated_sediment</strong> (<a class="reference external" href="https://docs.python.org/2.7/library/functions.html#bool" title="(in Python v2.7)"><em>bool</em></a>) – whether the sediment field is depth-integrated</p></li>
</ul>
</dd>
</dl>
</dd></dl>

</section>
<section id="module-thetis.exporter">
<span id="thetis-exporter-module"></span><h2>thetis.exporter module<a class="headerlink" href="#module-thetis.exporter" title="Link to this heading">¶</a></h2>
<p>Routines for handling file exports.</p>
<dl class="py class">
<dt class="sig sig-object py" id="thetis.exporter.ExportManager">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">thetis.exporter.</span></span><span class="sig-name descname"><span class="pre">ExportManager</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">outputdir</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fields_to_export</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">functions</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">field_metadata</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">export_type</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'vtk'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">next_export_ix</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">verbose</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">legacy_mode</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">preproc_funcs</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">{}</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/exporter.html#ExportManager"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#thetis.exporter.ExportManager" title="Link to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference external" href="https://docs.python.org/2.7/library/functions.html#object" title="(in Python v2.7)"><code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></a></p>
<p>Helper object for exporting multiple fields simultaneously</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span><span class="w"> </span><span class="nn">.field_defs</span><span class="w"> </span><span class="kn">import</span> <span class="n">field_metadata</span>
<span class="n">field_dict</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;elev_2d&#39;</span><span class="p">:</span> <span class="n">Function</span><span class="p">(</span><span class="o">...</span><span class="p">),</span> <span class="s1">&#39;uv_3d&#39;</span><span class="p">:</span> <span class="n">Function</span><span class="p">(</span><span class="o">...</span><span class="p">),</span> <span class="o">...</span><span class="p">}</span>
<span class="n">e</span> <span class="o">=</span> <span class="n">exporter</span><span class="o">.</span><span class="n">ExportManager</span><span class="p">(</span><span class="s1">&#39;mydirectory&#39;</span><span class="p">,</span>
                           <span class="p">[</span><span class="s1">&#39;elev_2d&#39;</span><span class="p">,</span> <span class="s1">&#39;uv_3d&#39;</span><span class="p">,</span> <span class="n">salt_3d</span><span class="s1">&#39;],</span>
                           <span class="n">field_dict</span><span class="p">,</span>
                           <span class="n">field_metadata</span><span class="p">,</span>
                           <span class="n">export_type</span><span class="o">=</span><span class="s1">&#39;vtk&#39;</span><span class="p">)</span>
<span class="n">e</span><span class="o">.</span><span class="n">export</span><span class="p">()</span>
</pre></div>
</div>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>outputdir</strong> (<em>string</em>) – directory where files are stored</p></li>
<li><p><strong>fields_to_export</strong> (<em>list</em><em> of </em><em>strings</em>) – list of fields to export</p></li>
<li><p><strong>functions</strong> – dict that contains all existing <code class="xref py py-class docutils literal notranslate"><span class="pre">Function</span></code> s</p></li>
<li><p><strong>field_metadata</strong> – dict of all field metadata.
See <a class="reference internal" href="#module-thetis.field_defs" title="thetis.field_defs"><code class="xref py py-mod docutils literal notranslate"><span class="pre">field_defs</span></code></a></p></li>
<li><p><strong>export_type</strong> (<a class="reference external" href="https://docs.python.org/2.7/library/functions.html#str" title="(in Python v2.7)"><em>str</em></a>) – export format, either ‘vtk’ or ‘hdf5’</p></li>
<li><p><strong>next_export_ix</strong> (<a class="reference external" href="https://docs.python.org/2.7/library/functions.html#int" title="(in Python v2.7)"><em>int</em></a>) – index for next export (default 0)</p></li>
<li><p><strong>verbose</strong> (<a class="reference external" href="https://docs.python.org/2.7/library/functions.html#bool" title="(in Python v2.7)"><em>bool</em></a>) – print debug info to stdout</p></li>
<li><p><strong>legacy_mode</strong> (<a class="reference external" href="https://docs.python.org/2.7/library/functions.html#bool" title="(in Python v2.7)"><em>bool</em></a>) – use legacy <cite>DumbCheckpoint</cite> hdf5 format</p></li>
</ul>
</dd>
</dl>
<dl class="py method">
<dt class="sig sig-object py" id="thetis.exporter.ExportManager.add_export">
<span class="sig-name descname"><span class="pre">add_export</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">fieldname</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">function</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">export_type</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'vtk'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">next_export_ix</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">outputdir</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">shortname</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">filename</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">legacy_mode</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">preproc_func</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/exporter.html#ExportManager.add_export"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#thetis.exporter.ExportManager.add_export" title="Link to this definition">¶</a></dt>
<dd><p>Adds a new field exporter in the manager.</p>
<p>This method allows exporting both default Thetis fields and user
defined fields. In the latter case the user must provide sufficient
metadata, i.e. fieldname, shortname and filename.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>fieldname</strong> (<em>string</em>) – canonical field name</p></li>
<li><p><strong>function</strong> – Firedrake function to export</p></li>
<li><p><strong>export_type</strong> (<a class="reference external" href="https://docs.python.org/2.7/library/functions.html#str" title="(in Python v2.7)"><em>str</em></a>) – export format, either ‘vtk’ or ‘hdf5’</p></li>
<li><p><strong>next_export_ix</strong> (<a class="reference external" href="https://docs.python.org/2.7/library/functions.html#int" title="(in Python v2.7)"><em>int</em></a>) – index for next export (default 0)</p></li>
<li><p><strong>outputdir</strong> (<em>string</em>) – optional directory where files are stored</p></li>
<li><p><strong>shortname</strong> (<em>string</em>) – override shortname defined in field_metadata</p></li>
<li><p><strong>filename</strong> (<em>string</em>) – override filename defined in field_metadata</p></li>
<li><p><strong>legacy_mode</strong> (<a class="reference external" href="https://docs.python.org/2.7/library/functions.html#bool" title="(in Python v2.7)"><em>bool</em></a>) – use legacy <cite>DumbCheckpoint</cite> hdf5 format</p></li>
<li><p><strong>preproc_func</strong> – optional funtion that will be called prior to
exporting. E.g. for computing diagnostic fields.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="thetis.exporter.ExportManager.export">
<span class="sig-name descname"><span class="pre">export</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/exporter.html#ExportManager.export"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#thetis.exporter.ExportManager.export" title="Link to this definition">¶</a></dt>
<dd><p>Export all designated functions to disk</p>
<p>Increments export index by 1.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="thetis.exporter.ExportManager.export_bathymetry">
<span class="sig-name descname"><span class="pre">export_bathymetry</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">bathymetry_2d</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/exporter.html#ExportManager.export_bathymetry"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#thetis.exporter.ExportManager.export_bathymetry" title="Link to this definition">¶</a></dt>
<dd><p>Special function to export 2D bathymetry data to disk</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>bathymetry_2d</strong> – 2D bathymetry <code class="xref py py-class docutils literal notranslate"><span class="pre">Function</span></code></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="thetis.exporter.ExportManager.set_next_export_ix">
<span class="sig-name descname"><span class="pre">set_next_export_ix</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">next_export_ix</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/exporter.html#ExportManager.set_next_export_ix"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#thetis.exporter.ExportManager.set_next_export_ix" title="Link to this definition">¶</a></dt>
<dd><p>Set export index to all child exporters</p>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="thetis.exporter.ExporterBase">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">thetis.exporter.</span></span><span class="sig-name descname"><span class="pre">ExporterBase</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">filename</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">outputdir</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">next_export_ix</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">verbose</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/exporter.html#ExporterBase"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#thetis.exporter.ExporterBase" title="Link to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference external" href="https://docs.python.org/2.7/library/functions.html#object" title="(in Python v2.7)"><code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></a></p>
<p>Base class for exporter objects.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>filename</strong> (<em>string</em>) – output file name (without directory)</p></li>
<li><p><strong>outputdir</strong> (<em>string</em>) – directory where file is stored</p></li>
<li><p><strong>next_export_ix</strong> (<a class="reference external" href="https://docs.python.org/2.7/library/functions.html#int" title="(in Python v2.7)"><em>int</em></a>) – set the index for next output</p></li>
<li><p><strong>verbose</strong> (<a class="reference external" href="https://docs.python.org/2.7/library/functions.html#bool" title="(in Python v2.7)"><em>bool</em></a>) – print debug info to stdout</p></li>
</ul>
</dd>
</dl>
<dl class="py method">
<dt class="sig sig-object py" id="thetis.exporter.ExporterBase.export">
<span class="sig-name descname"><span class="pre">export</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">function</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/exporter.html#ExporterBase.export"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#thetis.exporter.ExporterBase.export" title="Link to this definition">¶</a></dt>
<dd><p>Exports given function to disk</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="thetis.exporter.ExporterBase.set_next_export_ix">
<span class="sig-name descname"><span class="pre">set_next_export_ix</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">next_export_ix</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/exporter.html#ExporterBase.set_next_export_ix"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#thetis.exporter.ExporterBase.set_next_export_ix" title="Link to this definition">¶</a></dt>
<dd><p>Sets the index of next export</p>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="thetis.exporter.HDF5Exporter">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">thetis.exporter.</span></span><span class="sig-name descname"><span class="pre">HDF5Exporter</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">function_space</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">outputdir</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">filename_prefix</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">next_export_ix</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">legacy_mode</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">verbose</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/exporter.html#HDF5Exporter"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#thetis.exporter.HDF5Exporter" title="Link to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#thetis.exporter.ExporterBase" title="thetis.exporter.ExporterBase"><code class="xref py py-class docutils literal notranslate"><span class="pre">ExporterBase</span></code></a></p>
<p>Stores fields in disk in native discretization using HDF5 containers</p>
<p>Create exporter object for given function.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>function_space</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">FunctionSpace</span></code>) – space where the exported functions belong</p></li>
<li><p><strong>outputdir</strong> (<em>string</em>) – directory where outputs will be stored</p></li>
<li><p><strong>filename_prefix</strong> (<em>string</em>) – prefix of output filename. Filename is
prefix_nnnnn.h5 where nnnnn is the export number.</p></li>
<li><p><strong>next_export_ix</strong> (<a class="reference external" href="https://docs.python.org/2.7/library/functions.html#int" title="(in Python v2.7)"><em>int</em></a>) – index for next export (default 0)</p></li>
<li><p><strong>legacy_mode</strong> (<a class="reference external" href="https://docs.python.org/2.7/library/functions.html#bool" title="(in Python v2.7)"><em>bool</em></a>) – use legacy DumbCheckpoint format</p></li>
<li><p><strong>verbose</strong> (<a class="reference external" href="https://docs.python.org/2.7/library/functions.html#bool" title="(in Python v2.7)"><em>bool</em></a>) – print debug info to stdout</p></li>
</ul>
</dd>
</dl>
<dl class="py method">
<dt class="sig sig-object py" id="thetis.exporter.HDF5Exporter.export">
<span class="sig-name descname"><span class="pre">export</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">function</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/exporter.html#HDF5Exporter.export"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#thetis.exporter.HDF5Exporter.export" title="Link to this definition">¶</a></dt>
<dd><p>Export function to disk.</p>
<p>Increments export index by 1.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>function</strong> – <code class="xref py py-class docutils literal notranslate"><span class="pre">Function</span></code> to export</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="thetis.exporter.HDF5Exporter.export_as_index">
<span class="sig-name descname"><span class="pre">export_as_index</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">iexport</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">function</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/exporter.html#HDF5Exporter.export_as_index"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#thetis.exporter.HDF5Exporter.export_as_index" title="Link to this definition">¶</a></dt>
<dd><p>Export function to disk using the specified export index number</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>iexport</strong> (<a class="reference external" href="https://docs.python.org/2.7/library/functions.html#int" title="(in Python v2.7)"><em>int</em></a>) – export index &gt;= 0</p></li>
<li><p><strong>function</strong> – <code class="xref py py-class docutils literal notranslate"><span class="pre">Function</span></code> to export</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="thetis.exporter.HDF5Exporter.gen_filename">
<span class="sig-name descname"><span class="pre">gen_filename</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">iexport</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/exporter.html#HDF5Exporter.gen_filename"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#thetis.exporter.HDF5Exporter.gen_filename" title="Link to this definition">¶</a></dt>
<dd><p>Generate file name ‘prefix_nnnnn.h5’ for i-th export</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>iexport</strong> (<a class="reference external" href="https://docs.python.org/2.7/library/functions.html#int" title="(in Python v2.7)"><em>int</em></a>) – export index &gt;= 0</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="thetis.exporter.HDF5Exporter.load">
<span class="sig-name descname"><span class="pre">load</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">iexport</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">function</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/exporter.html#HDF5Exporter.load"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#thetis.exporter.HDF5Exporter.load" title="Link to this definition">¶</a></dt>
<dd><p>Loads nodal values from disk and assigns to the given function</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>iexport</strong> (<a class="reference external" href="https://docs.python.org/2.7/library/functions.html#int" title="(in Python v2.7)"><em>int</em></a>) – export index &gt;= 0</p></li>
<li><p><strong>function</strong> – target <code class="xref py py-class docutils literal notranslate"><span class="pre">Function</span></code></p></li>
</ul>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="thetis.exporter.VTKExporter">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">thetis.exporter.</span></span><span class="sig-name descname"><span class="pre">VTKExporter</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">fs_visu</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">func_name</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">outputdir</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">filename</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">next_export_ix</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">project_output</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">verbose</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/exporter.html#VTKExporter"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#thetis.exporter.VTKExporter" title="Link to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#thetis.exporter.ExporterBase" title="thetis.exporter.ExporterBase"><code class="xref py py-class docutils literal notranslate"><span class="pre">ExporterBase</span></code></a></p>
<p>Class that handles Paraview VTK file exports</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>fs_visu</strong> – function space where input function will be cast
before exporting</p></li>
<li><p><strong>func_name</strong> – name of the function</p></li>
<li><p><strong>outputdir</strong> – output directory</p></li>
<li><p><strong>filename</strong> – name of the pvd file</p></li>
<li><p><strong>next_export_ix</strong> (<a class="reference external" href="https://docs.python.org/2.7/library/functions.html#int" title="(in Python v2.7)"><em>int</em></a>) – index for next export (default 0)</p></li>
<li><p><strong>project_output</strong> (<a class="reference external" href="https://docs.python.org/2.7/library/functions.html#bool" title="(in Python v2.7)"><em>bool</em></a>) – project function to output space instead of
interpolating</p></li>
<li><p><strong>verbose</strong> (<a class="reference external" href="https://docs.python.org/2.7/library/functions.html#bool" title="(in Python v2.7)"><em>bool</em></a>) – print debug info to stdout</p></li>
</ul>
</dd>
</dl>
<dl class="py method">
<dt class="sig sig-object py" id="thetis.exporter.VTKExporter.export">
<span class="sig-name descname"><span class="pre">export</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">function</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/exporter.html#VTKExporter.export"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#thetis.exporter.VTKExporter.export" title="Link to this definition">¶</a></dt>
<dd><p>Exports given function to disk</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="thetis.exporter.VTKExporter.set_next_export_ix">
<span class="sig-name descname"><span class="pre">set_next_export_ix</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">next_export_ix</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/exporter.html#VTKExporter.set_next_export_ix"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#thetis.exporter.VTKExporter.set_next_export_ix" title="Link to this definition">¶</a></dt>
<dd><p>Sets the index of next export</p>
</dd></dl>

</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="thetis.exporter.get_visu_space">
<span class="sig-prename descclassname"><span class="pre">thetis.exporter.</span></span><span class="sig-name descname"><span class="pre">get_visu_space</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">fs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/exporter.html#get_visu_space"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#thetis.exporter.get_visu_space" title="Link to this definition">¶</a></dt>
<dd><p>Returns an appropriate VTK visualization space for a function space</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>fs</strong> – function space</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>function space for VTK visualization</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="thetis.exporter.is_2d">
<span class="sig-prename descclassname"><span class="pre">thetis.exporter.</span></span><span class="sig-name descname"><span class="pre">is_2d</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">fs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/exporter.html#is_2d"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#thetis.exporter.is_2d" title="Link to this definition">¶</a></dt>
<dd><p>Tests wether a function space is 2D or 3D</p>
</dd></dl>

</section>
<section id="module-thetis.field_defs">
<span id="thetis-field-defs-module"></span><h2>thetis.field_defs module<a class="headerlink" href="#module-thetis.field_defs" title="Link to this heading">¶</a></h2>
<p>Definitions and meta data of fields</p>
<dl class="py data">
<dt class="sig sig-object py" id="thetis.field_defs.field_metadata">
<span class="sig-prename descclassname"><span class="pre">thetis.field_defs.</span></span><span class="sig-name descname"><span class="pre">field_metadata</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">{'baroc_head_3d':</span> <span class="pre">{'filename':</span> <span class="pre">'BaroHead3d',</span> <span class="pre">'name':</span> <span class="pre">'Baroclinic</span> <span class="pre">head',</span> <span class="pre">'shortname':</span> <span class="pre">'Baroclinic</span> <span class="pre">head',</span> <span class="pre">'unit':</span> <span class="pre">'m'},</span> <span class="pre">'bathymetry_2d':</span> <span class="pre">{'filename':</span> <span class="pre">'bathymetry2d',</span> <span class="pre">'name':</span> <span class="pre">'Bathymetry',</span> <span class="pre">'shortname':</span> <span class="pre">'Bathymetry',</span> <span class="pre">'unit':</span> <span class="pre">'m'},</span> <span class="pre">'buoy_freq_3d':</span> <span class="pre">{'filename':</span> <span class="pre">'BuoyFreq3d',</span> <span class="pre">'name':</span> <span class="pre">'Buoyancy</span> <span class="pre">frequency</span> <span class="pre">squared',</span> <span class="pre">'shortname':</span> <span class="pre">'Buoyancy</span> <span class="pre">frequency</span> <span class="pre">squared',</span> <span class="pre">'unit':</span> <span class="pre">'s-2'},</span> <span class="pre">'coriolis_2d':</span> <span class="pre">{'filename':</span> <span class="pre">'coriolis_2d',</span> <span class="pre">'name':</span> <span class="pre">'Coriolis</span> <span class="pre">parameter',</span> <span class="pre">'shortname':</span> <span class="pre">'Coriolis</span> <span class="pre">parameter',</span> <span class="pre">'unit':</span> <span class="pre">'s-1'},</span> <span class="pre">'coriolis_3d':</span> <span class="pre">{'filename':</span> <span class="pre">'coriolis_3d',</span> <span class="pre">'name':</span> <span class="pre">'Coriolis</span> <span class="pre">parameter',</span> <span class="pre">'shortname':</span> <span class="pre">'Coriolis</span> <span class="pre">parameter',</span> <span class="pre">'unit':</span> <span class="pre">'s-1'},</span> <span class="pre">'density_3d':</span> <span class="pre">{'filename':</span> <span class="pre">'Density3d',</span> <span class="pre">'name':</span> <span class="pre">'Water</span> <span class="pre">density',</span> <span class="pre">'shortname':</span> <span class="pre">'Density',</span> <span class="pre">'unit':</span> <span class="pre">'kg</span> <span class="pre">m-3'},</span> <span class="pre">'eddy_diff_3d':</span> <span class="pre">{'filename':</span> <span class="pre">'EddyDiff3d',</span> <span class="pre">'name':</span> <span class="pre">'Eddy</span> <span class="pre">diffusivity',</span> <span class="pre">'shortname':</span> <span class="pre">'Eddy</span> <span class="pre">diffusivity',</span> <span class="pre">'unit':</span> <span class="pre">'m2</span> <span class="pre">s-1'},</span> <span class="pre">'eddy_visc_3d':</span> <span class="pre">{'filename':</span> <span class="pre">'EddyVisc3d',</span> <span class="pre">'name':</span> <span class="pre">'Eddy</span> <span class="pre">Viscosity',</span> <span class="pre">'shortname':</span> <span class="pre">'Eddy</span> <span class="pre">Viscosity',</span> <span class="pre">'unit':</span> <span class="pre">'m2</span> <span class="pre">s-1'},</span> <span class="pre">'elev_2d':</span> <span class="pre">{'filename':</span> <span class="pre">'Elevation2d',</span> <span class="pre">'name':</span> <span class="pre">'Water</span> <span class="pre">elevation',</span> <span class="pre">'shortname':</span> <span class="pre">'Elevation',</span> <span class="pre">'unit':</span> <span class="pre">'m'},</span> <span class="pre">'elev_cg_2d':</span> <span class="pre">{'filename':</span> <span class="pre">'ElevationCG2d',</span> <span class="pre">'name':</span> <span class="pre">'Water</span> <span class="pre">elevation</span> <span class="pre">CG',</span> <span class="pre">'shortname':</span> <span class="pre">'Elevation',</span> <span class="pre">'unit':</span> <span class="pre">'m'},</span> <span class="pre">'elev_domain_2d':</span> <span class="pre">{'filename':</span> <span class="pre">'ElevationDomain2d',</span> <span class="pre">'name':</span> <span class="pre">'Surface</span> <span class="pre">elevation</span> <span class="pre">of</span> <span class="pre">domain',</span> <span class="pre">'shortname':</span> <span class="pre">'Elevation',</span> <span class="pre">'unit':</span> <span class="pre">'m'},</span> <span class="pre">'eps_3d':</span> <span class="pre">{'filename':</span> <span class="pre">'TurbEps3d',</span> <span class="pre">'name':</span> <span class="pre">'TKE</span> <span class="pre">dissipation</span> <span class="pre">rate',</span> <span class="pre">'shortname':</span> <span class="pre">'TKE</span> <span class="pre">dissipation</span> <span class="pre">rate',</span> <span class="pre">'unit':</span> <span class="pre">'m2</span> <span class="pre">s-3'},</span> <span class="pre">'h_elem_size_2d':</span> <span class="pre">{'filename':</span> <span class="pre">'h_elem_size_2d',</span> <span class="pre">'name':</span> <span class="pre">'Element</span> <span class="pre">size</span> <span class="pre">in</span> <span class="pre">horizontal</span> <span class="pre">direction',</span> <span class="pre">'shortname':</span> <span class="pre">'Horizontal</span> <span class="pre">element</span> <span class="pre">size',</span> <span class="pre">'unit':</span> <span class="pre">'m'},</span> <span class="pre">'h_elem_size_3d':</span> <span class="pre">{'filename':</span> <span class="pre">'h_elem_size_3d',</span> <span class="pre">'name':</span> <span class="pre">'Element</span> <span class="pre">size</span> <span class="pre">in</span> <span class="pre">horizontal</span> <span class="pre">direction',</span> <span class="pre">'shortname':</span> <span class="pre">'Horizontal</span> <span class="pre">element</span> <span class="pre">size',</span> <span class="pre">'unit':</span> <span class="pre">'m'},</span> <span class="pre">'hcc_metric_3d':</span> <span class="pre">{'filename':</span> <span class="pre">'HCCMetric3d',</span> <span class="pre">'name':</span> <span class="pre">'HCC</span> <span class="pre">mesh</span> <span class="pre">quality',</span> <span class="pre">'shortname':</span> <span class="pre">'HCC</span> <span class="pre">metric',</span> <span class="pre">'unit':</span> <span class="pre">'-'},</span> <span class="pre">'int_pg_3d':</span> <span class="pre">{'filename':</span> <span class="pre">'IntPG3d',</span> <span class="pre">'name':</span> <span class="pre">'Internal</span> <span class="pre">pressure</span> <span class="pre">gradient',</span> <span class="pre">'shortname':</span> <span class="pre">'Int.</span> <span class="pre">Pressure</span> <span class="pre">gradient',</span> <span class="pre">'unit':</span> <span class="pre">'m</span> <span class="pre">s-2'},</span> <span class="pre">'len_3d':</span> <span class="pre">{'filename':</span> <span class="pre">'TurbLen3d',</span> <span class="pre">'name':</span> <span class="pre">'Turbulent</span> <span class="pre">length</span> <span class="pre">scale',</span> <span class="pre">'shortname':</span> <span class="pre">'Turbulent</span> <span class="pre">length</span> <span class="pre">scale',</span> <span class="pre">'unit':</span> <span class="pre">'m'},</span> <span class="pre">'max_h_diff':</span> <span class="pre">{'filename':</span> <span class="pre">'MaxHDiffusivity3d',</span> <span class="pre">'name':</span> <span class="pre">'Maximum</span> <span class="pre">stable</span> <span class="pre">horizontal</span> <span class="pre">diffusivity',</span> <span class="pre">'shortname':</span> <span class="pre">'Maximum</span> <span class="pre">horizontal</span> <span class="pre">diffusivity',</span> <span class="pre">'unit':</span> <span class="pre">'m2</span> <span class="pre">s-1'},</span> <span class="pre">'psi_3d':</span> <span class="pre">{'filename':</span> <span class="pre">'TurbPsi3d',</span> <span class="pre">'name':</span> <span class="pre">'Turbulence</span> <span class="pre">psi</span> <span class="pre">variable',</span> <span class="pre">'shortname':</span> <span class="pre">'Turbulence</span> <span class="pre">psi</span> <span class="pre">variable',</span> <span class="pre">'unit':</span> <span class="pre">''},</span> <span class="pre">'q_2d':</span> <span class="pre">{'filename':</span> <span class="pre">'NHPressure2d',</span> <span class="pre">'name':</span> <span class="pre">'Non-hydrostatic</span> <span class="pre">pressure</span> <span class="pre">at</span> <span class="pre">bottom',</span> <span class="pre">'shortname':</span> <span class="pre">'NH</span> <span class="pre">pressure',</span> <span class="pre">'unit':</span> <span class="pre">'Pa'},</span> <span class="pre">'salt_3d':</span> <span class="pre">{'filename':</span> <span class="pre">'Salinity3d',</span> <span class="pre">'name':</span> <span class="pre">'Water</span> <span class="pre">salinity',</span> <span class="pre">'shortname':</span> <span class="pre">'Salinity',</span> <span class="pre">'unit':</span> <span class="pre">'psu'},</span> <span class="pre">'sediment_2d':</span> <span class="pre">{'filename':</span> <span class="pre">'Sediment2d',</span> <span class="pre">'name':</span> <span class="pre">'Sediment',</span> <span class="pre">'shortname':</span> <span class="pre">'Sediment',</span> <span class="pre">'unit':</span> <span class="pre">''},</span> <span class="pre">'shear_freq_3d':</span> <span class="pre">{'filename':</span> <span class="pre">'ShearFreq3d',</span> <span class="pre">'name':</span> <span class="pre">'Vertical</span> <span class="pre">shear</span> <span class="pre">frequency</span> <span class="pre">squared',</span> <span class="pre">'shortname':</span> <span class="pre">'Vertical</span> <span class="pre">shear</span> <span class="pre">frequency</span> <span class="pre">squared',</span> <span class="pre">'unit':</span> <span class="pre">'s-2'},</span> <span class="pre">'smag_visc_3d':</span> <span class="pre">{'filename':</span> <span class="pre">'SmagViscosity3d',</span> <span class="pre">'name':</span> <span class="pre">'Smagorinsky</span> <span class="pre">viscosity',</span> <span class="pre">'shortname':</span> <span class="pre">'Smagorinsky</span> <span class="pre">viscosity',</span> <span class="pre">'unit':</span> <span class="pre">'m2</span> <span class="pre">s-1'},</span> <span class="pre">'split_residual_2d':</span> <span class="pre">{'filename':</span> <span class="pre">'SplitResidual2d',</span> <span class="pre">'name':</span> <span class="pre">'Momentum</span> <span class="pre">eq.</span> <span class="pre">residual</span> <span class="pre">for</span> <span class="pre">mode</span> <span class="pre">splitting',</span> <span class="pre">'shortname':</span> <span class="pre">'Momentum</span> <span class="pre">residual',</span> <span class="pre">'unit':</span> <span class="pre">'m</span> <span class="pre">s-2'},</span> <span class="pre">'temp_3d':</span> <span class="pre">{'filename':</span> <span class="pre">'Temperature3d',</span> <span class="pre">'name':</span> <span class="pre">'Water</span> <span class="pre">temperature',</span> <span class="pre">'shortname':</span> <span class="pre">'Temperature',</span> <span class="pre">'unit':</span> <span class="pre">'C'},</span> <span class="pre">'tke_3d':</span> <span class="pre">{'filename':</span> <span class="pre">'TurbKEnergy3d',</span> <span class="pre">'name':</span> <span class="pre">'Turbulent</span> <span class="pre">Kinetic</span> <span class="pre">Energy',</span> <span class="pre">'shortname':</span> <span class="pre">'Turbulent</span> <span class="pre">Kinetic</span> <span class="pre">Energy',</span> <span class="pre">'unit':</span> <span class="pre">'m2</span> <span class="pre">s-2'},</span> <span class="pre">'turbine_density_2d':</span> <span class="pre">{'filename':</span> <span class="pre">'turbine_density_2d',</span> <span class="pre">'name':</span> <span class="pre">'Turbine</span> <span class="pre">density',</span> <span class="pre">'shortname':</span> <span class="pre">'Turbine</span> <span class="pre">density',</span> <span class="pre">'unit':</span> <span class="pre">'m-2'},</span> <span class="pre">'uv_2d':</span> <span class="pre">{'filename':</span> <span class="pre">'Velocity2d',</span> <span class="pre">'name':</span> <span class="pre">'Depth</span> <span class="pre">averaged</span> <span class="pre">velocity',</span> <span class="pre">'shortname':</span> <span class="pre">'Depth</span> <span class="pre">averaged</span> <span class="pre">velocity',</span> <span class="pre">'unit':</span> <span class="pre">'m</span> <span class="pre">s-1'},</span> <span class="pre">'uv_3d':</span> <span class="pre">{'filename':</span> <span class="pre">'Velocity3d',</span> <span class="pre">'name':</span> <span class="pre">'Horizontal</span> <span class="pre">velocity',</span> <span class="pre">'shortname':</span> <span class="pre">'Horizontal</span> <span class="pre">velocity',</span> <span class="pre">'unit':</span> <span class="pre">'m</span> <span class="pre">s-1'},</span> <span class="pre">'uv_dav_2d':</span> <span class="pre">{'filename':</span> <span class="pre">'DAVelocity2d',</span> <span class="pre">'name':</span> <span class="pre">'Depth</span> <span class="pre">averaged</span> <span class="pre">velocity',</span> <span class="pre">'shortname':</span> <span class="pre">'Depth</span> <span class="pre">averaged</span> <span class="pre">velocity',</span> <span class="pre">'unit':</span> <span class="pre">'m</span> <span class="pre">s-1'},</span> <span class="pre">'uv_dav_3d':</span> <span class="pre">{'filename':</span> <span class="pre">'DAVelocity3d',</span> <span class="pre">'name':</span> <span class="pre">'Depth</span> <span class="pre">averaged</span> <span class="pre">velocity',</span> <span class="pre">'shortname':</span> <span class="pre">'Depth</span> <span class="pre">averaged</span> <span class="pre">velocity',</span> <span class="pre">'unit':</span> <span class="pre">'m</span> <span class="pre">s-1'},</span> <span class="pre">'v_elem_size_2d':</span> <span class="pre">{'filename':</span> <span class="pre">'VElemSize2d',</span> <span class="pre">'name':</span> <span class="pre">'Element</span> <span class="pre">size</span> <span class="pre">in</span> <span class="pre">vertical</span> <span class="pre">direction',</span> <span class="pre">'shortname':</span> <span class="pre">'Vertical</span> <span class="pre">element</span> <span class="pre">size',</span> <span class="pre">'unit':</span> <span class="pre">'m'},</span> <span class="pre">'v_elem_size_3d':</span> <span class="pre">{'filename':</span> <span class="pre">'VElemSize3d',</span> <span class="pre">'name':</span> <span class="pre">'Element</span> <span class="pre">size</span> <span class="pre">in</span> <span class="pre">vertical</span> <span class="pre">direction',</span> <span class="pre">'shortname':</span> <span class="pre">'Vertical</span> <span class="pre">element</span> <span class="pre">size',</span> <span class="pre">'unit':</span> <span class="pre">'m'},</span> <span class="pre">'w_2d':</span> <span class="pre">{'filename':</span> <span class="pre">'VertVelo2d',</span> <span class="pre">'name':</span> <span class="pre">'Depth</span> <span class="pre">averaged</span> <span class="pre">vertical</span> <span class="pre">velocity',</span> <span class="pre">'shortname':</span> <span class="pre">'Depth</span> <span class="pre">averaged</span> <span class="pre">vertical</span> <span class="pre">velocity',</span> <span class="pre">'unit':</span> <span class="pre">'m</span> <span class="pre">s-1'},</span> <span class="pre">'w_3d':</span> <span class="pre">{'filename':</span> <span class="pre">'VertVelo3d',</span> <span class="pre">'name':</span> <span class="pre">'Vertical</span> <span class="pre">velocity',</span> <span class="pre">'shortname':</span> <span class="pre">'Vertical</span> <span class="pre">velocity',</span> <span class="pre">'unit':</span> <span class="pre">'m</span> <span class="pre">s-1'},</span> <span class="pre">'w_mesh_3d':</span> <span class="pre">{'filename':</span> <span class="pre">'MeshVelo3d',</span> <span class="pre">'name':</span> <span class="pre">'Mesh</span> <span class="pre">velocity',</span> <span class="pre">'shortname':</span> <span class="pre">'Mesh</span> <span class="pre">velocity',</span> <span class="pre">'unit':</span> <span class="pre">'m</span> <span class="pre">s-1'},</span> <span class="pre">'wind_stress_3d':</span> <span class="pre">{'filename':</span> <span class="pre">'wind_stress_3d',</span> <span class="pre">'name':</span> <span class="pre">'Wind</span> <span class="pre">stress',</span> <span class="pre">'shortname':</span> <span class="pre">'Wind</span> <span class="pre">stress',</span> <span class="pre">'unit':</span> <span class="pre">'Pa'},</span> <span class="pre">'z_coord_3d':</span> <span class="pre">{'filename':</span> <span class="pre">'ZCoord3d',</span> <span class="pre">'name':</span> <span class="pre">'Mesh</span> <span class="pre">z</span> <span class="pre">coordinates',</span> <span class="pre">'shortname':</span> <span class="pre">'Z</span> <span class="pre">coordinates',</span> <span class="pre">'unit':</span> <span class="pre">'m'},</span> <span class="pre">'z_coord_ref_3d':</span> <span class="pre">{'filename':</span> <span class="pre">'ZCoordRef3d',</span> <span class="pre">'name':</span> <span class="pre">'Static</span> <span class="pre">mesh</span> <span class="pre">z</span> <span class="pre">coordinates',</span> <span class="pre">'shortname':</span> <span class="pre">'Z</span> <span class="pre">coordinates',</span> <span class="pre">'unit':</span> <span class="pre">'m'}}</span></em><a class="headerlink" href="#thetis.field_defs.field_metadata" title="Link to this definition">¶</a></dt>
<dd><p>Dictionary that contains the meta data of each field.</p>
<p>Required meta data entries are:</p>
<ul class="simple">
<li><p><strong>name</strong>: human readable description</p></li>
<li><p><strong>shortname</strong>: description used in visualization etc</p></li>
<li><p><strong>unit</strong>: SI unit of the field</p></li>
<li><p><strong>filename</strong>: filename for output files</p></li>
</ul>
<p>The naming convention for field keys is snake_case: <code class="docutils literal notranslate"><span class="pre">field_name_3d</span></code></p>
</dd></dl>

</section>
<section id="module-thetis.forcing">
<span id="thetis-forcing-module"></span><h2>thetis.forcing module<a class="headerlink" href="#module-thetis.forcing" title="Link to this heading">¶</a></h2>
<p>Routines for interpolating forcing fields for the 3D solver.</p>
<dl class="py class">
<dt class="sig sig-object py" id="thetis.forcing.ATMInterpolator">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">thetis.forcing.</span></span><span class="sig-name descname"><span class="pre">ATMInterpolator</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">function_space</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">wind_stress_field</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">atm_pressure_field</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">coord_system</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ncfile_pattern</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">init_date</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">vect_rotator</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">east_wind_var_name</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'uwind'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">north_wind_var_name</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'vwind'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">pressure_var_name</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'prmsl'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">time_variable_name</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'time'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fill_mode</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fill_value</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">nan</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">verbose</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/forcing.html#ATMInterpolator"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#thetis.forcing.ATMInterpolator" title="Link to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference external" href="https://docs.python.org/2.7/library/functions.html#object" title="(in Python v2.7)"><code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></a></p>
<p>Interpolates WRF/NAM atmospheric model data on 2D fields.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>function_space</strong> – Target (scalar) <code class="xref py py-class docutils literal notranslate"><span class="pre">FunctionSpace</span></code> object onto
which data will be interpolated.</p></li>
<li><p><strong>wind_stress_field</strong> – A 2D vector <code class="xref py py-class docutils literal notranslate"><span class="pre">Function</span></code> where the output
wind stress will be stored.</p></li>
<li><p><strong>atm_pressure_field</strong> – A 2D scalar <code class="xref py py-class docutils literal notranslate"><span class="pre">Function</span></code> where the output
atmospheric pressure will be stored.</p></li>
<li><p><strong>coord_system</strong> – <code class="xref py py-class docutils literal notranslate"><span class="pre">CoordinateSystem</span></code> object</p></li>
<li><p><strong>ncfile_pattern</strong> – A file name pattern for reading the atmospheric
model output files. E.g. ‘forcings/nam_air.local.2006_*.nc’</p></li>
<li><p><strong>init_date</strong> – A <code class="xref py py-class docutils literal notranslate"><span class="pre">datetime</span></code> object that indicates the start
date/time of the Thetis simulation. Must contain time zone. E.g.
‘datetime(2006, 5, 1, tzinfo=pytz.utc)’</p></li>
<li><p><strong>vect_rotator</strong> – function that rotates vectors from ENU coordinates
to target function space (optional).</p></li>
<li><p><strong>pressure_var_name</strong> (<em>east_wind_var_name</em><em>, </em><em>north_wind_var_name</em><em>,</em>) – wind component and pressure field names in netCDF file.</p></li>
<li><p><strong>fill_mode</strong> – Determines how points outside the source grid will be
treated. If ‘nearest’, value of the nearest source point will be
used. Otherwise a constant fill value will be used (default).</p></li>
<li><p><strong>fill_value</strong> (<a class="reference external" href="https://docs.python.org/2.7/library/functions.html#float" title="(in Python v2.7)"><em>float</em></a>) – Set the fill value (default: NaN)</p></li>
<li><p><strong>verbose</strong> (<a class="reference external" href="https://docs.python.org/2.7/library/functions.html#bool" title="(in Python v2.7)"><em>bool</em></a>) – Se True to print debug information.</p></li>
</ul>
</dd>
</dl>
<dl class="py method">
<dt class="sig sig-object py" id="thetis.forcing.ATMInterpolator.set_fields">
<span class="sig-name descname"><span class="pre">set_fields</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">time</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/forcing.html#ATMInterpolator.set_fields"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#thetis.forcing.ATMInterpolator.set_fields" title="Link to this definition">¶</a></dt>
<dd><p>Evaluates forcing fields at the given time.</p>
<p>Performs interpolation and updates the output wind stress and
atmospheric pressure fields in place.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>time</strong> (<a class="reference external" href="https://docs.python.org/2.7/library/functions.html#float" title="(in Python v2.7)"><em>float</em></a>) – Thetis simulation time in seconds.</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="thetis.forcing.ATMNetCDFTime">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">thetis.forcing.</span></span><span class="sig-name descname"><span class="pre">ATMNetCDFTime</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">filename</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">max_duration</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">verbose</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">time_variable_name</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'time'</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/forcing.html#ATMNetCDFTime"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#thetis.forcing.ATMNetCDFTime" title="Link to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#thetis.interpolation.NetCDFTimeParser" title="thetis.interpolation.NetCDFTimeParser"><code class="xref py py-class docutils literal notranslate"><span class="pre">NetCDFTimeParser</span></code></a></p>
<p>A TimeParser class for reading atmosphere model output files.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>filename</strong></p></li>
<li><p><strong>max_duration</strong> – Time span to read from each file (in seconds).
E.g. forecast files can consist of daily files with &gt; 1 day of
data. In this case max_duration should be set to 24 h. If None,
all time steps are loaded. Default: None.</p></li>
<li><p><strong>verbose</strong> (<a class="reference external" href="https://docs.python.org/2.7/library/functions.html#bool" title="(in Python v2.7)"><em>bool</em></a>) – Se True to print debug information.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="thetis.forcing.FES2004TidalBoundaryForcing">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">thetis.forcing.</span></span><span class="sig-name descname"><span class="pre">FES2004TidalBoundaryForcing</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">elev_field</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">init_date</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">coord_system</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">vect_rotator</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">uv_field</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">constituents</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">boundary_ids</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">data_dir</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/forcing.html#FES2004TidalBoundaryForcing"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#thetis.forcing.FES2004TidalBoundaryForcing" title="Link to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#thetis.forcing.TidalBoundaryForcing" title="thetis.forcing.TidalBoundaryForcing"><code class="xref py py-class docutils literal notranslate"><span class="pre">TidalBoundaryForcing</span></code></a></p>
<p>Tidal boundary interpolator for FES2004 tidal model.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>elev_field</strong> – Function where tidal elevation will be interpolated.</p></li>
<li><p><strong>init_date</strong> – Datetime object defining the simulation init time.</p></li>
<li><p><strong>coord_system</strong> – <code class="xref py py-class docutils literal notranslate"><span class="pre">CoordinateSystem</span></code> object</p></li>
<li><p><strong>vect_rotator</strong> – User-defined vector rotator function</p></li>
<li><p><strong>uv_field</strong> – Function where tidal transport will be interpolated.</p></li>
<li><p><strong>constituents</strong> – list of tidal constituents, e.g. [‘M2’, ‘K1’]</p></li>
<li><p><strong>boundary_ids</strong> – list of boundary_ids where tidal data will be
evaluated. If not defined, tides will be in evaluated in the entire
domain.</p></li>
<li><p><strong>data_dir</strong> – path to directory where tidal model netCDF files are
located.</p></li>
</ul>
</dd>
</dl>
<dl class="py attribute">
<dt class="sig sig-object py" id="thetis.forcing.FES2004TidalBoundaryForcing.compute_velocity">
<span class="sig-name descname"><span class="pre">compute_velocity</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">False</span></em><a class="headerlink" href="#thetis.forcing.FES2004TidalBoundaryForcing.compute_velocity" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="thetis.forcing.FES2004TidalBoundaryForcing.coord_layout">
<span class="sig-name descname"><span class="pre">coord_layout</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">'lat,lon'</span></em><a class="headerlink" href="#thetis.forcing.FES2004TidalBoundaryForcing.coord_layout" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="thetis.forcing.FES2004TidalBoundaryForcing.elev_nc_file">
<span class="sig-name descname"><span class="pre">elev_nc_file</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">'tide.fes2004.nc'</span></em><a class="headerlink" href="#thetis.forcing.FES2004TidalBoundaryForcing.elev_nc_file" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="thetis.forcing.FES2004TidalBoundaryForcing.grid_nc_file">
<span class="sig-name descname"><span class="pre">grid_nc_file</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">None</span></em><a class="headerlink" href="#thetis.forcing.FES2004TidalBoundaryForcing.grid_nc_file" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="thetis.forcing.FES2004TidalBoundaryForcing.uv_nc_file">
<span class="sig-name descname"><span class="pre">uv_nc_file</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">None</span></em><a class="headerlink" href="#thetis.forcing.FES2004TidalBoundaryForcing.uv_nc_file" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="thetis.forcing.GenericInterpolator2D">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">thetis.forcing.</span></span><span class="sig-name descname"><span class="pre">GenericInterpolator2D</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">function_space</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fields</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">field_names</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ncfile_pattern</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">init_date</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">coord_system</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">vector_field</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">vector_components</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">vector_rotator</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/forcing.html#GenericInterpolator2D"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#thetis.forcing.GenericInterpolator2D" title="Link to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference external" href="https://docs.python.org/2.7/library/functions.html#object" title="(in Python v2.7)"><code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></a></p>
<p>Interpolates 2D fields from netCDF files.</p>
<p>The grid latitude, longitude coordinates must be defined in 1D arrays
with CF standard_name attributes “latitude” and “longitude”. Time must be
defined with cftime compliant units and metadata.</p>
<dl class="py method">
<dt class="sig sig-object py" id="thetis.forcing.GenericInterpolator2D.set_fields">
<span class="sig-name descname"><span class="pre">set_fields</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">time</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/forcing.html#GenericInterpolator2D.set_fields"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#thetis.forcing.GenericInterpolator2D.set_fields" title="Link to this definition">¶</a></dt>
<dd><p>Evaluates forcing fields at the given time</p>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="thetis.forcing.GenericSpatialInterpolator2D">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">thetis.forcing.</span></span><span class="sig-name descname"><span class="pre">GenericSpatialInterpolator2D</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">function_space</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">coord_system</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fill_mode</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fill_value</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">nan</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/forcing.html#GenericSpatialInterpolator2D"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#thetis.forcing.GenericSpatialInterpolator2D" title="Link to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#thetis.interpolation.SpatialInterpolator2d" title="thetis.interpolation.SpatialInterpolator2d"><code class="xref py py-class docutils literal notranslate"><span class="pre">SpatialInterpolator2d</span></code></a></p>
<p>Spatial interpolator class for interpolating netCDF 2D fields.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>function_space</strong> – target Firedrake FunctionSpace</p></li>
<li><p><strong>coord_system</strong> – <code class="xref py py-class docutils literal notranslate"><span class="pre">CoordinateSystem</span></code> object</p></li>
<li><p><strong>fill_mode</strong> – Determines how points outside the source grid will be
treated. If ‘nearest’, value of the nearest source point will be
used. Otherwise a constant fill value will be used (default).</p></li>
<li><p><strong>fill_value</strong> (<a class="reference external" href="https://docs.python.org/2.7/library/functions.html#float" title="(in Python v2.7)"><em>float</em></a>) – Set the fill value (default: NaN)</p></li>
</ul>
</dd>
</dl>
<dl class="py method">
<dt class="sig sig-object py" id="thetis.forcing.GenericSpatialInterpolator2D.interpolate">
<span class="sig-name descname"><span class="pre">interpolate</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">nc_filename</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">variable_list</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">itime</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/forcing.html#GenericSpatialInterpolator2D.interpolate"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#thetis.forcing.GenericSpatialInterpolator2D.interpolate" title="Link to this definition">¶</a></dt>
<dd><p>Calls the interpolator object</p>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="thetis.forcing.LiveOceanInterpolator">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">thetis.forcing.</span></span><span class="sig-name descname"><span class="pre">LiveOceanInterpolator</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">function_space</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fields</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">field_names</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ncfile_pattern</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">init_date</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">coord_system</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/forcing.html#LiveOceanInterpolator"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#thetis.forcing.LiveOceanInterpolator" title="Link to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference external" href="https://docs.python.org/2.7/library/functions.html#object" title="(in Python v2.7)"><code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></a></p>
<p>Interpolates LiveOcean (ROMS) model data on 3D fields</p>
<dl class="py method">
<dt class="sig sig-object py" id="thetis.forcing.LiveOceanInterpolator.set_fields">
<span class="sig-name descname"><span class="pre">set_fields</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">time</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/forcing.html#LiveOceanInterpolator.set_fields"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#thetis.forcing.LiveOceanInterpolator.set_fields" title="Link to this definition">¶</a></dt>
<dd><p>Evaluates forcing fields at the given time</p>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="thetis.forcing.NCOMInterpolator">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">thetis.forcing.</span></span><span class="sig-name descname"><span class="pre">NCOMInterpolator</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">function_space_2d</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">function_space_3d</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fields</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">field_names</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">field_fnstr</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">coord_system</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">basedir</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">file_pattern</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">init_date</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">verbose</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/forcing.html#NCOMInterpolator"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#thetis.forcing.NCOMInterpolator" title="Link to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference external" href="https://docs.python.org/2.7/library/functions.html#object" title="(in Python v2.7)"><code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></a></p>
<p>Interpolates NCOM model data on 3D fields.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>The following NCOM output files must be present:
./forcings/ncom/model_h.nc
./forcings/ncom/model_lat.nc
./forcings/ncom/model_ang.nc
./forcings/ncom/model_lon.nc
./forcings/ncom/model_zm.nc
./forcings/ncom/2006/s3d/s3d.glb8_2f_2006041900.nc
./forcings/ncom/2006/s3d/s3d.glb8_2f_2006042000.nc
./forcings/ncom/2006/t3d/t3d.glb8_2f_2006041900.nc
./forcings/ncom/2006/t3d/t3d.glb8_2f_2006042000.nc
./forcings/ncom/2006/u3d/u3d.glb8_2f_2006041900.nc
./forcings/ncom/2006/u3d/u3d.glb8_2f_2006042000.nc
./forcings/ncom/2006/v3d/v3d.glb8_2f_2006041900.nc
./forcings/ncom/2006/v3d/v3d.glb8_2f_2006042000.nc
./forcings/ncom/2006/ssh/ssh.glb8_2f_2006041900.nc
./forcings/ncom/2006/ssh/ssh.glb8_2f_2006042000.nc</p>
</div>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>function_space_2d</strong> – Target (scalar) <code class="xref py py-class docutils literal notranslate"><span class="pre">FunctionSpace</span></code> object onto
which 2D data will be interpolated.</p></li>
<li><p><strong>function_space_3d</strong> – Target (scalar) <code class="xref py py-class docutils literal notranslate"><span class="pre">FunctionSpace</span></code> object onto
which 3D data will be interpolated.</p></li>
<li><p><strong>fields</strong> – list of <code class="xref py py-class docutils literal notranslate"><span class="pre">Function</span></code> objects where data will be
stored.</p></li>
<li><p><strong>field_names</strong> – List of netCDF variable names for the fields. E.g.
[‘Salinity’, ‘Temperature’].</p></li>
<li><p><strong>field_fnstr</strong> – List of variables in netCDF file names. E.g.
[‘s3d’, ‘t3d’].</p></li>
<li><p><strong>coord_system</strong> – <code class="xref py py-class docutils literal notranslate"><span class="pre">CoordinateSystem</span></code> object</p></li>
<li><p><strong>basedir</strong> – Root dir where NCOM files are stored.
E.g. ‘/forcings/ncom’.</p></li>
<li><p><strong>file_pattern</strong> – A file name pattern for reading the NCOM output
files (excluding the basedir). E.g.
{year:04d}/{fieldstr:}/{fieldstr:}.glb8_2f_{year:04d}{month:02d}{day:02d}00.nc’.</p></li>
<li><p><strong>init_date</strong> – A <code class="xref py py-class docutils literal notranslate"><span class="pre">datetime</span></code> object that indicates the start
date/time of the Thetis simulation. Must contain time zone. E.g.
‘datetime(2006, 5, 1, tzinfo=pytz.utc)’</p></li>
<li><p><strong>verbose</strong> (<a class="reference external" href="https://docs.python.org/2.7/library/functions.html#bool" title="(in Python v2.7)"><em>bool</em></a>) – Se True to print debug information.</p></li>
</ul>
</dd>
</dl>
<dl class="py method">
<dt class="sig sig-object py" id="thetis.forcing.NCOMInterpolator.set_fields">
<span class="sig-name descname"><span class="pre">set_fields</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">time</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/forcing.html#NCOMInterpolator.set_fields"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#thetis.forcing.NCOMInterpolator.set_fields" title="Link to this definition">¶</a></dt>
<dd><p>Evaluates forcing fields at the given time</p>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="thetis.forcing.SpatialInterpolatorNCOM2d">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">thetis.forcing.</span></span><span class="sig-name descname"><span class="pre">SpatialInterpolatorNCOM2d</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">function_space</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">coord_system</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">grid_path</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/forcing.html#SpatialInterpolatorNCOM2d"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#thetis.forcing.SpatialInterpolatorNCOM2d" title="Link to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#thetis.forcing.SpatialInterpolatorNCOMBase" title="thetis.forcing.SpatialInterpolatorNCOMBase"><code class="xref py py-class docutils literal notranslate"><span class="pre">SpatialInterpolatorNCOMBase</span></code></a></p>
<p>Spatial interpolator class for interpolating NCOM ocean model 2D fields.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>function_space</strong> – Target (scalar) <code class="xref py py-class docutils literal notranslate"><span class="pre">FunctionSpace</span></code> object onto
which data will be interpolated.</p></li>
<li><p><strong>coord_system</strong> – <code class="xref py py-class docutils literal notranslate"><span class="pre">CoordinateSystem</span></code> object</p></li>
<li><p><strong>grid_path</strong> – File path where the NCOM model grid files
(‘model_lat.nc’, ‘model_lon.nc’, ‘model_zm.nc’) are located.</p></li>
</ul>
</dd>
</dl>
<dl class="py method">
<dt class="sig sig-object py" id="thetis.forcing.SpatialInterpolatorNCOM2d.interpolate">
<span class="sig-name descname"><span class="pre">interpolate</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">nc_filename</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">variable_list</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">itime</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/forcing.html#SpatialInterpolatorNCOM2d.interpolate"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#thetis.forcing.SpatialInterpolatorNCOM2d.interpolate" title="Link to this definition">¶</a></dt>
<dd><p>Calls the interpolator object</p>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="thetis.forcing.SpatialInterpolatorNCOM3d">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">thetis.forcing.</span></span><span class="sig-name descname"><span class="pre">SpatialInterpolatorNCOM3d</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">function_space</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">coord_system</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">grid_path</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/forcing.html#SpatialInterpolatorNCOM3d"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#thetis.forcing.SpatialInterpolatorNCOM3d" title="Link to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#thetis.forcing.SpatialInterpolatorNCOMBase" title="thetis.forcing.SpatialInterpolatorNCOMBase"><code class="xref py py-class docutils literal notranslate"><span class="pre">SpatialInterpolatorNCOMBase</span></code></a></p>
<p>Spatial interpolator class for interpolating NCOM ocean model 3D fields.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>function_space</strong> – Target (scalar) <code class="xref py py-class docutils literal notranslate"><span class="pre">FunctionSpace</span></code> object onto
which data will be interpolated.</p></li>
<li><p><strong>coord_system</strong> – <code class="xref py py-class docutils literal notranslate"><span class="pre">CoordinateSystem</span></code> object</p></li>
<li><p><strong>grid_path</strong> – File path where the NCOM model grid files
(‘model_lat.nc’, ‘model_lon.nc’, ‘model_zm.nc’) are located.</p></li>
</ul>
</dd>
</dl>
<dl class="py method">
<dt class="sig sig-object py" id="thetis.forcing.SpatialInterpolatorNCOM3d.interpolate">
<span class="sig-name descname"><span class="pre">interpolate</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">nc_filename</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">variable_list</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">itime</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/forcing.html#SpatialInterpolatorNCOM3d.interpolate"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#thetis.forcing.SpatialInterpolatorNCOM3d.interpolate" title="Link to this definition">¶</a></dt>
<dd><p>Calls the interpolator object</p>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="thetis.forcing.SpatialInterpolatorNCOMBase">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">thetis.forcing.</span></span><span class="sig-name descname"><span class="pre">SpatialInterpolatorNCOMBase</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">function_space</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">coord_system</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">grid_path</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/forcing.html#SpatialInterpolatorNCOMBase"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#thetis.forcing.SpatialInterpolatorNCOMBase" title="Link to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#thetis.interpolation.SpatialInterpolator" title="thetis.interpolation.SpatialInterpolator"><code class="xref py py-class docutils literal notranslate"><span class="pre">SpatialInterpolator</span></code></a></p>
<p>Base class for 2D and 3D NCOM spatial interpolators.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>function_space</strong> – Target (scalar) <code class="xref py py-class docutils literal notranslate"><span class="pre">FunctionSpace</span></code> object onto
which data will be interpolated.</p></li>
<li><p><strong>coord_system</strong> – <code class="xref py py-class docutils literal notranslate"><span class="pre">CoordinateSystem</span></code> object</p></li>
<li><p><strong>grid_path</strong> – File path where the NCOM model grid files
(‘model_lat.nc’, ‘model_lon.nc’, ‘model_zm.nc’) are located.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="thetis.forcing.SpatialInterpolatorROMS3d">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">thetis.forcing.</span></span><span class="sig-name descname"><span class="pre">SpatialInterpolatorROMS3d</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">function_space</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">coord_system</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/forcing.html#SpatialInterpolatorROMS3d"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#thetis.forcing.SpatialInterpolatorROMS3d" title="Link to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#thetis.interpolation.SpatialInterpolator" title="thetis.interpolation.SpatialInterpolator"><code class="xref py py-class docutils literal notranslate"><span class="pre">SpatialInterpolator</span></code></a></p>
<p>Abstract spatial interpolator class that can interpolate onto a Function</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>function_space</strong> – target Firedrake FunctionSpace</p></li>
<li><p><strong>coord_system</strong> – <code class="xref py py-class docutils literal notranslate"><span class="pre">CoordinateSystem</span></code> object</p></li>
</ul>
</dd>
</dl>
<dl class="py method">
<dt class="sig sig-object py" id="thetis.forcing.SpatialInterpolatorROMS3d.interpolate">
<span class="sig-name descname"><span class="pre">interpolate</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">nc_filename</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">variable_list</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">itime</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/forcing.html#SpatialInterpolatorROMS3d.interpolate"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#thetis.forcing.SpatialInterpolatorROMS3d.interpolate" title="Link to this definition">¶</a></dt>
<dd><p>Calls the interpolator object</p>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="thetis.forcing.TPXOTidalBoundaryForcing">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">thetis.forcing.</span></span><span class="sig-name descname"><span class="pre">TPXOTidalBoundaryForcing</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">elev_field</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">init_date</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">coord_system</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">vect_rotator</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">uv_field</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">constituents</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">boundary_ids</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">data_dir</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">elev_file</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'h_tpxo9.v5a.nc'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">uv_file</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'u_tpxo9.v5a.nc'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">grid_file</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'gridtpxo9v5a.nc'</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/forcing.html#TPXOTidalBoundaryForcing"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#thetis.forcing.TPXOTidalBoundaryForcing" title="Link to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#thetis.forcing.TidalBoundaryForcing" title="thetis.forcing.TidalBoundaryForcing"><code class="xref py py-class docutils literal notranslate"><span class="pre">TidalBoundaryForcing</span></code></a></p>
<p>Interpolator for TPXO global tidal model data.</p>
<p>See the <a class="reference external" href="https://www.tpxo.net/global/tpxo9-atlas">TPXO website</a> for data
access. By default, this routine assumes the <cite>tpxo9v5a</cite> data set in NetCDF
format. Other versions can be used by setting correct <cite>elev_file</cite>,
<cite>uv_file</cite>, and <cite>grid_file</cite> arguments.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>elev_field</strong> – Function where tidal elevation will be interpolated.</p></li>
<li><p><strong>init_date</strong> – Datetime object defining the simulation init time.</p></li>
<li><p><strong>coord_system</strong> – <code class="xref py py-class docutils literal notranslate"><span class="pre">CoordinateSystem</span></code> object</p></li>
<li><p><strong>vect_rotator</strong> – User-defined vector rotator function</p></li>
<li><p><strong>uv_field</strong> – Function where tidal transport will be interpolated.</p></li>
<li><p><strong>constituents</strong> – list of tidal constituents, e.g. [‘M2’, ‘K1’]</p></li>
<li><p><strong>boundary_ids</strong> – list of boundary_ids where tidal data will be
evaluated. If not defined, tides will be in evaluated in the entire
domain.</p></li>
<li><p><strong>data_dir</strong> – path to directory where tidal model netCDF files are
located.</p></li>
<li><p><strong>elev_file</strong> – TPXO tidal elevation file</p></li>
<li><p><strong>uv_file</strong> – TPXO transport/velocity file</p></li>
<li><p><strong>grid_file</strong> – TPXO grid file</p></li>
</ul>
</dd>
</dl>
<dl class="py attribute">
<dt class="sig sig-object py" id="thetis.forcing.TPXOTidalBoundaryForcing.compute_velocity">
<span class="sig-name descname"><span class="pre">compute_velocity</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">True</span></em><a class="headerlink" href="#thetis.forcing.TPXOTidalBoundaryForcing.compute_velocity" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="thetis.forcing.TPXOTidalBoundaryForcing.coord_layout">
<span class="sig-name descname"><span class="pre">coord_layout</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">'lon,lat'</span></em><a class="headerlink" href="#thetis.forcing.TPXOTidalBoundaryForcing.coord_layout" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="thetis.forcing.TidalBoundaryForcing">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">thetis.forcing.</span></span><span class="sig-name descname"><span class="pre">TidalBoundaryForcing</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">elev_field</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">init_date</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">coord_system</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">vect_rotator</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">uv_field</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">constituents</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">boundary_ids</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">data_dir</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/forcing.html#TidalBoundaryForcing"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#thetis.forcing.TidalBoundaryForcing" title="Link to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">ABC</span></code></p>
<p>Base class for tidal boundary interpolators.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>elev_field</strong> – Function where tidal elevation will be interpolated.</p></li>
<li><p><strong>init_date</strong> – Datetime object defining the simulation init time.</p></li>
<li><p><strong>coord_system</strong> – <code class="xref py py-class docutils literal notranslate"><span class="pre">CoordinateSystem</span></code> object</p></li>
<li><p><strong>vect_rotator</strong> – User-defined vector rotator function</p></li>
<li><p><strong>uv_field</strong> – Function where tidal transport will be interpolated.</p></li>
<li><p><strong>constituents</strong> – list of tidal constituents, e.g. [‘M2’, ‘K1’]</p></li>
<li><p><strong>boundary_ids</strong> – list of boundary_ids where tidal data will be
evaluated. If not defined, tides will be in evaluated in the entire
domain.</p></li>
<li><p><strong>data_dir</strong> – path to directory where tidal model netCDF files are
located.</p></li>
</ul>
</dd>
</dl>
<dl class="py property">
<dt class="sig sig-object py" id="thetis.forcing.TidalBoundaryForcing.compute_velocity">
<em class="property"><span class="pre">abstract</span><span class="w"> </span><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">compute_velocity</span></span><a class="headerlink" href="#thetis.forcing.TidalBoundaryForcing.compute_velocity" title="Link to this definition">¶</a></dt>
<dd><p>If True, compute tidal currents as well.</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="thetis.forcing.TidalBoundaryForcing.coord_layout">
<em class="property"><span class="pre">abstract</span><span class="w"> </span><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">coord_layout</span></span><a class="headerlink" href="#thetis.forcing.TidalBoundaryForcing.coord_layout" title="Link to this definition">¶</a></dt>
<dd><p>Data layout in the netcdf files.</p>
<p>Either ‘lon,lat’ or ‘lat,lon’.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="thetis.forcing.TidalBoundaryForcing.set_tidal_field">
<span class="sig-name descname"><span class="pre">set_tidal_field</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">t</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/forcing.html#TidalBoundaryForcing.set_tidal_field"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#thetis.forcing.TidalBoundaryForcing.set_tidal_field" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="thetis.forcing.compute_wind_stress">
<span class="sig-prename descclassname"><span class="pre">thetis.forcing.</span></span><span class="sig-name descname"><span class="pre">compute_wind_stress</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">wind_u</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">wind_v</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">method</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'LargeYeager2009'</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/forcing.html#compute_wind_stress"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#thetis.forcing.compute_wind_stress" title="Link to this definition">¶</a></dt>
<dd><p>Compute wind stress from atmospheric 10 m wind.</p>
<p>wind stress is defined as</p>
<p>where <span class="math notranslate nohighlight">\(C_D\)</span> is the drag coefficient, <span class="math notranslate nohighlight">\(\rho_{air}\)</span> is the
density of air, and <span class="math notranslate nohighlight">\(U_{10}\)</span> is wind speed 10 m above the sea
surface.</p>
<p>In practice <cite>C_D</cite> depends on the wind speed.</p>
<p>Two formulation are currently implemented:</p>
<ul class="simple">
<li><dl class="simple">
<dt>“LargePond1981”:</dt><dd><p>Wind stress formulation by [1]</p>
</dd>
</dl>
</li>
<li><dl class="simple">
<dt>“SmithBanke1975”:</dt><dd><p>Wind stress formulation by [2]</p>
</dd>
</dl>
</li>
<li><dl class="simple">
<dt>“LargeYeager2009”:</dt><dd><p>Wind stress formulation by [3]</p>
</dd>
</dl>
</li>
</ul>
<dl class="simple">
<dt>[1] Large and Pond (1981). Open Ocean Momentum Flux Measurements in</dt><dd><p>Moderate to Strong Winds. Journal of Physical Oceanography,
11(3):324-336.
<a class="reference external" href="https://doi.org/10.1175/1520-0485(1981)011%3C0324:OOMFMI%3E2.0.CO;2">https://doi.org/10.1175/1520-0485(1981)011%3C0324:OOMFMI%3E2.0.CO;2</a></p>
</dd>
<dt>[2] Smith and Banke (1975). Variation of the sea surface drag coefficient</dt><dd><p>with wind speed. Q J R Meteorol Soc., 101(429):665-673.
<a class="reference external" href="https://doi.org/10.1002/qj.49710142920">https://doi.org/10.1002/qj.49710142920</a></p>
</dd>
<dt>[3] Large and Yeager (2009). The global climatology of an interannually</dt><dd><p>varying air–sea flux data set. Climate Dynamics,
33:341–364. <a class="reference external" href="http://dx.doi.org/10.1007/s00382-008-0441-3">http://dx.doi.org/10.1007/s00382-008-0441-3</a></p>
</dd>
</dl>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>wind_v</strong> (<em>wind_u</em><em>,</em>) – Wind u and v components as numpy arrays</p></li>
<li><p><strong>method</strong> – Choose the stress formulation. Currently supports:
‘LargeYeager2009’ (default), ‘LargePond1981’, or ‘SmithBanke1975’.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>(tau_x, tau_y) wind stress x and y components as numpy arrays</p>
</dd>
</dl>
</dd></dl>

</section>
<section id="module-thetis.implicitexplicit">
<span id="thetis-implicitexplicit-module"></span><h2>thetis.implicitexplicit module<a class="headerlink" href="#module-thetis.implicitexplicit" title="Link to this heading">¶</a></h2>
<p>Implicit-explicit time integrators</p>
<dl class="py class">
<dt class="sig sig-object py" id="thetis.implicitexplicit.IMEXEuler">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">thetis.implicitexplicit.</span></span><span class="sig-name descname"><span class="pre">IMEXEuler</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">equation</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">solution</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fields</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dt</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">options</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">bnd_conditions</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/implicitexplicit.html#IMEXEuler"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#thetis.implicitexplicit.IMEXEuler" title="Link to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#thetis.implicitexplicit.IMEXGeneric" title="thetis.implicitexplicit.IMEXGeneric"><code class="xref py py-class docutils literal notranslate"><span class="pre">IMEXGeneric</span></code></a></p>
<p>Forward-Backward Euler</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>equation</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">Equation</span></code> object) – equation to solve</p></li>
<li><p><strong>solution</strong> – <code class="xref py py-class docutils literal notranslate"><span class="pre">Function</span></code> where solution will be stored</p></li>
<li><p><strong>fields</strong> (dict of <code class="xref py py-class docutils literal notranslate"><span class="pre">Function</span></code> or <code class="xref py py-class docutils literal notranslate"><span class="pre">Constant</span></code> objects) – Dictionary of fields that are passed to the equation</p></li>
<li><p><strong>dt</strong> (<a class="reference external" href="https://docs.python.org/2.7/library/functions.html#float" title="(in Python v2.7)"><em>float</em></a>) – time step in seconds</p></li>
<li><p><strong>options</strong> – <code class="xref py py-class docutils literal notranslate"><span class="pre">TimeStepperOptions</span></code> instance containing parameter values.</p></li>
<li><p><strong>bnd_conditions</strong> (<a class="reference external" href="https://docs.python.org/2.7/library/stdtypes.html#dict" title="(in Python v2.7)"><em>dict</em></a>) – Dictionary of boundary conditions passed to the equation</p></li>
</ul>
</dd>
</dl>
<dl class="py attribute">
<dt class="sig sig-object py" id="thetis.implicitexplicit.IMEXEuler.dirk_class">
<span class="sig-name descname"><span class="pre">dirk_class</span></span><a class="headerlink" href="#thetis.implicitexplicit.IMEXEuler.dirk_class" title="Link to this definition">¶</a></dt>
<dd><p>alias of <a class="reference internal" href="#thetis.rungekutta.BackwardEuler" title="thetis.rungekutta.BackwardEuler"><code class="xref py py-class docutils literal notranslate"><span class="pre">BackwardEuler</span></code></a></p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="thetis.implicitexplicit.IMEXEuler.erk_class">
<span class="sig-name descname"><span class="pre">erk_class</span></span><a class="headerlink" href="#thetis.implicitexplicit.IMEXEuler.erk_class" title="Link to this definition">¶</a></dt>
<dd><p>alias of <a class="reference internal" href="#thetis.rungekutta.ERKEuler" title="thetis.rungekutta.ERKEuler"><code class="xref py py-class docutils literal notranslate"><span class="pre">ERKEuler</span></code></a></p>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="thetis.implicitexplicit.IMEXGeneric">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">thetis.implicitexplicit.</span></span><span class="sig-name descname"><span class="pre">IMEXGeneric</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">equation</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">solution</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fields</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dt</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">options</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">bnd_conditions</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/implicitexplicit.html#IMEXGeneric"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#thetis.implicitexplicit.IMEXGeneric" title="Link to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#thetis.timeintegrator.TimeIntegrator" title="thetis.timeintegrator.TimeIntegrator"><code class="xref py py-class docutils literal notranslate"><span class="pre">TimeIntegrator</span></code></a>, <code class="xref py py-class docutils literal notranslate"><span class="pre">ABC</span></code></p>
<p>Generic implementation of Runge-Kutta Implicit-Explicit schemes</p>
<p>Derived classes must define the implicit <a class="reference internal" href="#thetis.implicitexplicit.IMEXGeneric.dirk_class" title="thetis.implicitexplicit.IMEXGeneric.dirk_class"><code class="xref py py-attr docutils literal notranslate"><span class="pre">dirk_class</span></code></a> and explicit
<a class="reference internal" href="#thetis.implicitexplicit.IMEXGeneric.erk_class" title="thetis.implicitexplicit.IMEXGeneric.erk_class"><code class="xref py py-attr docutils literal notranslate"><span class="pre">erk_class</span></code></a> Runge-Kutta time integrator classes.</p>
<p>This method solves the linearized equations: All implicit terms are fed to
the implicit solver, while all the other terms are fed to the explicit
solver. In case of non-linear terms proper linearization must defined in the
equation using the two solution functions (solution, solution_old)</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>equation</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">Equation</span></code> object) – equation to solve</p></li>
<li><p><strong>solution</strong> – <code class="xref py py-class docutils literal notranslate"><span class="pre">Function</span></code> where solution will be stored</p></li>
<li><p><strong>fields</strong> (dict of <code class="xref py py-class docutils literal notranslate"><span class="pre">Function</span></code> or <code class="xref py py-class docutils literal notranslate"><span class="pre">Constant</span></code> objects) – Dictionary of fields that are passed to the equation</p></li>
<li><p><strong>dt</strong> (<a class="reference external" href="https://docs.python.org/2.7/library/functions.html#float" title="(in Python v2.7)"><em>float</em></a>) – time step in seconds</p></li>
<li><p><strong>options</strong> – <code class="xref py py-class docutils literal notranslate"><span class="pre">TimeStepperOptions</span></code> instance containing parameter values.</p></li>
<li><p><strong>bnd_conditions</strong> (<a class="reference external" href="https://docs.python.org/2.7/library/stdtypes.html#dict" title="(in Python v2.7)"><em>dict</em></a>) – Dictionary of boundary conditions passed to the equation</p></li>
</ul>
</dd>
</dl>
<dl class="py method">
<dt class="sig sig-object py" id="thetis.implicitexplicit.IMEXGeneric.advance">
<span class="sig-name descname"><span class="pre">advance</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">t</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">update_forcings</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/implicitexplicit.html#IMEXGeneric.advance"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#thetis.implicitexplicit.IMEXGeneric.advance" title="Link to this definition">¶</a></dt>
<dd><p>Advances equations for one time step.</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="thetis.implicitexplicit.IMEXGeneric.dirk_class">
<em class="property"><span class="pre">abstract</span><span class="w"> </span><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">dirk_class</span></span><a class="headerlink" href="#thetis.implicitexplicit.IMEXGeneric.dirk_class" title="Link to this definition">¶</a></dt>
<dd><p>Implicit DIRK class</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="thetis.implicitexplicit.IMEXGeneric.erk_class">
<em class="property"><span class="pre">abstract</span><span class="w"> </span><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">erk_class</span></span><a class="headerlink" href="#thetis.implicitexplicit.IMEXGeneric.erk_class" title="Link to this definition">¶</a></dt>
<dd><p>Explicit Runge-Kutta class</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="thetis.implicitexplicit.IMEXGeneric.get_final_solution">
<span class="sig-name descname"><span class="pre">get_final_solution</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/implicitexplicit.html#IMEXGeneric.get_final_solution"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#thetis.implicitexplicit.IMEXGeneric.get_final_solution" title="Link to this definition">¶</a></dt>
<dd><p>Evaluates the final solution.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="thetis.implicitexplicit.IMEXGeneric.initialize">
<span class="sig-name descname"><span class="pre">initialize</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">solution</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/implicitexplicit.html#IMEXGeneric.initialize"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#thetis.implicitexplicit.IMEXGeneric.initialize" title="Link to this definition">¶</a></dt>
<dd><p>Assigns initial conditions to all required fields.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="thetis.implicitexplicit.IMEXGeneric.set_dt">
<span class="sig-name descname"><span class="pre">set_dt</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">dt</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/implicitexplicit.html#IMEXGeneric.set_dt"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#thetis.implicitexplicit.IMEXGeneric.set_dt" title="Link to this definition">¶</a></dt>
<dd><p>Update time step</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>dt</strong> (<a class="reference external" href="https://docs.python.org/2.7/library/functions.html#float" title="(in Python v2.7)"><em>float</em></a>) – time step</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="thetis.implicitexplicit.IMEXGeneric.solve_stage">
<span class="sig-name descname"><span class="pre">solve_stage</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">i_stage</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">t</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">update_forcings</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/implicitexplicit.html#IMEXGeneric.solve_stage"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#thetis.implicitexplicit.IMEXGeneric.solve_stage" title="Link to this definition">¶</a></dt>
<dd><p>Solves i-th stage</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="thetis.implicitexplicit.IMEXGeneric.update_solver">
<span class="sig-name descname"><span class="pre">update_solver</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/implicitexplicit.html#IMEXGeneric.update_solver"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#thetis.implicitexplicit.IMEXGeneric.update_solver" title="Link to this definition">¶</a></dt>
<dd><p>Create solver objects</p>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="thetis.implicitexplicit.IMEXLPUM2">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">thetis.implicitexplicit.</span></span><span class="sig-name descname"><span class="pre">IMEXLPUM2</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">equation</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">solution</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fields</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dt</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">options</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">bnd_conditions</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/implicitexplicit.html#IMEXLPUM2"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#thetis.implicitexplicit.IMEXLPUM2" title="Link to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#thetis.implicitexplicit.IMEXGeneric" title="thetis.implicitexplicit.IMEXGeneric"><code class="xref py py-class docutils literal notranslate"><span class="pre">IMEXGeneric</span></code></a></p>
<p>SSP-IMEX RK scheme (20) in Higureras et al. (2014)</p>
<p>CFL coefficient is 2.0</p>
<p>Higueras et al (2014). Optimized strong stability preserving IMEX
Runge-Kutta methods. Journal of Computational and Applied Mathematics
272(2014) 116-140. <a class="reference external" href="http://dx.doi.org/10.1016/j.cam.2014.05.011">http://dx.doi.org/10.1016/j.cam.2014.05.011</a></p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>equation</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">Equation</span></code> object) – equation to solve</p></li>
<li><p><strong>solution</strong> – <code class="xref py py-class docutils literal notranslate"><span class="pre">Function</span></code> where solution will be stored</p></li>
<li><p><strong>fields</strong> (dict of <code class="xref py py-class docutils literal notranslate"><span class="pre">Function</span></code> or <code class="xref py py-class docutils literal notranslate"><span class="pre">Constant</span></code> objects) – Dictionary of fields that are passed to the equation</p></li>
<li><p><strong>dt</strong> (<a class="reference external" href="https://docs.python.org/2.7/library/functions.html#float" title="(in Python v2.7)"><em>float</em></a>) – time step in seconds</p></li>
<li><p><strong>options</strong> – <code class="xref py py-class docutils literal notranslate"><span class="pre">TimeStepperOptions</span></code> instance containing parameter values.</p></li>
<li><p><strong>bnd_conditions</strong> (<a class="reference external" href="https://docs.python.org/2.7/library/stdtypes.html#dict" title="(in Python v2.7)"><em>dict</em></a>) – Dictionary of boundary conditions passed to the equation</p></li>
</ul>
</dd>
</dl>
<dl class="py attribute">
<dt class="sig sig-object py" id="thetis.implicitexplicit.IMEXLPUM2.dirk_class">
<span class="sig-name descname"><span class="pre">dirk_class</span></span><a class="headerlink" href="#thetis.implicitexplicit.IMEXLPUM2.dirk_class" title="Link to this definition">¶</a></dt>
<dd><p>alias of <a class="reference internal" href="#thetis.rungekutta.DIRKLPUM2" title="thetis.rungekutta.DIRKLPUM2"><code class="xref py py-class docutils literal notranslate"><span class="pre">DIRKLPUM2</span></code></a></p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="thetis.implicitexplicit.IMEXLPUM2.erk_class">
<span class="sig-name descname"><span class="pre">erk_class</span></span><a class="headerlink" href="#thetis.implicitexplicit.IMEXLPUM2.erk_class" title="Link to this definition">¶</a></dt>
<dd><p>alias of <a class="reference internal" href="#thetis.rungekutta.ERKLPUM2" title="thetis.rungekutta.ERKLPUM2"><code class="xref py py-class docutils literal notranslate"><span class="pre">ERKLPUM2</span></code></a></p>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="thetis.implicitexplicit.IMEXLSPUM2">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">thetis.implicitexplicit.</span></span><span class="sig-name descname"><span class="pre">IMEXLSPUM2</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">equation</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">solution</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fields</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dt</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">options</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">bnd_conditions</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/implicitexplicit.html#IMEXLSPUM2"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#thetis.implicitexplicit.IMEXLSPUM2" title="Link to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#thetis.implicitexplicit.IMEXGeneric" title="thetis.implicitexplicit.IMEXGeneric"><code class="xref py py-class docutils literal notranslate"><span class="pre">IMEXGeneric</span></code></a></p>
<p>SSP-IMEX RK scheme (17) in Higureras et al. (2014)</p>
<p>CFL coefficient is 2.0</p>
<p>Higueras et al (2014). Optimized strong stability preserving IMEX
Runge-Kutta methods. Journal of Computational and Applied Mathematics
272(2014) 116-140. <a class="reference external" href="http://dx.doi.org/10.1016/j.cam.2014.05.011">http://dx.doi.org/10.1016/j.cam.2014.05.011</a></p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>equation</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">Equation</span></code> object) – equation to solve</p></li>
<li><p><strong>solution</strong> – <code class="xref py py-class docutils literal notranslate"><span class="pre">Function</span></code> where solution will be stored</p></li>
<li><p><strong>fields</strong> (dict of <code class="xref py py-class docutils literal notranslate"><span class="pre">Function</span></code> or <code class="xref py py-class docutils literal notranslate"><span class="pre">Constant</span></code> objects) – Dictionary of fields that are passed to the equation</p></li>
<li><p><strong>dt</strong> (<a class="reference external" href="https://docs.python.org/2.7/library/functions.html#float" title="(in Python v2.7)"><em>float</em></a>) – time step in seconds</p></li>
<li><p><strong>options</strong> – <code class="xref py py-class docutils literal notranslate"><span class="pre">TimeStepperOptions</span></code> instance containing parameter values.</p></li>
<li><p><strong>bnd_conditions</strong> (<a class="reference external" href="https://docs.python.org/2.7/library/stdtypes.html#dict" title="(in Python v2.7)"><em>dict</em></a>) – Dictionary of boundary conditions passed to the equation</p></li>
</ul>
</dd>
</dl>
<dl class="py attribute">
<dt class="sig sig-object py" id="thetis.implicitexplicit.IMEXLSPUM2.dirk_class">
<span class="sig-name descname"><span class="pre">dirk_class</span></span><a class="headerlink" href="#thetis.implicitexplicit.IMEXLSPUM2.dirk_class" title="Link to this definition">¶</a></dt>
<dd><p>alias of <a class="reference internal" href="#thetis.rungekutta.DIRKLSPUM2" title="thetis.rungekutta.DIRKLSPUM2"><code class="xref py py-class docutils literal notranslate"><span class="pre">DIRKLSPUM2</span></code></a></p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="thetis.implicitexplicit.IMEXLSPUM2.erk_class">
<span class="sig-name descname"><span class="pre">erk_class</span></span><a class="headerlink" href="#thetis.implicitexplicit.IMEXLSPUM2.erk_class" title="Link to this definition">¶</a></dt>
<dd><p>alias of <a class="reference internal" href="#thetis.rungekutta.ERKLSPUM2" title="thetis.rungekutta.ERKLSPUM2"><code class="xref py py-class docutils literal notranslate"><span class="pre">ERKLSPUM2</span></code></a></p>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="thetis.implicitexplicit.IMEXMidpoint">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">thetis.implicitexplicit.</span></span><span class="sig-name descname"><span class="pre">IMEXMidpoint</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">equation</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">solution</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fields</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dt</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">options</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">bnd_conditions</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/implicitexplicit.html#IMEXMidpoint"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#thetis.implicitexplicit.IMEXMidpoint" title="Link to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#thetis.implicitexplicit.IMEXGeneric" title="thetis.implicitexplicit.IMEXGeneric"><code class="xref py py-class docutils literal notranslate"><span class="pre">IMEXGeneric</span></code></a></p>
<p>Implicit-explicit midpoint scheme (1, 2, 2) from Ascher et al. (1997)</p>
<p>Ascher et al. (1997). Implicit-explicit Runge-Kutta methods for
time-dependent partial differential equations. Applied Numerical
Mathematics, 25:151-167. <a class="reference external" href="http://dx.doi.org/10.1137/0732037">http://dx.doi.org/10.1137/0732037</a></p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>equation</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">Equation</span></code> object) – equation to solve</p></li>
<li><p><strong>solution</strong> – <code class="xref py py-class docutils literal notranslate"><span class="pre">Function</span></code> where solution will be stored</p></li>
<li><p><strong>fields</strong> (dict of <code class="xref py py-class docutils literal notranslate"><span class="pre">Function</span></code> or <code class="xref py py-class docutils literal notranslate"><span class="pre">Constant</span></code> objects) – Dictionary of fields that are passed to the equation</p></li>
<li><p><strong>dt</strong> (<a class="reference external" href="https://docs.python.org/2.7/library/functions.html#float" title="(in Python v2.7)"><em>float</em></a>) – time step in seconds</p></li>
<li><p><strong>options</strong> – <code class="xref py py-class docutils literal notranslate"><span class="pre">TimeStepperOptions</span></code> instance containing parameter values.</p></li>
<li><p><strong>bnd_conditions</strong> (<a class="reference external" href="https://docs.python.org/2.7/library/stdtypes.html#dict" title="(in Python v2.7)"><em>dict</em></a>) – Dictionary of boundary conditions passed to the equation</p></li>
</ul>
</dd>
</dl>
<dl class="py attribute">
<dt class="sig sig-object py" id="thetis.implicitexplicit.IMEXMidpoint.dirk_class">
<span class="sig-name descname"><span class="pre">dirk_class</span></span><a class="headerlink" href="#thetis.implicitexplicit.IMEXMidpoint.dirk_class" title="Link to this definition">¶</a></dt>
<dd><p>alias of <a class="reference internal" href="#thetis.rungekutta.ESDIRKMidpoint" title="thetis.rungekutta.ESDIRKMidpoint"><code class="xref py py-class docutils literal notranslate"><span class="pre">ESDIRKMidpoint</span></code></a></p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="thetis.implicitexplicit.IMEXMidpoint.erk_class">
<span class="sig-name descname"><span class="pre">erk_class</span></span><a class="headerlink" href="#thetis.implicitexplicit.IMEXMidpoint.erk_class" title="Link to this definition">¶</a></dt>
<dd><p>alias of <a class="reference internal" href="#thetis.rungekutta.ERKMidpoint" title="thetis.rungekutta.ERKMidpoint"><code class="xref py py-class docutils literal notranslate"><span class="pre">ERKMidpoint</span></code></a></p>
</dd></dl>

</dd></dl>

</section>
<section id="module-thetis.interpolation">
<span id="thetis-interpolation-module"></span><h2>thetis.interpolation module<a class="headerlink" href="#module-thetis.interpolation" title="Link to this heading">¶</a></h2>
<p>Methods for interpolating data from structured data sets on Thetis fields.</p>
<p>Simple example of an atmospheric pressure interpolator:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="k">class</span><span class="w"> </span><span class="nc">WRFInterpolator</span><span class="p">(</span><span class="nb">object</span><span class="p">):</span>
    <span class="c1"># Interpolates WRF atmospheric model data on 2D fields</span>
    <span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">function_space</span><span class="p">,</span> <span class="n">atm_pressure_field</span><span class="p">,</span> <span class="n">ncfile_pattern</span><span class="p">,</span> <span class="n">init_date</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">atm_pressure_field</span> <span class="o">=</span> <span class="n">atm_pressure_field</span>

        <span class="c1"># object that interpolates forcing data from structured grid on the local mesh</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">grid_interpolator</span> <span class="o">=</span> <span class="n">NetCDFLatLonInterpolator2d</span><span class="p">(</span><span class="n">function_space</span><span class="p">,</span> <span class="n">coord_system</span><span class="p">)</span>
        <span class="c1"># reader object that can read fields from netCDF files, applies spatial interpolation</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">reader</span> <span class="o">=</span> <span class="n">NetCDFSpatialInterpolator</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">grid_interpolator</span><span class="p">,</span> <span class="p">[</span><span class="s1">&#39;prmsl&#39;</span><span class="p">])</span>
        <span class="c1"># object that can find previous/next time stamps in a collection of netCDF files</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">timesearch_obj</span> <span class="o">=</span> <span class="n">NetCDFTimeSearch</span><span class="p">(</span><span class="n">ncfile_pattern</span><span class="p">,</span> <span class="n">init_date</span><span class="p">,</span> <span class="n">NetCDFTimeParser</span><span class="p">)</span>
        <span class="c1"># finally a linear intepolator class that performs linar interpolation in time</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">interpolator</span> <span class="o">=</span> <span class="n">LinearTimeInterpolator</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">timesearch_obj</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">reader</span><span class="p">)</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">set_fields</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">time</span><span class="p">):</span>
        <span class="c1"># Evaluates forcing fields at the given time</span>
        <span class="n">pressure</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">interpolator</span><span class="p">(</span><span class="n">time</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">atm_pressure_field</span><span class="o">.</span><span class="n">dat</span><span class="o">.</span><span class="n">data_with_halos</span><span class="p">[:]</span> <span class="o">=</span> <span class="n">pressure</span>
</pre></div>
</div>
<p>Usage:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">atm_pressure_2d</span> <span class="o">=</span> <span class="n">Function</span><span class="p">(</span><span class="n">solver_obj</span><span class="o">.</span><span class="n">function_spaces</span><span class="o">.</span><span class="n">P1_2d</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="s1">&#39;atm pressure&#39;</span><span class="p">)</span>
<span class="n">wrf_pattern</span> <span class="o">=</span> <span class="s1">&#39;forcings/atm/wrf/wrf_air.2016_*_*.nc&#39;</span>
<span class="n">wrf_atm</span> <span class="o">=</span> <span class="n">WRFInterpolator</span><span class="p">(</span>
    <span class="n">solver_obj</span><span class="o">.</span><span class="n">function_spaces</span><span class="o">.</span><span class="n">P1_2d</span><span class="p">,</span>
    <span class="n">wind_stress_2d</span><span class="p">,</span> <span class="n">atm_pressure_2d</span><span class="p">,</span> <span class="n">wrf_pattern</span><span class="p">,</span> <span class="n">init_date</span><span class="p">)</span>
<span class="n">simulation_time</span> <span class="o">=</span> <span class="mf">3600.</span>
<span class="n">wrf_atm</span><span class="o">.</span><span class="n">set_fields</span><span class="p">(</span><span class="n">simulation_time</span><span class="p">)</span>
</pre></div>
</div>
<dl class="py class">
<dt class="sig sig-object py" id="thetis.interpolation.DailyFileTimeSearch">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">thetis.interpolation.</span></span><span class="sig-name descname"><span class="pre">DailyFileTimeSearch</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">file_pattern</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">init_date</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">verbose=False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">center_hour=12</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">center_timezone=&lt;UTC&gt;</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/interpolation.html#DailyFileTimeSearch"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#thetis.interpolation.DailyFileTimeSearch" title="Link to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#thetis.interpolation.TimeSearch" title="thetis.interpolation.TimeSearch"><code class="xref py py-class docutils literal notranslate"><span class="pre">TimeSearch</span></code></a></p>
<p>Treats a list of daily files as a time series.</p>
<p>File name pattern must be given as a string where the 4-digit year is
tagged with “{year:04d}”, and 2-digit zero-padded month and year are tagged
with “{month:02d}” and “{day:02d}”, respectively. The tags can be used
multiple times.</p>
<dl class="simple">
<dt>Example pattern:</dt><dd><p>‘ncom/{year:04d}/s3d.glb8_2f_{year:04d}{month:02d}{day:02d}00.nc’</p>
</dd>
</dl>
<p>In this time search method the time stamps are parsed solely from the
filename, no other metadata is used. By default the data is assumed to be
centered at 12:00 UTC every day.</p>
<dl class="py method">
<dt class="sig sig-object py" id="thetis.interpolation.DailyFileTimeSearch.find">
<span class="sig-name descname"><span class="pre">find</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">simulation_time</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">previous</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/interpolation.html#DailyFileTimeSearch.find"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#thetis.interpolation.DailyFileTimeSearch.find" title="Link to this definition">¶</a></dt>
<dd><p>Find file that contains the given simulation time</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>simulation_time</strong> (<a class="reference external" href="https://docs.python.org/2.7/library/functions.html#float" title="(in Python v2.7)"><em>float</em></a>) – simulation time in seconds</p></li>
<li><p><strong>previous</strong> (<a class="reference external" href="https://docs.python.org/2.7/library/functions.html#bool" title="(in Python v2.7)"><em>bool</em></a>) – if True finds previous existing time stamp instead
of next (default False).</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>(filename, time index, simulation time) of found data</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="thetis.interpolation.DailyFileTimeSearch.simulation_time_to_datetime">
<span class="sig-name descname"><span class="pre">simulation_time_to_datetime</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">t</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/interpolation.html#DailyFileTimeSearch.simulation_time_to_datetime"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#thetis.interpolation.DailyFileTimeSearch.simulation_time_to_datetime" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="thetis.interpolation.FileTreeReader">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">thetis.interpolation.</span></span><span class="sig-name descname"><span class="pre">FileTreeReader</span></span><a class="reference internal" href="_modules/thetis/interpolation.html#FileTreeReader"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#thetis.interpolation.FileTreeReader" title="Link to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference external" href="https://docs.python.org/2.7/library/functions.html#object" title="(in Python v2.7)"><code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></a></p>
<p>Abstract base class of file tree reader object</p>
</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="thetis.interpolation.GridInterpolator">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">thetis.interpolation.</span></span><span class="sig-name descname"><span class="pre">GridInterpolator</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">grid_xyz</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">target_xyz</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fill_mode</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fill_value</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">nan</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">normalize</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dont_raise</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/interpolation.html#GridInterpolator"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#thetis.interpolation.GridInterpolator" title="Link to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference external" href="https://docs.python.org/2.7/library/functions.html#object" title="(in Python v2.7)"><code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></a></p>
<p>A reuseable griddata interpolator object.</p>
<p>Usage:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">interpolator</span> <span class="o">=</span> <span class="n">GridInterpolator</span><span class="p">(</span><span class="n">source_xyz</span><span class="p">,</span> <span class="n">target_xyz</span><span class="p">)</span>
<span class="n">vals</span> <span class="o">=</span> <span class="n">interpolator</span><span class="p">(</span><span class="n">source_data</span><span class="p">)</span>
</pre></div>
</div>
<p>Example:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">x0</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="mi">10</span><span class="p">)</span>
<span class="n">y0</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">5</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="mi">10</span><span class="p">)</span>
<span class="n">X</span><span class="p">,</span> <span class="n">Y</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">meshgrid</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">)</span>
<span class="n">x</span> <span class="o">=</span> <span class="n">X</span><span class="o">.</span><span class="n">ravel</span><span class="p">();</span> <span class="n">y</span> <span class="o">=</span> <span class="n">Y</span><span class="o">.</span><span class="n">ravel</span><span class="p">()</span>
<span class="n">data</span> <span class="o">=</span> <span class="n">x</span> <span class="o">+</span> <span class="mf">25.</span><span class="o">*</span><span class="n">y</span>
<span class="n">x_target</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="mi">20</span><span class="p">)</span>
<span class="n">y_target</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">5</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="mi">20</span><span class="p">)</span>
<span class="n">interpolator</span> <span class="o">=</span> <span class="n">GridInterpolator</span><span class="p">(</span><span class="n">numpy</span><span class="o">.</span><span class="n">vstack</span><span class="p">((</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">))</span><span class="o">.</span><span class="n">T</span><span class="p">,</span> <span class="n">numpy</span><span class="o">.</span><span class="n">vstack</span><span class="p">((</span><span class="n">target_x</span><span class="p">,</span> <span class="n">target_y</span><span class="p">))</span><span class="o">.</span><span class="n">T</span><span class="p">)</span>
<span class="n">vals</span> <span class="o">=</span> <span class="n">interpolator</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>
</pre></div>
</div>
<p>Based on
<a class="reference external" href="http://stackoverflow.com/questions/20915502/speedup-scipy-griddata-for-multiple-interpolations-between-two-irregular-grids">http://stackoverflow.com/questions/20915502/speedup-scipy-griddata-for-multiple-interpolations-between-two-irregular-grids</a></p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>grid_xyz</strong> – Array of source grid coordinates, shape (npoints, 2) or
(npoints, 3)</p></li>
<li><p><strong>target_xyz</strong> – Array of target grid coordinates, shape (n, 2) or
(n, 3)</p></li>
<li><p><strong>fill_mode</strong> – Determines how points outside the source grid will be
treated. If ‘nearest’, value of the nearest source point will be
used. Otherwise a constant fill value will be used (default).</p></li>
<li><p><strong>fill_value</strong> (<a class="reference external" href="https://docs.python.org/2.7/library/functions.html#float" title="(in Python v2.7)"><em>float</em></a>) – Set the fill value (default: NaN)</p></li>
<li><p><strong>normalize</strong> (<a class="reference external" href="https://docs.python.org/2.7/library/functions.html#bool" title="(in Python v2.7)"><em>bool</em></a>) – If true the data is scaled to unit cube before
interpolation. Default: False.</p></li>
<li><p><strong>dont_raise</strong> (<a class="reference external" href="https://docs.python.org/2.7/library/functions.html#bool" title="(in Python v2.7)"><em>bool</em></a>) – Do not raise a Qhull error if triangulation
fails. In this case the data will be set to fill value or nearest
neighbor value.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="thetis.interpolation.LinearTimeInterpolator">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">thetis.interpolation.</span></span><span class="sig-name descname"><span class="pre">LinearTimeInterpolator</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">timesearch_obj</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">reader</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/interpolation.html#LinearTimeInterpolator"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#thetis.interpolation.LinearTimeInterpolator" title="Link to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference external" href="https://docs.python.org/2.7/library/functions.html#object" title="(in Python v2.7)"><code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></a></p>
<p>Interpolates time series in time</p>
<p>User must provide timesearch_obj that finds time stamps from
a file tree, and a reader that can read those time stamps into numpy arrays.</p>
<p>Previous/next data sets are cached in memory to avoid hitting disk every
time.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>timesearch_obj</strong> – TimeSearch object</p></li>
<li><p><strong>reader</strong> – FileTreeReader object</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="thetis.interpolation.NetCDFLatLonInterpolator2d">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">thetis.interpolation.</span></span><span class="sig-name descname"><span class="pre">NetCDFLatLonInterpolator2d</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">function_space</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">coord_system</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fill_mode</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fill_value</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">nan</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/interpolation.html#NetCDFLatLonInterpolator2d"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#thetis.interpolation.NetCDFLatLonInterpolator2d" title="Link to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#thetis.interpolation.SpatialInterpolator2d" title="thetis.interpolation.SpatialInterpolator2d"><code class="xref py py-class docutils literal notranslate"><span class="pre">SpatialInterpolator2d</span></code></a></p>
<p>Interpolates netCDF data on a local 2D unstructured mesh</p>
<p>The intepolator is constructed for a single netCDF file that defines the
source grid. Once the interpolator has been constructed, data can be read
from any file that uses the same grid.</p>
<p>This routine returns the data in numpy arrays.</p>
<p>Usage:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">fs</span> <span class="o">=</span> <span class="n">FunctionSpace</span><span class="p">(</span><span class="o">...</span><span class="p">)</span>
<span class="n">myfunc</span> <span class="o">=</span> <span class="n">Function</span><span class="p">(</span><span class="n">fs</span><span class="p">,</span> <span class="o">...</span><span class="p">)</span>
<span class="n">ncinterp2d</span> <span class="o">=</span> <span class="n">NetCDFLatLonInterpolator2d</span><span class="p">(</span><span class="n">fs</span><span class="p">,</span> <span class="n">coord_system</span><span class="p">,</span> <span class="n">nc_filename</span><span class="p">)</span>
<span class="n">val1</span><span class="p">,</span> <span class="n">val2</span> <span class="o">=</span> <span class="n">ncinterp2d</span><span class="o">.</span><span class="n">interpolate</span><span class="p">(</span><span class="n">nc_filename</span><span class="p">,</span> <span class="p">[</span><span class="s1">&#39;var1&#39;</span><span class="p">,</span> <span class="s1">&#39;var2&#39;</span><span class="p">],</span> <span class="mi">10</span><span class="p">)</span>
<span class="n">myfunc</span><span class="o">.</span><span class="n">dat</span><span class="o">.</span><span class="n">data_with_halos</span><span class="p">[:]</span> <span class="o">=</span> <span class="n">val1</span> <span class="o">+</span> <span class="n">val2</span>
</pre></div>
</div>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>function_space</strong> – target Firedrake FunctionSpace</p></li>
<li><p><strong>coord_system</strong> – <code class="xref py py-class docutils literal notranslate"><span class="pre">CoordinateSystem</span></code> object</p></li>
<li><p><strong>fill_mode</strong> – Determines how points outside the source grid will be
treated. If ‘nearest’, value of the nearest source point will be
used. Otherwise a constant fill value will be used (default).</p></li>
<li><p><strong>fill_value</strong> (<a class="reference external" href="https://docs.python.org/2.7/library/functions.html#float" title="(in Python v2.7)"><em>float</em></a>) – Set the fill value (default: NaN)</p></li>
</ul>
</dd>
</dl>
<dl class="py method">
<dt class="sig sig-object py" id="thetis.interpolation.NetCDFLatLonInterpolator2d.interpolate">
<span class="sig-name descname"><span class="pre">interpolate</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">nc_filename</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">variable_list</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">itime</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/interpolation.html#NetCDFLatLonInterpolator2d.interpolate"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#thetis.interpolation.NetCDFLatLonInterpolator2d.interpolate" title="Link to this definition">¶</a></dt>
<dd><p>Interpolates data from a netCDF file onto Firedrake function space.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>nc_filename</strong> (<a class="reference external" href="https://docs.python.org/2.7/library/functions.html#str" title="(in Python v2.7)"><em>str</em></a>) – netCDF file to read</p></li>
<li><p><strong>variable_list</strong> – list of netCDF variable names to read</p></li>
<li><p><strong>itime</strong> (<a class="reference external" href="https://docs.python.org/2.7/library/functions.html#int" title="(in Python v2.7)"><em>int</em></a>) – time index to read</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>list of numpy.arrays corresponding to variable_list</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="thetis.interpolation.NetCDFSpatialInterpolator">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">thetis.interpolation.</span></span><span class="sig-name descname"><span class="pre">NetCDFSpatialInterpolator</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">grid_interpolator</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">variable_list</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/interpolation.html#NetCDFSpatialInterpolator"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#thetis.interpolation.NetCDFSpatialInterpolator" title="Link to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#thetis.interpolation.FileTreeReader" title="thetis.interpolation.FileTreeReader"><code class="xref py py-class docutils literal notranslate"><span class="pre">FileTreeReader</span></code></a></p>
<p>Wrapper class that provides FileTreeReader API for grid interpolators</p>
</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="thetis.interpolation.NetCDFTimeParser">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">thetis.interpolation.</span></span><span class="sig-name descname"><span class="pre">NetCDFTimeParser</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">filename</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">time_variable_name</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'time'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">allow_gaps</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">verbose</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/interpolation.html#NetCDFTimeParser"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#thetis.interpolation.NetCDFTimeParser" title="Link to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#thetis.interpolation.TimeParser" title="thetis.interpolation.TimeParser"><code class="xref py py-class docutils literal notranslate"><span class="pre">TimeParser</span></code></a></p>
<p>Describes the time stamps stored in a netCDF file.</p>
<p>Construct a new object by scraping data from the given netcdf file.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>filename</strong> (<a class="reference external" href="https://docs.python.org/2.7/library/functions.html#str" title="(in Python v2.7)"><em>str</em></a>) – name of the netCDF file to read</p></li>
<li><p><strong>time_variable_name</strong> (<a class="reference external" href="https://docs.python.org/2.7/library/functions.html#str" title="(in Python v2.7)"><em>str</em></a>) – name of the time variable in the netCDF
file (default: ‘time’)</p></li>
<li><p><strong>allow_gaps</strong> (<a class="reference external" href="https://docs.python.org/2.7/library/functions.html#bool" title="(in Python v2.7)"><em>bool</em></a>) – if False, an error is raised if time step is
not constant.</p></li>
</ul>
</dd>
</dl>
<dl class="py method">
<dt class="sig sig-object py" id="thetis.interpolation.NetCDFTimeParser.find_time_stamp">
<span class="sig-name descname"><span class="pre">find_time_stamp</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">t</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">previous</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/interpolation.html#NetCDFTimeParser.find_time_stamp"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#thetis.interpolation.NetCDFTimeParser.find_time_stamp" title="Link to this definition">¶</a></dt>
<dd><p>Given time t, returns index of the next (previous) time stamp</p>
<p>raises IndexError if t is out of range, i.e.
t &gt; self.get_end_time() or t &lt; self.get_start_time()</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="thetis.interpolation.NetCDFTimeParser.get_end_time">
<span class="sig-name descname"><span class="pre">get_end_time</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/interpolation.html#NetCDFTimeParser.get_end_time"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#thetis.interpolation.NetCDFTimeParser.get_end_time" title="Link to this definition">¶</a></dt>
<dd><p>Returns the last time stamp in the file/data set</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="thetis.interpolation.NetCDFTimeParser.get_start_time">
<span class="sig-name descname"><span class="pre">get_start_time</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/interpolation.html#NetCDFTimeParser.get_start_time"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#thetis.interpolation.NetCDFTimeParser.get_start_time" title="Link to this definition">¶</a></dt>
<dd><p>Returns the first time stamp in the file/data set</p>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="thetis.interpolation.NetCDFTimeSearch">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">thetis.interpolation.</span></span><span class="sig-name descname"><span class="pre">NetCDFTimeSearch</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">file_pattern</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">init_date</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">netcdf_class</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/interpolation.html#NetCDFTimeSearch"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#thetis.interpolation.NetCDFTimeSearch" title="Link to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#thetis.interpolation.TimeSearch" title="thetis.interpolation.TimeSearch"><code class="xref py py-class docutils literal notranslate"><span class="pre">TimeSearch</span></code></a></p>
<p>Finds a nearest time stamp in a collection of netCDF files.</p>
<dl class="py method">
<dt class="sig sig-object py" id="thetis.interpolation.NetCDFTimeSearch.find">
<span class="sig-name descname"><span class="pre">find</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">simulation_time</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">previous</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/interpolation.html#NetCDFTimeSearch.find"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#thetis.interpolation.NetCDFTimeSearch.find" title="Link to this definition">¶</a></dt>
<dd><p>Find file that contains the given simulation time</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>simulation_time</strong> (<a class="reference external" href="https://docs.python.org/2.7/library/functions.html#float" title="(in Python v2.7)"><em>float</em></a>) – simulation time in seconds</p></li>
<li><p><strong>previous</strong> (<a class="reference external" href="https://docs.python.org/2.7/library/functions.html#bool" title="(in Python v2.7)"><em>bool</em></a>) – if True finds previous existing time stamp instead
of next (default False).</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>(filename, time index, simulation time) of found data</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="thetis.interpolation.NetCDFTimeSearch.simulation_time_to_datetime">
<span class="sig-name descname"><span class="pre">simulation_time_to_datetime</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">t</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/interpolation.html#NetCDFTimeSearch.simulation_time_to_datetime"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#thetis.interpolation.NetCDFTimeSearch.simulation_time_to_datetime" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="thetis.interpolation.NetCDFTimeSeriesInterpolator">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">thetis.interpolation.</span></span><span class="sig-name descname"><span class="pre">NetCDFTimeSeriesInterpolator</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">ncfile_pattern</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">variable_list</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">init_date</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">time_variable_name</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'time'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">scalars</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">allow_gaps</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/interpolation.html#NetCDFTimeSeriesInterpolator"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#thetis.interpolation.NetCDFTimeSeriesInterpolator" title="Link to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference external" href="https://docs.python.org/2.7/library/functions.html#object" title="(in Python v2.7)"><code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></a></p>
<p>Reads and interpolates scalar time series from a sequence of netCDF files.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>ncfile_pattern</strong> (<a class="reference external" href="https://docs.python.org/2.7/library/functions.html#str" title="(in Python v2.7)"><em>str</em></a>) – file search pattern, e.g. “mydir/foo_*.nc”</p></li>
<li><p><strong>variable_list</strong> – list if netCDF variable names to read</p></li>
<li><p><strong>init_date</strong> (<a class="reference external" href="https://docs.python.org/2.7/library/datetime.html#datetime.datetime" title="(in Python v2.7)"><em>datetime.datetime</em></a>) – simulation start time</p></li>
<li><p><strong>scalars</strong> – (optional) list of scalars; scale output variables by
a factor.</p></li>
</ul>
</dd>
</dl>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>All the variables must have the same dimensions in the netCDF files.
If the shapes differ, create separate interpolator instances.</p>
</div>
</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="thetis.interpolation.NetCDFTimeSeriesReader">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">thetis.interpolation.</span></span><span class="sig-name descname"><span class="pre">NetCDFTimeSeriesReader</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">variable_list</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">time_variable_name</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'time'</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/interpolation.html#NetCDFTimeSeriesReader"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#thetis.interpolation.NetCDFTimeSeriesReader" title="Link to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#thetis.interpolation.FileTreeReader" title="thetis.interpolation.FileTreeReader"><code class="xref py py-class docutils literal notranslate"><span class="pre">FileTreeReader</span></code></a></p>
<p>A simple netCDF reader that returns a time slice of the given variable.</p>
<p>This class does not interpolate the data in any way. Useful for
interpolating time series.</p>
</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="thetis.interpolation.SpatialInterpolator">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">thetis.interpolation.</span></span><span class="sig-name descname"><span class="pre">SpatialInterpolator</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">function_space</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">coord_system</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/interpolation.html#SpatialInterpolator"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#thetis.interpolation.SpatialInterpolator" title="Link to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">ABC</span></code></p>
<p>Abstract base class for spatial interpolators that read data from disk</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>function_space</strong> – target Firedrake FunctionSpace</p></li>
<li><p><strong>coord_system</strong> – <code class="xref py py-class docutils literal notranslate"><span class="pre">CoordinateSystem</span></code> object</p></li>
</ul>
</dd>
</dl>
<dl class="py method">
<dt class="sig sig-object py" id="thetis.interpolation.SpatialInterpolator.interpolate">
<em class="property"><span class="pre">abstract</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">interpolate</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">filename</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">variable_list</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">itime</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/interpolation.html#SpatialInterpolator.interpolate"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#thetis.interpolation.SpatialInterpolator.interpolate" title="Link to this definition">¶</a></dt>
<dd><p>Interpolates data from the given file at given time step</p>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="thetis.interpolation.SpatialInterpolator2d">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">thetis.interpolation.</span></span><span class="sig-name descname"><span class="pre">SpatialInterpolator2d</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">function_space</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">coord_system</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fill_mode</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fill_value</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">nan</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/interpolation.html#SpatialInterpolator2d"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#thetis.interpolation.SpatialInterpolator2d" title="Link to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#thetis.interpolation.SpatialInterpolator" title="thetis.interpolation.SpatialInterpolator"><code class="xref py py-class docutils literal notranslate"><span class="pre">SpatialInterpolator</span></code></a>, <code class="xref py py-class docutils literal notranslate"><span class="pre">ABC</span></code></p>
<p>Abstract spatial interpolator class that can interpolate onto a 2D Function</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>function_space</strong> – target Firedrake FunctionSpace</p></li>
<li><p><strong>coord_system</strong> – <code class="xref py py-class docutils literal notranslate"><span class="pre">CoordinateSystem</span></code> object</p></li>
<li><p><strong>fill_mode</strong> – Determines how points outside the source grid will be
treated. If ‘nearest’, value of the nearest source point will be
used. Otherwise a constant fill value will be used (default).</p></li>
<li><p><strong>fill_value</strong> (<a class="reference external" href="https://docs.python.org/2.7/library/functions.html#float" title="(in Python v2.7)"><em>float</em></a>) – Set the fill value (default: NaN)</p></li>
</ul>
</dd>
</dl>
<dl class="py method">
<dt class="sig sig-object py" id="thetis.interpolation.SpatialInterpolator2d.interpolate">
<em class="property"><span class="pre">abstract</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">interpolate</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">filename</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">variable_list</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">time</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/interpolation.html#SpatialInterpolator2d.interpolate"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#thetis.interpolation.SpatialInterpolator2d.interpolate" title="Link to this definition">¶</a></dt>
<dd><p>Calls the interpolator object</p>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="thetis.interpolation.TimeParser">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">thetis.interpolation.</span></span><span class="sig-name descname"><span class="pre">TimeParser</span></span><a class="reference internal" href="_modules/thetis/interpolation.html#TimeParser"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#thetis.interpolation.TimeParser" title="Link to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference external" href="https://docs.python.org/2.7/library/functions.html#object" title="(in Python v2.7)"><code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></a></p>
<p>Abstract base class for time definition objects.</p>
<p>Defines the time span that a file (or data set) covers and provides a time
index search routine.</p>
<dl class="py method">
<dt class="sig sig-object py" id="thetis.interpolation.TimeParser.find_time_stamp">
<em class="property"><span class="pre">abstract</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">find_time_stamp</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">t</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">previous</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/interpolation.html#TimeParser.find_time_stamp"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#thetis.interpolation.TimeParser.find_time_stamp" title="Link to this definition">¶</a></dt>
<dd><p>Given time t, returns index of the next (previous) time stamp</p>
<p>raises IndexError if t is out of range, i.e.
t &gt; self.get_end_time() or t &lt; self.get_start_time()</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="thetis.interpolation.TimeParser.get_end_time">
<em class="property"><span class="pre">abstract</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">get_end_time</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/interpolation.html#TimeParser.get_end_time"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#thetis.interpolation.TimeParser.get_end_time" title="Link to this definition">¶</a></dt>
<dd><p>Returns the last time stamp in the file/data set</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="thetis.interpolation.TimeParser.get_start_time">
<em class="property"><span class="pre">abstract</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">get_start_time</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/interpolation.html#TimeParser.get_start_time"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#thetis.interpolation.TimeParser.get_start_time" title="Link to this definition">¶</a></dt>
<dd><p>Returns the first time stamp in the file/data set</p>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="thetis.interpolation.TimeSearch">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">thetis.interpolation.</span></span><span class="sig-name descname"><span class="pre">TimeSearch</span></span><a class="reference internal" href="_modules/thetis/interpolation.html#TimeSearch"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#thetis.interpolation.TimeSearch" title="Link to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference external" href="https://docs.python.org/2.7/library/functions.html#object" title="(in Python v2.7)"><code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></a></p>
<p>Base class for searching nearest time steps in a file tree or database</p>
<dl class="py method">
<dt class="sig sig-object py" id="thetis.interpolation.TimeSearch.find">
<em class="property"><span class="pre">abstract</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">find</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">time</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">previous</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/interpolation.html#TimeSearch.find"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#thetis.interpolation.TimeSearch.find" title="Link to this definition">¶</a></dt>
<dd><p>Find a next (previous) time stamp from a given time</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>time</strong> (<a class="reference external" href="https://docs.python.org/2.7/library/functions.html#float" title="(in Python v2.7)"><em>float</em></a>) – input time stamp</p></li>
<li><p><strong>previous</strong> (<a class="reference external" href="https://docs.python.org/2.7/library/functions.html#bool" title="(in Python v2.7)"><em>bool</em></a>) – if True, look for last time stamp before requested
time. Otherwise returns next time stamp.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>a (filename, time_index, time) tuple</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="thetis.interpolation.get_ncvar_name">
<span class="sig-prename descclassname"><span class="pre">thetis.interpolation.</span></span><span class="sig-name descname"><span class="pre">get_ncvar_name</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">ncfile</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">standard_name</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">long_name</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">var_name</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/interpolation.html#get_ncvar_name"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#thetis.interpolation.get_ncvar_name" title="Link to this definition">¶</a></dt>
<dd><p>Look for variables that match either CF standard_name or long_name
attributes.</p>
<p>If both are defined, standard_name takes precedence.</p>
<p>Note that the attributes in the netCDF file converted to
lower case prior to checking.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>ncfile</strong> – netCDF4 Dataset object</p></li>
<li><p><strong>standard_name</strong> – a target standard_name, or a list of them</p></li>
<li><p><strong>long_name</strong> – a target long_name, or a list of them</p></li>
<li><p><strong>var_name</strong> – a target netCDF variable name, or a list of them</p></li>
</ul>
</dd>
</dl>
</dd></dl>

</section>
<section id="module-thetis.inversion_tools">
<span id="thetis-inversion-tools-module"></span><h2>thetis.inversion_tools module<a class="headerlink" href="#module-thetis.inversion_tools" title="Link to this heading">¶</a></h2>
<dl class="py class">
<dt class="sig sig-object py" id="thetis.inversion_tools.ControlRegularizationManager">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">thetis.inversion_tools.</span></span><span class="sig-name descname"><span class="pre">ControlRegularizationManager</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">function_list</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">gamma_list</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">penalty_term_scaling=None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">calculator=&lt;class</span> <span class="pre">'thetis.inversion_tools.HessianRegularizationCalculator'&gt;</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">calculator_kwargs=None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/inversion_tools.html#ControlRegularizationManager"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#thetis.inversion_tools.ControlRegularizationManager" title="Link to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference external" href="https://docs.python.org/2.7/library/functions.html#object" title="(in Python v2.7)"><code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></a></p>
<p>Handles regularization of multiple control fields</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>function_list</strong> – list of control functions</p></li>
<li><p><strong>gamma_list</strong> – list of penalty parameters</p></li>
<li><p><strong>penalty_term_scaling</strong> – Penalty term scaling factor</p></li>
<li><p><strong>calculator</strong> – class used for obtaining regularization</p></li>
</ul>
</dd>
</dl>
<dl class="py method">
<dt class="sig sig-object py" id="thetis.inversion_tools.ControlRegularizationManager.eval_cost_function">
<span class="sig-name descname"><span class="pre">eval_cost_function</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/inversion_tools.html#ControlRegularizationManager.eval_cost_function"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#thetis.inversion_tools.ControlRegularizationManager.eval_cost_function" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="thetis.inversion_tools.GradientRegularizationCalculator">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">thetis.inversion_tools.</span></span><span class="sig-name descname"><span class="pre">GradientRegularizationCalculator</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">function</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">gradient_penalty</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">scaling</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">use_local_element_size</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/inversion_tools.html#GradientRegularizationCalculator"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#thetis.inversion_tools.GradientRegularizationCalculator" title="Link to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#thetis.inversion_tools.RegularizationCalculator" title="thetis.inversion_tools.RegularizationCalculator"><code class="xref py py-class docutils literal notranslate"><span class="pre">RegularizationCalculator</span></code></a></p>
<p>Computes the following regularization term for a control Function <cite>f</cite>:</p>
<div class="math notranslate nohighlight">
\[J = \gamma \| (\Delta x) \nabla f \|^2,\]</div>
<p>where:</p>
<ul class="simple">
<li><p><span class="math notranslate nohighlight">\(\nabla f\)</span> is the gradient of the field <cite>f</cite>.</p></li>
<li><p><span class="math notranslate nohighlight">\(\Delta x\)</span> is the characteristic element size (cell size)
used to scale the gradient regularization.</p></li>
</ul>
<p>The element size defaults to varying spatially with the mesh,
but can be set constant with the smallest element size by specifying
the <cite>use_local_element_size</cite> flag to be False.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>function</strong> – Control <code class="xref py py-class docutils literal notranslate"><span class="pre">Function</span></code></p></li>
<li><p><strong>gradient_penalty</strong> – Gradient penalty coefficient</p></li>
<li><p><strong>scaling</strong> – Optional global scaling for the regularization term</p></li>
</ul>
</dd>
</dl>
<dl class="py method">
<dt class="sig sig-object py" id="thetis.inversion_tools.GradientRegularizationCalculator.eval_cost_function">
<span class="sig-name descname"><span class="pre">eval_cost_function</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/inversion_tools.html#GradientRegularizationCalculator.eval_cost_function"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#thetis.inversion_tools.GradientRegularizationCalculator.eval_cost_function" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="thetis.inversion_tools.HessianRegularizationCalculator">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">thetis.inversion_tools.</span></span><span class="sig-name descname"><span class="pre">HessianRegularizationCalculator</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">function</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">hessian_penalty</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">scaling</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">use_local_element_size</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/inversion_tools.html#HessianRegularizationCalculator"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#thetis.inversion_tools.HessianRegularizationCalculator" title="Link to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#thetis.inversion_tools.RegularizationCalculator" title="thetis.inversion_tools.RegularizationCalculator"><code class="xref py py-class docutils literal notranslate"><span class="pre">RegularizationCalculator</span></code></a></p>
<p>Computes the following regularization term for a cost function
involving a control <code class="xref py py-class docutils literal notranslate"><span class="pre">Function</span></code> <span class="math notranslate nohighlight">\(f\)</span>:</p>
<div class="math notranslate nohighlight">
\[J = \gamma \| (\Delta x)^2 H(f) \|^2,\]</div>
<p>where:</p>
<blockquote>
<div><blockquote>
<div><ul class="simple">
<li><p><span class="math notranslate nohighlight">\(H\)</span> is the Hessian of field <span class="math notranslate nohighlight">\(f\)</span>.</p></li>
<li><p><span class="math notranslate nohighlight">\(\Delta x\)</span> is the characteristic element size (cell size)</p></li>
</ul>
</div></blockquote>
<p>used to scale the gradient regularization.</p>
</div></blockquote>
<p>The element size defaults to varying spatially with the mesh,
but can be set constant with the smallest element size by specifying
the <cite>use_local_element_size</cite> flag to be False.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>function</strong> – Control <code class="xref py py-class docutils literal notranslate"><span class="pre">Function</span></code></p></li>
<li><p><strong>hessian_penalty</strong> – Hessian penalty coefficient</p></li>
</ul>
</dd>
</dl>
<dl class="py method">
<dt class="sig sig-object py" id="thetis.inversion_tools.HessianRegularizationCalculator.eval_cost_function">
<span class="sig-name descname"><span class="pre">eval_cost_function</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/inversion_tools.html#HessianRegularizationCalculator.eval_cost_function"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#thetis.inversion_tools.HessianRegularizationCalculator.eval_cost_function" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="thetis.inversion_tools.InversionManager">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">thetis.inversion_tools.</span></span><span class="sig-name descname"><span class="pre">InversionManager</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Any</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/inversion_tools.html#InversionManager"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#thetis.inversion_tools.InversionManager" title="Link to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#thetis.configuration.FrozenHasTraits" title="thetis.configuration.FrozenHasTraits"><code class="xref py py-class docutils literal notranslate"><span class="pre">FrozenHasTraits</span></code></a></p>
<p>Class for handling inversion problems and stashing
the progress of the associated optimization routines.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>sta_manager</strong> – the <code class="xref py py-class docutils literal notranslate"><span class="pre">StationManager</span></code> instance</p></li>
<li><p><strong>output_dir</strong> – model output directory</p></li>
<li><p><strong>no_exports</strong> – if True, nothing will be written to disk</p></li>
<li><p><strong>real</strong> – is the inversion in the Real space?</p></li>
<li><p><strong>penalty_parameters</strong> – a list of penalty parameters to pass
to the <a class="reference internal" href="#thetis.inversion_tools.ControlRegularizationManager" title="thetis.inversion_tools.ControlRegularizationManager"><code class="xref py py-class docutils literal notranslate"><span class="pre">ControlRegularizationManager</span></code></a></p></li>
<li><p><strong>cost_function_scaling</strong> – global scaling for the cost function.
As rule of thumb, it’s good to scale the functional to J &lt; 1.</p></li>
<li><p><strong>test_consistency</strong> – toggle testing the correctness with
which the <code class="xref py py-class docutils literal notranslate"><span class="pre">ReducedFunctional</span></code> can recompute values</p></li>
<li><p><strong>test_gradient</strong> – toggle testing the correctness with
which the <code class="xref py py-class docutils literal notranslate"><span class="pre">ReducedFunctional</span></code> can recompute gradients</p></li>
</ul>
</dd>
</dl>
<dl class="py method">
<dt class="sig sig-object py" id="thetis.inversion_tools.InversionManager.add_control">
<span class="sig-name descname"><span class="pre">add_control</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">f</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/inversion_tools.html#InversionManager.add_control"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#thetis.inversion_tools.InversionManager.add_control" title="Link to this definition">¶</a></dt>
<dd><p>Add a control field.</p>
<p>Can be called multiple times in case of multiparameter optimization.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>f</strong> – Function or Constant to be used as a control variable.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="thetis.inversion_tools.InversionManager.consistency_test">
<span class="sig-name descname"><span class="pre">consistency_test</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/inversion_tools.html#InversionManager.consistency_test"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#thetis.inversion_tools.InversionManager.consistency_test" title="Link to this definition">¶</a></dt>
<dd><p>Test that <a class="reference internal" href="#thetis.inversion_tools.InversionManager.reduced_functional" title="thetis.inversion_tools.InversionManager.reduced_functional"><code class="xref py py-attr docutils literal notranslate"><span class="pre">reduced_functional</span></code></a> can correctly recompute the
objective value, assuming that none of the controls have changed
since it was created.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="thetis.inversion_tools.InversionManager.get_cost_function">
<span class="sig-name descname"><span class="pre">get_cost_function</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">solver_obj</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">weight_by_variance</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">regularisation_manager</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'Hessian'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">use_local_element_size</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/inversion_tools.html#InversionManager.get_cost_function"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#thetis.inversion_tools.InversionManager.get_cost_function" title="Link to this definition">¶</a></dt>
<dd><blockquote>
<div><p>Get a sum of square errors cost function for the problem:</p>
</div></blockquote>
<dl>
<dt>..math::</dt><dd><blockquote>
<div><p>J(u) = sum_{i=1}^{n_{ts}} sum_{j=1}^{n_{sta}} (u_j^{(i)} - u_{j,o}^{(i)})^2,</p>
</div></blockquote>
<p>where <span class="math notranslate nohighlight">\(u_{j,o}^{(i)}\)</span> and <span class="math notranslate nohighlight">\(u_j^{(i)}\)</span> denote the
observed and computed values at timestep <span class="math notranslate nohighlight">\(i\)</span>, and
<span class="math notranslate nohighlight">\(n_{ts}\)</span> and <span class="math notranslate nohighlight">\(n_{sta}\)</span> are the numbers of timesteps
and stations, respectively.</p>
<p>Regularization terms are included if a
<code class="xref py py-class docutils literal notranslate"><span class="pre">RegularizationManager</span></code> instance is provided.</p>
<dl class="field-list simple">
<dt class="field-odd">arg solver_obj<span class="colon">:</span></dt>
<dd class="field-odd"><p>the <code class="xref py py-class docutils literal notranslate"><span class="pre">FlowSolver2d</span></code> instance</p>
</dd>
<dt class="field-even">kwarg weight_by_variance<span class="colon">:</span></dt>
<dd class="field-even"><p>should the observation data be
weighted by the variance at each station?</p>
</dd>
<dt class="field-odd">kwarg regularisation_manager<span class="colon">:</span></dt>
<dd class="field-odd"><p>which regularisation to apply
(“Hessian” or “Gradient”)</p>
</dd>
<dt class="field-even">kwarg use_local_element_size<span class="colon">:</span></dt>
<dd class="field-even"><p>choose whether to use local
(varying) element size to normalise regularisation units</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="thetis.inversion_tools.InversionManager.get_optimization_callback">
<span class="sig-name descname"><span class="pre">get_optimization_callback</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/inversion_tools.html#InversionManager.get_optimization_callback"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#thetis.inversion_tools.InversionManager.get_optimization_callback" title="Link to this definition">¶</a></dt>
<dd><p>Get a callback for stashing optimization progress
after successful line search.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="thetis.inversion_tools.InversionManager.initialize">
<span class="sig-name descname"><span class="pre">initialize</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/inversion_tools.html#InversionManager.initialize"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#thetis.inversion_tools.InversionManager.initialize" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="thetis.inversion_tools.InversionManager.minimize">
<span class="sig-name descname"><span class="pre">minimize</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">opt_method</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'BFGS'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">bounds</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">opt_options</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/inversion_tools.html#InversionManager.minimize"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#thetis.inversion_tools.InversionManager.minimize" title="Link to this definition">¶</a></dt>
<dd><p>Minimize the reduced functional using a given optimization routine.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>opt_method</strong> – the optimization routine</p></li>
<li><p><strong>bounds</strong> – a list of bounds to pass to the optimization routine</p></li>
<li><p><strong>opt_options</strong> – other optimization parameters to pass</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="thetis.inversion_tools.InversionManager.reduced_functional">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">reduced_functional</span></span><a class="headerlink" href="#thetis.inversion_tools.InversionManager.reduced_functional" title="Link to this definition">¶</a></dt>
<dd><p>Create a Pyadjoint <code class="xref py py-class docutils literal notranslate"><span class="pre">ReducedFunctional</span></code> for the optimization.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="thetis.inversion_tools.InversionManager.reset_counters">
<span class="sig-name descname"><span class="pre">reset_counters</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/inversion_tools.html#InversionManager.reset_counters"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#thetis.inversion_tools.InversionManager.reset_counters" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="thetis.inversion_tools.InversionManager.rf_kwargs">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">rf_kwargs</span></span><a class="headerlink" href="#thetis.inversion_tools.InversionManager.rf_kwargs" title="Link to this definition">¶</a></dt>
<dd><p>Default keyword arguments to pass to the
<code class="xref py py-class docutils literal notranslate"><span class="pre">ReducedFunctional</span></code> class.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="thetis.inversion_tools.InversionManager.set_control_state">
<span class="sig-name descname"><span class="pre">set_control_state</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">j</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">djdm_list</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">m_list</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/inversion_tools.html#InversionManager.set_control_state"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#thetis.inversion_tools.InversionManager.set_control_state" title="Link to this definition">¶</a></dt>
<dd><p>Stores optimization state.</p>
<p>To call whenever variables are updated.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>j</strong> – error functional value</p></li>
<li><p><strong>djdm_list</strong> – list of gradient functions</p></li>
<li><p><strong>m_list</strong> – list of control coefficents</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="thetis.inversion_tools.InversionManager.set_initial_state">
<span class="sig-name descname"><span class="pre">set_initial_state</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">state</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/inversion_tools.html#InversionManager.set_initial_state"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#thetis.inversion_tools.InversionManager.set_initial_state" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="thetis.inversion_tools.InversionManager.start_clock">
<span class="sig-name descname"><span class="pre">start_clock</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/inversion_tools.html#InversionManager.start_clock"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#thetis.inversion_tools.InversionManager.start_clock" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="thetis.inversion_tools.InversionManager.stop_annotating">
<span class="sig-name descname"><span class="pre">stop_annotating</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/inversion_tools.html#InversionManager.stop_annotating"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#thetis.inversion_tools.InversionManager.stop_annotating" title="Link to this definition">¶</a></dt>
<dd><p>Stop recording operations for the adjoint solver.</p>
<p>This method should be called after the <code class="xref py py-meth docutils literal notranslate"><span class="pre">iterate()</span></code>
method of <code class="xref py py-class docutils literal notranslate"><span class="pre">FlowSolver2d</span></code>.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="thetis.inversion_tools.InversionManager.stop_clock">
<span class="sig-name descname"><span class="pre">stop_clock</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/inversion_tools.html#InversionManager.stop_clock"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#thetis.inversion_tools.InversionManager.stop_clock" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="thetis.inversion_tools.InversionManager.taylor_test">
<span class="sig-name descname"><span class="pre">taylor_test</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/inversion_tools.html#InversionManager.taylor_test"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#thetis.inversion_tools.InversionManager.taylor_test" title="Link to this definition">¶</a></dt>
<dd><p>Run a Taylor test to check that the <a class="reference internal" href="#thetis.inversion_tools.InversionManager.reduced_functional" title="thetis.inversion_tools.InversionManager.reduced_functional"><code class="xref py py-attr docutils literal notranslate"><span class="pre">reduced_functional</span></code></a> can
correctly compute consistent gradients.</p>
<p>Note that the Taylor test is applied on the current control values.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="thetis.inversion_tools.InversionManager.update_progress">
<span class="sig-name descname"><span class="pre">update_progress</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/inversion_tools.html#InversionManager.update_progress"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#thetis.inversion_tools.InversionManager.update_progress" title="Link to this definition">¶</a></dt>
<dd><p>Updates optimization progress and stores variables to disk.</p>
<p>To call after successful line searches.</p>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="thetis.inversion_tools.RSpaceRegularizationCalculator">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">thetis.inversion_tools.</span></span><span class="sig-name descname"><span class="pre">RSpaceRegularizationCalculator</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">function</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">gamma</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">eps</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.001</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">scaling</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1.0</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/inversion_tools.html#RSpaceRegularizationCalculator"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#thetis.inversion_tools.RSpaceRegularizationCalculator" title="Link to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#thetis.inversion_tools.RegularizationCalculator" title="thetis.inversion_tools.RegularizationCalculator"><code class="xref py py-class docutils literal notranslate"><span class="pre">RegularizationCalculator</span></code></a></p>
<p>Computes the following regularization term for a cost function
involving a control <code class="xref py py-class docutils literal notranslate"><span class="pre">Function</span></code> <span class="math notranslate nohighlight">\(f\)</span> from an R-space:</p>
<div class="math notranslate nohighlight">
\[J = \gamma (f - f_0)^2,\]</div>
<p>where <span class="math notranslate nohighlight">\(f_0\)</span> is a prior, taken to be the initial value of
<span class="math notranslate nohighlight">\(f\)</span>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>function</strong> – Control <code class="xref py py-class docutils literal notranslate"><span class="pre">Function</span></code></p></li>
<li><p><strong>gamma</strong> – penalty coefficient</p></li>
<li><p><strong>eps</strong> – tolerance for normalising by near-zero priors</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="thetis.inversion_tools.RegularizationCalculator">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">thetis.inversion_tools.</span></span><span class="sig-name descname"><span class="pre">RegularizationCalculator</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">function</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">scaling</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1.0</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/inversion_tools.html#RegularizationCalculator"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#thetis.inversion_tools.RegularizationCalculator" title="Link to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">ABC</span></code></p>
<p>Base class for computing regularization terms.</p>
<p>A derived class should set <code class="xref py py-attr docutils literal notranslate"><span class="pre">regularization_expr</span></code> in
<code class="xref py py-meth docutils literal notranslate"><span class="pre">__init__()</span></code>. Whenever the cost function is evaluated,
the ratio of this expression and the total mesh area will
be added.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>function</strong> – Control <code class="xref py py-class docutils literal notranslate"><span class="pre">Function</span></code></p>
</dd>
</dl>
<dl class="py method">
<dt class="sig sig-object py" id="thetis.inversion_tools.RegularizationCalculator.eval_cost_function">
<span class="sig-name descname"><span class="pre">eval_cost_function</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/inversion_tools.html#RegularizationCalculator.eval_cost_function"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#thetis.inversion_tools.RegularizationCalculator.eval_cost_function" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="thetis.inversion_tools.StationObservationManager">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">thetis.inversion_tools.</span></span><span class="sig-name descname"><span class="pre">StationObservationManager</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">mesh</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">output_directory</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'outputs'</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/inversion_tools.html#StationObservationManager"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#thetis.inversion_tools.StationObservationManager" title="Link to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference external" href="https://docs.python.org/2.7/library/functions.html#object" title="(in Python v2.7)"><code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></a></p>
<p>Implements error functional based on observation time series.</p>
<p>The functional is the squared sum of error between the model and
observations.</p>
<p>This object evaluates the model fields at the station locations,
interpolates the observations time series to the model time, computes the
error functional, and also stores the model’s time series data to disk.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>mesh</strong> – the 2D mesh object.</p></li>
<li><p><strong>output_directory</strong> – directory where model time series are stored.</p></li>
</ul>
</dd>
</dl>
<dl class="py method">
<dt class="sig sig-object py" id="thetis.inversion_tools.StationObservationManager.construct_evaluator">
<span class="sig-name descname"><span class="pre">construct_evaluator</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/inversion_tools.html#StationObservationManager.construct_evaluator"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#thetis.inversion_tools.StationObservationManager.construct_evaluator" title="Link to this definition">¶</a></dt>
<dd><p>Builds evaluators needed to compute the error functional.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="thetis.inversion_tools.StationObservationManager.dump_time_series">
<span class="sig-name descname"><span class="pre">dump_time_series</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/inversion_tools.html#StationObservationManager.dump_time_series"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#thetis.inversion_tools.StationObservationManager.dump_time_series" title="Link to this definition">¶</a></dt>
<dd><p>Stores model time series to disk.</p>
<p>Obtains station time series from the last optimization iteration,
and stores the data to disk.</p>
<p>The output files are have the format
<cite>{odir}/diagnostic_timeseries_progress_{station_name}_{variable}.hdf5</cite></p>
<p>The file contains the simulation time in the <cite>time</cite> array, and the
station name and coordinates as attributes. The time series data is
stored as a 2D (n_iterations, n_time_steps) array.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="thetis.inversion_tools.StationObservationManager.eval_cost_function">
<span class="sig-name descname"><span class="pre">eval_cost_function</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">t</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/inversion_tools.html#StationObservationManager.eval_cost_function"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#thetis.inversion_tools.StationObservationManager.eval_cost_function" title="Link to this definition">¶</a></dt>
<dd><p>Evaluate the cost function.</p>
<p>Should be called at every export of the forward model.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="thetis.inversion_tools.StationObservationManager.eval_observation_at_time">
<span class="sig-name descname"><span class="pre">eval_observation_at_time</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">t</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/inversion_tools.html#StationObservationManager.eval_observation_at_time"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#thetis.inversion_tools.StationObservationManager.eval_observation_at_time" title="Link to this definition">¶</a></dt>
<dd><p>Evaluate observation time series at the given time.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>t</strong> – model simulation time</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>list of observation time series values at time <cite>t</cite></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="thetis.inversion_tools.StationObservationManager.load_observation_data">
<span class="sig-name descname"><span class="pre">load_observation_data</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">observation_data_dir</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">station_names</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">variable</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">start_times</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">end_times</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/inversion_tools.html#StationObservationManager.load_observation_data"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#thetis.inversion_tools.StationObservationManager.load_observation_data" title="Link to this definition">¶</a></dt>
<dd><p>Load observation data from disk.</p>
<p>Assumes that observation data were stored with
<cite>TimeSeriesCallback2D</cite> during the forward run. For generic case, use
<cite>register_observation_data</cite> instead.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>observation_data_dir</strong> (<a class="reference external" href="https://docs.python.org/2.7/library/functions.html#str" title="(in Python v2.7)"><em>str</em></a>) – directory where observation data is stored</p></li>
<li><p><strong>station_names</strong> (<em>list</em>) – list of station names</p></li>
<li><p><strong>variable</strong> (<a class="reference external" href="https://docs.python.org/2.7/library/functions.html#str" title="(in Python v2.7)"><em>str</em></a>) – canonical variable name, e.g. ‘elev’</p></li>
<li><p><strong>start_times</strong> (<em>list</em>) – optional start times for the observation periods</p></li>
<li><p><strong>end_times</strong> (<em>list</em>) – optional end times for the observation periods</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="thetis.inversion_tools.StationObservationManager.register_observation_data">
<span class="sig-name descname"><span class="pre">register_observation_data</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">station_names</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">variable</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">time</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">values</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">x</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">start_times</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">end_times</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/inversion_tools.html#StationObservationManager.register_observation_data"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#thetis.inversion_tools.StationObservationManager.register_observation_data" title="Link to this definition">¶</a></dt>
<dd><p>Add station time series data to the object.</p>
<p>The <cite>x</cite>, and <cite>y</cite> coordinates must be such that
they allow extraction of model data at the same coordinates.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>station_names</strong> (<em>list</em>) – list of station names</p></li>
<li><p><strong>variable</strong> (<a class="reference external" href="https://docs.python.org/2.7/library/functions.html#str" title="(in Python v2.7)"><em>str</em></a>) – canonical variable name, e.g. ‘elev’</p></li>
<li><p><strong>time</strong> (<em>list</em>) – array of time stamps, one for each station</p></li>
<li><p><strong>values</strong> (<em>list</em>) – array of observations, one for each station</p></li>
<li><p><strong>x</strong> (<em>list</em>) – list of station x coordinates</p></li>
<li><p><strong>y</strong> (<em>list</em>) – list of station y coordinates</p></li>
<li><p><strong>start_times</strong> (<em>list</em>) – optional start times for the observation periods</p></li>
<li><p><strong>end_times</strong> (<em>list</em>) – optional end times for the observation periods</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="thetis.inversion_tools.StationObservationManager.set_model_field">
<span class="sig-name descname"><span class="pre">set_model_field</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">function</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/inversion_tools.html#StationObservationManager.set_model_field"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#thetis.inversion_tools.StationObservationManager.set_model_field" title="Link to this definition">¶</a></dt>
<dd><p>Set the model field that will be evaluated.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="thetis.inversion_tools.StationObservationManager.update_stations_in_use">
<span class="sig-name descname"><span class="pre">update_stations_in_use</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">t</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/inversion_tools.html#StationObservationManager.update_stations_in_use"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#thetis.inversion_tools.StationObservationManager.update_stations_in_use" title="Link to this definition">¶</a></dt>
<dd><p>Indicate which stations are in use at the current time.</p>
<p>An entry of unity indicates use, whereas zero indicates disuse.</p>
</dd></dl>

</dd></dl>

</section>
<section id="module-thetis.limiter">
<span id="thetis-limiter-module"></span><h2>thetis.limiter module<a class="headerlink" href="#module-thetis.limiter" title="Link to this heading">¶</a></h2>
<p>Slope limiters for discontinuous fields</p>
<dl class="py class">
<dt class="sig sig-object py" id="thetis.limiter.VertexBasedP1DGLimiter">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">thetis.limiter.</span></span><span class="sig-name descname"><span class="pre">VertexBasedP1DGLimiter</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">p1dg_space</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">time_dependent_mesh</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/limiter.html#VertexBasedP1DGLimiter"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#thetis.limiter.VertexBasedP1DGLimiter" title="Link to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference external" href="https://www.firedrakeproject.org/firedrake.slope_limiter.html#firedrake.slope_limiter.vertex_based_limiter.VertexBasedLimiter" title="(in Firedrake v0.12)"><code class="xref py py-class docutils literal notranslate"><span class="pre">VertexBasedLimiter</span></code></a></p>
<p>Vertex based limiter for P1DG tracer fields, see Kuzmin (2010)</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Currently only scalar fields are supported</p>
</div>
<p>Kuzmin (2010). A vertex-based hierarchical slope limiter
for p-adaptive discontinuous Galerkin methods. Journal of Computational
and Applied Mathematics, 233(12):3077-3085.
<a class="reference external" href="http://dx.doi.org/10.1016/j.cam.2009.05.028">http://dx.doi.org/10.1016/j.cam.2009.05.028</a></p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>p1dg_space</strong> – P1DG function space</p>
</dd>
</dl>
<dl class="py method">
<dt class="sig sig-object py" id="thetis.limiter.VertexBasedP1DGLimiter.apply">
<span class="sig-name descname"><span class="pre">apply</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">field</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/limiter.html#VertexBasedP1DGLimiter.apply"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#thetis.limiter.VertexBasedP1DGLimiter.apply" title="Link to this definition">¶</a></dt>
<dd><p>Applies the limiter on the given field (in place)</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>field</strong> – <code class="xref py py-class docutils literal notranslate"><span class="pre">Function</span></code> to limit</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="thetis.limiter.VertexBasedP1DGLimiter.compute_bounds">
<span class="sig-name descname"><span class="pre">compute_bounds</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">field</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/limiter.html#VertexBasedP1DGLimiter.compute_bounds"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#thetis.limiter.VertexBasedP1DGLimiter.compute_bounds" title="Link to this definition">¶</a></dt>
<dd><p>Re-compute min/max values of all neighbouring centroids</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>field</strong> – <code class="xref py py-class docutils literal notranslate"><span class="pre">Function</span></code> to limit</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="thetis.limiter.assert_function_space">
<span class="sig-prename descclassname"><span class="pre">thetis.limiter.</span></span><span class="sig-name descname"><span class="pre">assert_function_space</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">fs</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">family</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">degree</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/limiter.html#assert_function_space"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#thetis.limiter.assert_function_space" title="Link to this definition">¶</a></dt>
<dd><p>Checks the family and degree of function space.</p>
<p>Raises AssertionError if function space differs.
If the function space lies on an extruded mesh, checks both spaces of the
outer product.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>fs</strong> – function space</p></li>
<li><p><strong>family</strong> (<em>string</em>) – name of element family</p></li>
<li><p><strong>degree</strong> (<a class="reference external" href="https://docs.python.org/2.7/library/functions.html#int" title="(in Python v2.7)"><em>int</em></a>) – polynomial degree of the function space</p></li>
</ul>
</dd>
</dl>
</dd></dl>

</section>
<section id="module-thetis.log">
<span id="thetis-log-module"></span><h2>thetis.log module<a class="headerlink" href="#module-thetis.log" title="Link to this heading">¶</a></h2>
<p>Loggers for Thetis</p>
<p>Creates two logger instances, one for general model output and one for debug,
warning, error etc. messages.</p>
<p>To print to the model output stream, use <a class="reference internal" href="#thetis.log.print_output" title="thetis.log.print_output"><code class="xref py py-func docutils literal notranslate"><span class="pre">print_output()</span></code></a>.</p>
<p>Debug, warning etc. messages are issued with <a class="reference internal" href="#thetis.log.debug" title="thetis.log.debug"><code class="xref py py-func docutils literal notranslate"><span class="pre">debug()</span></code></a>, <a class="reference internal" href="#thetis.log.info" title="thetis.log.info"><code class="xref py py-func docutils literal notranslate"><span class="pre">info()</span></code></a>,
<a class="reference internal" href="#thetis.log.warning" title="thetis.log.warning"><code class="xref py py-func docutils literal notranslate"><span class="pre">warning()</span></code></a>, <a class="reference internal" href="#thetis.log.error" title="thetis.log.error"><code class="xref py py-func docutils literal notranslate"><span class="pre">error()</span></code></a>, <a class="reference internal" href="#thetis.log.critical" title="thetis.log.critical"><code class="xref py py-func docutils literal notranslate"><span class="pre">critical()</span></code></a> methods.</p>
<dl class="py function">
<dt class="sig sig-object py" id="thetis.log.critical">
<span class="sig-prename descclassname"><span class="pre">thetis.log.</span></span><span class="sig-name descname"><span class="pre">critical</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">msg</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/logging.html#critical"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#thetis.log.critical" title="Link to this definition">¶</a></dt>
<dd><p>Log ‘msg % args’ with severity ‘CRITICAL’.</p>
<p>To pass exception information, use the keyword argument exc_info with
a true value, e.g.</p>
<p>logger.critical(“Houston, we have a %s”, “major disaster”, exc_info=True)</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="thetis.log.debug">
<span class="sig-prename descclassname"><span class="pre">thetis.log.</span></span><span class="sig-name descname"><span class="pre">debug</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">msg</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/logging.html#debug"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#thetis.log.debug" title="Link to this definition">¶</a></dt>
<dd><p>Log ‘msg % args’ with severity ‘DEBUG’.</p>
<p>To pass exception information, use the keyword argument exc_info with
a true value, e.g.</p>
<p>logger.debug(“Houston, we have a %s”, “thorny problem”, exc_info=True)</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="thetis.log.error">
<span class="sig-prename descclassname"><span class="pre">thetis.log.</span></span><span class="sig-name descname"><span class="pre">error</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">msg</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/logging.html#error"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#thetis.log.error" title="Link to this definition">¶</a></dt>
<dd><p>Log ‘msg % args’ with severity ‘ERROR’.</p>
<p>To pass exception information, use the keyword argument exc_info with
a true value, e.g.</p>
<p>logger.error(“Houston, we have a %s”, “major problem”, exc_info=True)</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="thetis.log.info">
<span class="sig-prename descclassname"><span class="pre">thetis.log.</span></span><span class="sig-name descname"><span class="pre">info</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">msg</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/logging.html#info"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#thetis.log.info" title="Link to this definition">¶</a></dt>
<dd><p>Log ‘msg % args’ with severity ‘INFO’.</p>
<p>To pass exception information, use the keyword argument exc_info with
a true value, e.g.</p>
<p>logger.info(“Houston, we have a %s”, “notable problem”, exc_info=True)</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="thetis.log.log">
<span class="sig-prename descclassname"><span class="pre">thetis.log.</span></span><span class="sig-name descname"><span class="pre">log</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">level</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">msg</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/logging.html#log"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#thetis.log.log" title="Link to this definition">¶</a></dt>
<dd><p>Log ‘msg % args’ with the integer severity ‘level’.</p>
<p>To pass exception information, use the keyword argument exc_info with
a true value, e.g.</p>
<p>logger.log(level, “We have a %s”, “mysterious problem”, exc_info=True)</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="thetis.log.print_output">
<span class="sig-prename descclassname"><span class="pre">thetis.log.</span></span><span class="sig-name descname"><span class="pre">print_output</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">msg</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#thetis.log.print_output" title="Link to this definition">¶</a></dt>
<dd><p>Log ‘msg % args’ with severity ‘INFO’.</p>
<p>To pass exception information, use the keyword argument exc_info with
a true value, e.g.</p>
<p>logger.info(“Houston, we have a %s”, “notable problem”, exc_info=True)</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="thetis.log.set_log_directory">
<span class="sig-prename descclassname"><span class="pre">thetis.log.</span></span><span class="sig-name descname"><span class="pre">set_log_directory</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">output_directory</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">comm=&lt;mpi4py.MPI.Intracomm</span> <span class="pre">object&gt;</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mode='w'</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/log.html#set_log_directory"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#thetis.log.set_log_directory" title="Link to this definition">¶</a></dt>
<dd><p>Forward all log output to <cite>output_directory/log</cite> file.</p>
<p>When called, a new empty log file is created.</p>
<p>If called twice with a different <cite>output_directory</cite>, a warning is raised,
and the new log file location is assigned. The old log file or the
<cite>output_directory</cite> are not removed.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>output_directory</strong> – the directory where log file is stored</p></li>
<li><p><strong>comm</strong> – The communicator the handler should be collective
over. Only rank-0 on that communicator will write to the log, other
ranks will use a <a class="reference external" href="https://docs.python.org/2.7/library/logging.handlers.html#logging.NullHandler" title="(in Python v2.7)"><code class="xref py py-class docutils literal notranslate"><span class="pre">logging.NullHandler</span></code></a>.</p></li>
<li><p><strong>mode</strong> – write mode, ‘w’ removes previous log file (if any), otherwise
appends to it. Default: ‘w’.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="thetis.log.set_thetis_loggers">
<span class="sig-prename descclassname"><span class="pre">thetis.log.</span></span><span class="sig-name descname"><span class="pre">set_thetis_loggers</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">comm=&lt;mpi4py.MPI.Intracomm</span> <span class="pre">object&gt;</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/log.html#set_thetis_loggers"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#thetis.log.set_thetis_loggers" title="Link to this definition">¶</a></dt>
<dd><p>Set stream handlers for log messages.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>comm</strong> – The communicator the handler should be collective
over. Only rank-0 on that communicator will write to the log, other
ranks will use a <a class="reference external" href="https://docs.python.org/2.7/library/logging.handlers.html#logging.NullHandler" title="(in Python v2.7)"><code class="xref py py-class docutils literal notranslate"><span class="pre">logging.NullHandler</span></code></a>.</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="thetis.log.thetis_log_level">
<span class="sig-prename descclassname"><span class="pre">thetis.log.</span></span><span class="sig-name descname"><span class="pre">thetis_log_level</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">level</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/log.html#thetis_log_level"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#thetis.log.thetis_log_level" title="Link to this definition">¶</a></dt>
<dd><p>Set the log level for Thetis logger.</p>
<p>This controls what level of logging messages are printed to
stderr. The higher the level, the fewer the number of messages.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>level</strong> – The level to use, one of ‘DEBUG’, ‘INFO’, ‘WARNING’, ‘ERROR’,
‘CRITICAL’.</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="thetis.log.warning">
<span class="sig-prename descclassname"><span class="pre">thetis.log.</span></span><span class="sig-name descname"><span class="pre">warning</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">msg</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/logging.html#warning"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#thetis.log.warning" title="Link to this definition">¶</a></dt>
<dd><p>Log ‘msg % args’ with severity ‘WARNING’.</p>
<p>To pass exception information, use the keyword argument exc_info with
a true value, e.g.</p>
<p>logger.warning(“Houston, we have a %s”, “bit of a problem”, exc_info=True)</p>
</dd></dl>

</section>
<section id="module-thetis.momentum_eq">
<span id="thetis-momentum-eq-module"></span><h2>thetis.momentum_eq module<a class="headerlink" href="#module-thetis.momentum_eq" title="Link to this heading">¶</a></h2>
<p>3D momentum equation for hydrostatic Boussinesq flow.</p>
<p>The three dimensional momentum equation reads</p>
<div class="math notranslate nohighlight" id="equation-mom-eq">
<span class="eqno">(2)<a class="headerlink" href="#equation-mom-eq" title="Link to this equation">¶</a></span>\[\frac{\partial \textbf{u}}{\partial t}
    + \nabla_h \cdot (\textbf{u} \textbf{u})
    + \frac{\partial \left(w\textbf{u} \right)}{\partial z}
    + f\textbf{e}_z\wedge\textbf{u} + g\nabla_h \eta + g\nabla_h r
    = \nabla_h \cdot \left( \nu_h \nabla_h \textbf{u} \right)
    + \frac{\partial }{\partial z}\left( \nu \frac{\partial \textbf{u}}{\partial z}\right)\]</div>
<p>where <span class="math notranslate nohighlight">\(\textbf{u}\)</span> and <span class="math notranslate nohighlight">\(w\)</span> denote horizontal and vertical velocity,
<span class="math notranslate nohighlight">\(\nabla_h\)</span> is the horizontal gradient,
<span class="math notranslate nohighlight">\(\wedge\)</span> denotes the cross product,
<span class="math notranslate nohighlight">\(g\)</span> is the gravitational acceleration, <span class="math notranslate nohighlight">\(f\)</span> is the Coriolis
frequency, <span class="math notranslate nohighlight">\(\textbf{e}_z\)</span> is a vertical unit vector, and
<span class="math notranslate nohighlight">\(\nu_h, \nu\)</span> stand for horizontal and vertical viscosity.
Water density is given by <span class="math notranslate nohighlight">\(\rho = \rho'(T, S, p) + \rho_0\)</span>,
where <span class="math notranslate nohighlight">\(\rho_0\)</span> is a constant reference density.
Above <span class="math notranslate nohighlight">\(r\)</span> denotes the baroclinic head</p>
<div class="math notranslate nohighlight" id="equation-baroc-head">
<span class="eqno">(3)<a class="headerlink" href="#equation-baroc-head" title="Link to this equation">¶</a></span>\[r = \frac{1}{\rho_0} \int_{z}^\eta  \rho' d\zeta.\]</div>
<p>The internal pressure gradient is computed as a separate diagnostic field:</p>
<div class="math notranslate nohighlight" id="equation-int-pg-eq">
<span class="eqno">(4)<a class="headerlink" href="#equation-int-pg-eq" title="Link to this equation">¶</a></span>\[\mathbf{F}_{pg} = g\nabla_h r.\]</div>
<p>In the case of purely barotropic problems the <span class="math notranslate nohighlight">\(r\)</span> and
<span class="math notranslate nohighlight">\(\mathbf{F}_{pg}\)</span> fields are omitted.</p>
<p>When using mode splitting we split the velocity field into a depth average and
a deviation, <span class="math notranslate nohighlight">\(\textbf{u} = \bar{\textbf{u}} + \textbf{u}'\)</span>.
Following Higdon and de Szoeke (1997) we write an equation for the deviation
<span class="math notranslate nohighlight">\(\textbf{u}'\)</span>:</p>
<div class="math notranslate nohighlight" id="equation-mom-eq-split">
<span class="eqno">(5)<a class="headerlink" href="#equation-mom-eq-split" title="Link to this equation">¶</a></span>\[\frac{\partial \textbf{u}'}{\partial t} =
    + \nabla_h \cdot (\textbf{u} \textbf{u})
    + \frac{\partial \left(w\textbf{u} \right)}{\partial z}
    + f\textbf{e}_z\wedge\textbf{u}' + g\nabla_h r
    = \nabla_h \cdot \left( \nu_h \nabla_h \textbf{u} \right)
    + \frac{\partial }{\partial z}\left( \nu  \frac{\partial \textbf{u}}{\partial z}\right)\]</div>
<p>In <a class="reference internal" href="#equation-mom-eq-split">(5)</a> the external pressure gradient <span class="math notranslate nohighlight">\(g\nabla_h \eta\)</span> vanishes and the
Coriolis term only contains the deviation <span class="math notranslate nohighlight">\(\textbf{u}'\)</span>.
Advection and diffusion terms are not changed.</p>
<p>Higdon and de Szoeke (1997). Barotropic-Baroclinic Time Splitting for Ocean
Circulation Modeling. Journal of Computational Physics, 135(1):30-53.
<a class="reference external" href="http://dx.doi.org/10.1006/jcph.1997.5733">http://dx.doi.org/10.1006/jcph.1997.5733</a></p>
<dl class="py class">
<dt class="sig sig-object py" id="thetis.momentum_eq.BottomFrictionTerm">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">thetis.momentum_eq.</span></span><span class="sig-name descname"><span class="pre">BottomFrictionTerm</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">function_space</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">bathymetry</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">v_elem_size</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">h_elem_size</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">use_nonlinear_equations</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">use_lax_friedrichs</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">use_bottom_friction</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sipg_factor</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">Constant([1.],</span> <span class="pre">name='constant_6',</span> <span class="pre">count=6)</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sipg_factor_vertical</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">Constant([1.],</span> <span class="pre">name='constant_7',</span> <span class="pre">count=7)</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/momentum_eq.html#BottomFrictionTerm"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#thetis.momentum_eq.BottomFrictionTerm" title="Link to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#thetis.momentum_eq.MomentumTerm" title="thetis.momentum_eq.MomentumTerm"><code class="xref py py-class docutils literal notranslate"><span class="pre">MomentumTerm</span></code></a></p>
<p>Quadratic bottom friction term, <span class="math notranslate nohighlight">\(\tau_b = C_D \| \textbf{u}_b \| \textbf{u}_b\)</span></p>
<p>The weak formulation reads</p>
<div class="math notranslate nohighlight">
\[\int_{\Gamma_{bot}} \tau_b \cdot \boldsymbol{\psi} dx = \int_{\Gamma_{bot}} C_D \| \textbf{u}_b \| \textbf{u}_b \cdot \boldsymbol{\psi} dx\]</div>
<p>where <span class="math notranslate nohighlight">\(\textbf{u}_b\)</span> is reconstructed velocity in the middle of the
bottom element:</p>
<div class="math notranslate nohighlight">
\[\textbf{u}_b = \textbf{u}\Big|_{\Gamma_{bot}} + \frac{\partial \textbf{u}}{\partial z}\Big|_{\Gamma_{bot}} h_b,\]</div>
<p><span class="math notranslate nohighlight">\(h_b\)</span> being half of the element height.
For implicit solvers we linearize the stress as
<span class="math notranslate nohighlight">\(\tau_b = C_D \| \textbf{u}_b^{n} \| \textbf{u}_b^{n+1}\)</span></p>
<p>The drag is computed from the law-of-the wall</p>
<div class="math notranslate nohighlight">
\[C_D = \left( \frac{\kappa}{\ln (h_b + z_0)/z_0} \right)^2\]</div>
<p>where <span class="math notranslate nohighlight">\(z_0\)</span> is the bottom roughness length field.
The user can override the <span class="math notranslate nohighlight">\(C_D\)</span> value by providing <code class="docutils literal notranslate"><span class="pre">quadratic_drag_coefficient</span></code>
field.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>function_space</strong> – <code class="xref py py-class docutils literal notranslate"><span class="pre">FunctionSpace</span></code> where the solution belongs</p></li>
<li><p><strong>bathymetry</strong> (3D <code class="xref py py-class docutils literal notranslate"><span class="pre">Function</span></code> or <code class="xref py py-class docutils literal notranslate"><span class="pre">Constant</span></code>) – bathymetry of the domain</p></li>
<li><p><strong>v_elem_size</strong> – scalar <code class="xref py py-class docutils literal notranslate"><span class="pre">Function</span></code> that defines the vertical
element size</p></li>
<li><p><strong>h_elem_size</strong> – scalar <code class="xref py py-class docutils literal notranslate"><span class="pre">Function</span></code> that defines the horizontal
element size</p></li>
<li><p><strong>use_nonlinear_equations</strong> (<a class="reference external" href="https://docs.python.org/2.7/library/functions.html#bool" title="(in Python v2.7)"><em>bool</em></a>) – If False defines the linear shallow water equations</p></li>
<li><p><strong>use_bottom_friction</strong> (<a class="reference external" href="https://docs.python.org/2.7/library/functions.html#bool" title="(in Python v2.7)"><em>bool</em></a>) – If True includes bottom friction term</p></li>
<li><p><strong>sipg_factor</strong> – <dl class="field-list simple">
<dt class="field-odd">class<span class="colon">:</span></dt>
<dd class="field-odd"><p><cite>Constant</cite> or :class: <cite>Function</cite> horizontal SIPG penalty scaling factor</p>
</dd>
</dl>
</p></li>
<li><p><strong>sipg_factor_vertical</strong> – <dl class="field-list simple">
<dt class="field-odd">class<span class="colon">:</span></dt>
<dd class="field-odd"><p><cite>Constant</cite> or :class: <cite>Function</cite> vertical SIPG penalty scaling factor</p>
</dd>
</dl>
</p></li>
</ul>
</dd>
</dl>
<dl class="py method">
<dt class="sig sig-object py" id="thetis.momentum_eq.BottomFrictionTerm.residual">
<span class="sig-name descname"><span class="pre">residual</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">solution</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">solution_old</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fields</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fields_old</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">bnd_conditions</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/momentum_eq.html#BottomFrictionTerm.residual"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#thetis.momentum_eq.BottomFrictionTerm.residual" title="Link to this definition">¶</a></dt>
<dd><p>Returns an UFL form of the term.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>solution</strong> – solution <code class="xref py py-class docutils literal notranslate"><span class="pre">Function</span></code> of the corresponding equation</p></li>
<li><p><strong>solution_old</strong> – a time lagged solution <code class="xref py py-class docutils literal notranslate"><span class="pre">Function</span></code></p></li>
<li><p><strong>fields</strong> – a dictionary that provides all the remaining fields that the term depends on.
The keys of the dictionary should standard field names in <cite>field_metadata</cite></p></li>
<li><p><strong>fields_old</strong> – Time lagged dictionary of fields</p></li>
<li><p><strong>bnd_conditions</strong> – A dictionary describing boundary conditions.
E.g. {3: {‘elev_2d’: Constant(1.0)}} replaces elev_2d function by a constant on boundary ID 3.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="thetis.momentum_eq.CoriolisTerm">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">thetis.momentum_eq.</span></span><span class="sig-name descname"><span class="pre">CoriolisTerm</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">function_space</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">bathymetry</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">v_elem_size</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">h_elem_size</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">use_nonlinear_equations</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">use_lax_friedrichs</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">use_bottom_friction</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sipg_factor</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">Constant([1.],</span> <span class="pre">name='constant_6',</span> <span class="pre">count=6)</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sipg_factor_vertical</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">Constant([1.],</span> <span class="pre">name='constant_7',</span> <span class="pre">count=7)</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/momentum_eq.html#CoriolisTerm"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#thetis.momentum_eq.CoriolisTerm" title="Link to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#thetis.momentum_eq.MomentumTerm" title="thetis.momentum_eq.MomentumTerm"><code class="xref py py-class docutils literal notranslate"><span class="pre">MomentumTerm</span></code></a></p>
<p>Coriolis term, <span class="math notranslate nohighlight">\(f\textbf{e}_z\wedge \bar{\textbf{u}}\)</span></p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>function_space</strong> – <code class="xref py py-class docutils literal notranslate"><span class="pre">FunctionSpace</span></code> where the solution belongs</p></li>
<li><p><strong>bathymetry</strong> (3D <code class="xref py py-class docutils literal notranslate"><span class="pre">Function</span></code> or <code class="xref py py-class docutils literal notranslate"><span class="pre">Constant</span></code>) – bathymetry of the domain</p></li>
<li><p><strong>v_elem_size</strong> – scalar <code class="xref py py-class docutils literal notranslate"><span class="pre">Function</span></code> that defines the vertical
element size</p></li>
<li><p><strong>h_elem_size</strong> – scalar <code class="xref py py-class docutils literal notranslate"><span class="pre">Function</span></code> that defines the horizontal
element size</p></li>
<li><p><strong>use_nonlinear_equations</strong> (<a class="reference external" href="https://docs.python.org/2.7/library/functions.html#bool" title="(in Python v2.7)"><em>bool</em></a>) – If False defines the linear shallow water equations</p></li>
<li><p><strong>use_bottom_friction</strong> (<a class="reference external" href="https://docs.python.org/2.7/library/functions.html#bool" title="(in Python v2.7)"><em>bool</em></a>) – If True includes bottom friction term</p></li>
<li><p><strong>sipg_factor</strong> – <dl class="field-list simple">
<dt class="field-odd">class<span class="colon">:</span></dt>
<dd class="field-odd"><p><cite>Constant</cite> or :class: <cite>Function</cite> horizontal SIPG penalty scaling factor</p>
</dd>
</dl>
</p></li>
<li><p><strong>sipg_factor_vertical</strong> – <dl class="field-list simple">
<dt class="field-odd">class<span class="colon">:</span></dt>
<dd class="field-odd"><p><cite>Constant</cite> or :class: <cite>Function</cite> vertical SIPG penalty scaling factor</p>
</dd>
</dl>
</p></li>
</ul>
</dd>
</dl>
<dl class="py method">
<dt class="sig sig-object py" id="thetis.momentum_eq.CoriolisTerm.residual">
<span class="sig-name descname"><span class="pre">residual</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">solution</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">solution_old</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fields</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fields_old</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">bnd_conditions</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/momentum_eq.html#CoriolisTerm.residual"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#thetis.momentum_eq.CoriolisTerm.residual" title="Link to this definition">¶</a></dt>
<dd><p>Returns an UFL form of the term.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>solution</strong> – solution <code class="xref py py-class docutils literal notranslate"><span class="pre">Function</span></code> of the corresponding equation</p></li>
<li><p><strong>solution_old</strong> – a time lagged solution <code class="xref py py-class docutils literal notranslate"><span class="pre">Function</span></code></p></li>
<li><p><strong>fields</strong> – a dictionary that provides all the remaining fields that the term depends on.
The keys of the dictionary should standard field names in <cite>field_metadata</cite></p></li>
<li><p><strong>fields_old</strong> – Time lagged dictionary of fields</p></li>
<li><p><strong>bnd_conditions</strong> – A dictionary describing boundary conditions.
E.g. {3: {‘elev_2d’: Constant(1.0)}} replaces elev_2d function by a constant on boundary ID 3.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="thetis.momentum_eq.HorizontalAdvectionTerm">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">thetis.momentum_eq.</span></span><span class="sig-name descname"><span class="pre">HorizontalAdvectionTerm</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">function_space</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">bathymetry</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">v_elem_size</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">h_elem_size</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">use_nonlinear_equations</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">use_lax_friedrichs</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">use_bottom_friction</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sipg_factor</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">Constant([1.],</span> <span class="pre">name='constant_6',</span> <span class="pre">count=6)</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sipg_factor_vertical</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">Constant([1.],</span> <span class="pre">name='constant_7',</span> <span class="pre">count=7)</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/momentum_eq.html#HorizontalAdvectionTerm"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#thetis.momentum_eq.HorizontalAdvectionTerm" title="Link to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#thetis.momentum_eq.MomentumTerm" title="thetis.momentum_eq.MomentumTerm"><code class="xref py py-class docutils literal notranslate"><span class="pre">MomentumTerm</span></code></a></p>
<p>Horizontal advection term, <span class="math notranslate nohighlight">\(\nabla_h \cdot (\textbf{u} \textbf{u})\)</span></p>
<p>The weak form reads</p>
<div class="math notranslate nohighlight">
\[\int_\Omega \nabla_h \cdot (\textbf{u} \textbf{u}) \cdot \boldsymbol{\psi} dx
= - \int_\Omega \nabla_h \boldsymbol{\psi} : (\textbf{u} \textbf{u}) dx
+ \int_{\mathcal{I}_h \cup \mathcal{I}_v} \textbf{u}^{\text{up}} \cdot
\text{jump}(\boldsymbol{\psi} \textbf{n}_h) \cdot \text{avg}(\textbf{u}) dS\]</div>
<p>where the right hand side has been integrated by parts; <span class="math notranslate nohighlight">\(:\)</span> stand for
the Frobenius inner product, <span class="math notranslate nohighlight">\(\textbf{n}_h\)</span> is the horizontal
projection of the normal vector, <span class="math notranslate nohighlight">\(\textbf{u}^{\text{up}}\)</span> is the
upwind value, and <span class="math notranslate nohighlight">\(\text{jump}\)</span> and <span class="math notranslate nohighlight">\(\text{avg}\)</span> denote the
jump and average operators across the interface.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>function_space</strong> – <code class="xref py py-class docutils literal notranslate"><span class="pre">FunctionSpace</span></code> where the solution belongs</p></li>
<li><p><strong>bathymetry</strong> (3D <code class="xref py py-class docutils literal notranslate"><span class="pre">Function</span></code> or <code class="xref py py-class docutils literal notranslate"><span class="pre">Constant</span></code>) – bathymetry of the domain</p></li>
<li><p><strong>v_elem_size</strong> – scalar <code class="xref py py-class docutils literal notranslate"><span class="pre">Function</span></code> that defines the vertical
element size</p></li>
<li><p><strong>h_elem_size</strong> – scalar <code class="xref py py-class docutils literal notranslate"><span class="pre">Function</span></code> that defines the horizontal
element size</p></li>
<li><p><strong>use_nonlinear_equations</strong> (<a class="reference external" href="https://docs.python.org/2.7/library/functions.html#bool" title="(in Python v2.7)"><em>bool</em></a>) – If False defines the linear shallow water equations</p></li>
<li><p><strong>use_bottom_friction</strong> (<a class="reference external" href="https://docs.python.org/2.7/library/functions.html#bool" title="(in Python v2.7)"><em>bool</em></a>) – If True includes bottom friction term</p></li>
<li><p><strong>sipg_factor</strong> – <dl class="field-list simple">
<dt class="field-odd">class<span class="colon">:</span></dt>
<dd class="field-odd"><p><cite>Constant</cite> or :class: <cite>Function</cite> horizontal SIPG penalty scaling factor</p>
</dd>
</dl>
</p></li>
<li><p><strong>sipg_factor_vertical</strong> – <dl class="field-list simple">
<dt class="field-odd">class<span class="colon">:</span></dt>
<dd class="field-odd"><p><cite>Constant</cite> or :class: <cite>Function</cite> vertical SIPG penalty scaling factor</p>
</dd>
</dl>
</p></li>
</ul>
</dd>
</dl>
<dl class="py method">
<dt class="sig sig-object py" id="thetis.momentum_eq.HorizontalAdvectionTerm.residual">
<span class="sig-name descname"><span class="pre">residual</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">solution</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">solution_old</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fields</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fields_old</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">bnd_conditions</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/momentum_eq.html#HorizontalAdvectionTerm.residual"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#thetis.momentum_eq.HorizontalAdvectionTerm.residual" title="Link to this definition">¶</a></dt>
<dd><p>Returns an UFL form of the term.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>solution</strong> – solution <code class="xref py py-class docutils literal notranslate"><span class="pre">Function</span></code> of the corresponding equation</p></li>
<li><p><strong>solution_old</strong> – a time lagged solution <code class="xref py py-class docutils literal notranslate"><span class="pre">Function</span></code></p></li>
<li><p><strong>fields</strong> – a dictionary that provides all the remaining fields that the term depends on.
The keys of the dictionary should standard field names in <cite>field_metadata</cite></p></li>
<li><p><strong>fields_old</strong> – Time lagged dictionary of fields</p></li>
<li><p><strong>bnd_conditions</strong> – A dictionary describing boundary conditions.
E.g. {3: {‘elev_2d’: Constant(1.0)}} replaces elev_2d function by a constant on boundary ID 3.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="thetis.momentum_eq.HorizontalViscosityTerm">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">thetis.momentum_eq.</span></span><span class="sig-name descname"><span class="pre">HorizontalViscosityTerm</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">function_space</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">bathymetry</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">v_elem_size</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">h_elem_size</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">use_nonlinear_equations</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">use_lax_friedrichs</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">use_bottom_friction</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sipg_factor</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">Constant([1.],</span> <span class="pre">name='constant_6',</span> <span class="pre">count=6)</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sipg_factor_vertical</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">Constant([1.],</span> <span class="pre">name='constant_7',</span> <span class="pre">count=7)</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/momentum_eq.html#HorizontalViscosityTerm"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#thetis.momentum_eq.HorizontalViscosityTerm" title="Link to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#thetis.momentum_eq.MomentumTerm" title="thetis.momentum_eq.MomentumTerm"><code class="xref py py-class docutils literal notranslate"><span class="pre">MomentumTerm</span></code></a></p>
<p>Horizontal viscosity term, <span class="math notranslate nohighlight">\(- \nabla_h \cdot \left( \nu_h \nabla_h \textbf{u} \right)\)</span></p>
<p>Using the symmetric interior penalty method the weak form becomes</p>
<div class="math notranslate nohighlight">
\[\begin{split}\int_\Omega \nabla_h \cdot \left( \nu_h \nabla_h \textbf{u} \right) \cdot \boldsymbol{\psi} dx
=&amp; -\int_\Omega \nu_h (\nabla_h \boldsymbol{\psi}) : (\nabla_h \textbf{u})^T dx \\
&amp;+ \int_{\mathcal{I}_h \cup \mathcal{I}_v} \text{jump}(\boldsymbol{\psi} \textbf{n}_h) \cdot \text{avg}( \nu_h \nabla_h \textbf{u}) dS
+ \int_{\mathcal{I}_h \cup \mathcal{I}_v} \text{jump}(\textbf{u} \textbf{n}_h) \cdot \text{avg}( \nu_h \nabla_h \boldsymbol{\psi}) dS \\
&amp;- \int_{\mathcal{I}_h \cup \mathcal{I}_v} \sigma \text{avg}(\nu_h) \text{jump}(\textbf{u} \textbf{n}_h) \cdot \text{jump}(\boldsymbol{\psi} \textbf{n}_h) dS\end{split}\]</div>
<p>where <span class="math notranslate nohighlight">\(\sigma\)</span> is a penalty parameter, see Hillewaert (2013).</p>
<p>Hillewaert, Koen (2013). Development of the discontinuous Galerkin method
for high-resolution, large scale CFD and acoustics in industrial
geometries. PhD Thesis. Université catholique de Louvain.
<a class="reference external" href="https://dial.uclouvain.be/pr/boreal/object/boreal:128254/">https://dial.uclouvain.be/pr/boreal/object/boreal:128254/</a></p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>function_space</strong> – <code class="xref py py-class docutils literal notranslate"><span class="pre">FunctionSpace</span></code> where the solution belongs</p></li>
<li><p><strong>bathymetry</strong> (3D <code class="xref py py-class docutils literal notranslate"><span class="pre">Function</span></code> or <code class="xref py py-class docutils literal notranslate"><span class="pre">Constant</span></code>) – bathymetry of the domain</p></li>
<li><p><strong>v_elem_size</strong> – scalar <code class="xref py py-class docutils literal notranslate"><span class="pre">Function</span></code> that defines the vertical
element size</p></li>
<li><p><strong>h_elem_size</strong> – scalar <code class="xref py py-class docutils literal notranslate"><span class="pre">Function</span></code> that defines the horizontal
element size</p></li>
<li><p><strong>use_nonlinear_equations</strong> (<a class="reference external" href="https://docs.python.org/2.7/library/functions.html#bool" title="(in Python v2.7)"><em>bool</em></a>) – If False defines the linear shallow water equations</p></li>
<li><p><strong>use_bottom_friction</strong> (<a class="reference external" href="https://docs.python.org/2.7/library/functions.html#bool" title="(in Python v2.7)"><em>bool</em></a>) – If True includes bottom friction term</p></li>
<li><p><strong>sipg_factor</strong> – <dl class="field-list simple">
<dt class="field-odd">class<span class="colon">:</span></dt>
<dd class="field-odd"><p><cite>Constant</cite> or :class: <cite>Function</cite> horizontal SIPG penalty scaling factor</p>
</dd>
</dl>
</p></li>
<li><p><strong>sipg_factor_vertical</strong> – <dl class="field-list simple">
<dt class="field-odd">class<span class="colon">:</span></dt>
<dd class="field-odd"><p><cite>Constant</cite> or :class: <cite>Function</cite> vertical SIPG penalty scaling factor</p>
</dd>
</dl>
</p></li>
</ul>
</dd>
</dl>
<dl class="py method">
<dt class="sig sig-object py" id="thetis.momentum_eq.HorizontalViscosityTerm.residual">
<span class="sig-name descname"><span class="pre">residual</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">solution</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">solution_old</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fields</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fields_old</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">bnd_conditions</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/momentum_eq.html#HorizontalViscosityTerm.residual"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#thetis.momentum_eq.HorizontalViscosityTerm.residual" title="Link to this definition">¶</a></dt>
<dd><p>Returns an UFL form of the term.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>solution</strong> – solution <code class="xref py py-class docutils literal notranslate"><span class="pre">Function</span></code> of the corresponding equation</p></li>
<li><p><strong>solution_old</strong> – a time lagged solution <code class="xref py py-class docutils literal notranslate"><span class="pre">Function</span></code></p></li>
<li><p><strong>fields</strong> – a dictionary that provides all the remaining fields that the term depends on.
The keys of the dictionary should standard field names in <cite>field_metadata</cite></p></li>
<li><p><strong>fields_old</strong> – Time lagged dictionary of fields</p></li>
<li><p><strong>bnd_conditions</strong> – A dictionary describing boundary conditions.
E.g. {3: {‘elev_2d’: Constant(1.0)}} replaces elev_2d function by a constant on boundary ID 3.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="thetis.momentum_eq.InternalPressureGradientCalculator">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">thetis.momentum_eq.</span></span><span class="sig-name descname"><span class="pre">InternalPressureGradientCalculator</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">fields</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">bathymetry</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">bnd_functions</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">internal_pg_scalar</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">solver_parameters</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/momentum_eq.html#InternalPressureGradientCalculator"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#thetis.momentum_eq.InternalPressureGradientCalculator" title="Link to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#thetis.momentum_eq.MomentumTerm" title="thetis.momentum_eq.MomentumTerm"><code class="xref py py-class docutils literal notranslate"><span class="pre">MomentumTerm</span></code></a></p>
<p>Computes the internal pressure gradient term, <span class="math notranslate nohighlight">\(g\nabla_h r\)</span></p>
<p>where <span class="math notranslate nohighlight">\(r\)</span> is the baroclinic head <a class="reference internal" href="#equation-baroc-head">(3)</a>.</p>
<p>If <span class="math notranslate nohighlight">\(r\)</span> belongs to a discontinuous function space, the term is
integrated by parts:</p>
<div class="math notranslate nohighlight">
\[\int_\Omega g \nabla_h r \cdot \boldsymbol{\psi} dx
    = - \int_\Omega g r \nabla_h \cdot \boldsymbol{\psi} dx
    + \int_{\mathcal{I}_h \cup \mathcal{I}_v} g \text{avg}(r) \text{jump}(\boldsymbol{\psi} \cdot \textbf{n}_h) dx\]</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Due to the <code class="xref py py-class docutils literal notranslate"><span class="pre">Term</span></code> sign convention this term is assembled on the right-hand-side.</p>
</div>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>solver</strong> – <cite>class`FlowSolver</cite> object</p></li>
<li><p><strong>solver_parameters</strong> (<a class="reference external" href="https://docs.python.org/2.7/library/stdtypes.html#dict" title="(in Python v2.7)"><em>dict</em></a>) – PETSc solver options</p></li>
</ul>
</dd>
</dl>
<dl class="py method">
<dt class="sig sig-object py" id="thetis.momentum_eq.InternalPressureGradientCalculator.residual">
<span class="sig-name descname"><span class="pre">residual</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">solution</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">solution_old</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fields</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fields_old</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">bnd_conditions</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/momentum_eq.html#InternalPressureGradientCalculator.residual"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#thetis.momentum_eq.InternalPressureGradientCalculator.residual" title="Link to this definition">¶</a></dt>
<dd><p>Returns an UFL form of the term.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>solution</strong> – solution <code class="xref py py-class docutils literal notranslate"><span class="pre">Function</span></code> of the corresponding equation</p></li>
<li><p><strong>solution_old</strong> – a time lagged solution <code class="xref py py-class docutils literal notranslate"><span class="pre">Function</span></code></p></li>
<li><p><strong>fields</strong> – a dictionary that provides all the remaining fields that the term depends on.
The keys of the dictionary should standard field names in <cite>field_metadata</cite></p></li>
<li><p><strong>fields_old</strong> – Time lagged dictionary of fields</p></li>
<li><p><strong>bnd_conditions</strong> – A dictionary describing boundary conditions.
E.g. {3: {‘elev_2d’: Constant(1.0)}} replaces elev_2d function by a constant on boundary ID 3.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="thetis.momentum_eq.InternalPressureGradientCalculator.solve">
<span class="sig-name descname"><span class="pre">solve</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/momentum_eq.html#InternalPressureGradientCalculator.solve"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#thetis.momentum_eq.InternalPressureGradientCalculator.solve" title="Link to this definition">¶</a></dt>
<dd><p>Computes internal pressure gradient and stores it in int_pg_3d field</p>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="thetis.momentum_eq.LinearDragTerm">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">thetis.momentum_eq.</span></span><span class="sig-name descname"><span class="pre">LinearDragTerm</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">function_space</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">bathymetry</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">v_elem_size</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">h_elem_size</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">use_nonlinear_equations</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">use_lax_friedrichs</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">use_bottom_friction</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sipg_factor</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">Constant([1.],</span> <span class="pre">name='constant_6',</span> <span class="pre">count=6)</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sipg_factor_vertical</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">Constant([1.],</span> <span class="pre">name='constant_7',</span> <span class="pre">count=7)</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/momentum_eq.html#LinearDragTerm"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#thetis.momentum_eq.LinearDragTerm" title="Link to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#thetis.momentum_eq.MomentumTerm" title="thetis.momentum_eq.MomentumTerm"><code class="xref py py-class docutils literal notranslate"><span class="pre">MomentumTerm</span></code></a></p>
<p>Linear drag term, <span class="math notranslate nohighlight">\(\tau_b = D \textbf{u}_b\)</span></p>
<p>where <span class="math notranslate nohighlight">\(D\)</span> is the drag coefficient, read from <code class="docutils literal notranslate"><span class="pre">linear_drag_coefficient</span></code> field.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>function_space</strong> – <code class="xref py py-class docutils literal notranslate"><span class="pre">FunctionSpace</span></code> where the solution belongs</p></li>
<li><p><strong>bathymetry</strong> (3D <code class="xref py py-class docutils literal notranslate"><span class="pre">Function</span></code> or <code class="xref py py-class docutils literal notranslate"><span class="pre">Constant</span></code>) – bathymetry of the domain</p></li>
<li><p><strong>v_elem_size</strong> – scalar <code class="xref py py-class docutils literal notranslate"><span class="pre">Function</span></code> that defines the vertical
element size</p></li>
<li><p><strong>h_elem_size</strong> – scalar <code class="xref py py-class docutils literal notranslate"><span class="pre">Function</span></code> that defines the horizontal
element size</p></li>
<li><p><strong>use_nonlinear_equations</strong> (<a class="reference external" href="https://docs.python.org/2.7/library/functions.html#bool" title="(in Python v2.7)"><em>bool</em></a>) – If False defines the linear shallow water equations</p></li>
<li><p><strong>use_bottom_friction</strong> (<a class="reference external" href="https://docs.python.org/2.7/library/functions.html#bool" title="(in Python v2.7)"><em>bool</em></a>) – If True includes bottom friction term</p></li>
<li><p><strong>sipg_factor</strong> – <dl class="field-list simple">
<dt class="field-odd">class<span class="colon">:</span></dt>
<dd class="field-odd"><p><cite>Constant</cite> or :class: <cite>Function</cite> horizontal SIPG penalty scaling factor</p>
</dd>
</dl>
</p></li>
<li><p><strong>sipg_factor_vertical</strong> – <dl class="field-list simple">
<dt class="field-odd">class<span class="colon">:</span></dt>
<dd class="field-odd"><p><cite>Constant</cite> or :class: <cite>Function</cite> vertical SIPG penalty scaling factor</p>
</dd>
</dl>
</p></li>
</ul>
</dd>
</dl>
<dl class="py method">
<dt class="sig sig-object py" id="thetis.momentum_eq.LinearDragTerm.residual">
<span class="sig-name descname"><span class="pre">residual</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">solution</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">solution_old</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fields</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fields_old</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">bnd_conditions</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/momentum_eq.html#LinearDragTerm.residual"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#thetis.momentum_eq.LinearDragTerm.residual" title="Link to this definition">¶</a></dt>
<dd><p>Returns an UFL form of the term.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>solution</strong> – solution <code class="xref py py-class docutils literal notranslate"><span class="pre">Function</span></code> of the corresponding equation</p></li>
<li><p><strong>solution_old</strong> – a time lagged solution <code class="xref py py-class docutils literal notranslate"><span class="pre">Function</span></code></p></li>
<li><p><strong>fields</strong> – a dictionary that provides all the remaining fields that the term depends on.
The keys of the dictionary should standard field names in <cite>field_metadata</cite></p></li>
<li><p><strong>fields_old</strong> – Time lagged dictionary of fields</p></li>
<li><p><strong>bnd_conditions</strong> – A dictionary describing boundary conditions.
E.g. {3: {‘elev_2d’: Constant(1.0)}} replaces elev_2d function by a constant on boundary ID 3.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="thetis.momentum_eq.MomentumEquation">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">thetis.momentum_eq.</span></span><span class="sig-name descname"><span class="pre">MomentumEquation</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">function_space</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">bathymetry</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">v_elem_size</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">h_elem_size</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">use_nonlinear_equations</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">use_lax_friedrichs</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">use_bottom_friction</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sipg_factor</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">Constant([1.],</span> <span class="pre">name='constant_8',</span> <span class="pre">count=8)</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sipg_factor_vertical</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">Constant([1.],</span> <span class="pre">name='constant_9',</span> <span class="pre">count=9)</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/momentum_eq.html#MomentumEquation"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#thetis.momentum_eq.MomentumEquation" title="Link to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#thetis.equation.Equation" title="thetis.equation.Equation"><code class="xref py py-class docutils literal notranslate"><span class="pre">Equation</span></code></a></p>
<p>Hydrostatic 3D momentum equation <a class="reference internal" href="#equation-mom-eq-split">(5)</a> for mode split models</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>function_space</strong> – <code class="xref py py-class docutils literal notranslate"><span class="pre">FunctionSpace</span></code> where the solution belongs</p></li>
<li><p><strong>bathymetry</strong> (3D <code class="xref py py-class docutils literal notranslate"><span class="pre">Function</span></code> or <code class="xref py py-class docutils literal notranslate"><span class="pre">Constant</span></code>) – bathymetry of the domain</p></li>
<li><p><strong>v_elem_size</strong> – scalar <code class="xref py py-class docutils literal notranslate"><span class="pre">Function</span></code> that defines the vertical
element size</p></li>
<li><p><strong>h_elem_size</strong> – scalar <code class="xref py py-class docutils literal notranslate"><span class="pre">Function</span></code> that defines the horizontal
element size</p></li>
<li><p><strong>use_nonlinear_equations</strong> (<a class="reference external" href="https://docs.python.org/2.7/library/functions.html#bool" title="(in Python v2.7)"><em>bool</em></a>) – If False defines the linear shallow water equations</p></li>
<li><p><strong>use_bottom_friction</strong> (<a class="reference external" href="https://docs.python.org/2.7/library/functions.html#bool" title="(in Python v2.7)"><em>bool</em></a>) – If True includes bottom friction term</p></li>
<li><p><strong>sipg_factor</strong> – <dl class="field-list simple">
<dt class="field-odd">class<span class="colon">:</span></dt>
<dd class="field-odd"><p><cite>Constant</cite> or :class: <cite>Function</cite> horizontal SIPG penalty scaling factor</p>
</dd>
</dl>
</p></li>
<li><p><strong>sipg_factor_vertical</strong> – <dl class="field-list simple">
<dt class="field-odd">class<span class="colon">:</span></dt>
<dd class="field-odd"><p><cite>Constant</cite> or :class: <cite>Function</cite> vertical SIPG penalty scaling factor</p>
</dd>
</dl>
</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="thetis.momentum_eq.MomentumTerm">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">thetis.momentum_eq.</span></span><span class="sig-name descname"><span class="pre">MomentumTerm</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">function_space</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">bathymetry</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">v_elem_size</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">h_elem_size</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">use_nonlinear_equations</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">use_lax_friedrichs</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">use_bottom_friction</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sipg_factor</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">Constant([1.],</span> <span class="pre">name='constant_6',</span> <span class="pre">count=6)</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sipg_factor_vertical</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">Constant([1.],</span> <span class="pre">name='constant_7',</span> <span class="pre">count=7)</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/momentum_eq.html#MomentumTerm"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#thetis.momentum_eq.MomentumTerm" title="Link to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#thetis.equation.Term" title="thetis.equation.Term"><code class="xref py py-class docutils literal notranslate"><span class="pre">Term</span></code></a></p>
<p>Generic term for momentum equation that provides commonly used members and
mapping for boundary functions.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>function_space</strong> – <code class="xref py py-class docutils literal notranslate"><span class="pre">FunctionSpace</span></code> where the solution belongs</p></li>
<li><p><strong>bathymetry</strong> (3D <code class="xref py py-class docutils literal notranslate"><span class="pre">Function</span></code> or <code class="xref py py-class docutils literal notranslate"><span class="pre">Constant</span></code>) – bathymetry of the domain</p></li>
<li><p><strong>v_elem_size</strong> – scalar <code class="xref py py-class docutils literal notranslate"><span class="pre">Function</span></code> that defines the vertical
element size</p></li>
<li><p><strong>h_elem_size</strong> – scalar <code class="xref py py-class docutils literal notranslate"><span class="pre">Function</span></code> that defines the horizontal
element size</p></li>
<li><p><strong>use_nonlinear_equations</strong> (<a class="reference external" href="https://docs.python.org/2.7/library/functions.html#bool" title="(in Python v2.7)"><em>bool</em></a>) – If False defines the linear shallow water equations</p></li>
<li><p><strong>use_bottom_friction</strong> (<a class="reference external" href="https://docs.python.org/2.7/library/functions.html#bool" title="(in Python v2.7)"><em>bool</em></a>) – If True includes bottom friction term</p></li>
<li><p><strong>sipg_factor</strong> – <dl class="field-list simple">
<dt class="field-odd">class<span class="colon">:</span></dt>
<dd class="field-odd"><p><cite>Constant</cite> or :class: <cite>Function</cite> horizontal SIPG penalty scaling factor</p>
</dd>
</dl>
</p></li>
<li><p><strong>sipg_factor_vertical</strong> – <dl class="field-list simple">
<dt class="field-odd">class<span class="colon">:</span></dt>
<dd class="field-odd"><p><cite>Constant</cite> or :class: <cite>Function</cite> vertical SIPG penalty scaling factor</p>
</dd>
</dl>
</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="thetis.momentum_eq.PressureGradientTerm">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">thetis.momentum_eq.</span></span><span class="sig-name descname"><span class="pre">PressureGradientTerm</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">function_space</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">bathymetry</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">v_elem_size</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">h_elem_size</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">use_nonlinear_equations</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">use_lax_friedrichs</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">use_bottom_friction</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sipg_factor</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">Constant([1.],</span> <span class="pre">name='constant_6',</span> <span class="pre">count=6)</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sipg_factor_vertical</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">Constant([1.],</span> <span class="pre">name='constant_7',</span> <span class="pre">count=7)</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/momentum_eq.html#PressureGradientTerm"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#thetis.momentum_eq.PressureGradientTerm" title="Link to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#thetis.momentum_eq.MomentumTerm" title="thetis.momentum_eq.MomentumTerm"><code class="xref py py-class docutils literal notranslate"><span class="pre">MomentumTerm</span></code></a></p>
<p>Internal pressure gradient term, <span class="math notranslate nohighlight">\(g\nabla_h r\)</span></p>
<p>where <span class="math notranslate nohighlight">\(r\)</span> is the baroclinic head <a class="reference internal" href="#equation-baroc-head">(3)</a>. Let <span class="math notranslate nohighlight">\(s\)</span>
denote <span class="math notranslate nohighlight">\(r/H\)</span>. We can then write</p>
<div class="math notranslate nohighlight">
\[F_{IPG} = g\nabla_h((s -\bar{s}) H)
    + g\nabla_h\left(\frac{1}{H}\right) H^2\bar{s}
    + g s_{bot}\nabla_h h\]</div>
<p>where <span class="math notranslate nohighlight">\(\bar{s},s_{bot}\)</span> are the depth average and bottom value of
<span class="math notranslate nohighlight">\(s\)</span>.</p>
<p>If <span class="math notranslate nohighlight">\(s\)</span> belongs to a discontinuous function space, the first term is
integrated by parts. Its weak form reads</p>
<div class="math notranslate nohighlight">
\[\int_\Omega g\nabla_h((s -\bar{s}) H) \cdot \boldsymbol{\psi} dx
    = - \int_\Omega g (s -\bar{s}) H \nabla_h \cdot \boldsymbol{\psi} dx
    + \int_{\mathcal{I}_h \cup \mathcal{I}_v} g (s -\bar{s}) H \boldsymbol{\psi}  \cdot \textbf{n}_h dx\]</div>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>function_space</strong> – <code class="xref py py-class docutils literal notranslate"><span class="pre">FunctionSpace</span></code> where the solution belongs</p></li>
<li><p><strong>bathymetry</strong> (3D <code class="xref py py-class docutils literal notranslate"><span class="pre">Function</span></code> or <code class="xref py py-class docutils literal notranslate"><span class="pre">Constant</span></code>) – bathymetry of the domain</p></li>
<li><p><strong>v_elem_size</strong> – scalar <code class="xref py py-class docutils literal notranslate"><span class="pre">Function</span></code> that defines the vertical
element size</p></li>
<li><p><strong>h_elem_size</strong> – scalar <code class="xref py py-class docutils literal notranslate"><span class="pre">Function</span></code> that defines the horizontal
element size</p></li>
<li><p><strong>use_nonlinear_equations</strong> (<a class="reference external" href="https://docs.python.org/2.7/library/functions.html#bool" title="(in Python v2.7)"><em>bool</em></a>) – If False defines the linear shallow water equations</p></li>
<li><p><strong>use_bottom_friction</strong> (<a class="reference external" href="https://docs.python.org/2.7/library/functions.html#bool" title="(in Python v2.7)"><em>bool</em></a>) – If True includes bottom friction term</p></li>
<li><p><strong>sipg_factor</strong> – <dl class="field-list simple">
<dt class="field-odd">class<span class="colon">:</span></dt>
<dd class="field-odd"><p><cite>Constant</cite> or :class: <cite>Function</cite> horizontal SIPG penalty scaling factor</p>
</dd>
</dl>
</p></li>
<li><p><strong>sipg_factor_vertical</strong> – <dl class="field-list simple">
<dt class="field-odd">class<span class="colon">:</span></dt>
<dd class="field-odd"><p><cite>Constant</cite> or :class: <cite>Function</cite> vertical SIPG penalty scaling factor</p>
</dd>
</dl>
</p></li>
</ul>
</dd>
</dl>
<dl class="py method">
<dt class="sig sig-object py" id="thetis.momentum_eq.PressureGradientTerm.residual">
<span class="sig-name descname"><span class="pre">residual</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">solution</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">solution_old</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fields</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fields_old</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">bnd_conditions</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/momentum_eq.html#PressureGradientTerm.residual"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#thetis.momentum_eq.PressureGradientTerm.residual" title="Link to this definition">¶</a></dt>
<dd><p>Returns an UFL form of the term.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>solution</strong> – solution <code class="xref py py-class docutils literal notranslate"><span class="pre">Function</span></code> of the corresponding equation</p></li>
<li><p><strong>solution_old</strong> – a time lagged solution <code class="xref py py-class docutils literal notranslate"><span class="pre">Function</span></code></p></li>
<li><p><strong>fields</strong> – a dictionary that provides all the remaining fields that the term depends on.
The keys of the dictionary should standard field names in <cite>field_metadata</cite></p></li>
<li><p><strong>fields_old</strong> – Time lagged dictionary of fields</p></li>
<li><p><strong>bnd_conditions</strong> – A dictionary describing boundary conditions.
E.g. {3: {‘elev_2d’: Constant(1.0)}} replaces elev_2d function by a constant on boundary ID 3.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="thetis.momentum_eq.SourceTerm">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">thetis.momentum_eq.</span></span><span class="sig-name descname"><span class="pre">SourceTerm</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">function_space</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">bathymetry</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">v_elem_size</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">h_elem_size</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">use_nonlinear_equations</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">use_lax_friedrichs</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">use_bottom_friction</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sipg_factor</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">Constant([1.],</span> <span class="pre">name='constant_6',</span> <span class="pre">count=6)</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sipg_factor_vertical</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">Constant([1.],</span> <span class="pre">name='constant_7',</span> <span class="pre">count=7)</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/momentum_eq.html#SourceTerm"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#thetis.momentum_eq.SourceTerm" title="Link to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#thetis.momentum_eq.MomentumTerm" title="thetis.momentum_eq.MomentumTerm"><code class="xref py py-class docutils literal notranslate"><span class="pre">MomentumTerm</span></code></a></p>
<p>Generic momentum source term</p>
<p>The weak form reads</p>
<div class="math notranslate nohighlight">
\[F_s = \int_\Omega \sigma \cdot \boldsymbol{\psi} dx\]</div>
<p>where <span class="math notranslate nohighlight">\(\sigma\)</span> is a user defined vector valued <code class="xref py py-class docutils literal notranslate"><span class="pre">Function</span></code>.</p>
<p>This term also implements the wind stress, <span class="math notranslate nohighlight">\(-\tau_w/(H \rho_0)\)</span>.
<span class="math notranslate nohighlight">\(\tau_w\)</span> is a user-defined wind stress <code class="xref py py-class docutils literal notranslate"><span class="pre">Function</span></code>
<code class="docutils literal notranslate"><span class="pre">wind_stress</span></code>. The weak form is</p>
<div class="math notranslate nohighlight">
\[F_w = \int_{\Gamma_s} \frac{1}{\rho_0} \tau_w \cdot \boldsymbol{\psi} dx\]</div>
<p>Wind stress is only included if vertical viscosity is provided.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>function_space</strong> – <code class="xref py py-class docutils literal notranslate"><span class="pre">FunctionSpace</span></code> where the solution belongs</p></li>
<li><p><strong>bathymetry</strong> (3D <code class="xref py py-class docutils literal notranslate"><span class="pre">Function</span></code> or <code class="xref py py-class docutils literal notranslate"><span class="pre">Constant</span></code>) – bathymetry of the domain</p></li>
<li><p><strong>v_elem_size</strong> – scalar <code class="xref py py-class docutils literal notranslate"><span class="pre">Function</span></code> that defines the vertical
element size</p></li>
<li><p><strong>h_elem_size</strong> – scalar <code class="xref py py-class docutils literal notranslate"><span class="pre">Function</span></code> that defines the horizontal
element size</p></li>
<li><p><strong>use_nonlinear_equations</strong> (<a class="reference external" href="https://docs.python.org/2.7/library/functions.html#bool" title="(in Python v2.7)"><em>bool</em></a>) – If False defines the linear shallow water equations</p></li>
<li><p><strong>use_bottom_friction</strong> (<a class="reference external" href="https://docs.python.org/2.7/library/functions.html#bool" title="(in Python v2.7)"><em>bool</em></a>) – If True includes bottom friction term</p></li>
<li><p><strong>sipg_factor</strong> – <dl class="field-list simple">
<dt class="field-odd">class<span class="colon">:</span></dt>
<dd class="field-odd"><p><cite>Constant</cite> or :class: <cite>Function</cite> horizontal SIPG penalty scaling factor</p>
</dd>
</dl>
</p></li>
<li><p><strong>sipg_factor_vertical</strong> – <dl class="field-list simple">
<dt class="field-odd">class<span class="colon">:</span></dt>
<dd class="field-odd"><p><cite>Constant</cite> or :class: <cite>Function</cite> vertical SIPG penalty scaling factor</p>
</dd>
</dl>
</p></li>
</ul>
</dd>
</dl>
<dl class="py method">
<dt class="sig sig-object py" id="thetis.momentum_eq.SourceTerm.residual">
<span class="sig-name descname"><span class="pre">residual</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">solution</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">solution_old</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fields</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fields_old</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">bnd_conditions</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/momentum_eq.html#SourceTerm.residual"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#thetis.momentum_eq.SourceTerm.residual" title="Link to this definition">¶</a></dt>
<dd><p>Returns an UFL form of the term.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>solution</strong> – solution <code class="xref py py-class docutils literal notranslate"><span class="pre">Function</span></code> of the corresponding equation</p></li>
<li><p><strong>solution_old</strong> – a time lagged solution <code class="xref py py-class docutils literal notranslate"><span class="pre">Function</span></code></p></li>
<li><p><strong>fields</strong> – a dictionary that provides all the remaining fields that the term depends on.
The keys of the dictionary should standard field names in <cite>field_metadata</cite></p></li>
<li><p><strong>fields_old</strong> – Time lagged dictionary of fields</p></li>
<li><p><strong>bnd_conditions</strong> – A dictionary describing boundary conditions.
E.g. {3: {‘elev_2d’: Constant(1.0)}} replaces elev_2d function by a constant on boundary ID 3.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="thetis.momentum_eq.VerticalAdvectionTerm">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">thetis.momentum_eq.</span></span><span class="sig-name descname"><span class="pre">VerticalAdvectionTerm</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">function_space</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">bathymetry</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">v_elem_size</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">h_elem_size</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">use_nonlinear_equations</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">use_lax_friedrichs</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">use_bottom_friction</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sipg_factor</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">Constant([1.],</span> <span class="pre">name='constant_6',</span> <span class="pre">count=6)</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sipg_factor_vertical</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">Constant([1.],</span> <span class="pre">name='constant_7',</span> <span class="pre">count=7)</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/momentum_eq.html#VerticalAdvectionTerm"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#thetis.momentum_eq.VerticalAdvectionTerm" title="Link to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#thetis.momentum_eq.MomentumTerm" title="thetis.momentum_eq.MomentumTerm"><code class="xref py py-class docutils literal notranslate"><span class="pre">MomentumTerm</span></code></a></p>
<p>Vertical advection term, <span class="math notranslate nohighlight">\(\partial \left(w\textbf{u} \right)/(\partial z)\)</span></p>
<p>The weak form reads</p>
<div class="math notranslate nohighlight">
\[\int_\Omega \frac{\partial \left(w\textbf{u} \right)}{\partial z} \cdot \boldsymbol{\psi} dx
= - \int_\Omega \left( w \textbf{u} \right) \cdot \frac{\partial \boldsymbol{\psi}}{\partial z} dx
+ \int_{\mathcal{I}_{h}} \textbf{u}^{\text{up}} \cdot \text{jump}(\boldsymbol{\psi} n_z) \text{avg}(w) dS\]</div>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>function_space</strong> – <code class="xref py py-class docutils literal notranslate"><span class="pre">FunctionSpace</span></code> where the solution belongs</p></li>
<li><p><strong>bathymetry</strong> (3D <code class="xref py py-class docutils literal notranslate"><span class="pre">Function</span></code> or <code class="xref py py-class docutils literal notranslate"><span class="pre">Constant</span></code>) – bathymetry of the domain</p></li>
<li><p><strong>v_elem_size</strong> – scalar <code class="xref py py-class docutils literal notranslate"><span class="pre">Function</span></code> that defines the vertical
element size</p></li>
<li><p><strong>h_elem_size</strong> – scalar <code class="xref py py-class docutils literal notranslate"><span class="pre">Function</span></code> that defines the horizontal
element size</p></li>
<li><p><strong>use_nonlinear_equations</strong> (<a class="reference external" href="https://docs.python.org/2.7/library/functions.html#bool" title="(in Python v2.7)"><em>bool</em></a>) – If False defines the linear shallow water equations</p></li>
<li><p><strong>use_bottom_friction</strong> (<a class="reference external" href="https://docs.python.org/2.7/library/functions.html#bool" title="(in Python v2.7)"><em>bool</em></a>) – If True includes bottom friction term</p></li>
<li><p><strong>sipg_factor</strong> – <dl class="field-list simple">
<dt class="field-odd">class<span class="colon">:</span></dt>
<dd class="field-odd"><p><cite>Constant</cite> or :class: <cite>Function</cite> horizontal SIPG penalty scaling factor</p>
</dd>
</dl>
</p></li>
<li><p><strong>sipg_factor_vertical</strong> – <dl class="field-list simple">
<dt class="field-odd">class<span class="colon">:</span></dt>
<dd class="field-odd"><p><cite>Constant</cite> or :class: <cite>Function</cite> vertical SIPG penalty scaling factor</p>
</dd>
</dl>
</p></li>
</ul>
</dd>
</dl>
<dl class="py method">
<dt class="sig sig-object py" id="thetis.momentum_eq.VerticalAdvectionTerm.residual">
<span class="sig-name descname"><span class="pre">residual</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">solution</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">solution_old</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fields</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fields_old</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">bnd_conditions</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/momentum_eq.html#VerticalAdvectionTerm.residual"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#thetis.momentum_eq.VerticalAdvectionTerm.residual" title="Link to this definition">¶</a></dt>
<dd><p>Returns an UFL form of the term.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>solution</strong> – solution <code class="xref py py-class docutils literal notranslate"><span class="pre">Function</span></code> of the corresponding equation</p></li>
<li><p><strong>solution_old</strong> – a time lagged solution <code class="xref py py-class docutils literal notranslate"><span class="pre">Function</span></code></p></li>
<li><p><strong>fields</strong> – a dictionary that provides all the remaining fields that the term depends on.
The keys of the dictionary should standard field names in <cite>field_metadata</cite></p></li>
<li><p><strong>fields_old</strong> – Time lagged dictionary of fields</p></li>
<li><p><strong>bnd_conditions</strong> – A dictionary describing boundary conditions.
E.g. {3: {‘elev_2d’: Constant(1.0)}} replaces elev_2d function by a constant on boundary ID 3.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="thetis.momentum_eq.VerticalViscosityTerm">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">thetis.momentum_eq.</span></span><span class="sig-name descname"><span class="pre">VerticalViscosityTerm</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">function_space</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">bathymetry</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">v_elem_size</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">h_elem_size</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">use_nonlinear_equations</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">use_lax_friedrichs</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">use_bottom_friction</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sipg_factor</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">Constant([1.],</span> <span class="pre">name='constant_6',</span> <span class="pre">count=6)</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sipg_factor_vertical</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">Constant([1.],</span> <span class="pre">name='constant_7',</span> <span class="pre">count=7)</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/momentum_eq.html#VerticalViscosityTerm"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#thetis.momentum_eq.VerticalViscosityTerm" title="Link to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#thetis.momentum_eq.MomentumTerm" title="thetis.momentum_eq.MomentumTerm"><code class="xref py py-class docutils literal notranslate"><span class="pre">MomentumTerm</span></code></a></p>
<p>Vertical viscosity term, <span class="math notranslate nohighlight">\(- \frac{\partial }{\partial z}\left( \nu \frac{\partial \textbf{u}}{\partial z}\right)\)</span></p>
<p>Using the symmetric interior penalty method the weak form becomes</p>
<div class="math notranslate nohighlight">
\[\begin{split}\int_\Omega \frac{\partial }{\partial z}\left( \nu \frac{\partial \textbf{u}}{\partial z}\right) \cdot \boldsymbol{\psi} dx
=&amp; -\int_\Omega \nu \frac{\partial \boldsymbol{\psi}}{\partial z} \cdot \frac{\partial \textbf{u}}{\partial z} dx \\
&amp;+ \int_{\mathcal{I}_h} \text{jump}(\boldsymbol{\psi} n_z) \cdot \text{avg}\left(\nu \frac{\partial \textbf{u}}{\partial z}\right) dS
+ \int_{\mathcal{I}_h} \text{jump}(\textbf{u} n_z) \cdot \text{avg}\left(\nu \frac{\partial \boldsymbol{\psi}}{\partial z}\right) dS \\
&amp;- \int_{\mathcal{I}_h} \sigma \text{avg}(\nu) \text{jump}(\textbf{u} n_z) \cdot \text{jump}(\boldsymbol{\psi} n_z) dS\end{split}\]</div>
<p>where <span class="math notranslate nohighlight">\(\sigma\)</span> is a penalty parameter, see Hillewaert (2013).</p>
<p>Hillewaert, Koen (2013). Development of the discontinuous Galerkin method
for high-resolution, large scale CFD and acoustics in industrial
geometries. PhD Thesis. Université catholique de Louvain.
<a class="reference external" href="https://dial.uclouvain.be/pr/boreal/object/boreal:128254/">https://dial.uclouvain.be/pr/boreal/object/boreal:128254/</a></p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>function_space</strong> – <code class="xref py py-class docutils literal notranslate"><span class="pre">FunctionSpace</span></code> where the solution belongs</p></li>
<li><p><strong>bathymetry</strong> (3D <code class="xref py py-class docutils literal notranslate"><span class="pre">Function</span></code> or <code class="xref py py-class docutils literal notranslate"><span class="pre">Constant</span></code>) – bathymetry of the domain</p></li>
<li><p><strong>v_elem_size</strong> – scalar <code class="xref py py-class docutils literal notranslate"><span class="pre">Function</span></code> that defines the vertical
element size</p></li>
<li><p><strong>h_elem_size</strong> – scalar <code class="xref py py-class docutils literal notranslate"><span class="pre">Function</span></code> that defines the horizontal
element size</p></li>
<li><p><strong>use_nonlinear_equations</strong> (<a class="reference external" href="https://docs.python.org/2.7/library/functions.html#bool" title="(in Python v2.7)"><em>bool</em></a>) – If False defines the linear shallow water equations</p></li>
<li><p><strong>use_bottom_friction</strong> (<a class="reference external" href="https://docs.python.org/2.7/library/functions.html#bool" title="(in Python v2.7)"><em>bool</em></a>) – If True includes bottom friction term</p></li>
<li><p><strong>sipg_factor</strong> – <dl class="field-list simple">
<dt class="field-odd">class<span class="colon">:</span></dt>
<dd class="field-odd"><p><cite>Constant</cite> or :class: <cite>Function</cite> horizontal SIPG penalty scaling factor</p>
</dd>
</dl>
</p></li>
<li><p><strong>sipg_factor_vertical</strong> – <dl class="field-list simple">
<dt class="field-odd">class<span class="colon">:</span></dt>
<dd class="field-odd"><p><cite>Constant</cite> or :class: <cite>Function</cite> vertical SIPG penalty scaling factor</p>
</dd>
</dl>
</p></li>
</ul>
</dd>
</dl>
<dl class="py method">
<dt class="sig sig-object py" id="thetis.momentum_eq.VerticalViscosityTerm.residual">
<span class="sig-name descname"><span class="pre">residual</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">solution</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">solution_old</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fields</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fields_old</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">bnd_conditions</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/momentum_eq.html#VerticalViscosityTerm.residual"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#thetis.momentum_eq.VerticalViscosityTerm.residual" title="Link to this definition">¶</a></dt>
<dd><p>Returns an UFL form of the term.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>solution</strong> – solution <code class="xref py py-class docutils literal notranslate"><span class="pre">Function</span></code> of the corresponding equation</p></li>
<li><p><strong>solution_old</strong> – a time lagged solution <code class="xref py py-class docutils literal notranslate"><span class="pre">Function</span></code></p></li>
<li><p><strong>fields</strong> – a dictionary that provides all the remaining fields that the term depends on.
The keys of the dictionary should standard field names in <cite>field_metadata</cite></p></li>
<li><p><strong>fields_old</strong> – Time lagged dictionary of fields</p></li>
<li><p><strong>bnd_conditions</strong> – A dictionary describing boundary conditions.
E.g. {3: {‘elev_2d’: Constant(1.0)}} replaces elev_2d function by a constant on boundary ID 3.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

</dd></dl>

</section>
<section id="module-thetis.optimisation">
<span id="thetis-optimisation-module"></span><h2>thetis.optimisation module<a class="headerlink" href="#module-thetis.optimisation" title="Link to this heading">¶</a></h2>
<p>Some classes to help optimisation problems formulated with thetis_adjoint.</p>
<p>In particular this module contains some OptimisationCallbacks that can be used
as callbacks of a <code class="xref py py-class docutils literal notranslate"><span class="pre">ReducedFunctional</span></code> called at various stages during the optimisation
process:
- eval_cb_pre(controls) and eval_cb_post(functional, controls)                    called before and after (re)evaluation of the forward model
- derivative_cb_pre(controls) and eval_cb_post(functional, derivative, controls)  called before and after the gradient computation using the adjoint of the model
- hessian_cb_pre(controls) and eval_cb_post(functional, derivative, controls)     called before and after the hessian computation
OptimisationCallbacks that (can) use controls, functional and derivative information, work out
what is provided by the number of arguments: current control values are always in the last argument;
if more than 2 arguments are provided, the first is the latest evaluated functional value.</p>
<dl class="py class">
<dt class="sig sig-object py" id="thetis.optimisation.ConstantControlOptimisationCallback">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">thetis.optimisation.</span></span><span class="sig-name descname"><span class="pre">ConstantControlOptimisationCallback</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">solver_obj</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/optimisation.html#ConstantControlOptimisationCallback"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#thetis.optimisation.ConstantControlOptimisationCallback" title="Link to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#thetis.optimisation.DiagnosticOptimisationCallback" title="thetis.optimisation.DiagnosticOptimisationCallback"><code class="xref py py-class docutils literal notranslate"><span class="pre">DiagnosticOptimisationCallback</span></code></a></p>
<p>OptimisationCallback that records the control values (which are assumed to be a list of Constants) in the log and/or hdf5 file.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>solver_obj</strong> – Thetis solver object</p></li>
<li><p><strong>kwargs</strong> – keyword arguments passed to <a class="reference internal" href="#thetis.callback.DiagnosticCallback" title="thetis.callback.DiagnosticCallback"><code class="xref py py-class docutils literal notranslate"><span class="pre">DiagnosticCallback</span></code></a></p></li>
</ul>
</dd>
</dl>
<dl class="py method">
<dt class="sig sig-object py" id="thetis.optimisation.ConstantControlOptimisationCallback.compute_values">
<span class="sig-name descname"><span class="pre">compute_values</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/optimisation.html#ConstantControlOptimisationCallback.compute_values"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#thetis.optimisation.ConstantControlOptimisationCallback.compute_values" title="Link to this definition">¶</a></dt>
<dd><p>Compute diagnostic values.</p>
<p>This method is to be implemented in concrete subclasses of a <a class="reference internal" href="#thetis.optimisation.DiagnosticOptimisationCallback" title="thetis.optimisation.DiagnosticOptimisationCallback"><code class="xref py py-class docutils literal notranslate"><span class="pre">DiagnosticOptimisationCallback</span></code></a>.
The number of arguments varies depending on which of the 6 [eval|derivative|hessian]_cb_[pre|post] callbacks
this is used as. The last argument always contains the current controls. In the “pre” callbacks this is
the only argument. In all “post” callbacks the 0th argument is the current functional value. eval_cb_post
is given two arguments: functional and controls. derivative_cb_post and hessian_cb_post are given three
arguments with args[1] being the derivative/hessian just calculated.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="thetis.optimisation.ConstantControlOptimisationCallback.message_str">
<span class="sig-name descname"><span class="pre">message_str</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">controls</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/optimisation.html#ConstantControlOptimisationCallback.message_str"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#thetis.optimisation.ConstantControlOptimisationCallback.message_str" title="Link to this definition">¶</a></dt>
<dd><p>A string representation.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>args</strong> – If provided, these will be the return value from
<code class="xref py py-meth docutils literal notranslate"><span class="pre">__call__()</span></code>.</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="thetis.optimisation.ConstantControlOptimisationCallback.name">
<span class="sig-name descname"><span class="pre">name</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">'controls'</span></em><a class="headerlink" href="#thetis.optimisation.ConstantControlOptimisationCallback.name" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="thetis.optimisation.ConstantControlOptimisationCallback.variable_names">
<span class="sig-name descname"><span class="pre">variable_names</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">['controls']</span></em><a class="headerlink" href="#thetis.optimisation.ConstantControlOptimisationCallback.variable_names" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="thetis.optimisation.ControlsExportOptimisationCallback">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">thetis.optimisation.</span></span><span class="sig-name descname"><span class="pre">ControlsExportOptimisationCallback</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">solver_obj_or_outputdir</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/optimisation.html#ControlsExportOptimisationCallback"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#thetis.optimisation.ControlsExportOptimisationCallback" title="Link to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#thetis.optimisation.DeferredExportManager" title="thetis.optimisation.DeferredExportManager"><code class="xref py py-class docutils literal notranslate"><span class="pre">DeferredExportManager</span></code></a>, <a class="reference internal" href="#thetis.optimisation.OptimisationCallback" title="thetis.optimisation.OptimisationCallback"><code class="xref py py-class docutils literal notranslate"><span class="pre">OptimisationCallback</span></code></a></p>
<p>A callback that exports the current control values (assumed to all be <code class="xref py py-class docutils literal notranslate"><span class="pre">Function</span></code> s)</p>
<p>The control values are assumed to be the last argument in the callback (as for all <code class="xref py py-class docutils literal notranslate"><span class="pre">ReducedFunctional</span></code> callbacks).</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>solver_obj_or_outputdir</strong> – a <a class="reference internal" href="#thetis.solver2d.FlowSolver2d" title="thetis.solver2d.FlowSolver2d"><code class="xref py py-class docutils literal notranslate"><span class="pre">FlowSolver2d</span></code></a> object, used to determine the output directory. Alternatively, the
outputdir can be specified with a string as the first argument.</p></li>
<li><p><strong>kwargs</strong> – any further keyword arguments are passed on to <a class="reference internal" href="#thetis.optimisation.UserExportManager" title="thetis.optimisation.UserExportManager"><code class="xref py py-class docutils literal notranslate"><span class="pre">UserExportManager</span></code></a></p></li>
</ul>
</dd>
</dl>
<dl class="py method">
<dt class="sig sig-object py" id="thetis.optimisation.ControlsExportOptimisationCallback.callback">
<span class="sig-name descname"><span class="pre">callback</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/optimisation.html#ControlsExportOptimisationCallback.callback"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#thetis.optimisation.ControlsExportOptimisationCallback.callback" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="thetis.optimisation.DeferredExportManager">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">thetis.optimisation.</span></span><span class="sig-name descname"><span class="pre">DeferredExportManager</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">solver_obj_or_outputdir</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/optimisation.html#DeferredExportManager"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#thetis.optimisation.DeferredExportManager" title="Link to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference external" href="https://docs.python.org/2.7/library/functions.html#object" title="(in Python v2.7)"><code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></a></p>
<p>A wrapper around a UserExportManager that is only created on the first export() call.</p>
<p>In addition the functions provided in the export call are copied into a fixed set of functions,
where the functions provided in subsequent calls may be different (they need to be in the same
function space). This is used in the <a class="reference internal" href="#thetis.optimisation.ControlsExportOptimisationCallback" title="thetis.optimisation.ControlsExportOptimisationCallback"><code class="xref py py-class docutils literal notranslate"><span class="pre">ControlsExportOptimisationCallback</span></code></a>
and <a class="reference internal" href="#thetis.optimisation.DerivativesExportOptimisationCallback" title="thetis.optimisation.DerivativesExportOptimisationCallback"><code class="xref py py-class docutils literal notranslate"><span class="pre">DerivativesExportOptimisationCallback</span></code></a>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>solver_obj_or_outputdir</strong> – a <a class="reference internal" href="#thetis.solver2d.FlowSolver2d" title="thetis.solver2d.FlowSolver2d"><code class="xref py py-class docutils literal notranslate"><span class="pre">FlowSolver2d</span></code></a> object, used to determine the output directory. Alternatively, the
outputdir can be specified with a string as the first argument.</p></li>
<li><p><strong>kwargs</strong> – any further keyword arguments are passed on to <a class="reference internal" href="#thetis.optimisation.UserExportManager" title="thetis.optimisation.UserExportManager"><code class="xref py py-class docutils literal notranslate"><span class="pre">UserExportManager</span></code></a></p></li>
</ul>
</dd>
</dl>
<dl class="py method">
<dt class="sig sig-object py" id="thetis.optimisation.DeferredExportManager.export">
<span class="sig-name descname"><span class="pre">export</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">functions</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">suggested_names</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/optimisation.html#DeferredExportManager.export"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#thetis.optimisation.DeferredExportManager.export" title="Link to this definition">¶</a></dt>
<dd><p>Create the <a class="reference internal" href="#thetis.optimisation.UserExportManager" title="thetis.optimisation.UserExportManager"><code class="xref py py-class docutils literal notranslate"><span class="pre">UserExportManager</span></code></a> (first call only), and call its export() method.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>functions</strong> – a list of <code class="xref py py-class docutils literal notranslate"><span class="pre">Function</span></code> s that the <a class="reference internal" href="#thetis.optimisation.UserExportManager" title="thetis.optimisation.UserExportManager"><code class="xref py py-class docutils literal notranslate"><span class="pre">UserExportManager</span></code></a> will be based on. Their values
are first copied. The list may contain different functions in subsequent calls,
but their function space should remain the same.</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="thetis.optimisation.DerivativeConstantControlOptimisationCallback">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">thetis.optimisation.</span></span><span class="sig-name descname"><span class="pre">DerivativeConstantControlOptimisationCallback</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">solver_obj</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/optimisation.html#DerivativeConstantControlOptimisationCallback"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#thetis.optimisation.DerivativeConstantControlOptimisationCallback" title="Link to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#thetis.optimisation.DiagnosticOptimisationCallback" title="thetis.optimisation.DiagnosticOptimisationCallback"><code class="xref py py-class docutils literal notranslate"><span class="pre">DiagnosticOptimisationCallback</span></code></a></p>
<p>OptimisationCallback that records the derivatives with respect to the controls, assumed to be a list of Constants, in the log and/or hdf5 file.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>solver_obj</strong> – Thetis solver object</p></li>
<li><p><strong>kwargs</strong> – keyword arguments passed to <a class="reference internal" href="#thetis.callback.DiagnosticCallback" title="thetis.callback.DiagnosticCallback"><code class="xref py py-class docutils literal notranslate"><span class="pre">DiagnosticCallback</span></code></a></p></li>
</ul>
</dd>
</dl>
<dl class="py method">
<dt class="sig sig-object py" id="thetis.optimisation.DerivativeConstantControlOptimisationCallback.compute_values">
<span class="sig-name descname"><span class="pre">compute_values</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/optimisation.html#DerivativeConstantControlOptimisationCallback.compute_values"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#thetis.optimisation.DerivativeConstantControlOptimisationCallback.compute_values" title="Link to this definition">¶</a></dt>
<dd><p>Compute diagnostic values.</p>
<p>This method is to be implemented in concrete subclasses of a <a class="reference internal" href="#thetis.optimisation.DiagnosticOptimisationCallback" title="thetis.optimisation.DiagnosticOptimisationCallback"><code class="xref py py-class docutils literal notranslate"><span class="pre">DiagnosticOptimisationCallback</span></code></a>.
The number of arguments varies depending on which of the 6 [eval|derivative|hessian]_cb_[pre|post] callbacks
this is used as. The last argument always contains the current controls. In the “pre” callbacks this is
the only argument. In all “post” callbacks the 0th argument is the current functional value. eval_cb_post
is given two arguments: functional and controls. derivative_cb_post and hessian_cb_post are given three
arguments with args[1] being the derivative/hessian just calculated.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="thetis.optimisation.DerivativeConstantControlOptimisationCallback.message_str">
<span class="sig-name descname"><span class="pre">message_str</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">derivatives</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/optimisation.html#DerivativeConstantControlOptimisationCallback.message_str"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#thetis.optimisation.DerivativeConstantControlOptimisationCallback.message_str" title="Link to this definition">¶</a></dt>
<dd><p>A string representation.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>args</strong> – If provided, these will be the return value from
<code class="xref py py-meth docutils literal notranslate"><span class="pre">__call__()</span></code>.</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="thetis.optimisation.DerivativeConstantControlOptimisationCallback.name">
<span class="sig-name descname"><span class="pre">name</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">'derivatives'</span></em><a class="headerlink" href="#thetis.optimisation.DerivativeConstantControlOptimisationCallback.name" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="thetis.optimisation.DerivativeConstantControlOptimisationCallback.variable_names">
<span class="sig-name descname"><span class="pre">variable_names</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">['derivatives']</span></em><a class="headerlink" href="#thetis.optimisation.DerivativeConstantControlOptimisationCallback.variable_names" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="thetis.optimisation.DerivativesExportOptimisationCallback">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">thetis.optimisation.</span></span><span class="sig-name descname"><span class="pre">DerivativesExportOptimisationCallback</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">solver_obj_or_outputdir</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/optimisation.html#DerivativesExportOptimisationCallback"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#thetis.optimisation.DerivativesExportOptimisationCallback" title="Link to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#thetis.optimisation.DeferredExportManager" title="thetis.optimisation.DeferredExportManager"><code class="xref py py-class docutils literal notranslate"><span class="pre">DeferredExportManager</span></code></a>, <a class="reference internal" href="#thetis.optimisation.OptimisationCallback" title="thetis.optimisation.OptimisationCallback"><code class="xref py py-class docutils literal notranslate"><span class="pre">OptimisationCallback</span></code></a></p>
<p>A callback that exports the derivatives calculated by the adjoint.</p>
<p>The derivatives are assumed to be the second argument in the callback. This can therefore
be used as a derivative_cb_post callback in a <code class="xref py py-class docutils literal notranslate"><span class="pre">ReducedFunctional</span></code></p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>solver_obj_or_outputdir</strong> – a <a class="reference internal" href="#thetis.solver2d.FlowSolver2d" title="thetis.solver2d.FlowSolver2d"><code class="xref py py-class docutils literal notranslate"><span class="pre">FlowSolver2d</span></code></a> object, used to determine the output directory. Alternatively, the
outputdir can be specified with a string as the first argument.</p></li>
<li><p><strong>kwargs</strong> – any further keyword arguments are passed on to <a class="reference internal" href="#thetis.optimisation.UserExportManager" title="thetis.optimisation.UserExportManager"><code class="xref py py-class docutils literal notranslate"><span class="pre">UserExportManager</span></code></a></p></li>
</ul>
</dd>
</dl>
<dl class="py method">
<dt class="sig sig-object py" id="thetis.optimisation.DerivativesExportOptimisationCallback.callback">
<span class="sig-name descname"><span class="pre">callback</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/optimisation.html#DerivativesExportOptimisationCallback.callback"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#thetis.optimisation.DerivativesExportOptimisationCallback.callback" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="thetis.optimisation.DiagnosticOptimisationCallback">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">thetis.optimisation.</span></span><span class="sig-name descname"><span class="pre">DiagnosticOptimisationCallback</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">solver_obj</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/optimisation.html#DiagnosticOptimisationCallback"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#thetis.optimisation.DiagnosticOptimisationCallback" title="Link to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#thetis.optimisation.OptimisationCallback" title="thetis.optimisation.OptimisationCallback"><code class="xref py py-class docutils literal notranslate"><span class="pre">OptimisationCallback</span></code></a>, <a class="reference internal" href="#thetis.callback.DiagnosticCallback" title="thetis.callback.DiagnosticCallback"><code class="xref py py-class docutils literal notranslate"><span class="pre">DiagnosticCallback</span></code></a></p>
<p>An OptimisationCallback similar to <a class="reference internal" href="#thetis.callback.DiagnosticCallback" title="thetis.callback.DiagnosticCallback"><code class="xref py py-class docutils literal notranslate"><span class="pre">DiagnosticCallback</span></code></a> that can be used as callback in a <code class="xref py py-class docutils literal notranslate"><span class="pre">ReducedFunctional</span></code>.</p>
<p>Note that in this case the computing of the values needs to be defined in the compute_values method,
not in the __call__ method (as this one is directly called from the <code class="xref py py-class docutils literal notranslate"><span class="pre">ReducedFunctional</span></code>). In addition,
like any <a class="reference internal" href="#thetis.callback.DiagnosticCallback" title="thetis.callback.DiagnosticCallback"><code class="xref py py-class docutils literal notranslate"><span class="pre">DiagnosticCallback</span></code></a>, the name and variable_names properties and a message_str method need to be defined.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>solver_obj</strong> – Thetis solver object</p></li>
<li><p><strong>kwargs</strong> – keyword arguments passed to <a class="reference internal" href="#thetis.callback.DiagnosticCallback" title="thetis.callback.DiagnosticCallback"><code class="xref py py-class docutils literal notranslate"><span class="pre">DiagnosticCallback</span></code></a></p></li>
</ul>
</dd>
</dl>
<dl class="py method">
<dt class="sig sig-object py" id="thetis.optimisation.DiagnosticOptimisationCallback.callback">
<span class="sig-name descname"><span class="pre">callback</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/optimisation.html#DiagnosticOptimisationCallback.callback"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#thetis.optimisation.DiagnosticOptimisationCallback.callback" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="thetis.optimisation.DiagnosticOptimisationCallback.compute_values">
<em class="property"><span class="pre">abstract</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">compute_values</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/optimisation.html#DiagnosticOptimisationCallback.compute_values"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#thetis.optimisation.DiagnosticOptimisationCallback.compute_values" title="Link to this definition">¶</a></dt>
<dd><p>Compute diagnostic values.</p>
<p>This method is to be implemented in concrete subclasses of a <a class="reference internal" href="#thetis.optimisation.DiagnosticOptimisationCallback" title="thetis.optimisation.DiagnosticOptimisationCallback"><code class="xref py py-class docutils literal notranslate"><span class="pre">DiagnosticOptimisationCallback</span></code></a>.
The number of arguments varies depending on which of the 6 [eval|derivative|hessian]_cb_[pre|post] callbacks
this is used as. The last argument always contains the current controls. In the “pre” callbacks this is
the only argument. In all “post” callbacks the 0th argument is the current functional value. eval_cb_post
is given two arguments: functional and controls. derivative_cb_post and hessian_cb_post are given three
arguments with args[1] being the derivative/hessian just calculated.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="thetis.optimisation.DiagnosticOptimisationCallback.evaluate">
<span class="sig-name descname"><span class="pre">evaluate</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">index</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/optimisation.html#DiagnosticOptimisationCallback.evaluate"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#thetis.optimisation.DiagnosticOptimisationCallback.evaluate" title="Link to this definition">¶</a></dt>
<dd><p>Evaluates callback and pushes values to log and hdf file (if enabled)</p>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="thetis.optimisation.FunctionalOptimisationCallback">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">thetis.optimisation.</span></span><span class="sig-name descname"><span class="pre">FunctionalOptimisationCallback</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">solver_obj</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/optimisation.html#FunctionalOptimisationCallback"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#thetis.optimisation.FunctionalOptimisationCallback" title="Link to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#thetis.optimisation.DiagnosticOptimisationCallback" title="thetis.optimisation.DiagnosticOptimisationCallback"><code class="xref py py-class docutils literal notranslate"><span class="pre">DiagnosticOptimisationCallback</span></code></a></p>
<p>A simple OptimisationCallback that records the functional value in the log and/or hdf5 file.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>solver_obj</strong> – Thetis solver object</p></li>
<li><p><strong>kwargs</strong> – keyword arguments passed to <a class="reference internal" href="#thetis.callback.DiagnosticCallback" title="thetis.callback.DiagnosticCallback"><code class="xref py py-class docutils literal notranslate"><span class="pre">DiagnosticCallback</span></code></a></p></li>
</ul>
</dd>
</dl>
<dl class="py method">
<dt class="sig sig-object py" id="thetis.optimisation.FunctionalOptimisationCallback.compute_values">
<span class="sig-name descname"><span class="pre">compute_values</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/optimisation.html#FunctionalOptimisationCallback.compute_values"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#thetis.optimisation.FunctionalOptimisationCallback.compute_values" title="Link to this definition">¶</a></dt>
<dd><p>Compute diagnostic values.</p>
<p>This method is to be implemented in concrete subclasses of a <a class="reference internal" href="#thetis.optimisation.DiagnosticOptimisationCallback" title="thetis.optimisation.DiagnosticOptimisationCallback"><code class="xref py py-class docutils literal notranslate"><span class="pre">DiagnosticOptimisationCallback</span></code></a>.
The number of arguments varies depending on which of the 6 [eval|derivative|hessian]_cb_[pre|post] callbacks
this is used as. The last argument always contains the current controls. In the “pre” callbacks this is
the only argument. In all “post” callbacks the 0th argument is the current functional value. eval_cb_post
is given two arguments: functional and controls. derivative_cb_post and hessian_cb_post are given three
arguments with args[1] being the derivative/hessian just calculated.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="thetis.optimisation.FunctionalOptimisationCallback.message_str">
<span class="sig-name descname"><span class="pre">message_str</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">functional</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/optimisation.html#FunctionalOptimisationCallback.message_str"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#thetis.optimisation.FunctionalOptimisationCallback.message_str" title="Link to this definition">¶</a></dt>
<dd><p>A string representation.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>args</strong> – If provided, these will be the return value from
<code class="xref py py-meth docutils literal notranslate"><span class="pre">__call__()</span></code>.</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="thetis.optimisation.FunctionalOptimisationCallback.name">
<span class="sig-name descname"><span class="pre">name</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">'functional'</span></em><a class="headerlink" href="#thetis.optimisation.FunctionalOptimisationCallback.name" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="thetis.optimisation.FunctionalOptimisationCallback.variable_names">
<span class="sig-name descname"><span class="pre">variable_names</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">['functional']</span></em><a class="headerlink" href="#thetis.optimisation.FunctionalOptimisationCallback.variable_names" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="thetis.optimisation.OptimisationCallback">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">thetis.optimisation.</span></span><span class="sig-name descname"><span class="pre">OptimisationCallback</span></span><a class="reference internal" href="_modules/thetis/optimisation.html#OptimisationCallback"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#thetis.optimisation.OptimisationCallback" title="Link to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">ABC</span></code></p>
<p>Base class for callback that can be used as callbacks of a <code class="xref py py-class docutils literal notranslate"><span class="pre">ReducedFunctional</span></code></p>
<p>Called at various stages during the optimisation process:
- eval_cb_pre(controls) and eval_cb_post(functional, controls)                    called before and after (re)evaluation of the forward model
- derivative_cb_pre(controls) and eval_cb_post(functional, derivative, controls)  called before and after the gradient computation using the adjoint of the model
- hessian_cb_pre(controls) and eval_cb_post(functional, derivative, controls)     called before and after the hessian computation
OptimisationCallbacks that (can) use controls, functional and derivative information, work out
what is provided by the number of arguments: current control values are always in the last argument;
if more than 2 arguments are provided, the first is the latest evaluated functional value.</p>
<dl class="py method">
<dt class="sig sig-object py" id="thetis.optimisation.OptimisationCallback.callback">
<em class="property"><span class="pre">abstract</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">callback</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/optimisation.html#OptimisationCallback.callback"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#thetis.optimisation.OptimisationCallback.callback" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="thetis.optimisation.OptimisationCallbackList">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">thetis.optimisation.</span></span><span class="sig-name descname"><span class="pre">OptimisationCallbackList</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">iterable</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">()</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">/</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/optimisation.html#OptimisationCallbackList"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#thetis.optimisation.OptimisationCallbackList" title="Link to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">list</span></code>, <a class="reference internal" href="#thetis.optimisation.OptimisationCallback" title="thetis.optimisation.OptimisationCallback"><code class="xref py py-class docutils literal notranslate"><span class="pre">OptimisationCallback</span></code></a></p>
<p>A list of callbacks that can be used as a single callback itself.</p>
<p>Calls all callbacks in order.</p>
<dl class="py method">
<dt class="sig sig-object py" id="thetis.optimisation.OptimisationCallbackList.callback">
<span class="sig-name descname"><span class="pre">callback</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/optimisation.html#OptimisationCallbackList.callback"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#thetis.optimisation.OptimisationCallbackList.callback" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="thetis.optimisation.UserExportManager">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">thetis.optimisation.</span></span><span class="sig-name descname"><span class="pre">UserExportManager</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">solver_obj_or_outputdir</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">functions_to_export</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">filenames</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">filename_prefix</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">''</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">shortnames</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/optimisation.html#UserExportManager"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#thetis.optimisation.UserExportManager" title="Link to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#thetis.exporter.ExportManager" title="thetis.exporter.ExportManager"><code class="xref py py-class docutils literal notranslate"><span class="pre">ExportManager</span></code></a></p>
<p>ExportManager for user provided functions (not necessarily known to Thetis)</p>
<p>In the standard <a class="reference internal" href="#thetis.exporter.ExportManager" title="thetis.exporter.ExportManager"><code class="xref py py-class docutils literal notranslate"><span class="pre">ExportManager</span></code></a> all provided functions need to have standard names
present in <a class="reference internal" href="#thetis.field_defs.field_metadata" title="thetis.field_defs.field_metadata"><code class="xref py py-data docutils literal notranslate"><span class="pre">field_metadata</span></code></a>. Here, any functions can be provided. If function.name() is in
<a class="reference internal" href="#thetis.field_defs.field_metadata" title="thetis.field_defs.field_metadata"><code class="xref py py-data docutils literal notranslate"><span class="pre">field_metadata</span></code></a>, the standard filename and shortname  are used.
If the function.name() is unknown, both are based on function.name()
directly (with an optional additional filename_prefix). Filenames and
shortnames can be overruled by the shortnames and filenames arguments.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>solver_obj_or_outputdir</strong> – a <a class="reference internal" href="#thetis.solver2d.FlowSolver2d" title="thetis.solver2d.FlowSolver2d"><code class="xref py py-class docutils literal notranslate"><span class="pre">FlowSolver2d</span></code></a> object, used to determine the output directory. Alternatively, the
outputdir can be specified with a string as the first argument.</p></li>
<li><p><strong>functions_to_export</strong> – a list of <code class="xref py py-class docutils literal notranslate"><span class="pre">Function</span></code> s</p></li>
<li><p><strong>filenames</strong> – a list of strings that specify the filename for each provided function. If not provided,
filenames are based on function.name().</p></li>
<li><p><strong>filename_prefix</strong> – a string prefixed to each filename</p></li>
<li><p><strong>shortnames</strong> – a list of strings with the shortnames used for each provided function. If not provided,
shortnames are based on function.name().</p></li>
<li><p><strong>kwargs</strong> – any further keyword arguments are passed on to <a class="reference internal" href="#thetis.exporter.ExportManager" title="thetis.exporter.ExportManager"><code class="xref py py-class docutils literal notranslate"><span class="pre">ExportManager</span></code></a></p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="thetis.optimisation.UserExportOptimisationCallback">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">thetis.optimisation.</span></span><span class="sig-name descname"><span class="pre">UserExportOptimisationCallback</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">solver_obj_or_outputdir</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">functions_to_export</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/optimisation.html#UserExportOptimisationCallback"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#thetis.optimisation.UserExportOptimisationCallback" title="Link to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#thetis.optimisation.UserExportManager" title="thetis.optimisation.UserExportManager"><code class="xref py py-class docutils literal notranslate"><span class="pre">UserExportManager</span></code></a>, <a class="reference internal" href="#thetis.optimisation.OptimisationCallback" title="thetis.optimisation.OptimisationCallback"><code class="xref py py-class docutils literal notranslate"><span class="pre">OptimisationCallback</span></code></a></p>
<p>A <a class="reference internal" href="#thetis.optimisation.UserExportManager" title="thetis.optimisation.UserExportManager"><code class="xref py py-class docutils literal notranslate"><span class="pre">UserExportManager</span></code></a> that can be used as a <code class="xref py py-class docutils literal notranslate"><span class="pre">ReducedFunctional</span></code> callback</p>
<p>Any callback arguments (functional value, derivatives, controls) are ignored</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>solver_obj_or_outputdir</strong> – a <a class="reference internal" href="#thetis.solver2d.FlowSolver2d" title="thetis.solver2d.FlowSolver2d"><code class="xref py py-class docutils literal notranslate"><span class="pre">FlowSolver2d</span></code></a> object, used to determine the output directory. Alternatively, the
outputdir can be specified with a string as the first argument.</p></li>
<li><p><strong>functions_to_export</strong> – a list of <code class="xref py py-class docutils literal notranslate"><span class="pre">Function</span></code> s</p></li>
<li><p><strong>kwargs</strong> – any further keyword arguments are passed on to <a class="reference internal" href="#thetis.optimisation.UserExportManager" title="thetis.optimisation.UserExportManager"><code class="xref py py-class docutils literal notranslate"><span class="pre">UserExportManager</span></code></a></p></li>
</ul>
</dd>
</dl>
<dl class="py method">
<dt class="sig sig-object py" id="thetis.optimisation.UserExportOptimisationCallback.callback">
<span class="sig-name descname"><span class="pre">callback</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/optimisation.html#UserExportOptimisationCallback.callback"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#thetis.optimisation.UserExportOptimisationCallback.callback" title="Link to this definition">¶</a></dt>
<dd><p>Ensure the <a class="reference internal" href="#thetis.optimisation.UserExportManager" title="thetis.optimisation.UserExportManager"><code class="xref py py-class docutils literal notranslate"><span class="pre">UserExportManager</span></code></a> uses the checkpointed values and call its export().</p>
<dl class="field-list simple">
<dt class="field-odd">Args<span class="colon">:</span></dt>
<dd class="field-odd"><p>these are ignored</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

</section>
<section id="module-thetis.options">
<span id="thetis-options-module"></span><h2>thetis.options module<a class="headerlink" href="#module-thetis.options" title="Link to this heading">¶</a></h2>
<p>Thetis options for the 2D and 3D model</p>
<p>All options are type-checked and they are stored in traitlets Configurable
objects.</p>
<dl class="py class">
<dt class="sig sig-object py" id="thetis.options.CommonModelOptions">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">thetis.options.</span></span><span class="sig-name descname"><span class="pre">CommonModelOptions</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Any</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/options.html#CommonModelOptions"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#thetis.options.CommonModelOptions" title="Link to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#thetis.configuration.FrozenConfigurable" title="thetis.configuration.FrozenConfigurable"><code class="xref py py-class docutils literal notranslate"><span class="pre">FrozenConfigurable</span></code></a></p>
<p>Options that are common for both 2d and 3d models</p>
<dl class="py attribute">
<dt class="sig sig-object py" id="thetis.options.CommonModelOptions.atmospheric_pressure">
<span class="sig-name descname"><span class="pre">atmospheric_pressure</span></span><a class="headerlink" href="#thetis.options.CommonModelOptions.atmospheric_pressure" title="Link to this definition">¶</a></dt>
<dd><p>Atmospheric pressure at free surface, in pascals</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="thetis.options.CommonModelOptions.cfl_2d">
<span class="sig-name descname"><span class="pre">cfl_2d</span></span><a class="headerlink" href="#thetis.options.CommonModelOptions.cfl_2d" title="Link to this definition">¶</a></dt>
<dd><p>Factor to scale the 2d time step OBSOLETE</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="thetis.options.CommonModelOptions.cfl_3d">
<span class="sig-name descname"><span class="pre">cfl_3d</span></span><a class="headerlink" href="#thetis.options.CommonModelOptions.cfl_3d" title="Link to this definition">¶</a></dt>
<dd><p>Factor to scale the 2d time step OBSOLETE</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="thetis.options.CommonModelOptions.check_volume_conservation_2d">
<span class="sig-name descname"><span class="pre">check_volume_conservation_2d</span></span><a class="headerlink" href="#thetis.options.CommonModelOptions.check_volume_conservation_2d" title="Link to this definition">¶</a></dt>
<dd><p>Compute volume of the 2D mode at every export</p>
<p>2D volume is defined as the integral of the water elevation field.
Prints deviation from the initial volume to stdout.</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="thetis.options.CommonModelOptions.coriolis_frequency">
<span class="sig-name descname"><span class="pre">coriolis_frequency</span></span><a class="headerlink" href="#thetis.options.CommonModelOptions.coriolis_frequency" title="Link to this definition">¶</a></dt>
<dd><p>2D Coriolis parameter</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="thetis.options.CommonModelOptions.element_family">
<span class="sig-name descname"><span class="pre">element_family</span></span><a class="headerlink" href="#thetis.options.CommonModelOptions.element_family" title="Link to this definition">¶</a></dt>
<dd><p>Finite element family</p>
<p>2D solver supports ‘dg-dg’, ‘rt-dg’, ‘bdm-dg’, or ‘dg-cg’ velocity-pressure pairs.
3D solver supports ‘dg-dg’, ‘rt-dg’, or ‘bdm-dg’ velocity-pressure pairs.</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="thetis.options.CommonModelOptions.export_diagnostics">
<span class="sig-name descname"><span class="pre">export_diagnostics</span></span><a class="headerlink" href="#thetis.options.CommonModelOptions.export_diagnostics" title="Link to this definition">¶</a></dt>
<dd><p>Store diagnostic variables to disk in HDF5 format</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="thetis.options.CommonModelOptions.fields_to_export">
<span class="sig-name descname"><span class="pre">fields_to_export</span></span><a class="headerlink" href="#thetis.options.CommonModelOptions.fields_to_export" title="Link to this definition">¶</a></dt>
<dd><p>Fields to export in VTK format</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="thetis.options.CommonModelOptions.fields_to_export_hdf5">
<span class="sig-name descname"><span class="pre">fields_to_export_hdf5</span></span><a class="headerlink" href="#thetis.options.CommonModelOptions.fields_to_export_hdf5" title="Link to this definition">¶</a></dt>
<dd><p>Fields to export in HDF5 format</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="thetis.options.CommonModelOptions.horizontal_diffusivity_scale">
<span class="sig-name descname"><span class="pre">horizontal_diffusivity_scale</span></span><a class="headerlink" href="#thetis.options.CommonModelOptions.horizontal_diffusivity_scale" title="Link to this definition">¶</a></dt>
<dd><p>Maximum horizontal diffusivity</p>
<p>Used to compute the mesh Peclet number in
the 2D tracer SUPG stabilization scheme.</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="thetis.options.CommonModelOptions.horizontal_velocity_scale">
<span class="sig-name descname"><span class="pre">horizontal_velocity_scale</span></span><a class="headerlink" href="#thetis.options.CommonModelOptions.horizontal_velocity_scale" title="Link to this definition">¶</a></dt>
<dd><p>Maximum horizontal velocity magnitude</p>
<p>Used to compute max stable advection time step.</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="thetis.options.CommonModelOptions.horizontal_viscosity">
<span class="sig-name descname"><span class="pre">horizontal_viscosity</span></span><a class="headerlink" href="#thetis.options.CommonModelOptions.horizontal_viscosity" title="Link to this definition">¶</a></dt>
<dd><p>Horizontal viscosity</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="thetis.options.CommonModelOptions.horizontal_viscosity_scale">
<span class="sig-name descname"><span class="pre">horizontal_viscosity_scale</span></span><a class="headerlink" href="#thetis.options.CommonModelOptions.horizontal_viscosity_scale" title="Link to this definition">¶</a></dt>
<dd><p>Maximum horizontal viscosity</p>
<p>Used to compute max stable diffusion time step.</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="thetis.options.CommonModelOptions.lax_friedrichs_tracer_scaling_factor">
<span class="sig-name descname"><span class="pre">lax_friedrichs_tracer_scaling_factor</span></span><a class="headerlink" href="#thetis.options.CommonModelOptions.lax_friedrichs_tracer_scaling_factor" title="Link to this definition">¶</a></dt>
<dd><p>Scaling factor for tracer Lax Friedrichs stability term.</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="thetis.options.CommonModelOptions.lax_friedrichs_velocity_scaling_factor">
<span class="sig-name descname"><span class="pre">lax_friedrichs_velocity_scaling_factor</span></span><a class="headerlink" href="#thetis.options.CommonModelOptions.lax_friedrichs_velocity_scaling_factor" title="Link to this definition">¶</a></dt>
<dd><p>Scaling factor for Lax Friedrichs stabilisation term in horizontal momentum advection.</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="thetis.options.CommonModelOptions.linear_drag_coefficient">
<span class="sig-name descname"><span class="pre">linear_drag_coefficient</span></span><a class="headerlink" href="#thetis.options.CommonModelOptions.linear_drag_coefficient" title="Link to this definition">¶</a></dt>
<dd><p>2D linear drag parameter <span class="math notranslate nohighlight">\(L\)</span></p>
<p>Bottom stress is <span class="math notranslate nohighlight">\(\tau_b/\rho_0 = -L \mathbf{u} H\)</span></p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="thetis.options.CommonModelOptions.log_output">
<span class="sig-name descname"><span class="pre">log_output</span></span><a class="headerlink" href="#thetis.options.CommonModelOptions.log_output" title="Link to this definition">¶</a></dt>
<dd><p>Redirect all output to log file in output directory</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="thetis.options.CommonModelOptions.manning_drag_coefficient">
<span class="sig-name descname"><span class="pre">manning_drag_coefficient</span></span><a class="headerlink" href="#thetis.options.CommonModelOptions.manning_drag_coefficient" title="Link to this definition">¶</a></dt>
<dd><p>Manning-Strickler 2D quadratic drag parameter <span class="math notranslate nohighlight">\(\mu\)</span></p>
<p>Bottom stress is <span class="math notranslate nohighlight">\(\tau_b/\rho_0 = -g \mu^2 |\mathbf{u}|\mathbf{u}/H^{1/3}\)</span></p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="thetis.options.CommonModelOptions.momentum_source_2d">
<span class="sig-name descname"><span class="pre">momentum_source_2d</span></span><a class="headerlink" href="#thetis.options.CommonModelOptions.momentum_source_2d" title="Link to this definition">¶</a></dt>
<dd><p>Source term for 2D momentum equation</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="thetis.options.CommonModelOptions.name">
<span class="sig-name descname"><span class="pre">name</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">'Model</span> <span class="pre">options'</span></em><a class="headerlink" href="#thetis.options.CommonModelOptions.name" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="thetis.options.CommonModelOptions.nh_model_options">
<span class="sig-name descname"><span class="pre">nh_model_options</span></span><a class="headerlink" href="#thetis.options.CommonModelOptions.nh_model_options" title="Link to this definition">¶</a></dt>
<dd><p>A trait whose value must be an instance of a specified class.</p>
<p>The value can also be an instance of a subclass of the specified class.</p>
<p>Subclasses can declare default classes by overriding the klass attribute</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="thetis.options.CommonModelOptions.nikuradse_bed_roughness">
<span class="sig-name descname"><span class="pre">nikuradse_bed_roughness</span></span><a class="headerlink" href="#thetis.options.CommonModelOptions.nikuradse_bed_roughness" title="Link to this definition">¶</a></dt>
<dd><p>Nikuradse bed roughness length used to construct the 2D quadratic drag parameter <span class="math notranslate nohighlight">\(C_D\)</span>.</p>
<p>In sediment transport this term is usually three times the average sediment diameter size.</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="thetis.options.CommonModelOptions.no_exports">
<span class="sig-name descname"><span class="pre">no_exports</span></span><a class="headerlink" href="#thetis.options.CommonModelOptions.no_exports" title="Link to this definition">¶</a></dt>
<dd><p>Do not store any outputs to disk</p>
<p>Disables VTK and HDF5 field outputs. and HDF5 diagnostic outputs.
Used in CI test suite.</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="thetis.options.CommonModelOptions.norm_smoother">
<span class="sig-name descname"><span class="pre">norm_smoother</span></span><a class="headerlink" href="#thetis.options.CommonModelOptions.norm_smoother" title="Link to this definition">¶</a></dt>
<dd><p>Coefficient used to avoid non-differentiable functions in the continuous formulation of the velocity norm in
the quadratic bottom drag term in the momentum equation. This replaces the velocity norm in the quadratic
bottom drag term with <span class="math notranslate nohighlight">\(\|u\| \approx \sqrt{\|u\|^2 + \alpha^2}\)</span></p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="thetis.options.CommonModelOptions.output_directory">
<span class="sig-name descname"><span class="pre">output_directory</span></span><a class="headerlink" href="#thetis.options.CommonModelOptions.output_directory" title="Link to this definition">¶</a></dt>
<dd><p>Directory where model output files are stored</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="thetis.options.CommonModelOptions.polynomial_degree">
<span class="sig-name descname"><span class="pre">polynomial_degree</span></span><a class="headerlink" href="#thetis.options.CommonModelOptions.polynomial_degree" title="Link to this definition">¶</a></dt>
<dd><p>Polynomial degree of elements</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="thetis.options.CommonModelOptions.quadratic_drag_coefficient">
<span class="sig-name descname"><span class="pre">quadratic_drag_coefficient</span></span><a class="headerlink" href="#thetis.options.CommonModelOptions.quadratic_drag_coefficient" title="Link to this definition">¶</a></dt>
<dd><p>Dimensionless 2D quadratic drag parameter <span class="math notranslate nohighlight">\(C_D\)</span></p>
<p>Bottom stress is <span class="math notranslate nohighlight">\(\tau_b/\rho_0 = -C_D |\mathbf{u}|\mathbf{u}\)</span></p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="thetis.options.CommonModelOptions.simulation_end_date">
<span class="sig-name descname"><span class="pre">simulation_end_date</span></span><a class="headerlink" href="#thetis.options.CommonModelOptions.simulation_end_date" title="Link to this definition">¶</a></dt>
<dd><p>Simulation end date</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="thetis.options.CommonModelOptions.simulation_end_time">
<span class="sig-name descname"><span class="pre">simulation_end_time</span></span><a class="headerlink" href="#thetis.options.CommonModelOptions.simulation_end_time" title="Link to this definition">¶</a></dt>
<dd><p>Simulation duration in seconds</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="thetis.options.CommonModelOptions.simulation_export_time">
<span class="sig-name descname"><span class="pre">simulation_export_time</span></span><a class="headerlink" href="#thetis.options.CommonModelOptions.simulation_export_time" title="Link to this definition">¶</a></dt>
<dd><p>Export interval in seconds</p>
<p>All fields in fields_to_export list will be stored to disk and
diagnostics will be computed</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="thetis.options.CommonModelOptions.simulation_initial_date">
<span class="sig-name descname"><span class="pre">simulation_initial_date</span></span><a class="headerlink" href="#thetis.options.CommonModelOptions.simulation_initial_date" title="Link to this definition">¶</a></dt>
<dd><p>Model initialization date. Corresponds to zero in simulation time.</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="thetis.options.CommonModelOptions.sipg_factor">
<span class="sig-name descname"><span class="pre">sipg_factor</span></span><a class="headerlink" href="#thetis.options.CommonModelOptions.sipg_factor" title="Link to this definition">¶</a></dt>
<dd><p>Penalty parameter scaling factor for horizontal viscosity terms.</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="thetis.options.CommonModelOptions.sipg_factor_tracer">
<span class="sig-name descname"><span class="pre">sipg_factor_tracer</span></span><a class="headerlink" href="#thetis.options.CommonModelOptions.sipg_factor_tracer" title="Link to this definition">¶</a></dt>
<dd><p>Penalty parameter scaling factor for horizontal diffusivity terms.</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="thetis.options.CommonModelOptions.timestep">
<span class="sig-name descname"><span class="pre">timestep</span></span><a class="headerlink" href="#thetis.options.CommonModelOptions.timestep" title="Link to this definition">¶</a></dt>
<dd><p>Time step</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="thetis.options.CommonModelOptions.use_grad_depth_viscosity_term">
<span class="sig-name descname"><span class="pre">use_grad_depth_viscosity_term</span></span><a class="headerlink" href="#thetis.options.CommonModelOptions.use_grad_depth_viscosity_term" title="Link to this definition">¶</a></dt>
<dd><p>Include <span class="math notranslate nohighlight">\(\nabla H\)</span> term in the depth-averaged viscosity</p>
<p>See <a class="reference internal" href="#thetis.shallowwater_eq.HorizontalViscosityTerm" title="thetis.shallowwater_eq.HorizontalViscosityTerm"><code class="xref py py-class docutils literal notranslate"><span class="pre">shallowwater_eq.HorizontalViscosityTerm</span></code></a> for details.</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="thetis.options.CommonModelOptions.use_grad_div_viscosity_term">
<span class="sig-name descname"><span class="pre">use_grad_div_viscosity_term</span></span><a class="headerlink" href="#thetis.options.CommonModelOptions.use_grad_div_viscosity_term" title="Link to this definition">¶</a></dt>
<dd><p>Include <span class="math notranslate nohighlight">\(\nabla (\nu_h \nabla \cdot \bar{\textbf{u}})\)</span> term in the depth-averaged viscosity</p>
<p>See <a class="reference internal" href="#thetis.shallowwater_eq.HorizontalViscosityTerm" title="thetis.shallowwater_eq.HorizontalViscosityTerm"><code class="xref py py-class docutils literal notranslate"><span class="pre">shallowwater_eq.HorizontalViscosityTerm</span></code></a> for details.</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="thetis.options.CommonModelOptions.use_lax_friedrichs_tracer">
<span class="sig-name descname"><span class="pre">use_lax_friedrichs_tracer</span></span><a class="headerlink" href="#thetis.options.CommonModelOptions.use_lax_friedrichs_tracer" title="Link to this definition">¶</a></dt>
<dd><p>Use Lax Friedrichs stabilisation in tracer advection.</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="thetis.options.CommonModelOptions.use_lax_friedrichs_velocity">
<span class="sig-name descname"><span class="pre">use_lax_friedrichs_velocity</span></span><a class="headerlink" href="#thetis.options.CommonModelOptions.use_lax_friedrichs_velocity" title="Link to this definition">¶</a></dt>
<dd><p>use Lax Friedrichs stabilisation in horizontal momentum advection.</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="thetis.options.CommonModelOptions.use_limiter_for_tracers">
<span class="sig-name descname"><span class="pre">use_limiter_for_tracers</span></span><a class="headerlink" href="#thetis.options.CommonModelOptions.use_limiter_for_tracers" title="Link to this definition">¶</a></dt>
<dd><p>Apply P1DG limiter for tracer fields</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="thetis.options.CommonModelOptions.use_nonlinear_equations">
<span class="sig-name descname"><span class="pre">use_nonlinear_equations</span></span><a class="headerlink" href="#thetis.options.CommonModelOptions.use_nonlinear_equations" title="Link to this definition">¶</a></dt>
<dd><p>Use nonlinear shallow water equations</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="thetis.options.CommonModelOptions.verbose">
<span class="sig-name descname"><span class="pre">verbose</span></span><a class="headerlink" href="#thetis.options.CommonModelOptions.verbose" title="Link to this definition">¶</a></dt>
<dd><p>Verbosity level</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="thetis.options.CommonModelOptions.volume_source_2d">
<span class="sig-name descname"><span class="pre">volume_source_2d</span></span><a class="headerlink" href="#thetis.options.CommonModelOptions.volume_source_2d" title="Link to this definition">¶</a></dt>
<dd><p>Source term for 2D continuity equation</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="thetis.options.CommonModelOptions.wind_stress">
<span class="sig-name descname"><span class="pre">wind_stress</span></span><a class="headerlink" href="#thetis.options.CommonModelOptions.wind_stress" title="Link to this definition">¶</a></dt>
<dd><p>Stress at free surface (2D vector function)</p>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="thetis.options.ConstantTidalTurbineOptions">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">thetis.options.</span></span><span class="sig-name descname"><span class="pre">ConstantTidalTurbineOptions</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Any</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/options.html#ConstantTidalTurbineOptions"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#thetis.options.ConstantTidalTurbineOptions" title="Link to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#thetis.options.TidalTurbineOptions" title="thetis.options.TidalTurbineOptions"><code class="xref py py-class docutils literal notranslate"><span class="pre">TidalTurbineOptions</span></code></a></p>
<p>Options for tidal turbine with constant thrust</p>
<dl class="py attribute">
<dt class="sig sig-object py" id="thetis.options.ConstantTidalTurbineOptions.name">
<span class="sig-name descname"><span class="pre">name</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">'Constant</span> <span class="pre">tidal</span> <span class="pre">turbine</span> <span class="pre">options'</span></em><a class="headerlink" href="#thetis.options.ConstantTidalTurbineOptions.name" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="thetis.options.ConstantTidalTurbineOptions.power_coefficient">
<span class="sig-name descname"><span class="pre">power_coefficient</span></span><a class="headerlink" href="#thetis.options.ConstantTidalTurbineOptions.power_coefficient" title="Link to this definition">¶</a></dt>
<dd><p>Power coefficient C_P, defaults to None and will be calculated using an empirical formula based on thrust coefficients unless specified (see ConstantThrustTurbine).</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="thetis.options.ConstantTidalTurbineOptions.thrust_coefficient">
<span class="sig-name descname"><span class="pre">thrust_coefficient</span></span><a class="headerlink" href="#thetis.options.ConstantTidalTurbineOptions.thrust_coefficient" title="Link to this definition">¶</a></dt>
<dd><p>Thrust coefficient C_T</p>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="thetis.options.CrankNicolsonSWETimeStepperOptions2d">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">thetis.options.</span></span><span class="sig-name descname"><span class="pre">CrankNicolsonSWETimeStepperOptions2d</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Any</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/options.html#CrankNicolsonSWETimeStepperOptions2d"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#thetis.options.CrankNicolsonSWETimeStepperOptions2d" title="Link to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#thetis.options.SemiImplicitSWETimeStepperOptions2d" title="thetis.options.SemiImplicitSWETimeStepperOptions2d"><code class="xref py py-class docutils literal notranslate"><span class="pre">SemiImplicitSWETimeStepperOptions2d</span></code></a></p>
<p>Options for 2d Crank-Nicolson time integrator
applied to shallow water equations</p>
<dl class="py attribute">
<dt class="sig sig-object py" id="thetis.options.CrankNicolsonSWETimeStepperOptions2d.implicitness_theta">
<span class="sig-name descname"><span class="pre">implicitness_theta</span></span><a class="headerlink" href="#thetis.options.CrankNicolsonSWETimeStepperOptions2d.implicitness_theta" title="Link to this definition">¶</a></dt>
<dd><p>implicitness parameter theta. Value 0.5 implies Crank-Nicolson scheme, 1.0 implies fully implicit formulation.</p>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="thetis.options.CrankNicolsonTracerTimeStepperOptions2d">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">thetis.options.</span></span><span class="sig-name descname"><span class="pre">CrankNicolsonTracerTimeStepperOptions2d</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Any</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/options.html#CrankNicolsonTracerTimeStepperOptions2d"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#thetis.options.CrankNicolsonTracerTimeStepperOptions2d" title="Link to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#thetis.options.SemiImplicitTracerTimeStepperOptions2d" title="thetis.options.SemiImplicitTracerTimeStepperOptions2d"><code class="xref py py-class docutils literal notranslate"><span class="pre">SemiImplicitTracerTimeStepperOptions2d</span></code></a></p>
<p>Options for 2d Crank-Nicolson time integrator
applied to tracer equations</p>
<dl class="py attribute">
<dt class="sig sig-object py" id="thetis.options.CrankNicolsonTracerTimeStepperOptions2d.implicitness_theta">
<span class="sig-name descname"><span class="pre">implicitness_theta</span></span><a class="headerlink" href="#thetis.options.CrankNicolsonTracerTimeStepperOptions2d.implicitness_theta" title="Link to this definition">¶</a></dt>
<dd><p>implicitness parameter theta. Value 0.5 implies Crank-Nicolson scheme, 1.0 implies fully implicit formulation.</p>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="thetis.options.DiscreteTidalTurbineFarmOptions">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">thetis.options.</span></span><span class="sig-name descname"><span class="pre">DiscreteTidalTurbineFarmOptions</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Any</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/options.html#DiscreteTidalTurbineFarmOptions"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#thetis.options.DiscreteTidalTurbineFarmOptions" title="Link to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#thetis.options.TidalTurbineFarmOptions" title="thetis.options.TidalTurbineFarmOptions"><code class="xref py py-class docutils literal notranslate"><span class="pre">TidalTurbineFarmOptions</span></code></a></p>
<p>Discrete Tidal turbine farm options - defaults to 0 turbines in the field</p>
<dl class="py attribute">
<dt class="sig sig-object py" id="thetis.options.DiscreteTidalTurbineFarmOptions.name">
<span class="sig-name descname"><span class="pre">name</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/2.7/library/functions.html#str" title="(in Python v2.7)"><span class="pre">str</span></a><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/2.7/library/constants.html#None" title="(in Python v2.7)"><span class="pre">None</span></a></em><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">'Discrete</span> <span class="pre">Farm</span> <span class="pre">options'</span></em><a class="headerlink" href="#thetis.options.DiscreteTidalTurbineFarmOptions.name" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="thetis.options.DiscreteTidalTurbineFarmOptions.quadrature_degree">
<span class="sig-name descname"><span class="pre">quadrature_degree</span></span><a class="headerlink" href="#thetis.options.DiscreteTidalTurbineFarmOptions.quadrature_degree" title="Link to this definition">¶</a></dt>
<dd><p>Quadrature degree for thrust force and power output integral</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="thetis.options.DiscreteTidalTurbineFarmOptions.turbine_coordinates">
<span class="sig-name descname"><span class="pre">turbine_coordinates</span></span><a class="headerlink" href="#thetis.options.DiscreteTidalTurbineFarmOptions.turbine_coordinates" title="Link to this definition">¶</a></dt>
<dd><p>Coordinates for turbines</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="thetis.options.DiscreteTidalTurbineFarmOptions.upwind_correction">
<span class="sig-name descname"><span class="pre">upwind_correction</span></span><a class="headerlink" href="#thetis.options.DiscreteTidalTurbineFarmOptions.upwind_correction" title="Link to this definition">¶</a></dt>
<dd><p>bool: Apply flow correction to correct for upwind velocity</p>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="thetis.options.EquationOfStateOptions">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">thetis.options.</span></span><span class="sig-name descname"><span class="pre">EquationOfStateOptions</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Any</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/options.html#EquationOfStateOptions"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#thetis.options.EquationOfStateOptions" title="Link to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#thetis.configuration.FrozenHasTraits" title="thetis.configuration.FrozenHasTraits"><code class="xref py py-class docutils literal notranslate"><span class="pre">FrozenHasTraits</span></code></a></p>
<p>Base class of equation of state options</p>
<dl class="py attribute">
<dt class="sig sig-object py" id="thetis.options.EquationOfStateOptions.name">
<span class="sig-name descname"><span class="pre">name</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">'Equation</span> <span class="pre">of</span> <span class="pre">State'</span></em><a class="headerlink" href="#thetis.options.EquationOfStateOptions.name" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="thetis.options.ExplicitMomentumTimeStepperOptions3d">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">thetis.options.</span></span><span class="sig-name descname"><span class="pre">ExplicitMomentumTimeStepperOptions3d</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Any</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/options.html#ExplicitMomentumTimeStepperOptions3d"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#thetis.options.ExplicitMomentumTimeStepperOptions3d" title="Link to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#thetis.options.TimeStepperOptions3d" title="thetis.options.TimeStepperOptions3d"><code class="xref py py-class docutils literal notranslate"><span class="pre">TimeStepperOptions3d</span></code></a></p>
<p>Options for 3d explicit time integrator
momentum component</p>
<dl class="py attribute">
<dt class="sig sig-object py" id="thetis.options.ExplicitMomentumTimeStepperOptions3d.solver_parameters">
<span class="sig-name descname"><span class="pre">solver_parameters</span></span><a class="headerlink" href="#thetis.options.ExplicitMomentumTimeStepperOptions3d.solver_parameters" title="Link to this definition">¶</a></dt>
<dd><p>PETSc solver options dictionary</p>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="thetis.options.ExplicitSWETimeStepperOptions2d">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">thetis.options.</span></span><span class="sig-name descname"><span class="pre">ExplicitSWETimeStepperOptions2d</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Any</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/options.html#ExplicitSWETimeStepperOptions2d"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#thetis.options.ExplicitSWETimeStepperOptions2d" title="Link to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#thetis.options.ExplicitTimeStepperOptions2d" title="thetis.options.ExplicitTimeStepperOptions2d"><code class="xref py py-class docutils literal notranslate"><span class="pre">ExplicitTimeStepperOptions2d</span></code></a></p>
<p>Options for 2d explicit time integrator
applied to shallow water equations</p>
<dl class="py attribute">
<dt class="sig sig-object py" id="thetis.options.ExplicitSWETimeStepperOptions2d.solver_parameters">
<span class="sig-name descname"><span class="pre">solver_parameters</span></span><a class="headerlink" href="#thetis.options.ExplicitSWETimeStepperOptions2d.solver_parameters" title="Link to this definition">¶</a></dt>
<dd><p>PETSc solver options dictionary</p>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="thetis.options.ExplicitTimeStepperOptions">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">thetis.options.</span></span><span class="sig-name descname"><span class="pre">ExplicitTimeStepperOptions</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Any</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/options.html#ExplicitTimeStepperOptions"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#thetis.options.ExplicitTimeStepperOptions" title="Link to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#thetis.options.TimeStepperOptions" title="thetis.options.TimeStepperOptions"><code class="xref py py-class docutils literal notranslate"><span class="pre">TimeStepperOptions</span></code></a></p>
<p>Options for explicit time integrator</p>
<dl class="py attribute">
<dt class="sig sig-object py" id="thetis.options.ExplicitTimeStepperOptions.use_automatic_timestep">
<span class="sig-name descname"><span class="pre">use_automatic_timestep</span></span><a class="headerlink" href="#thetis.options.ExplicitTimeStepperOptions.use_automatic_timestep" title="Link to this definition">¶</a></dt>
<dd><p>Set time step automatically based on local CFL conditions.</p>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="thetis.options.ExplicitTimeStepperOptions2d">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">thetis.options.</span></span><span class="sig-name descname"><span class="pre">ExplicitTimeStepperOptions2d</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Any</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/options.html#ExplicitTimeStepperOptions2d"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#thetis.options.ExplicitTimeStepperOptions2d" title="Link to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#thetis.options.ExplicitTimeStepperOptions" title="thetis.options.ExplicitTimeStepperOptions"><code class="xref py py-class docutils literal notranslate"><span class="pre">ExplicitTimeStepperOptions</span></code></a></p>
<p>Options for 2d explicit time integrator</p>
</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="thetis.options.ExplicitTracerTimeStepperOptions2d">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">thetis.options.</span></span><span class="sig-name descname"><span class="pre">ExplicitTracerTimeStepperOptions2d</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Any</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/options.html#ExplicitTracerTimeStepperOptions2d"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#thetis.options.ExplicitTracerTimeStepperOptions2d" title="Link to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#thetis.options.ExplicitTimeStepperOptions2d" title="thetis.options.ExplicitTimeStepperOptions2d"><code class="xref py py-class docutils literal notranslate"><span class="pre">ExplicitTimeStepperOptions2d</span></code></a></p>
<p>Options for 2d explicit time integrator
applied to tracer equations</p>
<dl class="py attribute">
<dt class="sig sig-object py" id="thetis.options.ExplicitTracerTimeStepperOptions2d.solver_parameters">
<span class="sig-name descname"><span class="pre">solver_parameters</span></span><a class="headerlink" href="#thetis.options.ExplicitTracerTimeStepperOptions2d.solver_parameters" title="Link to this definition">¶</a></dt>
<dd><p>PETSc solver options dictionary</p>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="thetis.options.ExplicitTracerTimeStepperOptions3d">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">thetis.options.</span></span><span class="sig-name descname"><span class="pre">ExplicitTracerTimeStepperOptions3d</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Any</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/options.html#ExplicitTracerTimeStepperOptions3d"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#thetis.options.ExplicitTracerTimeStepperOptions3d" title="Link to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#thetis.options.TimeStepperOptions3d" title="thetis.options.TimeStepperOptions3d"><code class="xref py py-class docutils literal notranslate"><span class="pre">TimeStepperOptions3d</span></code></a></p>
<p>Options for 3d explicit time integrator
applied to tracer equations</p>
<dl class="py attribute">
<dt class="sig sig-object py" id="thetis.options.ExplicitTracerTimeStepperOptions3d.solver_parameters">
<span class="sig-name descname"><span class="pre">solver_parameters</span></span><a class="headerlink" href="#thetis.options.ExplicitTracerTimeStepperOptions3d.solver_parameters" title="Link to this definition">¶</a></dt>
<dd><p>PETSc solver options dictionary</p>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="thetis.options.GLSModelOptions">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">thetis.options.</span></span><span class="sig-name descname"><span class="pre">GLSModelOptions</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Any</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/options.html#GLSModelOptions"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#thetis.options.GLSModelOptions" title="Link to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#thetis.options.TurbulenceModelOptions" title="thetis.options.TurbulenceModelOptions"><code class="xref py py-class docutils literal notranslate"><span class="pre">TurbulenceModelOptions</span></code></a></p>
<p>Options for Generic Length Scale turbulence model</p>
<dl class="py method">
<dt class="sig sig-object py" id="thetis.options.GLSModelOptions.apply_defaults">
<span class="sig-name descname"><span class="pre">apply_defaults</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">closure_name</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/options.html#GLSModelOptions.apply_defaults"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#thetis.options.GLSModelOptions.apply_defaults" title="Link to this definition">¶</a></dt>
<dd><p>Applies default parameters for given closure name</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>closure_name</strong> (<em>string</em>) – name of the turbulence closure model</p>
</dd>
</dl>
<p>Sets default values for parameters p, m, n, schmidt_nb_tke,
schmidt_nb_psi, c1, c2, c3_plus, c3_minus,
f_wall, k_min, psi_min</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="thetis.options.GLSModelOptions.c1">
<span class="sig-name descname"><span class="pre">c1</span></span><a class="headerlink" href="#thetis.options.GLSModelOptions.c1" title="Link to this definition">¶</a></dt>
<dd><p>float: c1 parameter for Psi equations</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="thetis.options.GLSModelOptions.c2">
<span class="sig-name descname"><span class="pre">c2</span></span><a class="headerlink" href="#thetis.options.GLSModelOptions.c2" title="Link to this definition">¶</a></dt>
<dd><p>float: c2 parameter for Psi equations</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="thetis.options.GLSModelOptions.c3_minus">
<span class="sig-name descname"><span class="pre">c3_minus</span></span><a class="headerlink" href="#thetis.options.GLSModelOptions.c3_minus" title="Link to this definition">¶</a></dt>
<dd><p>float: c3 parameter for Psi equations, stable stratification</p>
<p>If <a class="reference internal" href="#thetis.options.GLSModelOptions.compute_c3_minus" title="thetis.options.GLSModelOptions.compute_c3_minus"><code class="xref py py-attr docutils literal notranslate"><span class="pre">compute_c3_minus</span></code></a> is True this value will be overriden</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="thetis.options.GLSModelOptions.c3_plus">
<span class="sig-name descname"><span class="pre">c3_plus</span></span><a class="headerlink" href="#thetis.options.GLSModelOptions.c3_plus" title="Link to this definition">¶</a></dt>
<dd><p>float: c3 parameter for Psi equations, unstable stratification</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="thetis.options.GLSModelOptions.closure_name">
<span class="sig-name descname"><span class="pre">closure_name</span></span><a class="headerlink" href="#thetis.options.GLSModelOptions.closure_name" title="Link to this definition">¶</a></dt>
<dd><p>Name of two-equation closure</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="thetis.options.GLSModelOptions.cmu0">
<span class="sig-name descname"><span class="pre">cmu0</span></span><a class="headerlink" href="#thetis.options.GLSModelOptions.cmu0" title="Link to this definition">¶</a></dt>
<dd><p>float: cmu0 parameter</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="thetis.options.GLSModelOptions.compute_c3_minus">
<span class="sig-name descname"><span class="pre">compute_c3_minus</span></span><a class="headerlink" href="#thetis.options.GLSModelOptions.compute_c3_minus" title="Link to this definition">¶</a></dt>
<dd><p>bool: compute <a class="reference internal" href="#thetis.options.GLSModelOptions.c3_minus" title="thetis.options.GLSModelOptions.c3_minus"><code class="xref py py-attr docutils literal notranslate"><span class="pre">c3_minus</span></code></a> from <a class="reference internal" href="#thetis.options.GLSModelOptions.ri_st" title="thetis.options.GLSModelOptions.ri_st"><code class="xref py py-attr docutils literal notranslate"><span class="pre">ri_st</span></code></a></p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="thetis.options.GLSModelOptions.compute_cmu0">
<span class="sig-name descname"><span class="pre">compute_cmu0</span></span><a class="headerlink" href="#thetis.options.GLSModelOptions.compute_cmu0" title="Link to this definition">¶</a></dt>
<dd><p>bool: compute cmu0 from stability function parameters</p>
<p>If <a class="reference internal" href="#thetis.options.GLSModelOptions.compute_cmu0" title="thetis.options.GLSModelOptions.compute_cmu0"><code class="xref py py-attr docutils literal notranslate"><span class="pre">compute_cmu0</span></code></a> is True, this value will be overriden</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="thetis.options.GLSModelOptions.compute_galperin_clim">
<span class="sig-name descname"><span class="pre">compute_galperin_clim</span></span><a class="headerlink" href="#thetis.options.GLSModelOptions.compute_galperin_clim" title="Link to this definition">¶</a></dt>
<dd><p>bool: compute c_lim length scale limiting factor</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="thetis.options.GLSModelOptions.compute_kappa">
<span class="sig-name descname"><span class="pre">compute_kappa</span></span><a class="headerlink" href="#thetis.options.GLSModelOptions.compute_kappa" title="Link to this definition">¶</a></dt>
<dd><p>bool: compute von Karman constant from <a class="reference internal" href="#thetis.options.GLSModelOptions.schmidt_nb_psi" title="thetis.options.GLSModelOptions.schmidt_nb_psi"><code class="xref py py-attr docutils literal notranslate"><span class="pre">schmidt_nb_psi</span></code></a></p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="thetis.options.GLSModelOptions.compute_len_min">
<span class="sig-name descname"><span class="pre">compute_len_min</span></span><a class="headerlink" href="#thetis.options.GLSModelOptions.compute_len_min" title="Link to this definition">¶</a></dt>
<dd><p>bool: compute min_len from k_min and psi_min</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="thetis.options.GLSModelOptions.compute_psi_min">
<span class="sig-name descname"><span class="pre">compute_psi_min</span></span><a class="headerlink" href="#thetis.options.GLSModelOptions.compute_psi_min" title="Link to this definition">¶</a></dt>
<dd><p>bool: compute psi_len from k_min and eps_min</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="thetis.options.GLSModelOptions.compute_schmidt_nb_psi">
<span class="sig-name descname"><span class="pre">compute_schmidt_nb_psi</span></span><a class="headerlink" href="#thetis.options.GLSModelOptions.compute_schmidt_nb_psi" title="Link to this definition">¶</a></dt>
<dd><p>bool: compute psi Schmidt number</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="thetis.options.GLSModelOptions.diff_min">
<span class="sig-name descname"><span class="pre">diff_min</span></span><a class="headerlink" href="#thetis.options.GLSModelOptions.diff_min" title="Link to this definition">¶</a></dt>
<dd><p>float: minimum value for eddy diffusivity</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="thetis.options.GLSModelOptions.eps_min">
<span class="sig-name descname"><span class="pre">eps_min</span></span><a class="headerlink" href="#thetis.options.GLSModelOptions.eps_min" title="Link to this definition">¶</a></dt>
<dd><p>float: minimum value for epsilon</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="thetis.options.GLSModelOptions.f_wall">
<span class="sig-name descname"><span class="pre">f_wall</span></span><a class="headerlink" href="#thetis.options.GLSModelOptions.f_wall" title="Link to this definition">¶</a></dt>
<dd><p>float: wall function parameter</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="thetis.options.GLSModelOptions.galperin_clim">
<span class="sig-name descname"><span class="pre">galperin_clim</span></span><a class="headerlink" href="#thetis.options.GLSModelOptions.galperin_clim" title="Link to this definition">¶</a></dt>
<dd><p>float: Galperin length scale limitation parameter</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="thetis.options.GLSModelOptions.k_min">
<span class="sig-name descname"><span class="pre">k_min</span></span><a class="headerlink" href="#thetis.options.GLSModelOptions.k_min" title="Link to this definition">¶</a></dt>
<dd><p>float: minimum value for turbulent kinetic energy</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="thetis.options.GLSModelOptions.kappa">
<span class="sig-name descname"><span class="pre">kappa</span></span><a class="headerlink" href="#thetis.options.GLSModelOptions.kappa" title="Link to this definition">¶</a></dt>
<dd><p>float: von Karman constant</p>
<p>If <a class="reference internal" href="#thetis.options.GLSModelOptions.compute_kappa" title="thetis.options.GLSModelOptions.compute_kappa"><code class="xref py py-attr docutils literal notranslate"><span class="pre">compute_kappa</span></code></a> is True this value will be overriden</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="thetis.options.GLSModelOptions.len_min">
<span class="sig-name descname"><span class="pre">len_min</span></span><a class="headerlink" href="#thetis.options.GLSModelOptions.len_min" title="Link to this definition">¶</a></dt>
<dd><p>float: minimum value for turbulent length scale</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="thetis.options.GLSModelOptions.limit_eps">
<span class="sig-name descname"><span class="pre">limit_eps</span></span><a class="headerlink" href="#thetis.options.GLSModelOptions.limit_eps" title="Link to this definition">¶</a></dt>
<dd><p>bool: apply Galperin length scale limit on epsilon</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="thetis.options.GLSModelOptions.limit_len">
<span class="sig-name descname"><span class="pre">limit_len</span></span><a class="headerlink" href="#thetis.options.GLSModelOptions.limit_len" title="Link to this definition">¶</a></dt>
<dd><p>bool: apply Galperin length scale limit</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="thetis.options.GLSModelOptions.limit_len_min">
<span class="sig-name descname"><span class="pre">limit_len_min</span></span><a class="headerlink" href="#thetis.options.GLSModelOptions.limit_len_min" title="Link to this definition">¶</a></dt>
<dd><p>bool: limit minimum turbulent length scale to len_min</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="thetis.options.GLSModelOptions.limit_psi">
<span class="sig-name descname"><span class="pre">limit_psi</span></span><a class="headerlink" href="#thetis.options.GLSModelOptions.limit_psi" title="Link to this definition">¶</a></dt>
<dd><p>bool: apply Galperin length scale limit on psi</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="thetis.options.GLSModelOptions.m">
<span class="sig-name descname"><span class="pre">m</span></span><a class="headerlink" href="#thetis.options.GLSModelOptions.m" title="Link to this definition">¶</a></dt>
<dd><p>float: parameter m for the definition of psi</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="thetis.options.GLSModelOptions.n">
<span class="sig-name descname"><span class="pre">n</span></span><a class="headerlink" href="#thetis.options.GLSModelOptions.n" title="Link to this definition">¶</a></dt>
<dd><p>float: parameter n for the definition of psi</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="thetis.options.GLSModelOptions.name">
<span class="sig-name descname"><span class="pre">name</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">'Generic</span> <span class="pre">Length</span> <span class="pre">Scale</span> <span class="pre">turbulence</span> <span class="pre">closure</span> <span class="pre">model'</span></em><a class="headerlink" href="#thetis.options.GLSModelOptions.name" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="thetis.options.GLSModelOptions.p">
<span class="sig-name descname"><span class="pre">p</span></span><a class="headerlink" href="#thetis.options.GLSModelOptions.p" title="Link to this definition">¶</a></dt>
<dd><p>float: parameter p for the definition of psi</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="thetis.options.GLSModelOptions.psi_min">
<span class="sig-name descname"><span class="pre">psi_min</span></span><a class="headerlink" href="#thetis.options.GLSModelOptions.psi_min" title="Link to this definition">¶</a></dt>
<dd><p>float: minimum value for psi</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="thetis.options.GLSModelOptions.ri_st">
<span class="sig-name descname"><span class="pre">ri_st</span></span><a class="headerlink" href="#thetis.options.GLSModelOptions.ri_st" title="Link to this definition">¶</a></dt>
<dd><p>steady state gradient Richardson number</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="thetis.options.GLSModelOptions.schmidt_nb_psi">
<span class="sig-name descname"><span class="pre">schmidt_nb_psi</span></span><a class="headerlink" href="#thetis.options.GLSModelOptions.schmidt_nb_psi" title="Link to this definition">¶</a></dt>
<dd><p>float: psi Schmidt number</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="thetis.options.GLSModelOptions.schmidt_nb_tke">
<span class="sig-name descname"><span class="pre">schmidt_nb_tke</span></span><a class="headerlink" href="#thetis.options.GLSModelOptions.schmidt_nb_tke" title="Link to this definition">¶</a></dt>
<dd><p>float: turbulent kinetic energy Schmidt number</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="thetis.options.GLSModelOptions.stability_function_name">
<span class="sig-name descname"><span class="pre">stability_function_name</span></span><a class="headerlink" href="#thetis.options.GLSModelOptions.stability_function_name" title="Link to this definition">¶</a></dt>
<dd><p>Name of stability function family</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="thetis.options.GLSModelOptions.visc_min">
<span class="sig-name descname"><span class="pre">visc_min</span></span><a class="headerlink" href="#thetis.options.GLSModelOptions.visc_min" title="Link to this definition">¶</a></dt>
<dd><p>float: minimum value for eddy viscosity</p>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="thetis.options.IMEXSWETimeStepperOptions2d">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">thetis.options.</span></span><span class="sig-name descname"><span class="pre">IMEXSWETimeStepperOptions2d</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Any</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/options.html#IMEXSWETimeStepperOptions2d"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#thetis.options.IMEXSWETimeStepperOptions2d" title="Link to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#thetis.options.SemiImplicitTimeStepperOptions2d" title="thetis.options.SemiImplicitTimeStepperOptions2d"><code class="xref py py-class docutils literal notranslate"><span class="pre">SemiImplicitTimeStepperOptions2d</span></code></a></p>
<p>Options for 2d implicit-explicit time integrators
applied to shallow water equations</p>
<dl class="py attribute">
<dt class="sig sig-object py" id="thetis.options.IMEXSWETimeStepperOptions2d.solver_parameters">
<span class="sig-name descname"><span class="pre">solver_parameters</span></span><a class="headerlink" href="#thetis.options.IMEXSWETimeStepperOptions2d.solver_parameters" title="Link to this definition">¶</a></dt>
<dd><p>PETSc solver options dictionary</p>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="thetis.options.ImplicitMomentumTimeStepperOptions3d">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">thetis.options.</span></span><span class="sig-name descname"><span class="pre">ImplicitMomentumTimeStepperOptions3d</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Any</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/options.html#ImplicitMomentumTimeStepperOptions3d"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#thetis.options.ImplicitMomentumTimeStepperOptions3d" title="Link to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#thetis.options.TimeStepperOptions3d" title="thetis.options.TimeStepperOptions3d"><code class="xref py py-class docutils literal notranslate"><span class="pre">TimeStepperOptions3d</span></code></a></p>
<p>Options for 3d implicit time integrator
momentum component</p>
<dl class="py attribute">
<dt class="sig sig-object py" id="thetis.options.ImplicitMomentumTimeStepperOptions3d.solver_parameters">
<span class="sig-name descname"><span class="pre">solver_parameters</span></span><a class="headerlink" href="#thetis.options.ImplicitMomentumTimeStepperOptions3d.solver_parameters" title="Link to this definition">¶</a></dt>
<dd><p>PETSc solver options dictionary</p>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="thetis.options.ImplicitSWETimeStepperOptions3d">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">thetis.options.</span></span><span class="sig-name descname"><span class="pre">ImplicitSWETimeStepperOptions3d</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Any</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/options.html#ImplicitSWETimeStepperOptions3d"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#thetis.options.ImplicitSWETimeStepperOptions3d" title="Link to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#thetis.options.SWETimeStepperOptions3d" title="thetis.options.SWETimeStepperOptions3d"><code class="xref py py-class docutils literal notranslate"><span class="pre">SWETimeStepperOptions3d</span></code></a></p>
<p>Options for 3d implicit time integrator
shallow water component</p>
<dl class="py attribute">
<dt class="sig sig-object py" id="thetis.options.ImplicitSWETimeStepperOptions3d.implicitness_theta">
<span class="sig-name descname"><span class="pre">implicitness_theta</span></span><a class="headerlink" href="#thetis.options.ImplicitSWETimeStepperOptions3d.implicitness_theta" title="Link to this definition">¶</a></dt>
<dd><p>implicitness parameter theta. Value 0.5 implies Crank-Nicolson scheme, 1.0 implies fully implicit formulation.</p>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="thetis.options.ImplicitTracerTimeStepperOptions3d">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">thetis.options.</span></span><span class="sig-name descname"><span class="pre">ImplicitTracerTimeStepperOptions3d</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Any</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/options.html#ImplicitTracerTimeStepperOptions3d"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#thetis.options.ImplicitTracerTimeStepperOptions3d" title="Link to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#thetis.options.TimeStepperOptions3d" title="thetis.options.TimeStepperOptions3d"><code class="xref py py-class docutils literal notranslate"><span class="pre">TimeStepperOptions3d</span></code></a></p>
<p>Options for 3d implicit time integrator
applied to tracer equations</p>
<dl class="py attribute">
<dt class="sig sig-object py" id="thetis.options.ImplicitTracerTimeStepperOptions3d.solver_parameters">
<span class="sig-name descname"><span class="pre">solver_parameters</span></span><a class="headerlink" href="#thetis.options.ImplicitTracerTimeStepperOptions3d.solver_parameters" title="Link to this definition">¶</a></dt>
<dd><p>PETSc solver options dictionary</p>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="thetis.options.LeapFrogTimeStepperOptions3d">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">thetis.options.</span></span><span class="sig-name descname"><span class="pre">LeapFrogTimeStepperOptions3d</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Any</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/options.html#LeapFrogTimeStepperOptions3d"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#thetis.options.LeapFrogTimeStepperOptions3d" title="Link to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#thetis.options.SSPRKTimeStepperOptions3d" title="thetis.options.SSPRKTimeStepperOptions3d"><code class="xref py py-class docutils literal notranslate"><span class="pre">SSPRKTimeStepperOptions3d</span></code></a></p>
<p>Options for 3d LeapFrog coupled time integrator</p>
<dl class="py attribute">
<dt class="sig sig-object py" id="thetis.options.LeapFrogTimeStepperOptions3d.swe_options">
<span class="sig-name descname"><span class="pre">swe_options</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">&lt;thetis.options.ImplicitSWETimeStepperOptions3d</span> <span class="pre">object&gt;</span></em><a class="headerlink" href="#thetis.options.LeapFrogTimeStepperOptions3d.swe_options" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="thetis.options.LinearEquationOfStateOptions">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">thetis.options.</span></span><span class="sig-name descname"><span class="pre">LinearEquationOfStateOptions</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Any</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/options.html#LinearEquationOfStateOptions"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#thetis.options.LinearEquationOfStateOptions" title="Link to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#thetis.options.EquationOfStateOptions" title="thetis.options.EquationOfStateOptions"><code class="xref py py-class docutils literal notranslate"><span class="pre">EquationOfStateOptions</span></code></a></p>
<p>Linear equation of state options</p>
<dl class="py attribute">
<dt class="sig sig-object py" id="thetis.options.LinearEquationOfStateOptions.alpha">
<span class="sig-name descname"><span class="pre">alpha</span></span><a class="headerlink" href="#thetis.options.LinearEquationOfStateOptions.alpha" title="Link to this definition">¶</a></dt>
<dd><p>Thermal expansion coefficient of ocean water</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="thetis.options.LinearEquationOfStateOptions.beta">
<span class="sig-name descname"><span class="pre">beta</span></span><a class="headerlink" href="#thetis.options.LinearEquationOfStateOptions.beta" title="Link to this definition">¶</a></dt>
<dd><p>Saline contraction coefficient of ocean water</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="thetis.options.LinearEquationOfStateOptions.name">
<span class="sig-name descname"><span class="pre">name</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">'Linear</span> <span class="pre">Equation</span> <span class="pre">of</span> <span class="pre">State'</span></em><a class="headerlink" href="#thetis.options.LinearEquationOfStateOptions.name" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="thetis.options.LinearEquationOfStateOptions.rho_ref">
<span class="sig-name descname"><span class="pre">rho_ref</span></span><a class="headerlink" href="#thetis.options.LinearEquationOfStateOptions.rho_ref" title="Link to this definition">¶</a></dt>
<dd><p>Reference water density</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="thetis.options.LinearEquationOfStateOptions.s_ref">
<span class="sig-name descname"><span class="pre">s_ref</span></span><a class="headerlink" href="#thetis.options.LinearEquationOfStateOptions.s_ref" title="Link to this definition">¶</a></dt>
<dd><p>Reference water salinity</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="thetis.options.LinearEquationOfStateOptions.th_ref">
<span class="sig-name descname"><span class="pre">th_ref</span></span><a class="headerlink" href="#thetis.options.LinearEquationOfStateOptions.th_ref" title="Link to this definition">¶</a></dt>
<dd><p>Reference water temperature</p>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="thetis.options.ModelOptions2d">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">thetis.options.</span></span><span class="sig-name descname"><span class="pre">ModelOptions2d</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Any</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/options.html#ModelOptions2d"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#thetis.options.ModelOptions2d" title="Link to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#thetis.options.CommonModelOptions" title="thetis.options.CommonModelOptions"><code class="xref py py-class docutils literal notranslate"><span class="pre">CommonModelOptions</span></code></a></p>
<p>Options for 2D depth-averaged shallow water model</p>
<dl class="py method">
<dt class="sig sig-object py" id="thetis.options.ModelOptions2d.add_tracer_2d">
<span class="sig-name descname"><span class="pre">add_tracer_2d</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">label</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">name</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">filename</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">shortname</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">unit</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'-'</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/options.html#ModelOptions2d.add_tracer_2d"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#thetis.options.ModelOptions2d.add_tracer_2d" title="Link to this definition">¶</a></dt>
<dd><p>Add a 2D tracer field to <code class="xref py py-attr docutils literal notranslate"><span class="pre">tracer</span></code>.</p>
<p>Note that the tracer equations will be solved in the order in which they are added.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>label</strong> – field label used internally by Thetis, e.g. ‘tracer_2d’</p></li>
<li><p><strong>name</strong> – human readable name for the tracer field, e.g. ‘Depth averaged tracer’</p></li>
<li><p><strong>filename</strong> – file name for outputs, e.g. ‘Tracer2d’</p></li>
<li><p><strong>shortname</strong> – short version of name, e.g. ‘Tracer’</p></li>
<li><p><strong>unit</strong> – units for field, e.g. ‘-’</p></li>
<li><p><strong>function</strong> – <code class="xref py py-class docutils literal notranslate"><span class="pre">Function</span></code> to use for the tracer</p></li>
<li><p><strong>source</strong> – associated source term</p></li>
<li><p><strong>diffusivity</strong> – associated diffusivity coefficient</p></li>
<li><p><strong>use_conservative_form</strong> – should the tracer equation be solved in conservative form?</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="thetis.options.ModelOptions2d.add_tracer_system_2d">
<span class="sig-name descname"><span class="pre">add_tracer_system_2d</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">labels</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">names</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">filenames</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">shortnames</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">units</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">function</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/options.html#ModelOptions2d.add_tracer_system_2d"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#thetis.options.ModelOptions2d.add_tracer_system_2d" title="Link to this definition">¶</a></dt>
<dd><p>Add multiple 2D tracer fields to <code class="xref py py-attr docutils literal notranslate"><span class="pre">tracer</span></code> at once.</p>
<p>The equations associated with these fields will be solved as a mixed system.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>labels</strong> – a list of field labels used internally by Thetis</p></li>
<li><p><strong>names</strong> – a list of human readable names for the tracer fields</p></li>
<li><p><strong>filenames</strong> – a list of file names for outputs</p></li>
<li><p><strong>shortnames</strong> – a list of short versions of the names</p></li>
<li><p><strong>units</strong> – a list of units for fields</p></li>
<li><p><strong>function</strong> – <code class="xref py py-class docutils literal notranslate"><span class="pre">Function</span></code> to use for the mixed tracer</p></li>
</ul>
</dd>
<dt class="field-even">Kwargs<span class="colon">:</span></dt>
<dd class="field-even"><p>other parameters passed to <a class="reference internal" href="#thetis.options.ModelOptions2d.add_tracer_2d" title="thetis.options.ModelOptions2d.add_tracer_2d"><code class="xref py py-meth docutils literal notranslate"><span class="pre">add_tracer_2d()</span></code></a></p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="thetis.options.ModelOptions2d.check_tracer_conservation">
<span class="sig-name descname"><span class="pre">check_tracer_conservation</span></span><a class="headerlink" href="#thetis.options.ModelOptions2d.check_tracer_conservation" title="Link to this definition">¶</a></dt>
<dd><p>Compute total tracer mass at every export</p>
<p>Prints deviation from the initial mass to stdout.</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="thetis.options.ModelOptions2d.check_tracer_overshoot">
<span class="sig-name descname"><span class="pre">check_tracer_overshoot</span></span><a class="headerlink" href="#thetis.options.ModelOptions2d.check_tracer_overshoot" title="Link to this definition">¶</a></dt>
<dd><p>Compute tracer overshoots at every export</p>
<p>Prints overshoot values that exceed the initial range to stdout.</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="thetis.options.ModelOptions2d.discrete_tidal_turbine_farms">
<span class="sig-name descname"><span class="pre">discrete_tidal_turbine_farms</span></span><a class="headerlink" href="#thetis.options.ModelOptions2d.discrete_tidal_turbine_farms" title="Link to this definition">¶</a></dt>
<dd><p>Dictionary mapping subdomain ids to a list of DiscreteTidalTurbineFarmOptions instances corresponding to one or more farms.</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="thetis.options.ModelOptions2d.name">
<span class="sig-name descname"><span class="pre">name</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">'Depth-averaged</span> <span class="pre">2D</span> <span class="pre">model'</span></em><a class="headerlink" href="#thetis.options.ModelOptions2d.name" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="thetis.options.ModelOptions2d.sediment_model_options">
<span class="sig-name descname"><span class="pre">sediment_model_options</span></span><a class="headerlink" href="#thetis.options.ModelOptions2d.sediment_model_options" title="Link to this definition">¶</a></dt>
<dd><p>A trait whose value must be an instance of a specified class.</p>
<p>The value can also be an instance of a subclass of the specified class.</p>
<p>Subclasses can declare default classes by overriding the klass attribute</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="thetis.options.ModelOptions2d.set_timestepper_type">
<span class="sig-name descname"><span class="pre">set_timestepper_type</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">timestepper_type</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/options.html#ModelOptions2d.set_timestepper_type"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#thetis.options.ModelOptions2d.set_timestepper_type" title="Link to this definition">¶</a></dt>
<dd><p>Set the same timestepper type for all components.</p>
<p>Any keyword arguments are passed through to the
associated <a class="reference internal" href="#thetis.options.TimeStepperOptions" title="thetis.options.TimeStepperOptions"><code class="xref py py-class docutils literal notranslate"><span class="pre">TimeStepperOptions</span></code></a> object.</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="thetis.options.ModelOptions2d.swe_timestepper_options">
<span class="sig-name descname"><span class="pre">swe_timestepper_options</span></span><a class="headerlink" href="#thetis.options.ModelOptions2d.swe_timestepper_options" title="Link to this definition">¶</a></dt>
<dd><p>A trait whose value must be an instance of a specified class.</p>
<p>The value can also be an instance of a subclass of the specified class.</p>
<p>Subclasses can declare default classes by overriding the klass attribute</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="thetis.options.ModelOptions2d.swe_timestepper_type">
<span class="sig-name descname"><span class="pre">swe_timestepper_type</span></span><a class="headerlink" href="#thetis.options.ModelOptions2d.swe_timestepper_type" title="Link to this definition">¶</a></dt>
<dd><p>Name of the time integrator</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="thetis.options.ModelOptions2d.tidal_turbine_farms">
<span class="sig-name descname"><span class="pre">tidal_turbine_farms</span></span><a class="headerlink" href="#thetis.options.ModelOptions2d.tidal_turbine_farms" title="Link to this definition">¶</a></dt>
<dd><p>Dictionary mapping subdomain ids to a list of TidalTurbineFarmOptions instances corresponding to one or more farms.</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="thetis.options.ModelOptions2d.tracer_advective_velocity_factor">
<span class="sig-name descname"><span class="pre">tracer_advective_velocity_factor</span></span><a class="headerlink" href="#thetis.options.ModelOptions2d.tracer_advective_velocity_factor" title="Link to this definition">¶</a></dt>
<dd><p>Custom factor multiplied to the velocity variable in tracer advection equation.</p>
<p>Used to account for mismatch between depth-averaged product of velocity with tracer
and product of depth-averaged velocity with depth-averaged tracer</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="thetis.options.ModelOptions2d.tracer_element_family">
<span class="sig-name descname"><span class="pre">tracer_element_family</span></span><a class="headerlink" href="#thetis.options.ModelOptions2d.tracer_element_family" title="Link to this definition">¶</a></dt>
<dd><p>Finite element family for tracer transport</p>
<p>2D solver supports ‘dg’ or ‘cg’.</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="thetis.options.ModelOptions2d.tracer_only">
<span class="sig-name descname"><span class="pre">tracer_only</span></span><a class="headerlink" href="#thetis.options.ModelOptions2d.tracer_only" title="Link to this definition">¶</a></dt>
<dd><p>Hold shallow water variables in initial state</p>
<p>Advects tracer in the associated (constant) velocity field.</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="thetis.options.ModelOptions2d.tracer_picard_iterations">
<span class="sig-name descname"><span class="pre">tracer_picard_iterations</span></span><a class="headerlink" href="#thetis.options.ModelOptions2d.tracer_picard_iterations" title="Link to this definition">¶</a></dt>
<dd><p>Number of Picard iterations taken for tracer equations.</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="thetis.options.ModelOptions2d.tracer_timestepper_options">
<span class="sig-name descname"><span class="pre">tracer_timestepper_options</span></span><a class="headerlink" href="#thetis.options.ModelOptions2d.tracer_timestepper_options" title="Link to this definition">¶</a></dt>
<dd><p>A trait whose value must be an instance of a specified class.</p>
<p>The value can also be an instance of a subclass of the specified class.</p>
<p>Subclasses can declare default classes by overriding the klass attribute</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="thetis.options.ModelOptions2d.tracer_timestepper_type">
<span class="sig-name descname"><span class="pre">tracer_timestepper_type</span></span><a class="headerlink" href="#thetis.options.ModelOptions2d.tracer_timestepper_type" title="Link to this definition">¶</a></dt>
<dd><p>Name of the tracer time integrator</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="thetis.options.ModelOptions2d.use_automatic_wetting_and_drying_alpha">
<span class="sig-name descname"><span class="pre">use_automatic_wetting_and_drying_alpha</span></span><a class="headerlink" href="#thetis.options.ModelOptions2d.use_automatic_wetting_and_drying_alpha" title="Link to this definition">¶</a></dt>
<dd><p>Toggle automatic computation of the alpha parameter used in wetting and drying schemes.</p>
<p>By default, this parameter is set to 0.5.</p>
<p>For problems whose bathymetry varies wildly in coastal regions, it is advisable to use the
automatic wetting and drying parameter, rather than the default.</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="thetis.options.ModelOptions2d.use_supg_tracer">
<span class="sig-name descname"><span class="pre">use_supg_tracer</span></span><a class="headerlink" href="#thetis.options.ModelOptions2d.use_supg_tracer" title="Link to this definition">¶</a></dt>
<dd><p>Use SUPG stabilisation in tracer advection</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="thetis.options.ModelOptions2d.use_tracer_conservative_form">
<span class="sig-name descname"><span class="pre">use_tracer_conservative_form</span></span><a class="headerlink" href="#thetis.options.ModelOptions2d.use_tracer_conservative_form" title="Link to this definition">¶</a></dt>
<dd><p>Solve 2D tracer transport in the conservative form</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="thetis.options.ModelOptions2d.use_wetting_and_drying">
<span class="sig-name descname"><span class="pre">use_wetting_and_drying</span></span><a class="headerlink" href="#thetis.options.ModelOptions2d.use_wetting_and_drying" title="Link to this definition">¶</a></dt>
<dd><p>bool: Turn on wetting and drying</p>
<p>Uses the wetting and drying scheme from Karna et al (2011).
If <code class="docutils literal notranslate"><span class="pre">True</span></code>, one should also set <a class="reference internal" href="#thetis.options.ModelOptions2d.wetting_and_drying_alpha" title="thetis.options.ModelOptions2d.wetting_and_drying_alpha"><code class="xref py py-attr docutils literal notranslate"><span class="pre">wetting_and_drying_alpha</span></code></a> to control the bathymetry displacement.</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="thetis.options.ModelOptions2d.wetting_and_drying_alpha">
<span class="sig-name descname"><span class="pre">wetting_and_drying_alpha</span></span><a class="headerlink" href="#thetis.options.ModelOptions2d.wetting_and_drying_alpha" title="Link to this definition">¶</a></dt>
<dd><p>Coefficient: Wetting and drying parameter <span class="math notranslate nohighlight">\(\alpha\)</span>.</p>
<p>Used in bathymetry displacement function that ensures positive water depths. Unit is meters.</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="thetis.options.ModelOptions2d.wetting_and_drying_alpha_max">
<span class="sig-name descname"><span class="pre">wetting_and_drying_alpha_max</span></span><a class="headerlink" href="#thetis.options.ModelOptions2d.wetting_and_drying_alpha_max" title="Link to this definition">¶</a></dt>
<dd><p>Maximum value to be taken by wetting and drying parameter <span class="math notranslate nohighlight">\(\alpha\)</span>.</p>
<p>Note this is only relevant if <cite>use_automatic_wetting_and_drying_alpha</cite> is set to <code class="docutils literal notranslate"><span class="pre">True</span></code>.</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="thetis.options.ModelOptions2d.wetting_and_drying_alpha_min">
<span class="sig-name descname"><span class="pre">wetting_and_drying_alpha_min</span></span><a class="headerlink" href="#thetis.options.ModelOptions2d.wetting_and_drying_alpha_min" title="Link to this definition">¶</a></dt>
<dd><p>Minimum value to be taken by wetting and drying parameter <span class="math notranslate nohighlight">\(\alpha\)</span>.</p>
<p>Note this is only relevant if <cite>use_automatic_wetting_and_drying_alpha</cite> is set to <code class="docutils literal notranslate"><span class="pre">True</span></code>.</p>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="thetis.options.ModelOptions3d">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">thetis.options.</span></span><span class="sig-name descname"><span class="pre">ModelOptions3d</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Any</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/options.html#ModelOptions3d"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#thetis.options.ModelOptions3d" title="Link to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#thetis.options.CommonModelOptions" title="thetis.options.CommonModelOptions"><code class="xref py py-class docutils literal notranslate"><span class="pre">CommonModelOptions</span></code></a></p>
<p>Options for 3D hydrostatic model</p>
<dl class="py attribute">
<dt class="sig sig-object py" id="thetis.options.ModelOptions3d.bottom_roughness">
<span class="sig-name descname"><span class="pre">bottom_roughness</span></span><a class="headerlink" href="#thetis.options.ModelOptions3d.bottom_roughness" title="Link to this definition">¶</a></dt>
<dd><p>Bottom roughness length in meters.</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="thetis.options.ModelOptions3d.check_salinity_conservation">
<span class="sig-name descname"><span class="pre">check_salinity_conservation</span></span><a class="headerlink" href="#thetis.options.ModelOptions3d.check_salinity_conservation" title="Link to this definition">¶</a></dt>
<dd><p>Compute total salinity mass at every export</p>
<p>Prints deviation from the initial mass to stdout.</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="thetis.options.ModelOptions3d.check_salinity_overshoot">
<span class="sig-name descname"><span class="pre">check_salinity_overshoot</span></span><a class="headerlink" href="#thetis.options.ModelOptions3d.check_salinity_overshoot" title="Link to this definition">¶</a></dt>
<dd><p>Compute salinity overshoots at every export</p>
<p>Prints overshoot values that exceed the initial range to stdout.</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="thetis.options.ModelOptions3d.check_temperature_conservation">
<span class="sig-name descname"><span class="pre">check_temperature_conservation</span></span><a class="headerlink" href="#thetis.options.ModelOptions3d.check_temperature_conservation" title="Link to this definition">¶</a></dt>
<dd><p>Compute total temperature mass at every export</p>
<p>Prints deviation from the initial mass to stdout.</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="thetis.options.ModelOptions3d.check_temperature_overshoot">
<span class="sig-name descname"><span class="pre">check_temperature_overshoot</span></span><a class="headerlink" href="#thetis.options.ModelOptions3d.check_temperature_overshoot" title="Link to this definition">¶</a></dt>
<dd><p>Compute temperature overshoots at every export</p>
<p>Prints overshoot values that exceed the initial range to stdout.</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="thetis.options.ModelOptions3d.check_volume_conservation_3d">
<span class="sig-name descname"><span class="pre">check_volume_conservation_3d</span></span><a class="headerlink" href="#thetis.options.ModelOptions3d.check_volume_conservation_3d" title="Link to this definition">¶</a></dt>
<dd><p>Compute volume of the 3D domain at every export</p>
<p>Prints deviation from the initial volume to stdout.</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="thetis.options.ModelOptions3d.constant_salinity">
<span class="sig-name descname"><span class="pre">constant_salinity</span></span><a class="headerlink" href="#thetis.options.ModelOptions3d.constant_salinity" title="Link to this definition">¶</a></dt>
<dd><p>Constant salinity if salinity is not solved</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="thetis.options.ModelOptions3d.constant_temperature">
<span class="sig-name descname"><span class="pre">constant_temperature</span></span><a class="headerlink" href="#thetis.options.ModelOptions3d.constant_temperature" title="Link to this definition">¶</a></dt>
<dd><p>Constant temperature if temperature is not solved</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="thetis.options.ModelOptions3d.equation_of_state_options">
<span class="sig-name descname"><span class="pre">equation_of_state_options</span></span><a class="headerlink" href="#thetis.options.ModelOptions3d.equation_of_state_options" title="Link to this definition">¶</a></dt>
<dd><p>A trait whose value must be an instance of a specified class.</p>
<p>The value can also be an instance of a subclass of the specified class.</p>
<p>Subclasses can declare default classes by overriding the klass attribute</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="thetis.options.ModelOptions3d.equation_of_state_type">
<span class="sig-name descname"><span class="pre">equation_of_state_type</span></span><a class="headerlink" href="#thetis.options.ModelOptions3d.equation_of_state_type" title="Link to this definition">¶</a></dt>
<dd><p>Type of equation of state</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="thetis.options.ModelOptions3d.horizontal_diffusivity">
<span class="sig-name descname"><span class="pre">horizontal_diffusivity</span></span><a class="headerlink" href="#thetis.options.ModelOptions3d.horizontal_diffusivity" title="Link to this definition">¶</a></dt>
<dd><p>Horizontal diffusivity for tracers</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="thetis.options.ModelOptions3d.internal_pg_scalar">
<span class="sig-name descname"><span class="pre">internal_pg_scalar</span></span><a class="headerlink" href="#thetis.options.ModelOptions3d.internal_pg_scalar" title="Link to this definition">¶</a></dt>
<dd><p>A constant to scale the internal pressure gradient. Used to ramp up the model.</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="thetis.options.ModelOptions3d.momentum_source_3d">
<span class="sig-name descname"><span class="pre">momentum_source_3d</span></span><a class="headerlink" href="#thetis.options.ModelOptions3d.momentum_source_3d" title="Link to this definition">¶</a></dt>
<dd><p>Source term for 3D momentum equation</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="thetis.options.ModelOptions3d.name">
<span class="sig-name descname"><span class="pre">name</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">'3D</span> <span class="pre">hydrostatic</span> <span class="pre">model'</span></em><a class="headerlink" href="#thetis.options.ModelOptions3d.name" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="thetis.options.ModelOptions3d.salinity_source_3d">
<span class="sig-name descname"><span class="pre">salinity_source_3d</span></span><a class="headerlink" href="#thetis.options.ModelOptions3d.salinity_source_3d" title="Link to this definition">¶</a></dt>
<dd><p>Source term for salinity equation</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="thetis.options.ModelOptions3d.sipg_factor_turb">
<span class="sig-name descname"><span class="pre">sipg_factor_turb</span></span><a class="headerlink" href="#thetis.options.ModelOptions3d.sipg_factor_turb" title="Link to this definition">¶</a></dt>
<dd><p>Penalty parameter scaling factor for horizontal diffusivity terms of the turbulence model.</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="thetis.options.ModelOptions3d.sipg_factor_vertical">
<span class="sig-name descname"><span class="pre">sipg_factor_vertical</span></span><a class="headerlink" href="#thetis.options.ModelOptions3d.sipg_factor_vertical" title="Link to this definition">¶</a></dt>
<dd><p>Penalty parameter scaling factor for vertical viscosity terms.</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="thetis.options.ModelOptions3d.sipg_factor_vertical_tracer">
<span class="sig-name descname"><span class="pre">sipg_factor_vertical_tracer</span></span><a class="headerlink" href="#thetis.options.ModelOptions3d.sipg_factor_vertical_tracer" title="Link to this definition">¶</a></dt>
<dd><p>Penalty parameter scaling factor for vertical diffusivity terms.</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="thetis.options.ModelOptions3d.sipg_factor_vertical_turb">
<span class="sig-name descname"><span class="pre">sipg_factor_vertical_turb</span></span><a class="headerlink" href="#thetis.options.ModelOptions3d.sipg_factor_vertical_turb" title="Link to this definition">¶</a></dt>
<dd><p>Penalty parameter scaling factor for vertical diffusivity terms of the turbulence model.</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="thetis.options.ModelOptions3d.smagorinsky_coefficient">
<span class="sig-name descname"><span class="pre">smagorinsky_coefficient</span></span><a class="headerlink" href="#thetis.options.ModelOptions3d.smagorinsky_coefficient" title="Link to this definition">¶</a></dt>
<dd><p>Smagorinsky viscosity coefficient <span class="math notranslate nohighlight">\(C_S\)</span></p>
<p>See <a class="reference internal" href="#thetis.utility3d.SmagorinskyViscosity" title="thetis.utility3d.SmagorinskyViscosity"><code class="xref py py-class docutils literal notranslate"><span class="pre">SmagorinskyViscosity</span></code></a>.</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="thetis.options.ModelOptions3d.solve_salinity">
<span class="sig-name descname"><span class="pre">solve_salinity</span></span><a class="headerlink" href="#thetis.options.ModelOptions3d.solve_salinity" title="Link to this definition">¶</a></dt>
<dd><p>Solve salinity transport</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="thetis.options.ModelOptions3d.solve_temperature">
<span class="sig-name descname"><span class="pre">solve_temperature</span></span><a class="headerlink" href="#thetis.options.ModelOptions3d.solve_temperature" title="Link to this definition">¶</a></dt>
<dd><p>Solve temperature transport</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="thetis.options.ModelOptions3d.temperature_source_3d">
<span class="sig-name descname"><span class="pre">temperature_source_3d</span></span><a class="headerlink" href="#thetis.options.ModelOptions3d.temperature_source_3d" title="Link to this definition">¶</a></dt>
<dd><p>Source term for temperature equation</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="thetis.options.ModelOptions3d.timestep_2d">
<span class="sig-name descname"><span class="pre">timestep_2d</span></span><a class="headerlink" href="#thetis.options.ModelOptions3d.timestep_2d" title="Link to this definition">¶</a></dt>
<dd><p>Time step of the 2d mode</p>
<p>This option is only used in the 3d solver, if 2d mode is solved
explicitly.</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="thetis.options.ModelOptions3d.timestepper_options">
<span class="sig-name descname"><span class="pre">timestepper_options</span></span><a class="headerlink" href="#thetis.options.ModelOptions3d.timestepper_options" title="Link to this definition">¶</a></dt>
<dd><p>A trait whose value must be an instance of a specified class.</p>
<p>The value can also be an instance of a subclass of the specified class.</p>
<p>Subclasses can declare default classes by overriding the klass attribute</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="thetis.options.ModelOptions3d.timestepper_type">
<span class="sig-name descname"><span class="pre">timestepper_type</span></span><a class="headerlink" href="#thetis.options.ModelOptions3d.timestepper_type" title="Link to this definition">¶</a></dt>
<dd><p>Name of the 3D time integrator</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="thetis.options.ModelOptions3d.turbulence_model_options">
<span class="sig-name descname"><span class="pre">turbulence_model_options</span></span><a class="headerlink" href="#thetis.options.ModelOptions3d.turbulence_model_options" title="Link to this definition">¶</a></dt>
<dd><p>A trait whose value must be an instance of a specified class.</p>
<p>The value can also be an instance of a subclass of the specified class.</p>
<p>Subclasses can declare default classes by overriding the klass attribute</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="thetis.options.ModelOptions3d.turbulence_model_type">
<span class="sig-name descname"><span class="pre">turbulence_model_type</span></span><a class="headerlink" href="#thetis.options.ModelOptions3d.turbulence_model_type" title="Link to this definition">¶</a></dt>
<dd><p>Type of vertical turbulence model</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="thetis.options.ModelOptions3d.use_ale_moving_mesh">
<span class="sig-name descname"><span class="pre">use_ale_moving_mesh</span></span><a class="headerlink" href="#thetis.options.ModelOptions3d.use_ale_moving_mesh" title="Link to this definition">¶</a></dt>
<dd><p>Use ALE formulation where 3D mesh tracks free surface</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="thetis.options.ModelOptions3d.use_baroclinic_formulation">
<span class="sig-name descname"><span class="pre">use_baroclinic_formulation</span></span><a class="headerlink" href="#thetis.options.ModelOptions3d.use_baroclinic_formulation" title="Link to this definition">¶</a></dt>
<dd><p>Compute internal pressure gradient in momentum equation</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="thetis.options.ModelOptions3d.use_bottom_friction">
<span class="sig-name descname"><span class="pre">use_bottom_friction</span></span><a class="headerlink" href="#thetis.options.ModelOptions3d.use_bottom_friction" title="Link to this definition">¶</a></dt>
<dd><p>Apply log layer bottom stress in the 3D model</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="thetis.options.ModelOptions3d.use_implicit_vertical_diffusion">
<span class="sig-name descname"><span class="pre">use_implicit_vertical_diffusion</span></span><a class="headerlink" href="#thetis.options.ModelOptions3d.use_implicit_vertical_diffusion" title="Link to this definition">¶</a></dt>
<dd><p>Solve vertical diffusion and viscosity implicitly</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="thetis.options.ModelOptions3d.use_limiter_for_velocity">
<span class="sig-name descname"><span class="pre">use_limiter_for_velocity</span></span><a class="headerlink" href="#thetis.options.ModelOptions3d.use_limiter_for_velocity" title="Link to this definition">¶</a></dt>
<dd><p>Apply P1DG limiter for 3D horizontal velocity field</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="thetis.options.ModelOptions3d.use_quadratic_density">
<span class="sig-name descname"><span class="pre">use_quadratic_density</span></span><a class="headerlink" href="#thetis.options.ModelOptions3d.use_quadratic_density" title="Link to this definition">¶</a></dt>
<dd><p>Water density is projected to P2DGxP2 space.</p>
<p>This reduces pressure gradient errors associated with nonlinear
equation of state.
If False, density is computed point-wise in the tracer space.</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="thetis.options.ModelOptions3d.use_quadratic_pressure">
<span class="sig-name descname"><span class="pre">use_quadratic_pressure</span></span><a class="headerlink" href="#thetis.options.ModelOptions3d.use_quadratic_pressure" title="Link to this definition">¶</a></dt>
<dd><p>Use P2DGxP2 space for baroclinic head.</p>
<p>If element_family=’dg-dg’, P2DGxP1DG space is also used for the internal
pressure gradient.</p>
<p>This is useful to alleviate bathymetry-induced pressure gradient errors.
If False, the baroclinic head is in the tracer space, and internal
pressure gradient is in the velocity space.</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="thetis.options.ModelOptions3d.use_smagorinsky_viscosity">
<span class="sig-name descname"><span class="pre">use_smagorinsky_viscosity</span></span><a class="headerlink" href="#thetis.options.ModelOptions3d.use_smagorinsky_viscosity" title="Link to this definition">¶</a></dt>
<dd><p>Use Smagorinsky horisontal viscosity parametrization</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="thetis.options.ModelOptions3d.use_turbulence">
<span class="sig-name descname"><span class="pre">use_turbulence</span></span><a class="headerlink" href="#thetis.options.ModelOptions3d.use_turbulence" title="Link to this definition">¶</a></dt>
<dd><p>Activate turbulence model in the 3D model</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="thetis.options.ModelOptions3d.use_turbulence_advection">
<span class="sig-name descname"><span class="pre">use_turbulence_advection</span></span><a class="headerlink" href="#thetis.options.ModelOptions3d.use_turbulence_advection" title="Link to this definition">¶</a></dt>
<dd><p>Advect TKE and Psi in the GLS turbulence model</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="thetis.options.ModelOptions3d.vertical_diffusivity">
<span class="sig-name descname"><span class="pre">vertical_diffusivity</span></span><a class="headerlink" href="#thetis.options.ModelOptions3d.vertical_diffusivity" title="Link to this definition">¶</a></dt>
<dd><p>Vertical diffusivity for tracers</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="thetis.options.ModelOptions3d.vertical_velocity_scale">
<span class="sig-name descname"><span class="pre">vertical_velocity_scale</span></span><a class="headerlink" href="#thetis.options.ModelOptions3d.vertical_velocity_scale" title="Link to this definition">¶</a></dt>
<dd><p>Maximum vertical velocity magnitude</p>
<p>Used to compute max stable advection time step.</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="thetis.options.ModelOptions3d.vertical_viscosity">
<span class="sig-name descname"><span class="pre">vertical_viscosity</span></span><a class="headerlink" href="#thetis.options.ModelOptions3d.vertical_viscosity" title="Link to this definition">¶</a></dt>
<dd><p>Vertical viscosity</p>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="thetis.options.NonhydrostaticModelOptions">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">thetis.options.</span></span><span class="sig-name descname"><span class="pre">NonhydrostaticModelOptions</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Any</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/options.html#NonhydrostaticModelOptions"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#thetis.options.NonhydrostaticModelOptions" title="Link to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#thetis.configuration.FrozenHasTraits" title="thetis.configuration.FrozenHasTraits"><code class="xref py py-class docutils literal notranslate"><span class="pre">FrozenHasTraits</span></code></a></p>
<p>Options for non-hydrostatic models</p>
<dl class="py attribute">
<dt class="sig sig-object py" id="thetis.options.NonhydrostaticModelOptions.free_surface_timestepper_options">
<span class="sig-name descname"><span class="pre">free_surface_timestepper_options</span></span><a class="headerlink" href="#thetis.options.NonhydrostaticModelOptions.free_surface_timestepper_options" title="Link to this definition">¶</a></dt>
<dd><p>A trait whose value must be an instance of a specified class.</p>
<p>The value can also be an instance of a subclass of the specified class.</p>
<p>Subclasses can declare default classes by overriding the klass attribute</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="thetis.options.NonhydrostaticModelOptions.free_surface_timestepper_type">
<span class="sig-name descname"><span class="pre">free_surface_timestepper_type</span></span><a class="headerlink" href="#thetis.options.NonhydrostaticModelOptions.free_surface_timestepper_type" title="Link to this definition">¶</a></dt>
<dd><p>Name of the free surface time integrator</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="thetis.options.NonhydrostaticModelOptions.name">
<span class="sig-name descname"><span class="pre">name</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">'Non-hydrostatic</span> <span class="pre">2D/3D</span> <span class="pre">models'</span></em><a class="headerlink" href="#thetis.options.NonhydrostaticModelOptions.name" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="thetis.options.NonhydrostaticModelOptions.q_degree">
<span class="sig-name descname"><span class="pre">q_degree</span></span><a class="headerlink" href="#thetis.options.NonhydrostaticModelOptions.q_degree" title="Link to this definition">¶</a></dt>
<dd><p>Polynomial degree of the non-hydrostatic pressure space</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="thetis.options.NonhydrostaticModelOptions.solve_nonhydrostatic_pressure">
<span class="sig-name descname"><span class="pre">solve_nonhydrostatic_pressure</span></span><a class="headerlink" href="#thetis.options.NonhydrostaticModelOptions.solve_nonhydrostatic_pressure" title="Link to this definition">¶</a></dt>
<dd><p>Solve equations with the non-hydrostatic pressure</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="thetis.options.NonhydrostaticModelOptions.solver_parameters">
<span class="sig-name descname"><span class="pre">solver_parameters</span></span><a class="headerlink" href="#thetis.options.NonhydrostaticModelOptions.solver_parameters" title="Link to this definition">¶</a></dt>
<dd><p>PETSc solver options dictionary</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="thetis.options.NonhydrostaticModelOptions.update_free_surface">
<span class="sig-name descname"><span class="pre">update_free_surface</span></span><a class="headerlink" href="#thetis.options.NonhydrostaticModelOptions.update_free_surface" title="Link to this definition">¶</a></dt>
<dd><p>Update free surface elevation after pressure projection/correction step</p>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="thetis.options.PacanowskiPhilanderModelOptions">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">thetis.options.</span></span><span class="sig-name descname"><span class="pre">PacanowskiPhilanderModelOptions</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Any</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/options.html#PacanowskiPhilanderModelOptions"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#thetis.options.PacanowskiPhilanderModelOptions" title="Link to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#thetis.options.TurbulenceModelOptions" title="thetis.options.TurbulenceModelOptions"><code class="xref py py-class docutils literal notranslate"><span class="pre">TurbulenceModelOptions</span></code></a></p>
<p>Options for Pacanowski-Philander turbulence model</p>
<dl class="py attribute">
<dt class="sig sig-object py" id="thetis.options.PacanowskiPhilanderModelOptions.alpha">
<span class="sig-name descname"><span class="pre">alpha</span></span><a class="headerlink" href="#thetis.options.PacanowskiPhilanderModelOptions.alpha" title="Link to this definition">¶</a></dt>
<dd><p>float: Richardson number multiplier</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="thetis.options.PacanowskiPhilanderModelOptions.exponent">
<span class="sig-name descname"><span class="pre">exponent</span></span><a class="headerlink" href="#thetis.options.PacanowskiPhilanderModelOptions.exponent" title="Link to this definition">¶</a></dt>
<dd><p>float: Exponent of viscosity numerator <span class="math notranslate nohighlight">\(n\)</span></p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="thetis.options.PacanowskiPhilanderModelOptions.max_viscosity">
<span class="sig-name descname"><span class="pre">max_viscosity</span></span><a class="headerlink" href="#thetis.options.PacanowskiPhilanderModelOptions.max_viscosity" title="Link to this definition">¶</a></dt>
<dd><p>float: Constant maximum viscosity <span class="math notranslate nohighlight">\(\nu_{max}\)</span></p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="thetis.options.PacanowskiPhilanderModelOptions.name">
<span class="sig-name descname"><span class="pre">name</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">'Pacanowski-Philander</span> <span class="pre">turbulence</span> <span class="pre">closure</span> <span class="pre">model'</span></em><a class="headerlink" href="#thetis.options.PacanowskiPhilanderModelOptions.name" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="thetis.options.PressureProjectionSWETimeStepperOptions2d">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">thetis.options.</span></span><span class="sig-name descname"><span class="pre">PressureProjectionSWETimeStepperOptions2d</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Any</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/options.html#PressureProjectionSWETimeStepperOptions2d"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#thetis.options.PressureProjectionSWETimeStepperOptions2d" title="Link to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#thetis.options.TimeStepperOptions" title="thetis.options.TimeStepperOptions"><code class="xref py py-class docutils literal notranslate"><span class="pre">TimeStepperOptions</span></code></a></p>
<p>Options for 2d pressure-projection time integrator
applied to shallow water equations</p>
<dl class="py attribute">
<dt class="sig sig-object py" id="thetis.options.PressureProjectionSWETimeStepperOptions2d.implicitness_theta">
<span class="sig-name descname"><span class="pre">implicitness_theta</span></span><a class="headerlink" href="#thetis.options.PressureProjectionSWETimeStepperOptions2d.implicitness_theta" title="Link to this definition">¶</a></dt>
<dd><p>implicitness parameter theta. Value 0.5 implies Crank-Nicolson scheme, 1.0 implies fully implicit formulation.</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="thetis.options.PressureProjectionSWETimeStepperOptions2d.picard_iterations">
<span class="sig-name descname"><span class="pre">picard_iterations</span></span><a class="headerlink" href="#thetis.options.PressureProjectionSWETimeStepperOptions2d.picard_iterations" title="Link to this definition">¶</a></dt>
<dd><p>number of Picard iterations to converge the nonlinearity in the equations.</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="thetis.options.PressureProjectionSWETimeStepperOptions2d.solver_parameters_momentum">
<span class="sig-name descname"><span class="pre">solver_parameters_momentum</span></span><a class="headerlink" href="#thetis.options.PressureProjectionSWETimeStepperOptions2d.solver_parameters_momentum" title="Link to this definition">¶</a></dt>
<dd><p>PETSc solver options dictionary</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="thetis.options.PressureProjectionSWETimeStepperOptions2d.solver_parameters_pressure">
<span class="sig-name descname"><span class="pre">solver_parameters_pressure</span></span><a class="headerlink" href="#thetis.options.PressureProjectionSWETimeStepperOptions2d.solver_parameters_pressure" title="Link to this definition">¶</a></dt>
<dd><p>PETSc solver options dictionary</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="thetis.options.PressureProjectionSWETimeStepperOptions2d.use_semi_implicit_linearization">
<span class="sig-name descname"><span class="pre">use_semi_implicit_linearization</span></span><a class="headerlink" href="#thetis.options.PressureProjectionSWETimeStepperOptions2d.use_semi_implicit_linearization" title="Link to this definition">¶</a></dt>
<dd><p>Use linearized semi-implicit time integration</p>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="thetis.options.SSPRKTimeStepperOptions3d">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">thetis.options.</span></span><span class="sig-name descname"><span class="pre">SSPRKTimeStepperOptions3d</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Any</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/options.html#SSPRKTimeStepperOptions3d"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#thetis.options.SSPRKTimeStepperOptions3d" title="Link to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#thetis.options.TimeStepperOptions3d" title="thetis.options.TimeStepperOptions3d"><code class="xref py py-class docutils literal notranslate"><span class="pre">TimeStepperOptions3d</span></code></a></p>
<p>Options for 3d SSPRK coupled time integrator</p>
<dl class="py attribute">
<dt class="sig sig-object py" id="thetis.options.SSPRKTimeStepperOptions3d.explicit_momentum_options">
<span class="sig-name descname"><span class="pre">explicit_momentum_options</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">&lt;thetis.options.ExplicitMomentumTimeStepperOptions3d</span> <span class="pre">object&gt;</span></em><a class="headerlink" href="#thetis.options.SSPRKTimeStepperOptions3d.explicit_momentum_options" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="thetis.options.SSPRKTimeStepperOptions3d.explicit_tracer_options">
<span class="sig-name descname"><span class="pre">explicit_tracer_options</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">&lt;thetis.options.ExplicitTracerTimeStepperOptions3d</span> <span class="pre">object&gt;</span></em><a class="headerlink" href="#thetis.options.SSPRKTimeStepperOptions3d.explicit_tracer_options" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="thetis.options.SSPRKTimeStepperOptions3d.implicit_momentum_options">
<span class="sig-name descname"><span class="pre">implicit_momentum_options</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">&lt;thetis.options.ImplicitMomentumTimeStepperOptions3d</span> <span class="pre">object&gt;</span></em><a class="headerlink" href="#thetis.options.SSPRKTimeStepperOptions3d.implicit_momentum_options" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="thetis.options.SSPRKTimeStepperOptions3d.implicit_tracer_options">
<span class="sig-name descname"><span class="pre">implicit_tracer_options</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">&lt;thetis.options.ImplicitTracerTimeStepperOptions3d</span> <span class="pre">object&gt;</span></em><a class="headerlink" href="#thetis.options.SSPRKTimeStepperOptions3d.implicit_tracer_options" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="thetis.options.SSPRKTimeStepperOptions3d.swe_options">
<span class="sig-name descname"><span class="pre">swe_options</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">&lt;thetis.options.SWETimeStepperOptions3d</span> <span class="pre">object&gt;</span></em><a class="headerlink" href="#thetis.options.SSPRKTimeStepperOptions3d.swe_options" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="thetis.options.SSPRKTimeStepperOptions3d.use_automatic_timestep">
<span class="sig-name descname"><span class="pre">use_automatic_timestep</span></span><a class="headerlink" href="#thetis.options.SSPRKTimeStepperOptions3d.use_automatic_timestep" title="Link to this definition">¶</a></dt>
<dd><p>Set time step automatically based on local CFL conditions.</p>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="thetis.options.SWETimeStepperOptions3d">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">thetis.options.</span></span><span class="sig-name descname"><span class="pre">SWETimeStepperOptions3d</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Any</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/options.html#SWETimeStepperOptions3d"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#thetis.options.SWETimeStepperOptions3d" title="Link to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#thetis.options.TimeStepperOptions3d" title="thetis.options.TimeStepperOptions3d"><code class="xref py py-class docutils literal notranslate"><span class="pre">TimeStepperOptions3d</span></code></a></p>
<p>Options for 3d time integrator
shallow water component</p>
<dl class="py attribute">
<dt class="sig sig-object py" id="thetis.options.SWETimeStepperOptions3d.solver_parameters">
<span class="sig-name descname"><span class="pre">solver_parameters</span></span><a class="headerlink" href="#thetis.options.SWETimeStepperOptions3d.solver_parameters" title="Link to this definition">¶</a></dt>
<dd><p>PETSc solver options dictionary</p>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="thetis.options.SedimentModelOptions">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">thetis.options.</span></span><span class="sig-name descname"><span class="pre">SedimentModelOptions</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Any</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/options.html#SedimentModelOptions"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#thetis.options.SedimentModelOptions" title="Link to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#thetis.configuration.FrozenHasTraits" title="thetis.configuration.FrozenHasTraits"><code class="xref py py-class docutils literal notranslate"><span class="pre">FrozenHasTraits</span></code></a></p>
<dl class="py attribute">
<dt class="sig sig-object py" id="thetis.options.SedimentModelOptions.average_sediment_size">
<span class="sig-name descname"><span class="pre">average_sediment_size</span></span><a class="headerlink" href="#thetis.options.SedimentModelOptions.average_sediment_size" title="Link to this definition">¶</a></dt>
<dd><p>Average sediment size</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="thetis.options.SedimentModelOptions.bed_reference_height">
<span class="sig-name descname"><span class="pre">bed_reference_height</span></span><a class="headerlink" href="#thetis.options.SedimentModelOptions.bed_reference_height" title="Link to this definition">¶</a></dt>
<dd><p>Bottom bed reference height</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="thetis.options.SedimentModelOptions.check_sediment_conservation">
<span class="sig-name descname"><span class="pre">check_sediment_conservation</span></span><a class="headerlink" href="#thetis.options.SedimentModelOptions.check_sediment_conservation" title="Link to this definition">¶</a></dt>
<dd><p>Compute total sediment mass at every export</p>
<p>Prints deviation from the initial mass to stdout.</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="thetis.options.SedimentModelOptions.check_sediment_overshoot">
<span class="sig-name descname"><span class="pre">check_sediment_overshoot</span></span><a class="headerlink" href="#thetis.options.SedimentModelOptions.check_sediment_overshoot" title="Link to this definition">¶</a></dt>
<dd><p>Compute sediment overshoots at every export</p>
<p>Prints overshoot values that exceed the initial range to stdout.</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="thetis.options.SedimentModelOptions.exner_timestepper_options">
<span class="sig-name descname"><span class="pre">exner_timestepper_options</span></span><a class="headerlink" href="#thetis.options.SedimentModelOptions.exner_timestepper_options" title="Link to this definition">¶</a></dt>
<dd><p>A trait whose value must be an instance of a specified class.</p>
<p>The value can also be an instance of a subclass of the specified class.</p>
<p>Subclasses can declare default classes by overriding the klass attribute</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="thetis.options.SedimentModelOptions.exner_timestepper_type">
<span class="sig-name descname"><span class="pre">exner_timestepper_type</span></span><a class="headerlink" href="#thetis.options.SedimentModelOptions.exner_timestepper_type" title="Link to this definition">¶</a></dt>
<dd><p>Name of the exner time integrator</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="thetis.options.SedimentModelOptions.horizontal_diffusivity">
<span class="sig-name descname"><span class="pre">horizontal_diffusivity</span></span><a class="headerlink" href="#thetis.options.SedimentModelOptions.horizontal_diffusivity" title="Link to this definition">¶</a></dt>
<dd><p>Horizontal diffusivity for sediment</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="thetis.options.SedimentModelOptions.max_angle">
<span class="sig-name descname"><span class="pre">max_angle</span></span><a class="headerlink" href="#thetis.options.SedimentModelOptions.max_angle" title="Link to this definition">¶</a></dt>
<dd><p>Angle of repose for sediment slide mechanism in degrees</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="thetis.options.SedimentModelOptions.morphological_acceleration_factor">
<span class="sig-name descname"><span class="pre">morphological_acceleration_factor</span></span><a class="headerlink" href="#thetis.options.SedimentModelOptions.morphological_acceleration_factor" title="Link to this definition">¶</a></dt>
<dd><p>Rate at which timestep in exner equation is accelerated compared to timestep for model</p>
<p>timestep in exner = morphological_acceleration_factor * timestep</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="thetis.options.SedimentModelOptions.morphological_viscosity">
<span class="sig-name descname"><span class="pre">morphological_viscosity</span></span><a class="headerlink" href="#thetis.options.SedimentModelOptions.morphological_viscosity" title="Link to this definition">¶</a></dt>
<dd><p>Viscosity used to derive morphology terms.</p>
<p>Usually equal to horizontal viscosity but can be set to have a different value</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="thetis.options.SedimentModelOptions.porosity">
<span class="sig-name descname"><span class="pre">porosity</span></span><a class="headerlink" href="#thetis.options.SedimentModelOptions.porosity" title="Link to this definition">¶</a></dt>
<dd><p>Bed porosity for exner equation</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="thetis.options.SedimentModelOptions.secondary_current_parameter">
<span class="sig-name descname"><span class="pre">secondary_current_parameter</span></span><a class="headerlink" href="#thetis.options.SedimentModelOptions.secondary_current_parameter" title="Link to this definition">¶</a></dt>
<dd><p>Parameter controlling secondary current</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="thetis.options.SedimentModelOptions.sed_slide_length_scale">
<span class="sig-name descname"><span class="pre">sed_slide_length_scale</span></span><a class="headerlink" href="#thetis.options.SedimentModelOptions.sed_slide_length_scale" title="Link to this definition">¶</a></dt>
<dd><p>Length scale for sediment slide mechanism.</p>
<p>This should normally be the average meshgrid size.</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="thetis.options.SedimentModelOptions.sediment_density">
<span class="sig-name descname"><span class="pre">sediment_density</span></span><a class="headerlink" href="#thetis.options.SedimentModelOptions.sediment_density" title="Link to this definition">¶</a></dt>
<dd><p>Density of sediment</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="thetis.options.SedimentModelOptions.sediment_model_class">
<span class="sig-name descname"><span class="pre">sediment_model_class</span></span><a class="headerlink" href="#thetis.options.SedimentModelOptions.sediment_model_class" title="Link to this definition">¶</a></dt>
<dd><p>Class used to define the sediment model</p>
<p>This option can be used to provide a user-defined sediment model class that should
be a subclass of SedimentModel. For example:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="k">class</span><span class="w"> </span><span class="nc">UserSedimentModel</span><span class="p">(</span><span class="n">SedimentModel</span><span class="p">):</span>
   <span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span><span class="n">options</span><span class="p">,</span> <span class="n">mesh2d</span><span class="p">,</span> <span class="n">uv</span><span class="p">,</span> <span class="n">elev</span><span class="p">,</span> <span class="n">depth</span><span class="p">,</span> <span class="n">extra_term</span><span class="p">):</span>
      <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="n">options</span><span class="p">,</span> <span class="n">mesh2d</span><span class="p">,</span> <span class="n">uv</span><span class="p">,</span> <span class="n">elev</span><span class="p">,</span> <span class="n">depth</span><span class="p">)</span>
      <span class="bp">self</span><span class="o">.</span><span class="n">extra_term</span> <span class="o">=</span> <span class="n">extra_term</span>

   <span class="k">def</span><span class="w"> </span><span class="nf">get_bedloadterm</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">bathymetry</span><span class="p">):</span>
      <span class="k">return</span> <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="n">get_bedloadterm</span><span class="p">(</span><span class="n">bathymetry</span><span class="p">)</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">term</span>
</pre></div>
</div>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="thetis.options.SedimentModelOptions.sediment_timestepper_options">
<span class="sig-name descname"><span class="pre">sediment_timestepper_options</span></span><a class="headerlink" href="#thetis.options.SedimentModelOptions.sediment_timestepper_options" title="Link to this definition">¶</a></dt>
<dd><p>A trait whose value must be an instance of a specified class.</p>
<p>The value can also be an instance of a subclass of the specified class.</p>
<p>Subclasses can declare default classes by overriding the klass attribute</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="thetis.options.SedimentModelOptions.sediment_timestepper_type">
<span class="sig-name descname"><span class="pre">sediment_timestepper_type</span></span><a class="headerlink" href="#thetis.options.SedimentModelOptions.sediment_timestepper_type" title="Link to this definition">¶</a></dt>
<dd><p>Name of the sediment time integrator</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="thetis.options.SedimentModelOptions.slide_region">
<span class="sig-name descname"><span class="pre">slide_region</span></span><a class="headerlink" href="#thetis.options.SedimentModelOptions.slide_region" title="Link to this definition">¶</a></dt>
<dd><p>Region where sediment slide occurs.</p>
<p>If None then sediment slide is applied over whole domain.</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="thetis.options.SedimentModelOptions.slope_effect_angle_parameter">
<span class="sig-name descname"><span class="pre">slope_effect_angle_parameter</span></span><a class="headerlink" href="#thetis.options.SedimentModelOptions.slope_effect_angle_parameter" title="Link to this definition">¶</a></dt>
<dd><p>Parameter controlling angle of slope effect</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="thetis.options.SedimentModelOptions.slope_effect_parameter">
<span class="sig-name descname"><span class="pre">slope_effect_parameter</span></span><a class="headerlink" href="#thetis.options.SedimentModelOptions.slope_effect_parameter" title="Link to this definition">¶</a></dt>
<dd><p>Parameter controlling magnitude of slope effect</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="thetis.options.SedimentModelOptions.solve_exner">
<span class="sig-name descname"><span class="pre">solve_exner</span></span><a class="headerlink" href="#thetis.options.SedimentModelOptions.solve_exner" title="Link to this definition">¶</a></dt>
<dd><p>Solve exner equation for bed morphology</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="thetis.options.SedimentModelOptions.solve_suspended_sediment">
<span class="sig-name descname"><span class="pre">solve_suspended_sediment</span></span><a class="headerlink" href="#thetis.options.SedimentModelOptions.solve_suspended_sediment" title="Link to this definition">¶</a></dt>
<dd><p>Solve suspended sediment transport equation</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="thetis.options.SedimentModelOptions.use_advective_velocity_correction">
<span class="sig-name descname"><span class="pre">use_advective_velocity_correction</span></span><a class="headerlink" href="#thetis.options.SedimentModelOptions.use_advective_velocity_correction" title="Link to this definition">¶</a></dt>
<dd><p>Switch to apply correction to advective velocity used in sediment equation</p>
<p>Accounts for mismatch between depth-averaged product of velocity with sediment
and product of depth-averaged velocity with depth-averaged sediment</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="thetis.options.SedimentModelOptions.use_angle_correction">
<span class="sig-name descname"><span class="pre">use_angle_correction</span></span><a class="headerlink" href="#thetis.options.SedimentModelOptions.use_angle_correction" title="Link to this definition">¶</a></dt>
<dd><p>Switch to use slope effect angle correction</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="thetis.options.SedimentModelOptions.use_bedload">
<span class="sig-name descname"><span class="pre">use_bedload</span></span><a class="headerlink" href="#thetis.options.SedimentModelOptions.use_bedload" title="Link to this definition">¶</a></dt>
<dd><p>Use bedload transport in sediment model</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="thetis.options.SedimentModelOptions.use_secondary_current">
<span class="sig-name descname"><span class="pre">use_secondary_current</span></span><a class="headerlink" href="#thetis.options.SedimentModelOptions.use_secondary_current" title="Link to this definition">¶</a></dt>
<dd><p>Switch to use secondary current for helical flow effect</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="thetis.options.SedimentModelOptions.use_sediment_conservative_form">
<span class="sig-name descname"><span class="pre">use_sediment_conservative_form</span></span><a class="headerlink" href="#thetis.options.SedimentModelOptions.use_sediment_conservative_form" title="Link to this definition">¶</a></dt>
<dd><p>Solve 2D sediment transport in the conservative form</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="thetis.options.SedimentModelOptions.use_sediment_slide">
<span class="sig-name descname"><span class="pre">use_sediment_slide</span></span><a class="headerlink" href="#thetis.options.SedimentModelOptions.use_sediment_slide" title="Link to this definition">¶</a></dt>
<dd><p>Use sediment slide mechanism in sediment model</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="thetis.options.SedimentModelOptions.use_slope_mag_correction">
<span class="sig-name descname"><span class="pre">use_slope_mag_correction</span></span><a class="headerlink" href="#thetis.options.SedimentModelOptions.use_slope_mag_correction" title="Link to this definition">¶</a></dt>
<dd><p>Switch to use slope effect magnitude correction</p>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="thetis.options.SemiImplicitSWETimeStepperOptions2d">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">thetis.options.</span></span><span class="sig-name descname"><span class="pre">SemiImplicitSWETimeStepperOptions2d</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Any</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/options.html#SemiImplicitSWETimeStepperOptions2d"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#thetis.options.SemiImplicitSWETimeStepperOptions2d" title="Link to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#thetis.options.SemiImplicitTimeStepperOptions2d" title="thetis.options.SemiImplicitTimeStepperOptions2d"><code class="xref py py-class docutils literal notranslate"><span class="pre">SemiImplicitTimeStepperOptions2d</span></code></a></p>
<p>Options for 2d semi-implicit time integrator
applied to shallow water equations</p>
<dl class="py attribute">
<dt class="sig sig-object py" id="thetis.options.SemiImplicitSWETimeStepperOptions2d.solver_parameters">
<span class="sig-name descname"><span class="pre">solver_parameters</span></span><a class="headerlink" href="#thetis.options.SemiImplicitSWETimeStepperOptions2d.solver_parameters" title="Link to this definition">¶</a></dt>
<dd><p>PETSc solver options dictionary</p>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="thetis.options.SemiImplicitTimeStepperOptions2d">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">thetis.options.</span></span><span class="sig-name descname"><span class="pre">SemiImplicitTimeStepperOptions2d</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Any</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/options.html#SemiImplicitTimeStepperOptions2d"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#thetis.options.SemiImplicitTimeStepperOptions2d" title="Link to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#thetis.options.TimeStepperOptions" title="thetis.options.TimeStepperOptions"><code class="xref py py-class docutils literal notranslate"><span class="pre">TimeStepperOptions</span></code></a></p>
<p>Options for 2d semi-implicit time integrator</p>
<dl class="py attribute">
<dt class="sig sig-object py" id="thetis.options.SemiImplicitTimeStepperOptions2d.use_semi_implicit_linearization">
<span class="sig-name descname"><span class="pre">use_semi_implicit_linearization</span></span><a class="headerlink" href="#thetis.options.SemiImplicitTimeStepperOptions2d.use_semi_implicit_linearization" title="Link to this definition">¶</a></dt>
<dd><p>Use linearized semi-implicit time integration</p>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="thetis.options.SemiImplicitTracerTimeStepperOptions2d">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">thetis.options.</span></span><span class="sig-name descname"><span class="pre">SemiImplicitTracerTimeStepperOptions2d</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Any</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/options.html#SemiImplicitTracerTimeStepperOptions2d"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#thetis.options.SemiImplicitTracerTimeStepperOptions2d" title="Link to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#thetis.options.SemiImplicitTimeStepperOptions2d" title="thetis.options.SemiImplicitTimeStepperOptions2d"><code class="xref py py-class docutils literal notranslate"><span class="pre">SemiImplicitTimeStepperOptions2d</span></code></a></p>
<p>Options for 2d semi-implicit time integrator
applied to tracer equations</p>
<dl class="py attribute">
<dt class="sig sig-object py" id="thetis.options.SemiImplicitTracerTimeStepperOptions2d.solver_parameters">
<span class="sig-name descname"><span class="pre">solver_parameters</span></span><a class="headerlink" href="#thetis.options.SemiImplicitTracerTimeStepperOptions2d.solver_parameters" title="Link to this definition">¶</a></dt>
<dd><p>PETSc solver options dictionary</p>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="thetis.options.SteadyStateTimeStepperOptions2d">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">thetis.options.</span></span><span class="sig-name descname"><span class="pre">SteadyStateTimeStepperOptions2d</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Any</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/options.html#SteadyStateTimeStepperOptions2d"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#thetis.options.SteadyStateTimeStepperOptions2d" title="Link to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#thetis.options.TimeStepperOptions" title="thetis.options.TimeStepperOptions"><code class="xref py py-class docutils literal notranslate"><span class="pre">TimeStepperOptions</span></code></a></p>
<p>Options for 2d steady state solver</p>
<dl class="py attribute">
<dt class="sig sig-object py" id="thetis.options.SteadyStateTimeStepperOptions2d.solver_parameters">
<span class="sig-name descname"><span class="pre">solver_parameters</span></span><a class="headerlink" href="#thetis.options.SteadyStateTimeStepperOptions2d.solver_parameters" title="Link to this definition">¶</a></dt>
<dd><p>PETSc solver options dictionary</p>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="thetis.options.TabulatedTidalTurbineOptions">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">thetis.options.</span></span><span class="sig-name descname"><span class="pre">TabulatedTidalTurbineOptions</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Any</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/options.html#TabulatedTidalTurbineOptions"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#thetis.options.TabulatedTidalTurbineOptions" title="Link to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#thetis.options.TidalTurbineOptions" title="thetis.options.TidalTurbineOptions"><code class="xref py py-class docutils literal notranslate"><span class="pre">TidalTurbineOptions</span></code></a></p>
<p>Options for tidal turbine with tabulated thrust coefficient</p>
<dl class="py attribute">
<dt class="sig sig-object py" id="thetis.options.TabulatedTidalTurbineOptions.name">
<span class="sig-name descname"><span class="pre">name</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">'Tabulated</span> <span class="pre">tidal</span> <span class="pre">turbine</span> <span class="pre">options'</span></em><a class="headerlink" href="#thetis.options.TabulatedTidalTurbineOptions.name" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="thetis.options.TabulatedTidalTurbineOptions.power_coefficients">
<span class="sig-name descname"><span class="pre">power_coefficients</span></span><a class="headerlink" href="#thetis.options.TabulatedTidalTurbineOptions.power_coefficients" title="Link to this definition">¶</a></dt>
<dd><p>Table of power coefficients. Defaults to None and will be calculated using an empirical formula based on thrust coefficients unless specified (see TabulatedThrustTurbine).</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="thetis.options.TabulatedTidalTurbineOptions.thrust_coefficients">
<span class="sig-name descname"><span class="pre">thrust_coefficients</span></span><a class="headerlink" href="#thetis.options.TabulatedTidalTurbineOptions.thrust_coefficients" title="Link to this definition">¶</a></dt>
<dd><p>Table of thrust coefficients</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="thetis.options.TabulatedTidalTurbineOptions.thrust_speeds">
<span class="sig-name descname"><span class="pre">thrust_speeds</span></span><a class="headerlink" href="#thetis.options.TabulatedTidalTurbineOptions.thrust_speeds" title="Link to this definition">¶</a></dt>
<dd><p>List of speeds at which thrust_coefficients are applied.First and last entry function as cut-in and cut-out speeds respectively</p>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="thetis.options.TidalTurbineFarmOptions">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">thetis.options.</span></span><span class="sig-name descname"><span class="pre">TidalTurbineFarmOptions</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Any</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/options.html#TidalTurbineFarmOptions"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#thetis.options.TidalTurbineFarmOptions" title="Link to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#thetis.configuration.FrozenHasTraits" title="thetis.configuration.FrozenHasTraits"><code class="xref py py-class docutils literal notranslate"><span class="pre">FrozenHasTraits</span></code></a>, <code class="xref py py-class docutils literal notranslate"><span class="pre">TraitType</span></code></p>
<p>Tidal turbine farm options</p>
<dl class="py attribute">
<dt class="sig sig-object py" id="thetis.options.TidalTurbineFarmOptions.break_even_wattage">
<span class="sig-name descname"><span class="pre">break_even_wattage</span></span><a class="headerlink" href="#thetis.options.TidalTurbineFarmOptions.break_even_wattage" title="Link to this definition">¶</a></dt>
<dd><p>Average power production per turbine required to break even</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="thetis.options.TidalTurbineFarmOptions.name">
<span class="sig-name descname"><span class="pre">name</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/2.7/library/functions.html#str" title="(in Python v2.7)"><span class="pre">str</span></a><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/2.7/library/constants.html#None" title="(in Python v2.7)"><span class="pre">None</span></a></em><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">'Farm</span> <span class="pre">options'</span></em><a class="headerlink" href="#thetis.options.TidalTurbineFarmOptions.name" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="thetis.options.TidalTurbineFarmOptions.turbine_density">
<span class="sig-name descname"><span class="pre">turbine_density</span></span><a class="headerlink" href="#thetis.options.TidalTurbineFarmOptions.turbine_density" title="Link to this definition">¶</a></dt>
<dd><p>Density of turbines within the farm</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="thetis.options.TidalTurbineFarmOptions.turbine_options">
<span class="sig-name descname"><span class="pre">turbine_options</span></span><a class="headerlink" href="#thetis.options.TidalTurbineFarmOptions.turbine_options" title="Link to this definition">¶</a></dt>
<dd><p>A trait whose value must be an instance of a specified class.</p>
<p>The value can also be an instance of a subclass of the specified class.</p>
<p>Subclasses can declare default classes by overriding the klass attribute</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="thetis.options.TidalTurbineFarmOptions.turbine_type">
<span class="sig-name descname"><span class="pre">turbine_type</span></span><a class="headerlink" href="#thetis.options.TidalTurbineFarmOptions.turbine_type" title="Link to this definition">¶</a></dt>
<dd><p>Type of turbine thrust specification</p>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="thetis.options.TidalTurbineOptions">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">thetis.options.</span></span><span class="sig-name descname"><span class="pre">TidalTurbineOptions</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Any</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/options.html#TidalTurbineOptions"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#thetis.options.TidalTurbineOptions" title="Link to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#thetis.configuration.FrozenHasTraits" title="thetis.configuration.FrozenHasTraits"><code class="xref py py-class docutils literal notranslate"><span class="pre">FrozenHasTraits</span></code></a></p>
<p>Tidal turbine parameters</p>
<dl class="py attribute">
<dt class="sig sig-object py" id="thetis.options.TidalTurbineOptions.A_support">
<span class="sig-name descname"><span class="pre">A_support</span></span><a class="headerlink" href="#thetis.options.TidalTurbineOptions.A_support" title="Link to this definition">¶</a></dt>
<dd><p>Cross section of support structure</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="thetis.options.TidalTurbineOptions.C_support">
<span class="sig-name descname"><span class="pre">C_support</span></span><a class="headerlink" href="#thetis.options.TidalTurbineOptions.C_support" title="Link to this definition">¶</a></dt>
<dd><p>Thrust coefficient for support structure</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="thetis.options.TidalTurbineOptions.diameter">
<span class="sig-name descname"><span class="pre">diameter</span></span><a class="headerlink" href="#thetis.options.TidalTurbineOptions.diameter" title="Link to this definition">¶</a></dt>
<dd><p>Turbine diameter</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="thetis.options.TidalTurbineOptions.name">
<span class="sig-name descname"><span class="pre">name</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">'Tidal</span> <span class="pre">turbine</span> <span class="pre">options'</span></em><a class="headerlink" href="#thetis.options.TidalTurbineOptions.name" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="thetis.options.TidalTurbineOptions.projected_diameter">
<span class="sig-name descname"><span class="pre">projected_diameter</span></span><a class="headerlink" href="#thetis.options.TidalTurbineOptions.projected_diameter" title="Link to this definition">¶</a></dt>
<dd><p>Extent over which turbine drag is applied(defaults to diameter if not provided)</p>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="thetis.options.TimeStepperOptions">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">thetis.options.</span></span><span class="sig-name descname"><span class="pre">TimeStepperOptions</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Any</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/options.html#TimeStepperOptions"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#thetis.options.TimeStepperOptions" title="Link to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#thetis.configuration.FrozenHasTraits" title="thetis.configuration.FrozenHasTraits"><code class="xref py py-class docutils literal notranslate"><span class="pre">FrozenHasTraits</span></code></a></p>
<p>Base class for all time stepper options</p>
<dl class="py attribute">
<dt class="sig sig-object py" id="thetis.options.TimeStepperOptions.ad_block_tag">
<span class="sig-name descname"><span class="pre">ad_block_tag</span></span><a class="headerlink" href="#thetis.options.TimeStepperOptions.ad_block_tag" title="Link to this definition">¶</a></dt>
<dd><p>Custom tag for the Pyadjoint blocks generated by
this timestepper.</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="thetis.options.TimeStepperOptions.name">
<span class="sig-name descname"><span class="pre">name</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">'Time</span> <span class="pre">stepper'</span></em><a class="headerlink" href="#thetis.options.TimeStepperOptions.name" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="thetis.options.TimeStepperOptions.solver_parameters">
<span class="sig-name descname"><span class="pre">solver_parameters</span></span><a class="headerlink" href="#thetis.options.TimeStepperOptions.solver_parameters" title="Link to this definition">¶</a></dt>
<dd><p>PETSc solver options dictionary</p>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="thetis.options.TimeStepperOptions3d">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">thetis.options.</span></span><span class="sig-name descname"><span class="pre">TimeStepperOptions3d</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Any</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/options.html#TimeStepperOptions3d"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#thetis.options.TimeStepperOptions3d" title="Link to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#thetis.configuration.FrozenHasTraits" title="thetis.configuration.FrozenHasTraits"><code class="xref py py-class docutils literal notranslate"><span class="pre">FrozenHasTraits</span></code></a></p>
<p>Options for 3d explicit time integrator</p>
<dl class="py attribute">
<dt class="sig sig-object py" id="thetis.options.TimeStepperOptions3d.ad_block_tag">
<span class="sig-name descname"><span class="pre">ad_block_tag</span></span><a class="headerlink" href="#thetis.options.TimeStepperOptions3d.ad_block_tag" title="Link to this definition">¶</a></dt>
<dd><p>Custom tag for the Pyadjoint blocks generated by
this timestepper.</p>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="thetis.options.TracerFieldOptions">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">thetis.options.</span></span><span class="sig-name descname"><span class="pre">TracerFieldOptions</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Any</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/options.html#TracerFieldOptions"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#thetis.options.TracerFieldOptions" title="Link to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#thetis.configuration.FrozenHasTraits" title="thetis.configuration.FrozenHasTraits"><code class="xref py py-class docutils literal notranslate"><span class="pre">FrozenHasTraits</span></code></a></p>
<p>Tracer field options</p>
<dl class="py attribute">
<dt class="sig sig-object py" id="thetis.options.TracerFieldOptions.diffusivity">
<span class="sig-name descname"><span class="pre">diffusivity</span></span><a class="headerlink" href="#thetis.options.TracerFieldOptions.diffusivity" title="Link to this definition">¶</a></dt>
<dd><p>Diffusion coefficient for the tracer equation</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="thetis.options.TracerFieldOptions.function">
<span class="sig-name descname"><span class="pre">function</span></span><a class="headerlink" href="#thetis.options.TracerFieldOptions.function" title="Link to this definition">¶</a></dt>
<dd><p>Firedrake Function representing the tracer</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="thetis.options.TracerFieldOptions.metadata">
<span class="sig-name descname"><span class="pre">metadata</span></span><a class="headerlink" href="#thetis.options.TracerFieldOptions.metadata" title="Link to this definition">¶</a></dt>
<dd><p>Dictionary of metadata for the tracer field</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="thetis.options.TracerFieldOptions.name">
<span class="sig-name descname"><span class="pre">name</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">'Tracer</span> <span class="pre">options'</span></em><a class="headerlink" href="#thetis.options.TracerFieldOptions.name" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="thetis.options.TracerFieldOptions.source">
<span class="sig-name descname"><span class="pre">source</span></span><a class="headerlink" href="#thetis.options.TracerFieldOptions.source" title="Link to this definition">¶</a></dt>
<dd><p>Source term for the tracer equation</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="thetis.options.TracerFieldOptions.use_conservative_form">
<span class="sig-name descname"><span class="pre">use_conservative_form</span></span><a class="headerlink" href="#thetis.options.TracerFieldOptions.use_conservative_form" title="Link to this definition">¶</a></dt>
<dd><p>Should the tracer equation be solved in conservative form?</p>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="thetis.options.TurbulenceModelOptions">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">thetis.options.</span></span><span class="sig-name descname"><span class="pre">TurbulenceModelOptions</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Any</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/options.html#TurbulenceModelOptions"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#thetis.options.TurbulenceModelOptions" title="Link to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#thetis.configuration.FrozenHasTraits" title="thetis.configuration.FrozenHasTraits"><code class="xref py py-class docutils literal notranslate"><span class="pre">FrozenHasTraits</span></code></a></p>
<p>Abstract base class for all turbulence model options</p>
<dl class="py attribute">
<dt class="sig sig-object py" id="thetis.options.TurbulenceModelOptions.name">
<span class="sig-name descname"><span class="pre">name</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">'Turbulence</span> <span class="pre">closure</span> <span class="pre">model'</span></em><a class="headerlink" href="#thetis.options.TurbulenceModelOptions.name" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

</dd></dl>

</section>
<section id="module-thetis.physical_constants">
<span id="thetis-physical-constants-module"></span><h2>thetis.physical_constants module<a class="headerlink" href="#module-thetis.physical_constants" title="Link to this heading">¶</a></h2>
<p>Default values for physical constants and parameters</p>
</section>
<section id="module-thetis.rungekutta">
<span id="thetis-rungekutta-module"></span><h2>thetis.rungekutta module<a class="headerlink" href="#module-thetis.rungekutta" title="Link to this heading">¶</a></h2>
<p>Implements Runge-Kutta time integration methods.</p>
<p>The abstract class <a class="reference internal" href="#thetis.rungekutta.AbstractRKScheme" title="thetis.rungekutta.AbstractRKScheme"><code class="xref py py-class docutils literal notranslate"><span class="pre">AbstractRKScheme</span></code></a> defines the Runge-Kutta
coefficients, and can be used to implement generic time integrators.</p>
<dl class="py class">
<dt class="sig sig-object py" id="thetis.rungekutta.AbstractRKScheme">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">thetis.rungekutta.</span></span><span class="sig-name descname"><span class="pre">AbstractRKScheme</span></span><a class="reference internal" href="_modules/thetis/rungekutta.html#AbstractRKScheme"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#thetis.rungekutta.AbstractRKScheme" title="Link to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">ABC</span></code></p>
<p>Abstract class for defining Runge-Kutta schemes.</p>
<p>Derived classes must define the Butcher tableau (arrays <a class="reference internal" href="#thetis.rungekutta.AbstractRKScheme.a" title="thetis.rungekutta.AbstractRKScheme.a"><code class="xref py py-attr docutils literal notranslate"><span class="pre">a</span></code></a>, <a class="reference internal" href="#thetis.rungekutta.AbstractRKScheme.b" title="thetis.rungekutta.AbstractRKScheme.b"><code class="xref py py-attr docutils literal notranslate"><span class="pre">b</span></code></a>,
<a class="reference internal" href="#thetis.rungekutta.AbstractRKScheme.c" title="thetis.rungekutta.AbstractRKScheme.c"><code class="xref py py-attr docutils literal notranslate"><span class="pre">c</span></code></a>) and the CFL number (<a class="reference internal" href="#thetis.rungekutta.AbstractRKScheme.cfl_coeff" title="thetis.rungekutta.AbstractRKScheme.cfl_coeff"><code class="xref py py-attr docutils literal notranslate"><span class="pre">cfl_coeff</span></code></a>).</p>
<p>Currently only explicit or diagonally implicit schemes are supported.</p>
<dl class="py property">
<dt class="sig sig-object py" id="thetis.rungekutta.AbstractRKScheme.a">
<em class="property"><span class="pre">abstract</span><span class="w"> </span><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">a</span></span><a class="headerlink" href="#thetis.rungekutta.AbstractRKScheme.a" title="Link to this definition">¶</a></dt>
<dd><p>Runge-Kutta matrix <span class="math notranslate nohighlight">\(a_{i,j}\)</span> of the Butcher tableau</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="thetis.rungekutta.AbstractRKScheme.b">
<em class="property"><span class="pre">abstract</span><span class="w"> </span><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">b</span></span><a class="headerlink" href="#thetis.rungekutta.AbstractRKScheme.b" title="Link to this definition">¶</a></dt>
<dd><p>weights <span class="math notranslate nohighlight">\(b_{i}\)</span> of the Butcher tableau</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="thetis.rungekutta.AbstractRKScheme.c">
<em class="property"><span class="pre">abstract</span><span class="w"> </span><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">c</span></span><a class="headerlink" href="#thetis.rungekutta.AbstractRKScheme.c" title="Link to this definition">¶</a></dt>
<dd><p>nodes <span class="math notranslate nohighlight">\(c_{i}\)</span> of the Butcher tableau</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="thetis.rungekutta.AbstractRKScheme.cfl_coeff">
<em class="property"><span class="pre">abstract</span><span class="w"> </span><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">cfl_coeff</span></span><a class="headerlink" href="#thetis.rungekutta.AbstractRKScheme.cfl_coeff" title="Link to this definition">¶</a></dt>
<dd><p>CFL number of the scheme</p>
<p>Value 1.0 corresponds to Forward Euler time step.</p>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="thetis.rungekutta.BackwardEuler">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">thetis.rungekutta.</span></span><span class="sig-name descname"><span class="pre">BackwardEuler</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">equation</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">solution</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fields</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dt</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">options</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">bnd_conditions</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">terms_to_add</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'all'</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/rungekutta.html#BackwardEuler"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#thetis.rungekutta.BackwardEuler" title="Link to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#thetis.rungekutta.DIRKGeneric" title="thetis.rungekutta.DIRKGeneric"><code class="xref py py-class docutils literal notranslate"><span class="pre">DIRKGeneric</span></code></a>, <a class="reference internal" href="#thetis.rungekutta.BackwardEulerAbstract" title="thetis.rungekutta.BackwardEulerAbstract"><code class="xref py py-class docutils literal notranslate"><span class="pre">BackwardEulerAbstract</span></code></a></p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>equation</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">Equation</span></code> object) – the equation to solve</p></li>
<li><p><strong>solution</strong> – <code class="xref py py-class docutils literal notranslate"><span class="pre">Function</span></code> where solution will be stored</p></li>
<li><p><strong>fields</strong> (dict of <code class="xref py py-class docutils literal notranslate"><span class="pre">Function</span></code> or <code class="xref py py-class docutils literal notranslate"><span class="pre">Constant</span></code> objects) – Dictionary of fields that are passed to the equation</p></li>
<li><p><strong>dt</strong> (<a class="reference external" href="https://docs.python.org/2.7/library/functions.html#float" title="(in Python v2.7)"><em>float</em></a>) – time step in seconds</p></li>
<li><p><strong>options</strong> – <code class="xref py py-class docutils literal notranslate"><span class="pre">TimeStepperOptions</span></code> instance containing parameter values.</p></li>
<li><p><strong>bnd_conditions</strong> (<a class="reference external" href="https://docs.python.org/2.7/library/stdtypes.html#dict" title="(in Python v2.7)"><em>dict</em></a>) – Dictionary of boundary conditions passed to the equation</p></li>
<li><p><strong>terms_to_add</strong> (<em>'all'</em><em> or </em><em>list</em><em> of </em><em>'implicit'</em><em>, </em><em>'explicit'</em><em>, </em><em>'source'.</em>) – Defines which terms of the equation are to be
added to this solver. Default ‘all’ implies [‘implicit’, ‘explicit’, ‘source’].</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="thetis.rungekutta.BackwardEulerAbstract">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">thetis.rungekutta.</span></span><span class="sig-name descname"><span class="pre">BackwardEulerAbstract</span></span><a class="reference internal" href="_modules/thetis/rungekutta.html#BackwardEulerAbstract"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#thetis.rungekutta.BackwardEulerAbstract" title="Link to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#thetis.rungekutta.AbstractRKScheme" title="thetis.rungekutta.AbstractRKScheme"><code class="xref py py-class docutils literal notranslate"><span class="pre">AbstractRKScheme</span></code></a></p>
<p>Backward Euler method</p>
<dl class="py attribute">
<dt class="sig sig-object py" id="thetis.rungekutta.BackwardEulerAbstract.a">
<span class="sig-name descname"><span class="pre">a</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">[[1.0]]</span></em><a class="headerlink" href="#thetis.rungekutta.BackwardEulerAbstract.a" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="thetis.rungekutta.BackwardEulerAbstract.b">
<span class="sig-name descname"><span class="pre">b</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">[1.0]</span></em><a class="headerlink" href="#thetis.rungekutta.BackwardEulerAbstract.b" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="thetis.rungekutta.BackwardEulerAbstract.c">
<span class="sig-name descname"><span class="pre">c</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">[1.0]</span></em><a class="headerlink" href="#thetis.rungekutta.BackwardEulerAbstract.c" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="thetis.rungekutta.BackwardEulerAbstract.cfl_coeff">
<span class="sig-name descname"><span class="pre">cfl_coeff</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">inf</span></em><a class="headerlink" href="#thetis.rungekutta.BackwardEulerAbstract.cfl_coeff" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="thetis.rungekutta.BackwardEulerUForm">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">thetis.rungekutta.</span></span><span class="sig-name descname"><span class="pre">BackwardEulerUForm</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">equation</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">solution</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fields</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dt</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">options</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">bnd_conditions</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">terms_to_add</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'all'</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/rungekutta.html#BackwardEulerUForm"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#thetis.rungekutta.BackwardEulerUForm" title="Link to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#thetis.rungekutta.DIRKGenericUForm" title="thetis.rungekutta.DIRKGenericUForm"><code class="xref py py-class docutils literal notranslate"><span class="pre">DIRKGenericUForm</span></code></a>, <a class="reference internal" href="#thetis.rungekutta.BackwardEulerAbstract" title="thetis.rungekutta.BackwardEulerAbstract"><code class="xref py py-class docutils literal notranslate"><span class="pre">BackwardEulerAbstract</span></code></a></p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>equation</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">Equation</span></code> object) – the equation to solve</p></li>
<li><p><strong>solution</strong> – <code class="xref py py-class docutils literal notranslate"><span class="pre">Function</span></code> where solution will be stored</p></li>
<li><p><strong>fields</strong> (dict of <code class="xref py py-class docutils literal notranslate"><span class="pre">Function</span></code> or <code class="xref py py-class docutils literal notranslate"><span class="pre">Constant</span></code> objects) – Dictionary of fields that are passed to the equation</p></li>
<li><p><strong>dt</strong> (<a class="reference external" href="https://docs.python.org/2.7/library/functions.html#float" title="(in Python v2.7)"><em>float</em></a>) – time step in seconds</p></li>
<li><p><strong>options</strong> – <code class="xref py py-class docutils literal notranslate"><span class="pre">TimeStepperOptions</span></code> instance containing parameter values.</p></li>
<li><p><strong>bnd_conditions</strong> (<a class="reference external" href="https://docs.python.org/2.7/library/stdtypes.html#dict" title="(in Python v2.7)"><em>dict</em></a>) – Dictionary of boundary conditions passed to the equation</p></li>
<li><p><strong>terms_to_add</strong> (<em>'all'</em><em> or </em><em>list</em><em> of </em><em>'implicit'</em><em>, </em><em>'explicit'</em><em>, </em><em>'source'.</em>) – Defines which terms of the equation are to be
added to this solver. Default ‘all’ implies [‘implicit’, ‘explicit’, ‘source’].</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="thetis.rungekutta.CrankNicolsonAbstract">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">thetis.rungekutta.</span></span><span class="sig-name descname"><span class="pre">CrankNicolsonAbstract</span></span><a class="reference internal" href="_modules/thetis/rungekutta.html#CrankNicolsonAbstract"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#thetis.rungekutta.CrankNicolsonAbstract" title="Link to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#thetis.rungekutta.AbstractRKScheme" title="thetis.rungekutta.AbstractRKScheme"><code class="xref py py-class docutils literal notranslate"><span class="pre">AbstractRKScheme</span></code></a></p>
<p>Crack-Nicolson scheme</p>
<dl class="py attribute">
<dt class="sig sig-object py" id="thetis.rungekutta.CrankNicolsonAbstract.a">
<span class="sig-name descname"><span class="pre">a</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">[[0.0,</span> <span class="pre">0.0],</span> <span class="pre">[0.5,</span> <span class="pre">0.5]]</span></em><a class="headerlink" href="#thetis.rungekutta.CrankNicolsonAbstract.a" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="thetis.rungekutta.CrankNicolsonAbstract.b">
<span class="sig-name descname"><span class="pre">b</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">[0.5,</span> <span class="pre">0.5]</span></em><a class="headerlink" href="#thetis.rungekutta.CrankNicolsonAbstract.b" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="thetis.rungekutta.CrankNicolsonAbstract.c">
<span class="sig-name descname"><span class="pre">c</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">[0.0,</span> <span class="pre">1.0]</span></em><a class="headerlink" href="#thetis.rungekutta.CrankNicolsonAbstract.c" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="thetis.rungekutta.CrankNicolsonAbstract.cfl_coeff">
<span class="sig-name descname"><span class="pre">cfl_coeff</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">inf</span></em><a class="headerlink" href="#thetis.rungekutta.CrankNicolsonAbstract.cfl_coeff" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="thetis.rungekutta.CrankNicolsonRK">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">thetis.rungekutta.</span></span><span class="sig-name descname"><span class="pre">CrankNicolsonRK</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">equation</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">solution</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fields</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dt</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">options</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">bnd_conditions</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">terms_to_add</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'all'</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/rungekutta.html#CrankNicolsonRK"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#thetis.rungekutta.CrankNicolsonRK" title="Link to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#thetis.rungekutta.DIRKGeneric" title="thetis.rungekutta.DIRKGeneric"><code class="xref py py-class docutils literal notranslate"><span class="pre">DIRKGeneric</span></code></a>, <a class="reference internal" href="#thetis.rungekutta.CrankNicolsonAbstract" title="thetis.rungekutta.CrankNicolsonAbstract"><code class="xref py py-class docutils literal notranslate"><span class="pre">CrankNicolsonAbstract</span></code></a></p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>equation</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">Equation</span></code> object) – the equation to solve</p></li>
<li><p><strong>solution</strong> – <code class="xref py py-class docutils literal notranslate"><span class="pre">Function</span></code> where solution will be stored</p></li>
<li><p><strong>fields</strong> (dict of <code class="xref py py-class docutils literal notranslate"><span class="pre">Function</span></code> or <code class="xref py py-class docutils literal notranslate"><span class="pre">Constant</span></code> objects) – Dictionary of fields that are passed to the equation</p></li>
<li><p><strong>dt</strong> (<a class="reference external" href="https://docs.python.org/2.7/library/functions.html#float" title="(in Python v2.7)"><em>float</em></a>) – time step in seconds</p></li>
<li><p><strong>options</strong> – <code class="xref py py-class docutils literal notranslate"><span class="pre">TimeStepperOptions</span></code> instance containing parameter values.</p></li>
<li><p><strong>bnd_conditions</strong> (<a class="reference external" href="https://docs.python.org/2.7/library/stdtypes.html#dict" title="(in Python v2.7)"><em>dict</em></a>) – Dictionary of boundary conditions passed to the equation</p></li>
<li><p><strong>terms_to_add</strong> (<em>'all'</em><em> or </em><em>list</em><em> of </em><em>'implicit'</em><em>, </em><em>'explicit'</em><em>, </em><em>'source'.</em>) – Defines which terms of the equation are to be
added to this solver. Default ‘all’ implies [‘implicit’, ‘explicit’, ‘source’].</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="thetis.rungekutta.DIRK22">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">thetis.rungekutta.</span></span><span class="sig-name descname"><span class="pre">DIRK22</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">equation</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">solution</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fields</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dt</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">options</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">bnd_conditions</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">terms_to_add</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'all'</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/rungekutta.html#DIRK22"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#thetis.rungekutta.DIRK22" title="Link to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#thetis.rungekutta.DIRKGeneric" title="thetis.rungekutta.DIRKGeneric"><code class="xref py py-class docutils literal notranslate"><span class="pre">DIRKGeneric</span></code></a>, <a class="reference internal" href="#thetis.rungekutta.DIRK22Abstract" title="thetis.rungekutta.DIRK22Abstract"><code class="xref py py-class docutils literal notranslate"><span class="pre">DIRK22Abstract</span></code></a></p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>equation</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">Equation</span></code> object) – the equation to solve</p></li>
<li><p><strong>solution</strong> – <code class="xref py py-class docutils literal notranslate"><span class="pre">Function</span></code> where solution will be stored</p></li>
<li><p><strong>fields</strong> (dict of <code class="xref py py-class docutils literal notranslate"><span class="pre">Function</span></code> or <code class="xref py py-class docutils literal notranslate"><span class="pre">Constant</span></code> objects) – Dictionary of fields that are passed to the equation</p></li>
<li><p><strong>dt</strong> (<a class="reference external" href="https://docs.python.org/2.7/library/functions.html#float" title="(in Python v2.7)"><em>float</em></a>) – time step in seconds</p></li>
<li><p><strong>options</strong> – <code class="xref py py-class docutils literal notranslate"><span class="pre">TimeStepperOptions</span></code> instance containing parameter values.</p></li>
<li><p><strong>bnd_conditions</strong> (<a class="reference external" href="https://docs.python.org/2.7/library/stdtypes.html#dict" title="(in Python v2.7)"><em>dict</em></a>) – Dictionary of boundary conditions passed to the equation</p></li>
<li><p><strong>terms_to_add</strong> (<em>'all'</em><em> or </em><em>list</em><em> of </em><em>'implicit'</em><em>, </em><em>'explicit'</em><em>, </em><em>'source'.</em>) – Defines which terms of the equation are to be
added to this solver. Default ‘all’ implies [‘implicit’, ‘explicit’, ‘source’].</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="thetis.rungekutta.DIRK22Abstract">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">thetis.rungekutta.</span></span><span class="sig-name descname"><span class="pre">DIRK22Abstract</span></span><a class="reference internal" href="_modules/thetis/rungekutta.html#DIRK22Abstract"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#thetis.rungekutta.DIRK22Abstract" title="Link to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#thetis.rungekutta.AbstractRKScheme" title="thetis.rungekutta.AbstractRKScheme"><code class="xref py py-class docutils literal notranslate"><span class="pre">AbstractRKScheme</span></code></a></p>
<p>2-stage, 2nd order, L-stable Diagonally Implicit Runge Kutta method</p>
<p>This method has the Butcher tableau</p>
<div class="math notranslate nohighlight">
\[\begin{split}\begin{array}{c|cc}
\gamma &amp;   \gamma &amp;       0 \\
      1 &amp; 1-\gamma &amp; \gamma \\ \hline
        &amp;       1/2 &amp;     1/2
\end{array}\end{split}\]</div>
<p>with <span class="math notranslate nohighlight">\(\gamma = (2 - \sqrt{2})/2\)</span>.</p>
<p>From DIRK(2,3,2) IMEX scheme in Ascher et al. (1997)</p>
<p>Ascher et al. (1997). Implicit-explicit Runge-Kutta methods for
time-dependent partial differential equations. Applied Numerical
Mathematics, 25:151-167. <a class="reference external" href="http://dx.doi.org/10.1137/0732037">http://dx.doi.org/10.1137/0732037</a></p>
<dl class="py attribute">
<dt class="sig sig-object py" id="thetis.rungekutta.DIRK22Abstract.a">
<span class="sig-name descname"><span class="pre">a</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">[[np.float64(0.2928932188134524),</span> <span class="pre">0],</span> <span class="pre">[np.float64(0.7071067811865476),</span> <span class="pre">np.float64(0.2928932188134524)]]</span></em><a class="headerlink" href="#thetis.rungekutta.DIRK22Abstract.a" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="thetis.rungekutta.DIRK22Abstract.b">
<span class="sig-name descname"><span class="pre">b</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">[np.float64(0.7071067811865476),</span> <span class="pre">np.float64(0.2928932188134524)]</span></em><a class="headerlink" href="#thetis.rungekutta.DIRK22Abstract.b" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="thetis.rungekutta.DIRK22Abstract.c">
<span class="sig-name descname"><span class="pre">c</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">[np.float64(0.2928932188134524),</span> <span class="pre">1]</span></em><a class="headerlink" href="#thetis.rungekutta.DIRK22Abstract.c" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="thetis.rungekutta.DIRK22Abstract.cfl_coeff">
<span class="sig-name descname"><span class="pre">cfl_coeff</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">inf</span></em><a class="headerlink" href="#thetis.rungekutta.DIRK22Abstract.cfl_coeff" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="thetis.rungekutta.DIRK22Abstract.gamma">
<span class="sig-name descname"><span class="pre">gamma</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">np.float64(0.2928932188134524)</span></em><a class="headerlink" href="#thetis.rungekutta.DIRK22Abstract.gamma" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="thetis.rungekutta.DIRK22UForm">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">thetis.rungekutta.</span></span><span class="sig-name descname"><span class="pre">DIRK22UForm</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">equation</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">solution</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fields</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dt</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">options</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">bnd_conditions</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">terms_to_add</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'all'</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/rungekutta.html#DIRK22UForm"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#thetis.rungekutta.DIRK22UForm" title="Link to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#thetis.rungekutta.DIRKGenericUForm" title="thetis.rungekutta.DIRKGenericUForm"><code class="xref py py-class docutils literal notranslate"><span class="pre">DIRKGenericUForm</span></code></a>, <a class="reference internal" href="#thetis.rungekutta.DIRK22Abstract" title="thetis.rungekutta.DIRK22Abstract"><code class="xref py py-class docutils literal notranslate"><span class="pre">DIRK22Abstract</span></code></a></p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>equation</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">Equation</span></code> object) – the equation to solve</p></li>
<li><p><strong>solution</strong> – <code class="xref py py-class docutils literal notranslate"><span class="pre">Function</span></code> where solution will be stored</p></li>
<li><p><strong>fields</strong> (dict of <code class="xref py py-class docutils literal notranslate"><span class="pre">Function</span></code> or <code class="xref py py-class docutils literal notranslate"><span class="pre">Constant</span></code> objects) – Dictionary of fields that are passed to the equation</p></li>
<li><p><strong>dt</strong> (<a class="reference external" href="https://docs.python.org/2.7/library/functions.html#float" title="(in Python v2.7)"><em>float</em></a>) – time step in seconds</p></li>
<li><p><strong>options</strong> – <code class="xref py py-class docutils literal notranslate"><span class="pre">TimeStepperOptions</span></code> instance containing parameter values.</p></li>
<li><p><strong>bnd_conditions</strong> (<a class="reference external" href="https://docs.python.org/2.7/library/stdtypes.html#dict" title="(in Python v2.7)"><em>dict</em></a>) – Dictionary of boundary conditions passed to the equation</p></li>
<li><p><strong>terms_to_add</strong> (<em>'all'</em><em> or </em><em>list</em><em> of </em><em>'implicit'</em><em>, </em><em>'explicit'</em><em>, </em><em>'source'.</em>) – Defines which terms of the equation are to be
added to this solver. Default ‘all’ implies [‘implicit’, ‘explicit’, ‘source’].</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="thetis.rungekutta.DIRK23">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">thetis.rungekutta.</span></span><span class="sig-name descname"><span class="pre">DIRK23</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">equation</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">solution</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fields</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dt</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">options</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">bnd_conditions</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">terms_to_add</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'all'</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/rungekutta.html#DIRK23"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#thetis.rungekutta.DIRK23" title="Link to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#thetis.rungekutta.DIRKGeneric" title="thetis.rungekutta.DIRKGeneric"><code class="xref py py-class docutils literal notranslate"><span class="pre">DIRKGeneric</span></code></a>, <a class="reference internal" href="#thetis.rungekutta.DIRK23Abstract" title="thetis.rungekutta.DIRK23Abstract"><code class="xref py py-class docutils literal notranslate"><span class="pre">DIRK23Abstract</span></code></a></p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>equation</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">Equation</span></code> object) – the equation to solve</p></li>
<li><p><strong>solution</strong> – <code class="xref py py-class docutils literal notranslate"><span class="pre">Function</span></code> where solution will be stored</p></li>
<li><p><strong>fields</strong> (dict of <code class="xref py py-class docutils literal notranslate"><span class="pre">Function</span></code> or <code class="xref py py-class docutils literal notranslate"><span class="pre">Constant</span></code> objects) – Dictionary of fields that are passed to the equation</p></li>
<li><p><strong>dt</strong> (<a class="reference external" href="https://docs.python.org/2.7/library/functions.html#float" title="(in Python v2.7)"><em>float</em></a>) – time step in seconds</p></li>
<li><p><strong>options</strong> – <code class="xref py py-class docutils literal notranslate"><span class="pre">TimeStepperOptions</span></code> instance containing parameter values.</p></li>
<li><p><strong>bnd_conditions</strong> (<a class="reference external" href="https://docs.python.org/2.7/library/stdtypes.html#dict" title="(in Python v2.7)"><em>dict</em></a>) – Dictionary of boundary conditions passed to the equation</p></li>
<li><p><strong>terms_to_add</strong> (<em>'all'</em><em> or </em><em>list</em><em> of </em><em>'implicit'</em><em>, </em><em>'explicit'</em><em>, </em><em>'source'.</em>) – Defines which terms of the equation are to be
added to this solver. Default ‘all’ implies [‘implicit’, ‘explicit’, ‘source’].</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="thetis.rungekutta.DIRK23Abstract">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">thetis.rungekutta.</span></span><span class="sig-name descname"><span class="pre">DIRK23Abstract</span></span><a class="reference internal" href="_modules/thetis/rungekutta.html#DIRK23Abstract"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#thetis.rungekutta.DIRK23Abstract" title="Link to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#thetis.rungekutta.AbstractRKScheme" title="thetis.rungekutta.AbstractRKScheme"><code class="xref py py-class docutils literal notranslate"><span class="pre">AbstractRKScheme</span></code></a></p>
<p>2-stage, 3rd order Diagonally Implicit Runge Kutta method</p>
<p>This method has the Butcher tableau</p>
<div class="math notranslate nohighlight">
\[\begin{split}\begin{array}{c|cc}
  \gamma &amp;    \gamma &amp;       0 \\
1-\gamma &amp; 1-2\gamma &amp; \gamma \\ \hline
          &amp;        1/2 &amp;     1/2
\end{array}\end{split}\]</div>
<p>with <span class="math notranslate nohighlight">\(\gamma = (3 + \sqrt{3})/6\)</span>.</p>
<p>From DIRK(2,3,3) IMEX scheme in Ascher et al. (1997)</p>
<p>Ascher et al. (1997). Implicit-explicit Runge-Kutta methods for
time-dependent partial differential equations. Applied Numerical
Mathematics, 25:151-167. <a class="reference external" href="http://dx.doi.org/10.1137/0732037">http://dx.doi.org/10.1137/0732037</a></p>
<dl class="py attribute">
<dt class="sig sig-object py" id="thetis.rungekutta.DIRK23Abstract.a">
<span class="sig-name descname"><span class="pre">a</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">[[np.float64(0.7886751345948128),</span> <span class="pre">0],</span> <span class="pre">[np.float64(-0.5773502691896255),</span> <span class="pre">np.float64(0.7886751345948128)]]</span></em><a class="headerlink" href="#thetis.rungekutta.DIRK23Abstract.a" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="thetis.rungekutta.DIRK23Abstract.b">
<span class="sig-name descname"><span class="pre">b</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">[0.5,</span> <span class="pre">0.5]</span></em><a class="headerlink" href="#thetis.rungekutta.DIRK23Abstract.b" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="thetis.rungekutta.DIRK23Abstract.c">
<span class="sig-name descname"><span class="pre">c</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">[np.float64(0.7886751345948128),</span> <span class="pre">np.float64(0.21132486540518725)]</span></em><a class="headerlink" href="#thetis.rungekutta.DIRK23Abstract.c" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="thetis.rungekutta.DIRK23Abstract.cfl_coeff">
<span class="sig-name descname"><span class="pre">cfl_coeff</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">inf</span></em><a class="headerlink" href="#thetis.rungekutta.DIRK23Abstract.cfl_coeff" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="thetis.rungekutta.DIRK23Abstract.gamma">
<span class="sig-name descname"><span class="pre">gamma</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">np.float64(0.7886751345948128)</span></em><a class="headerlink" href="#thetis.rungekutta.DIRK23Abstract.gamma" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="thetis.rungekutta.DIRK33">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">thetis.rungekutta.</span></span><span class="sig-name descname"><span class="pre">DIRK33</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">equation</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">solution</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fields</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dt</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">options</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">bnd_conditions</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">terms_to_add</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'all'</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/rungekutta.html#DIRK33"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#thetis.rungekutta.DIRK33" title="Link to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#thetis.rungekutta.DIRKGeneric" title="thetis.rungekutta.DIRKGeneric"><code class="xref py py-class docutils literal notranslate"><span class="pre">DIRKGeneric</span></code></a>, <a class="reference internal" href="#thetis.rungekutta.DIRK33Abstract" title="thetis.rungekutta.DIRK33Abstract"><code class="xref py py-class docutils literal notranslate"><span class="pre">DIRK33Abstract</span></code></a></p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>equation</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">Equation</span></code> object) – the equation to solve</p></li>
<li><p><strong>solution</strong> – <code class="xref py py-class docutils literal notranslate"><span class="pre">Function</span></code> where solution will be stored</p></li>
<li><p><strong>fields</strong> (dict of <code class="xref py py-class docutils literal notranslate"><span class="pre">Function</span></code> or <code class="xref py py-class docutils literal notranslate"><span class="pre">Constant</span></code> objects) – Dictionary of fields that are passed to the equation</p></li>
<li><p><strong>dt</strong> (<a class="reference external" href="https://docs.python.org/2.7/library/functions.html#float" title="(in Python v2.7)"><em>float</em></a>) – time step in seconds</p></li>
<li><p><strong>options</strong> – <code class="xref py py-class docutils literal notranslate"><span class="pre">TimeStepperOptions</span></code> instance containing parameter values.</p></li>
<li><p><strong>bnd_conditions</strong> (<a class="reference external" href="https://docs.python.org/2.7/library/stdtypes.html#dict" title="(in Python v2.7)"><em>dict</em></a>) – Dictionary of boundary conditions passed to the equation</p></li>
<li><p><strong>terms_to_add</strong> (<em>'all'</em><em> or </em><em>list</em><em> of </em><em>'implicit'</em><em>, </em><em>'explicit'</em><em>, </em><em>'source'.</em>) – Defines which terms of the equation are to be
added to this solver. Default ‘all’ implies [‘implicit’, ‘explicit’, ‘source’].</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="thetis.rungekutta.DIRK33Abstract">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">thetis.rungekutta.</span></span><span class="sig-name descname"><span class="pre">DIRK33Abstract</span></span><a class="reference internal" href="_modules/thetis/rungekutta.html#DIRK33Abstract"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#thetis.rungekutta.DIRK33Abstract" title="Link to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#thetis.rungekutta.AbstractRKScheme" title="thetis.rungekutta.AbstractRKScheme"><code class="xref py py-class docutils literal notranslate"><span class="pre">AbstractRKScheme</span></code></a></p>
<p>3-stage, 3rd order, L-stable Diagonally Implicit Runge Kutta method</p>
<p>From DIRK(3,4,3) IMEX scheme in Ascher et al. (1997)</p>
<p>Ascher et al. (1997). Implicit-explicit Runge-Kutta methods for
time-dependent partial differential equations. Applied Numerical
Mathematics, 25:151-167. <a class="reference external" href="http://dx.doi.org/10.1137/0732037">http://dx.doi.org/10.1137/0732037</a></p>
<dl class="py attribute">
<dt class="sig sig-object py" id="thetis.rungekutta.DIRK33Abstract.a">
<span class="sig-name descname"><span class="pre">a</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">[[0.4358665215,</span> <span class="pre">0,</span> <span class="pre">0],</span> <span class="pre">[0.28206673925000003,</span> <span class="pre">0.4358665215,</span> <span class="pre">0],</span> <span class="pre">[1.208496649153235,</span> <span class="pre">-0.6443631706532353,</span> <span class="pre">0.4358665215]]</span></em><a class="headerlink" href="#thetis.rungekutta.DIRK33Abstract.a" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="thetis.rungekutta.DIRK33Abstract.b">
<span class="sig-name descname"><span class="pre">b</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">[1.208496649153235,</span> <span class="pre">-0.6443631706532353,</span> <span class="pre">0.4358665215]</span></em><a class="headerlink" href="#thetis.rungekutta.DIRK33Abstract.b" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="thetis.rungekutta.DIRK33Abstract.b1">
<span class="sig-name descname"><span class="pre">b1</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">1.208496649153235</span></em><a class="headerlink" href="#thetis.rungekutta.DIRK33Abstract.b1" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="thetis.rungekutta.DIRK33Abstract.b2">
<span class="sig-name descname"><span class="pre">b2</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">-0.6443631706532353</span></em><a class="headerlink" href="#thetis.rungekutta.DIRK33Abstract.b2" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="thetis.rungekutta.DIRK33Abstract.c">
<span class="sig-name descname"><span class="pre">c</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">[0.4358665215,</span> <span class="pre">0.71793326075,</span> <span class="pre">1]</span></em><a class="headerlink" href="#thetis.rungekutta.DIRK33Abstract.c" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="thetis.rungekutta.DIRK33Abstract.cfl_coeff">
<span class="sig-name descname"><span class="pre">cfl_coeff</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">inf</span></em><a class="headerlink" href="#thetis.rungekutta.DIRK33Abstract.cfl_coeff" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="thetis.rungekutta.DIRK33Abstract.gamma">
<span class="sig-name descname"><span class="pre">gamma</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">0.4358665215</span></em><a class="headerlink" href="#thetis.rungekutta.DIRK33Abstract.gamma" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="thetis.rungekutta.DIRK33UForm">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">thetis.rungekutta.</span></span><span class="sig-name descname"><span class="pre">DIRK33UForm</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">equation</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">solution</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fields</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dt</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">options</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">bnd_conditions</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">terms_to_add</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'all'</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/rungekutta.html#DIRK33UForm"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#thetis.rungekutta.DIRK33UForm" title="Link to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#thetis.rungekutta.DIRKGenericUForm" title="thetis.rungekutta.DIRKGenericUForm"><code class="xref py py-class docutils literal notranslate"><span class="pre">DIRKGenericUForm</span></code></a>, <a class="reference internal" href="#thetis.rungekutta.DIRK33Abstract" title="thetis.rungekutta.DIRK33Abstract"><code class="xref py py-class docutils literal notranslate"><span class="pre">DIRK33Abstract</span></code></a></p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>equation</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">Equation</span></code> object) – the equation to solve</p></li>
<li><p><strong>solution</strong> – <code class="xref py py-class docutils literal notranslate"><span class="pre">Function</span></code> where solution will be stored</p></li>
<li><p><strong>fields</strong> (dict of <code class="xref py py-class docutils literal notranslate"><span class="pre">Function</span></code> or <code class="xref py py-class docutils literal notranslate"><span class="pre">Constant</span></code> objects) – Dictionary of fields that are passed to the equation</p></li>
<li><p><strong>dt</strong> (<a class="reference external" href="https://docs.python.org/2.7/library/functions.html#float" title="(in Python v2.7)"><em>float</em></a>) – time step in seconds</p></li>
<li><p><strong>options</strong> – <code class="xref py py-class docutils literal notranslate"><span class="pre">TimeStepperOptions</span></code> instance containing parameter values.</p></li>
<li><p><strong>bnd_conditions</strong> (<a class="reference external" href="https://docs.python.org/2.7/library/stdtypes.html#dict" title="(in Python v2.7)"><em>dict</em></a>) – Dictionary of boundary conditions passed to the equation</p></li>
<li><p><strong>terms_to_add</strong> (<em>'all'</em><em> or </em><em>list</em><em> of </em><em>'implicit'</em><em>, </em><em>'explicit'</em><em>, </em><em>'source'.</em>) – Defines which terms of the equation are to be
added to this solver. Default ‘all’ implies [‘implicit’, ‘explicit’, ‘source’].</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="thetis.rungekutta.DIRK43">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">thetis.rungekutta.</span></span><span class="sig-name descname"><span class="pre">DIRK43</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">equation</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">solution</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fields</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dt</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">options</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">bnd_conditions</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">terms_to_add</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'all'</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/rungekutta.html#DIRK43"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#thetis.rungekutta.DIRK43" title="Link to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#thetis.rungekutta.DIRKGeneric" title="thetis.rungekutta.DIRKGeneric"><code class="xref py py-class docutils literal notranslate"><span class="pre">DIRKGeneric</span></code></a>, <a class="reference internal" href="#thetis.rungekutta.DIRK43Abstract" title="thetis.rungekutta.DIRK43Abstract"><code class="xref py py-class docutils literal notranslate"><span class="pre">DIRK43Abstract</span></code></a></p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>equation</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">Equation</span></code> object) – the equation to solve</p></li>
<li><p><strong>solution</strong> – <code class="xref py py-class docutils literal notranslate"><span class="pre">Function</span></code> where solution will be stored</p></li>
<li><p><strong>fields</strong> (dict of <code class="xref py py-class docutils literal notranslate"><span class="pre">Function</span></code> or <code class="xref py py-class docutils literal notranslate"><span class="pre">Constant</span></code> objects) – Dictionary of fields that are passed to the equation</p></li>
<li><p><strong>dt</strong> (<a class="reference external" href="https://docs.python.org/2.7/library/functions.html#float" title="(in Python v2.7)"><em>float</em></a>) – time step in seconds</p></li>
<li><p><strong>options</strong> – <code class="xref py py-class docutils literal notranslate"><span class="pre">TimeStepperOptions</span></code> instance containing parameter values.</p></li>
<li><p><strong>bnd_conditions</strong> (<a class="reference external" href="https://docs.python.org/2.7/library/stdtypes.html#dict" title="(in Python v2.7)"><em>dict</em></a>) – Dictionary of boundary conditions passed to the equation</p></li>
<li><p><strong>terms_to_add</strong> (<em>'all'</em><em> or </em><em>list</em><em> of </em><em>'implicit'</em><em>, </em><em>'explicit'</em><em>, </em><em>'source'.</em>) – Defines which terms of the equation are to be
added to this solver. Default ‘all’ implies [‘implicit’, ‘explicit’, ‘source’].</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="thetis.rungekutta.DIRK43Abstract">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">thetis.rungekutta.</span></span><span class="sig-name descname"><span class="pre">DIRK43Abstract</span></span><a class="reference internal" href="_modules/thetis/rungekutta.html#DIRK43Abstract"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#thetis.rungekutta.DIRK43Abstract" title="Link to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#thetis.rungekutta.AbstractRKScheme" title="thetis.rungekutta.AbstractRKScheme"><code class="xref py py-class docutils literal notranslate"><span class="pre">AbstractRKScheme</span></code></a></p>
<p>4-stage, 3rd order, L-stable Diagonally Implicit Runge Kutta method</p>
<p>From DIRK(4,4,3) IMEX scheme in Ascher et al. (1997)</p>
<p>Ascher et al. (1997). Implicit-explicit Runge-Kutta methods for
time-dependent partial differential equations. Applied Numerical
Mathematics, 25:151-167. <a class="reference external" href="http://dx.doi.org/10.1137/0732037">http://dx.doi.org/10.1137/0732037</a></p>
<dl class="py attribute">
<dt class="sig sig-object py" id="thetis.rungekutta.DIRK43Abstract.a">
<span class="sig-name descname"><span class="pre">a</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">[[0.5,</span> <span class="pre">0,</span> <span class="pre">0,</span> <span class="pre">0],</span> <span class="pre">[0.16666666666666666,</span> <span class="pre">0.5,</span> <span class="pre">0,</span> <span class="pre">0],</span> <span class="pre">[-0.5,</span> <span class="pre">0.5,</span> <span class="pre">0.5,</span> <span class="pre">0],</span> <span class="pre">[1.5,</span> <span class="pre">-1.5,</span> <span class="pre">0.5,</span> <span class="pre">0.5]]</span></em><a class="headerlink" href="#thetis.rungekutta.DIRK43Abstract.a" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="thetis.rungekutta.DIRK43Abstract.b">
<span class="sig-name descname"><span class="pre">b</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">[1.5,</span> <span class="pre">-1.5,</span> <span class="pre">0.5,</span> <span class="pre">0.5]</span></em><a class="headerlink" href="#thetis.rungekutta.DIRK43Abstract.b" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="thetis.rungekutta.DIRK43Abstract.c">
<span class="sig-name descname"><span class="pre">c</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">[0.5,</span> <span class="pre">0.6666666666666666,</span> <span class="pre">0.5,</span> <span class="pre">1.0]</span></em><a class="headerlink" href="#thetis.rungekutta.DIRK43Abstract.c" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="thetis.rungekutta.DIRK43Abstract.cfl_coeff">
<span class="sig-name descname"><span class="pre">cfl_coeff</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">inf</span></em><a class="headerlink" href="#thetis.rungekutta.DIRK43Abstract.cfl_coeff" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="thetis.rungekutta.DIRKGeneric">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">thetis.rungekutta.</span></span><span class="sig-name descname"><span class="pre">DIRKGeneric</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">equation</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">solution</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fields</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dt</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">options</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">bnd_conditions</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">terms_to_add</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'all'</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/rungekutta.html#DIRKGeneric"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#thetis.rungekutta.DIRKGeneric" title="Link to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#thetis.rungekutta.RungeKuttaTimeIntegrator" title="thetis.rungekutta.RungeKuttaTimeIntegrator"><code class="xref py py-class docutils literal notranslate"><span class="pre">RungeKuttaTimeIntegrator</span></code></a></p>
<p>Generic implementation of Diagonally Implicit Runge Kutta schemes.</p>
<p>All derived classes must define the Butcher tableau coefficients <code class="xref py py-attr docutils literal notranslate"><span class="pre">a</span></code>,
<code class="xref py py-attr docutils literal notranslate"><span class="pre">b</span></code>, <code class="xref py py-attr docutils literal notranslate"><span class="pre">c</span></code>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>equation</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">Equation</span></code> object) – the equation to solve</p></li>
<li><p><strong>solution</strong> – <code class="xref py py-class docutils literal notranslate"><span class="pre">Function</span></code> where solution will be stored</p></li>
<li><p><strong>fields</strong> (dict of <code class="xref py py-class docutils literal notranslate"><span class="pre">Function</span></code> or <code class="xref py py-class docutils literal notranslate"><span class="pre">Constant</span></code> objects) – Dictionary of fields that are passed to the equation</p></li>
<li><p><strong>dt</strong> (<a class="reference external" href="https://docs.python.org/2.7/library/functions.html#float" title="(in Python v2.7)"><em>float</em></a>) – time step in seconds</p></li>
<li><p><strong>options</strong> – <code class="xref py py-class docutils literal notranslate"><span class="pre">TimeStepperOptions</span></code> instance containing parameter values.</p></li>
<li><p><strong>bnd_conditions</strong> (<a class="reference external" href="https://docs.python.org/2.7/library/stdtypes.html#dict" title="(in Python v2.7)"><em>dict</em></a>) – Dictionary of boundary conditions passed to the equation</p></li>
<li><p><strong>terms_to_add</strong> (<em>'all'</em><em> or </em><em>list</em><em> of </em><em>'implicit'</em><em>, </em><em>'explicit'</em><em>, </em><em>'source'.</em>) – Defines which terms of the equation are to be
added to this solver. Default ‘all’ implies [‘implicit’, ‘explicit’, ‘source’].</p></li>
</ul>
</dd>
</dl>
<dl class="py method">
<dt class="sig sig-object py" id="thetis.rungekutta.DIRKGeneric.get_final_solution">
<span class="sig-name descname"><span class="pre">get_final_solution</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/rungekutta.html#DIRKGeneric.get_final_solution"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#thetis.rungekutta.DIRKGeneric.get_final_solution" title="Link to this definition">¶</a></dt>
<dd><p>Assign final solution to <code class="xref py py-attr docutils literal notranslate"><span class="pre">self.solution</span></code></p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="thetis.rungekutta.DIRKGeneric.initialize">
<span class="sig-name descname"><span class="pre">initialize</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">init_cond</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/rungekutta.html#DIRKGeneric.initialize"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#thetis.rungekutta.DIRKGeneric.initialize" title="Link to this definition">¶</a></dt>
<dd><p>Assigns initial conditions to all required fields.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="thetis.rungekutta.DIRKGeneric.solve_stage">
<span class="sig-name descname"><span class="pre">solve_stage</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">i_stage</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">t</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">update_forcings</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/rungekutta.html#DIRKGeneric.solve_stage"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#thetis.rungekutta.DIRKGeneric.solve_stage" title="Link to this definition">¶</a></dt>
<dd><p>Solve i-th stage and assign solution to <code class="xref py py-attr docutils literal notranslate"><span class="pre">self.solution</span></code>.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="thetis.rungekutta.DIRKGeneric.solve_tendency">
<span class="sig-name descname"><span class="pre">solve_tendency</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">i_stage</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">t</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">update_forcings</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/rungekutta.html#DIRKGeneric.solve_tendency"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#thetis.rungekutta.DIRKGeneric.solve_tendency" title="Link to this definition">¶</a></dt>
<dd><p>Evaluates the tendency of i-th stage.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="thetis.rungekutta.DIRKGeneric.update_solution">
<span class="sig-name descname"><span class="pre">update_solution</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">i_stage</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/rungekutta.html#DIRKGeneric.update_solution"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#thetis.rungekutta.DIRKGeneric.update_solution" title="Link to this definition">¶</a></dt>
<dd><p>Updates solution to i_stage sub-stage.</p>
<p>Tendencies must have been evaluated first.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="thetis.rungekutta.DIRKGeneric.update_solver">
<span class="sig-name descname"><span class="pre">update_solver</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/rungekutta.html#DIRKGeneric.update_solver"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#thetis.rungekutta.DIRKGeneric.update_solver" title="Link to this definition">¶</a></dt>
<dd><p>Create solver objects</p>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="thetis.rungekutta.DIRKGenericUForm">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">thetis.rungekutta.</span></span><span class="sig-name descname"><span class="pre">DIRKGenericUForm</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">equation</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">solution</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fields</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dt</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">options</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">bnd_conditions</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">terms_to_add</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'all'</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/rungekutta.html#DIRKGenericUForm"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#thetis.rungekutta.DIRKGenericUForm" title="Link to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#thetis.rungekutta.RungeKuttaTimeIntegrator" title="thetis.rungekutta.RungeKuttaTimeIntegrator"><code class="xref py py-class docutils literal notranslate"><span class="pre">RungeKuttaTimeIntegrator</span></code></a></p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>equation</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">Equation</span></code> object) – the equation to solve</p></li>
<li><p><strong>solution</strong> – <code class="xref py py-class docutils literal notranslate"><span class="pre">Function</span></code> where solution will be stored</p></li>
<li><p><strong>fields</strong> (dict of <code class="xref py py-class docutils literal notranslate"><span class="pre">Function</span></code> or <code class="xref py py-class docutils literal notranslate"><span class="pre">Constant</span></code> objects) – Dictionary of fields that are passed to the equation</p></li>
<li><p><strong>dt</strong> (<a class="reference external" href="https://docs.python.org/2.7/library/functions.html#float" title="(in Python v2.7)"><em>float</em></a>) – time step in seconds</p></li>
<li><p><strong>options</strong> – <code class="xref py py-class docutils literal notranslate"><span class="pre">TimeStepperOptions</span></code> instance containing parameter values.</p></li>
<li><p><strong>bnd_conditions</strong> (<a class="reference external" href="https://docs.python.org/2.7/library/stdtypes.html#dict" title="(in Python v2.7)"><em>dict</em></a>) – Dictionary of boundary conditions passed to the equation</p></li>
<li><p><strong>terms_to_add</strong> (<em>'all'</em><em> or </em><em>list</em><em> of </em><em>'implicit'</em><em>, </em><em>'explicit'</em><em>, </em><em>'source'.</em>) – Defines which terms of the equation are to be
added to this solver. Default ‘all’ implies [‘implicit’, ‘explicit’, ‘source’].</p></li>
</ul>
</dd>
</dl>
<dl class="py attribute">
<dt class="sig sig-object py" id="thetis.rungekutta.DIRKGenericUForm.cfl_coeff">
<span class="sig-name descname"><span class="pre">cfl_coeff</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">inf</span></em><a class="headerlink" href="#thetis.rungekutta.DIRKGenericUForm.cfl_coeff" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="thetis.rungekutta.DIRKGenericUForm.get_final_solution">
<span class="sig-name descname"><span class="pre">get_final_solution</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">additive</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/rungekutta.html#DIRKGenericUForm.get_final_solution"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#thetis.rungekutta.DIRKGenericUForm.get_final_solution" title="Link to this definition">¶</a></dt>
<dd><p>Evaluates the final solution</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="thetis.rungekutta.DIRKGenericUForm.initialize">
<span class="sig-name descname"><span class="pre">initialize</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">init_cond</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/rungekutta.html#DIRKGenericUForm.initialize"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#thetis.rungekutta.DIRKGenericUForm.initialize" title="Link to this definition">¶</a></dt>
<dd><p>Assigns initial conditions to all required fields.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="thetis.rungekutta.DIRKGenericUForm.solve_stage">
<span class="sig-name descname"><span class="pre">solve_stage</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">i_stage</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">t</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">update_forcings</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/rungekutta.html#DIRKGenericUForm.solve_stage"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#thetis.rungekutta.DIRKGenericUForm.solve_stage" title="Link to this definition">¶</a></dt>
<dd><p>Solves a single stage of step from t to t+dt.
All functions that the equation depends on must be at right state
corresponding to each sub-step.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="thetis.rungekutta.DIRKGenericUForm.update_solver">
<span class="sig-name descname"><span class="pre">update_solver</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/rungekutta.html#DIRKGenericUForm.update_solver"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#thetis.rungekutta.DIRKGenericUForm.update_solver" title="Link to this definition">¶</a></dt>
<dd><p>Create solver objects</p>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="thetis.rungekutta.DIRKLPUM2">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">thetis.rungekutta.</span></span><span class="sig-name descname"><span class="pre">DIRKLPUM2</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">equation</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">solution</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fields</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dt</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">options</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">bnd_conditions</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">terms_to_add</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'all'</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/rungekutta.html#DIRKLPUM2"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#thetis.rungekutta.DIRKLPUM2" title="Link to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#thetis.rungekutta.DIRKGeneric" title="thetis.rungekutta.DIRKGeneric"><code class="xref py py-class docutils literal notranslate"><span class="pre">DIRKGeneric</span></code></a>, <a class="reference internal" href="#thetis.rungekutta.DIRKLPUM2Abstract" title="thetis.rungekutta.DIRKLPUM2Abstract"><code class="xref py py-class docutils literal notranslate"><span class="pre">DIRKLPUM2Abstract</span></code></a></p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>equation</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">Equation</span></code> object) – the equation to solve</p></li>
<li><p><strong>solution</strong> – <code class="xref py py-class docutils literal notranslate"><span class="pre">Function</span></code> where solution will be stored</p></li>
<li><p><strong>fields</strong> (dict of <code class="xref py py-class docutils literal notranslate"><span class="pre">Function</span></code> or <code class="xref py py-class docutils literal notranslate"><span class="pre">Constant</span></code> objects) – Dictionary of fields that are passed to the equation</p></li>
<li><p><strong>dt</strong> (<a class="reference external" href="https://docs.python.org/2.7/library/functions.html#float" title="(in Python v2.7)"><em>float</em></a>) – time step in seconds</p></li>
<li><p><strong>options</strong> – <code class="xref py py-class docutils literal notranslate"><span class="pre">TimeStepperOptions</span></code> instance containing parameter values.</p></li>
<li><p><strong>bnd_conditions</strong> (<a class="reference external" href="https://docs.python.org/2.7/library/stdtypes.html#dict" title="(in Python v2.7)"><em>dict</em></a>) – Dictionary of boundary conditions passed to the equation</p></li>
<li><p><strong>terms_to_add</strong> (<em>'all'</em><em> or </em><em>list</em><em> of </em><em>'implicit'</em><em>, </em><em>'explicit'</em><em>, </em><em>'source'.</em>) – Defines which terms of the equation are to be
added to this solver. Default ‘all’ implies [‘implicit’, ‘explicit’, ‘source’].</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="thetis.rungekutta.DIRKLPUM2Abstract">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">thetis.rungekutta.</span></span><span class="sig-name descname"><span class="pre">DIRKLPUM2Abstract</span></span><a class="reference internal" href="_modules/thetis/rungekutta.html#DIRKLPUM2Abstract"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#thetis.rungekutta.DIRKLPUM2Abstract" title="Link to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#thetis.rungekutta.AbstractRKScheme" title="thetis.rungekutta.AbstractRKScheme"><code class="xref py py-class docutils literal notranslate"><span class="pre">AbstractRKScheme</span></code></a></p>
<p>DIRKLPUM2, 3-stage, 2nd order, L-stable Diagonally Implicit Runge Kutta method</p>
<p>From IMEX RK scheme (20) in Higureras et al. (2014).</p>
<p>Higueras et al (2014). Optimized strong stability preserving IMEX
Runge-Kutta methods. Journal of Computational and Applied Mathematics
272(2014) 116-140. <a class="reference external" href="http://dx.doi.org/10.1016/j.cam.2014.05.011">http://dx.doi.org/10.1016/j.cam.2014.05.011</a></p>
<dl class="py attribute">
<dt class="sig sig-object py" id="thetis.rungekutta.DIRKLPUM2Abstract.a">
<span class="sig-name descname"><span class="pre">a</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">[[0.18181818181818182,</span> <span class="pre">0,</span> <span class="pre">0],</span> <span class="pre">[0.2662337662337662,</span> <span class="pre">0.18181818181818182,</span> <span class="pre">0],</span> <span class="pre">[0.3412042502951594,</span> <span class="pre">0.34710743801652894,</span> <span class="pre">0.18181818181818182]]</span></em><a class="headerlink" href="#thetis.rungekutta.DIRKLPUM2Abstract.a" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="thetis.rungekutta.DIRKLPUM2Abstract.b">
<span class="sig-name descname"><span class="pre">b</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">[0.3333333333333333,</span> <span class="pre">0.3333333333333333,</span> <span class="pre">0.3333333333333333]</span></em><a class="headerlink" href="#thetis.rungekutta.DIRKLPUM2Abstract.b" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="thetis.rungekutta.DIRKLPUM2Abstract.c">
<span class="sig-name descname"><span class="pre">c</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">[0.18181818181818182,</span> <span class="pre">0.44805194805194803,</span> <span class="pre">0.8701298701298701]</span></em><a class="headerlink" href="#thetis.rungekutta.DIRKLPUM2Abstract.c" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="thetis.rungekutta.DIRKLPUM2Abstract.cfl_coeff">
<span class="sig-name descname"><span class="pre">cfl_coeff</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">4.34</span></em><a class="headerlink" href="#thetis.rungekutta.DIRKLPUM2Abstract.cfl_coeff" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="thetis.rungekutta.DIRKLSPUM2">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">thetis.rungekutta.</span></span><span class="sig-name descname"><span class="pre">DIRKLSPUM2</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">equation</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">solution</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fields</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dt</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">options</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">bnd_conditions</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">terms_to_add</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'all'</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/rungekutta.html#DIRKLSPUM2"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#thetis.rungekutta.DIRKLSPUM2" title="Link to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#thetis.rungekutta.DIRKGeneric" title="thetis.rungekutta.DIRKGeneric"><code class="xref py py-class docutils literal notranslate"><span class="pre">DIRKGeneric</span></code></a>, <a class="reference internal" href="#thetis.rungekutta.DIRKLSPUM2Abstract" title="thetis.rungekutta.DIRKLSPUM2Abstract"><code class="xref py py-class docutils literal notranslate"><span class="pre">DIRKLSPUM2Abstract</span></code></a></p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>equation</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">Equation</span></code> object) – the equation to solve</p></li>
<li><p><strong>solution</strong> – <code class="xref py py-class docutils literal notranslate"><span class="pre">Function</span></code> where solution will be stored</p></li>
<li><p><strong>fields</strong> (dict of <code class="xref py py-class docutils literal notranslate"><span class="pre">Function</span></code> or <code class="xref py py-class docutils literal notranslate"><span class="pre">Constant</span></code> objects) – Dictionary of fields that are passed to the equation</p></li>
<li><p><strong>dt</strong> (<a class="reference external" href="https://docs.python.org/2.7/library/functions.html#float" title="(in Python v2.7)"><em>float</em></a>) – time step in seconds</p></li>
<li><p><strong>options</strong> – <code class="xref py py-class docutils literal notranslate"><span class="pre">TimeStepperOptions</span></code> instance containing parameter values.</p></li>
<li><p><strong>bnd_conditions</strong> (<a class="reference external" href="https://docs.python.org/2.7/library/stdtypes.html#dict" title="(in Python v2.7)"><em>dict</em></a>) – Dictionary of boundary conditions passed to the equation</p></li>
<li><p><strong>terms_to_add</strong> (<em>'all'</em><em> or </em><em>list</em><em> of </em><em>'implicit'</em><em>, </em><em>'explicit'</em><em>, </em><em>'source'.</em>) – Defines which terms of the equation are to be
added to this solver. Default ‘all’ implies [‘implicit’, ‘explicit’, ‘source’].</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="thetis.rungekutta.DIRKLSPUM2Abstract">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">thetis.rungekutta.</span></span><span class="sig-name descname"><span class="pre">DIRKLSPUM2Abstract</span></span><a class="reference internal" href="_modules/thetis/rungekutta.html#DIRKLSPUM2Abstract"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#thetis.rungekutta.DIRKLSPUM2Abstract" title="Link to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#thetis.rungekutta.AbstractRKScheme" title="thetis.rungekutta.AbstractRKScheme"><code class="xref py py-class docutils literal notranslate"><span class="pre">AbstractRKScheme</span></code></a></p>
<p>DIRKLSPUM2, 3-stage, 2nd order, L-stable Diagonally Implicit Runge Kutta method</p>
<p>From IMEX RK scheme (17) in Higureras et al. (2014).</p>
<p>Higueras et al (2014). Optimized strong stability preserving IMEX
Runge-Kutta methods. Journal of Computational and Applied Mathematics
272(2014) 116-140. <a class="reference external" href="http://dx.doi.org/10.1016/j.cam.2014.05.011">http://dx.doi.org/10.1016/j.cam.2014.05.011</a></p>
<dl class="py attribute">
<dt class="sig sig-object py" id="thetis.rungekutta.DIRKLSPUM2Abstract.a">
<span class="sig-name descname"><span class="pre">a</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">[[0.18181818181818182,</span> <span class="pre">0,</span> <span class="pre">0],</span> <span class="pre">[0.44372294372294374,</span> <span class="pre">0.18181818181818182,</span> <span class="pre">0],</span> <span class="pre">[0.44004329004329007,</span> <span class="pre">0.19090909090909092,</span> <span class="pre">0.18181818181818182]]</span></em><a class="headerlink" href="#thetis.rungekutta.DIRKLSPUM2Abstract.a" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="thetis.rungekutta.DIRKLSPUM2Abstract.b">
<span class="sig-name descname"><span class="pre">b</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">[0.43636363636363634,</span> <span class="pre">0.2,</span> <span class="pre">0.36363636363636365]</span></em><a class="headerlink" href="#thetis.rungekutta.DIRKLSPUM2Abstract.b" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="thetis.rungekutta.DIRKLSPUM2Abstract.c">
<span class="sig-name descname"><span class="pre">c</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">[0.18181818181818182,</span> <span class="pre">0.6255411255411255,</span> <span class="pre">0.8127705627705628]</span></em><a class="headerlink" href="#thetis.rungekutta.DIRKLSPUM2Abstract.c" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="thetis.rungekutta.DIRKLSPUM2Abstract.cfl_coeff">
<span class="sig-name descname"><span class="pre">cfl_coeff</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">4.34</span></em><a class="headerlink" href="#thetis.rungekutta.DIRKLSPUM2Abstract.cfl_coeff" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="thetis.rungekutta.ERKEuler">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">thetis.rungekutta.</span></span><span class="sig-name descname"><span class="pre">ERKEuler</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">equation</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">solution</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fields</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dt</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">options</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">bnd_conditions</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">terms_to_add</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'all'</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/rungekutta.html#ERKEuler"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#thetis.rungekutta.ERKEuler" title="Link to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#thetis.rungekutta.ERKGeneric" title="thetis.rungekutta.ERKGeneric"><code class="xref py py-class docutils literal notranslate"><span class="pre">ERKGeneric</span></code></a>, <a class="reference internal" href="#thetis.rungekutta.ForwardEulerAbstract" title="thetis.rungekutta.ForwardEulerAbstract"><code class="xref py py-class docutils literal notranslate"><span class="pre">ForwardEulerAbstract</span></code></a></p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>equation</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">Equation</span></code> object) – the equation to solve</p></li>
<li><p><strong>solution</strong> – <code class="xref py py-class docutils literal notranslate"><span class="pre">Function</span></code> where solution will be stored</p></li>
<li><p><strong>fields</strong> (dict of <code class="xref py py-class docutils literal notranslate"><span class="pre">Function</span></code> or <code class="xref py py-class docutils literal notranslate"><span class="pre">Constant</span></code> objects) – Dictionary of fields that are passed to the equation</p></li>
<li><p><strong>dt</strong> (<a class="reference external" href="https://docs.python.org/2.7/library/functions.html#float" title="(in Python v2.7)"><em>float</em></a>) – time step in seconds</p></li>
<li><p><strong>options</strong> – <code class="xref py py-class docutils literal notranslate"><span class="pre">TimeStepperOptions</span></code> instance containing parameter values.</p></li>
<li><p><strong>bnd_conditions</strong> (<a class="reference external" href="https://docs.python.org/2.7/library/stdtypes.html#dict" title="(in Python v2.7)"><em>dict</em></a>) – Dictionary of boundary conditions passed to the equation</p></li>
<li><p><strong>terms_to_add</strong> (<em>'all'</em><em> or </em><em>list</em><em> of </em><em>'implicit'</em><em>, </em><em>'explicit'</em><em>, </em><em>'source'.</em>) – Defines which terms of the equation are to be
added to this solver. Default ‘all’ implies [‘implicit’, ‘explicit’, ‘source’].</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="thetis.rungekutta.ERKGeneric">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">thetis.rungekutta.</span></span><span class="sig-name descname"><span class="pre">ERKGeneric</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">equation</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">solution</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fields</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dt</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">options</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">bnd_conditions</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">terms_to_add</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'all'</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/rungekutta.html#ERKGeneric"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#thetis.rungekutta.ERKGeneric" title="Link to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#thetis.rungekutta.RungeKuttaTimeIntegrator" title="thetis.rungekutta.RungeKuttaTimeIntegrator"><code class="xref py py-class docutils literal notranslate"><span class="pre">RungeKuttaTimeIntegrator</span></code></a></p>
<p>Generic explicit Runge-Kutta time integrator.</p>
<p>Implements the Butcher form. All terms in the equation are treated explicitly.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>equation</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">Equation</span></code> object) – the equation to solve</p></li>
<li><p><strong>solution</strong> – <code class="xref py py-class docutils literal notranslate"><span class="pre">Function</span></code> where solution will be stored</p></li>
<li><p><strong>fields</strong> (dict of <code class="xref py py-class docutils literal notranslate"><span class="pre">Function</span></code> or <code class="xref py py-class docutils literal notranslate"><span class="pre">Constant</span></code> objects) – Dictionary of fields that are passed to the equation</p></li>
<li><p><strong>dt</strong> (<a class="reference external" href="https://docs.python.org/2.7/library/functions.html#float" title="(in Python v2.7)"><em>float</em></a>) – time step in seconds</p></li>
<li><p><strong>options</strong> – <code class="xref py py-class docutils literal notranslate"><span class="pre">TimeStepperOptions</span></code> instance containing parameter values.</p></li>
<li><p><strong>bnd_conditions</strong> (<a class="reference external" href="https://docs.python.org/2.7/library/stdtypes.html#dict" title="(in Python v2.7)"><em>dict</em></a>) – Dictionary of boundary conditions passed to the equation</p></li>
<li><p><strong>terms_to_add</strong> (<em>'all'</em><em> or </em><em>list</em><em> of </em><em>'implicit'</em><em>, </em><em>'explicit'</em><em>, </em><em>'source'.</em>) – Defines which terms of the equation are to be
added to this solver. Default ‘all’ implies [‘implicit’, ‘explicit’, ‘source’].</p></li>
</ul>
</dd>
</dl>
<dl class="py method">
<dt class="sig sig-object py" id="thetis.rungekutta.ERKGeneric.get_final_solution">
<span class="sig-name descname"><span class="pre">get_final_solution</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">additive</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/rungekutta.html#ERKGeneric.get_final_solution"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#thetis.rungekutta.ERKGeneric.get_final_solution" title="Link to this definition">¶</a></dt>
<dd><p>Assign final solution to <code class="xref py py-attr docutils literal notranslate"><span class="pre">self.solution</span></code></p>
<p>If additive=False, will overwrite <code class="xref py py-attr docutils literal notranslate"><span class="pre">solution</span></code> function, otherwise
will add to it.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="thetis.rungekutta.ERKGeneric.initialize">
<span class="sig-name descname"><span class="pre">initialize</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">solution</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/rungekutta.html#ERKGeneric.initialize"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#thetis.rungekutta.ERKGeneric.initialize" title="Link to this definition">¶</a></dt>
<dd><p>Assigns initial conditions to all required fields.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="thetis.rungekutta.ERKGeneric.solve_stage">
<span class="sig-name descname"><span class="pre">solve_stage</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">i_stage</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">t</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">update_forcings</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/rungekutta.html#ERKGeneric.solve_stage"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#thetis.rungekutta.ERKGeneric.solve_stage" title="Link to this definition">¶</a></dt>
<dd><p>Solve i-th stage and assign solution to <code class="xref py py-attr docutils literal notranslate"><span class="pre">self.solution</span></code>.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="thetis.rungekutta.ERKGeneric.solve_tendency">
<span class="sig-name descname"><span class="pre">solve_tendency</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">i_stage</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">t</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">update_forcings</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/rungekutta.html#ERKGeneric.solve_tendency"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#thetis.rungekutta.ERKGeneric.solve_tendency" title="Link to this definition">¶</a></dt>
<dd><p>Evaluates the tendency of i-th stage</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="thetis.rungekutta.ERKGeneric.update_solution">
<span class="sig-name descname"><span class="pre">update_solution</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">i_stage</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">additive</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/rungekutta.html#ERKGeneric.update_solution"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#thetis.rungekutta.ERKGeneric.update_solution" title="Link to this definition">¶</a></dt>
<dd><p>Computes the solution of the i-th stage</p>
<p>Tendencies must have been evaluated first.</p>
<p>If additive=False, will overwrite <code class="xref py py-attr docutils literal notranslate"><span class="pre">solution</span></code> function, otherwise
will add to it.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="thetis.rungekutta.ERKGeneric.update_solver">
<span class="sig-name descname"><span class="pre">update_solver</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/rungekutta.html#ERKGeneric.update_solver"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#thetis.rungekutta.ERKGeneric.update_solver" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="thetis.rungekutta.ERKGenericShuOsher">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">thetis.rungekutta.</span></span><span class="sig-name descname"><span class="pre">ERKGenericShuOsher</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">equation</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">solution</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fields</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dt</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">options</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">bnd_conditions</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">terms_to_add</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'all'</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/rungekutta.html#ERKGenericShuOsher"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#thetis.rungekutta.ERKGenericShuOsher" title="Link to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#thetis.timeintegrator.TimeIntegrator" title="thetis.timeintegrator.TimeIntegrator"><code class="xref py py-class docutils literal notranslate"><span class="pre">TimeIntegrator</span></code></a></p>
<p>Generic explicit Runge-Kutta time integrator.</p>
<p>Implements the Shu-Osher form.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>equation</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">Equation</span></code> object) – the equation to solve</p></li>
<li><p><strong>solution</strong> – <code class="xref py py-class docutils literal notranslate"><span class="pre">Function</span></code> where solution will be stored</p></li>
<li><p><strong>fields</strong> (dict of <code class="xref py py-class docutils literal notranslate"><span class="pre">Function</span></code> or <code class="xref py py-class docutils literal notranslate"><span class="pre">Constant</span></code> objects) – Dictionary of fields that are passed to the equation</p></li>
<li><p><strong>dt</strong> (<a class="reference external" href="https://docs.python.org/2.7/library/functions.html#float" title="(in Python v2.7)"><em>float</em></a>) – time step in seconds</p></li>
<li><p><strong>options</strong> – <code class="xref py py-class docutils literal notranslate"><span class="pre">TimeStepperOptions</span></code> instance containing parameter values.</p></li>
<li><p><strong>bnd_conditions</strong> (<a class="reference external" href="https://docs.python.org/2.7/library/stdtypes.html#dict" title="(in Python v2.7)"><em>dict</em></a>) – Dictionary of boundary conditions passed to the equation</p></li>
<li><p><strong>terms_to_add</strong> (<em>'all'</em><em> or </em><em>list</em><em> of </em><em>'implicit'</em><em>, </em><em>'explicit'</em><em>, </em><em>'source'.</em>) – Defines which terms of the equation are to be
added to this solver. Default ‘all’ implies [‘implicit’, ‘explicit’, ‘source’].</p></li>
</ul>
</dd>
</dl>
<dl class="py method">
<dt class="sig sig-object py" id="thetis.rungekutta.ERKGenericShuOsher.advance">
<span class="sig-name descname"><span class="pre">advance</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">t</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">update_forcings</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/rungekutta.html#ERKGenericShuOsher.advance"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#thetis.rungekutta.ERKGenericShuOsher.advance" title="Link to this definition">¶</a></dt>
<dd><p>Advances equations for one time step.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="thetis.rungekutta.ERKGenericShuOsher.initialize">
<span class="sig-name descname"><span class="pre">initialize</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">solution</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/rungekutta.html#ERKGenericShuOsher.initialize"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#thetis.rungekutta.ERKGenericShuOsher.initialize" title="Link to this definition">¶</a></dt>
<dd><p>Initialize the time integrator</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>init_solution</strong> – initial solution</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="thetis.rungekutta.ERKGenericShuOsher.solve_stage">
<span class="sig-name descname"><span class="pre">solve_stage</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">i_stage</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">t</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">update_forcings</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/rungekutta.html#ERKGenericShuOsher.solve_stage"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#thetis.rungekutta.ERKGenericShuOsher.solve_stage" title="Link to this definition">¶</a></dt>
<dd><p>Solve i-th stage and assign solution to <code class="xref py py-attr docutils literal notranslate"><span class="pre">self.solution</span></code>.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="thetis.rungekutta.ERKGenericShuOsher.update_solver">
<span class="sig-name descname"><span class="pre">update_solver</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/rungekutta.html#ERKGenericShuOsher.update_solver"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#thetis.rungekutta.ERKGenericShuOsher.update_solver" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="thetis.rungekutta.ERKLPUM2">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">thetis.rungekutta.</span></span><span class="sig-name descname"><span class="pre">ERKLPUM2</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">equation</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">solution</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fields</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dt</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">options</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">bnd_conditions</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">terms_to_add</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'all'</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/rungekutta.html#ERKLPUM2"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#thetis.rungekutta.ERKLPUM2" title="Link to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#thetis.rungekutta.ERKGeneric" title="thetis.rungekutta.ERKGeneric"><code class="xref py py-class docutils literal notranslate"><span class="pre">ERKGeneric</span></code></a>, <a class="reference internal" href="#thetis.rungekutta.ERKLPUM2Abstract" title="thetis.rungekutta.ERKLPUM2Abstract"><code class="xref py py-class docutils literal notranslate"><span class="pre">ERKLPUM2Abstract</span></code></a></p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>equation</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">Equation</span></code> object) – the equation to solve</p></li>
<li><p><strong>solution</strong> – <code class="xref py py-class docutils literal notranslate"><span class="pre">Function</span></code> where solution will be stored</p></li>
<li><p><strong>fields</strong> (dict of <code class="xref py py-class docutils literal notranslate"><span class="pre">Function</span></code> or <code class="xref py py-class docutils literal notranslate"><span class="pre">Constant</span></code> objects) – Dictionary of fields that are passed to the equation</p></li>
<li><p><strong>dt</strong> (<a class="reference external" href="https://docs.python.org/2.7/library/functions.html#float" title="(in Python v2.7)"><em>float</em></a>) – time step in seconds</p></li>
<li><p><strong>options</strong> – <code class="xref py py-class docutils literal notranslate"><span class="pre">TimeStepperOptions</span></code> instance containing parameter values.</p></li>
<li><p><strong>bnd_conditions</strong> (<a class="reference external" href="https://docs.python.org/2.7/library/stdtypes.html#dict" title="(in Python v2.7)"><em>dict</em></a>) – Dictionary of boundary conditions passed to the equation</p></li>
<li><p><strong>terms_to_add</strong> (<em>'all'</em><em> or </em><em>list</em><em> of </em><em>'implicit'</em><em>, </em><em>'explicit'</em><em>, </em><em>'source'.</em>) – Defines which terms of the equation are to be
added to this solver. Default ‘all’ implies [‘implicit’, ‘explicit’, ‘source’].</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="thetis.rungekutta.ERKLPUM2Abstract">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">thetis.rungekutta.</span></span><span class="sig-name descname"><span class="pre">ERKLPUM2Abstract</span></span><a class="reference internal" href="_modules/thetis/rungekutta.html#ERKLPUM2Abstract"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#thetis.rungekutta.ERKLPUM2Abstract" title="Link to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#thetis.rungekutta.AbstractRKScheme" title="thetis.rungekutta.AbstractRKScheme"><code class="xref py py-class docutils literal notranslate"><span class="pre">AbstractRKScheme</span></code></a></p>
<p>ERKLPUM2, 3-stage, 2nd order
Explicit Runge Kutta method</p>
<p>From IMEX RK scheme (20) in Higureras et al. (2014).</p>
<p>Higueras et al (2014). Optimized strong stability preserving IMEX
Runge-Kutta methods. Journal of Computational and Applied Mathematics
272(2014) 116-140. <a class="reference external" href="http://dx.doi.org/10.1016/j.cam.2014.05.011">http://dx.doi.org/10.1016/j.cam.2014.05.011</a></p>
<dl class="py attribute">
<dt class="sig sig-object py" id="thetis.rungekutta.ERKLPUM2Abstract.a">
<span class="sig-name descname"><span class="pre">a</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">[[0,</span> <span class="pre">0,</span> <span class="pre">0],</span> <span class="pre">[0.5,</span> <span class="pre">0,</span> <span class="pre">0],</span> <span class="pre">[0.5,</span> <span class="pre">0.5,</span> <span class="pre">0]]</span></em><a class="headerlink" href="#thetis.rungekutta.ERKLPUM2Abstract.a" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="thetis.rungekutta.ERKLPUM2Abstract.b">
<span class="sig-name descname"><span class="pre">b</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">[0.3333333333333333,</span> <span class="pre">0.3333333333333333,</span> <span class="pre">0.3333333333333333]</span></em><a class="headerlink" href="#thetis.rungekutta.ERKLPUM2Abstract.b" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="thetis.rungekutta.ERKLPUM2Abstract.c">
<span class="sig-name descname"><span class="pre">c</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">[0,</span> <span class="pre">0.5,</span> <span class="pre">1.0]</span></em><a class="headerlink" href="#thetis.rungekutta.ERKLPUM2Abstract.c" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="thetis.rungekutta.ERKLPUM2Abstract.cfl_coeff">
<span class="sig-name descname"><span class="pre">cfl_coeff</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">2.0</span></em><a class="headerlink" href="#thetis.rungekutta.ERKLPUM2Abstract.cfl_coeff" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="thetis.rungekutta.ERKLSPUM2">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">thetis.rungekutta.</span></span><span class="sig-name descname"><span class="pre">ERKLSPUM2</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">equation</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">solution</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fields</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dt</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">options</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">bnd_conditions</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">terms_to_add</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'all'</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/rungekutta.html#ERKLSPUM2"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#thetis.rungekutta.ERKLSPUM2" title="Link to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#thetis.rungekutta.ERKGeneric" title="thetis.rungekutta.ERKGeneric"><code class="xref py py-class docutils literal notranslate"><span class="pre">ERKGeneric</span></code></a>, <a class="reference internal" href="#thetis.rungekutta.ERKLSPUM2Abstract" title="thetis.rungekutta.ERKLSPUM2Abstract"><code class="xref py py-class docutils literal notranslate"><span class="pre">ERKLSPUM2Abstract</span></code></a></p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>equation</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">Equation</span></code> object) – the equation to solve</p></li>
<li><p><strong>solution</strong> – <code class="xref py py-class docutils literal notranslate"><span class="pre">Function</span></code> where solution will be stored</p></li>
<li><p><strong>fields</strong> (dict of <code class="xref py py-class docutils literal notranslate"><span class="pre">Function</span></code> or <code class="xref py py-class docutils literal notranslate"><span class="pre">Constant</span></code> objects) – Dictionary of fields that are passed to the equation</p></li>
<li><p><strong>dt</strong> (<a class="reference external" href="https://docs.python.org/2.7/library/functions.html#float" title="(in Python v2.7)"><em>float</em></a>) – time step in seconds</p></li>
<li><p><strong>options</strong> – <code class="xref py py-class docutils literal notranslate"><span class="pre">TimeStepperOptions</span></code> instance containing parameter values.</p></li>
<li><p><strong>bnd_conditions</strong> (<a class="reference external" href="https://docs.python.org/2.7/library/stdtypes.html#dict" title="(in Python v2.7)"><em>dict</em></a>) – Dictionary of boundary conditions passed to the equation</p></li>
<li><p><strong>terms_to_add</strong> (<em>'all'</em><em> or </em><em>list</em><em> of </em><em>'implicit'</em><em>, </em><em>'explicit'</em><em>, </em><em>'source'.</em>) – Defines which terms of the equation are to be
added to this solver. Default ‘all’ implies [‘implicit’, ‘explicit’, ‘source’].</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="thetis.rungekutta.ERKLSPUM2Abstract">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">thetis.rungekutta.</span></span><span class="sig-name descname"><span class="pre">ERKLSPUM2Abstract</span></span><a class="reference internal" href="_modules/thetis/rungekutta.html#ERKLSPUM2Abstract"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#thetis.rungekutta.ERKLSPUM2Abstract" title="Link to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#thetis.rungekutta.AbstractRKScheme" title="thetis.rungekutta.AbstractRKScheme"><code class="xref py py-class docutils literal notranslate"><span class="pre">AbstractRKScheme</span></code></a></p>
<p>ERKLSPUM2, 3-stage, 2nd order Explicit Runge Kutta method</p>
<p>From IMEX RK scheme (17) in Higureras et al. (2014).</p>
<p>Higueras et al (2014). Optimized strong stability preserving IMEX
Runge-Kutta methods. Journal of Computational and Applied Mathematics
272(2014) 116-140. <a class="reference external" href="http://dx.doi.org/10.1016/j.cam.2014.05.011">http://dx.doi.org/10.1016/j.cam.2014.05.011</a></p>
<dl class="py attribute">
<dt class="sig sig-object py" id="thetis.rungekutta.ERKLSPUM2Abstract.a">
<span class="sig-name descname"><span class="pre">a</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">[[0,</span> <span class="pre">0,</span> <span class="pre">0],</span> <span class="pre">[0.8333333333333334,</span> <span class="pre">0,</span> <span class="pre">0],</span> <span class="pre">[0.4583333333333333,</span> <span class="pre">0.4583333333333333,</span> <span class="pre">0]]</span></em><a class="headerlink" href="#thetis.rungekutta.ERKLSPUM2Abstract.a" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="thetis.rungekutta.ERKLSPUM2Abstract.b">
<span class="sig-name descname"><span class="pre">b</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">[0.43636363636363634,</span> <span class="pre">0.2,</span> <span class="pre">0.36363636363636365]</span></em><a class="headerlink" href="#thetis.rungekutta.ERKLSPUM2Abstract.b" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="thetis.rungekutta.ERKLSPUM2Abstract.c">
<span class="sig-name descname"><span class="pre">c</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">[0,</span> <span class="pre">0.8333333333333334,</span> <span class="pre">0.9166666666666666]</span></em><a class="headerlink" href="#thetis.rungekutta.ERKLSPUM2Abstract.c" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="thetis.rungekutta.ERKLSPUM2Abstract.cfl_coeff">
<span class="sig-name descname"><span class="pre">cfl_coeff</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">1.2</span></em><a class="headerlink" href="#thetis.rungekutta.ERKLSPUM2Abstract.cfl_coeff" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="thetis.rungekutta.ERKMidpoint">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">thetis.rungekutta.</span></span><span class="sig-name descname"><span class="pre">ERKMidpoint</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">equation</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">solution</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fields</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dt</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">options</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">bnd_conditions</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">terms_to_add</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'all'</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/rungekutta.html#ERKMidpoint"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#thetis.rungekutta.ERKMidpoint" title="Link to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#thetis.rungekutta.ERKGeneric" title="thetis.rungekutta.ERKGeneric"><code class="xref py py-class docutils literal notranslate"><span class="pre">ERKGeneric</span></code></a>, <a class="reference internal" href="#thetis.rungekutta.ERKMidpointAbstract" title="thetis.rungekutta.ERKMidpointAbstract"><code class="xref py py-class docutils literal notranslate"><span class="pre">ERKMidpointAbstract</span></code></a></p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>equation</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">Equation</span></code> object) – the equation to solve</p></li>
<li><p><strong>solution</strong> – <code class="xref py py-class docutils literal notranslate"><span class="pre">Function</span></code> where solution will be stored</p></li>
<li><p><strong>fields</strong> (dict of <code class="xref py py-class docutils literal notranslate"><span class="pre">Function</span></code> or <code class="xref py py-class docutils literal notranslate"><span class="pre">Constant</span></code> objects) – Dictionary of fields that are passed to the equation</p></li>
<li><p><strong>dt</strong> (<a class="reference external" href="https://docs.python.org/2.7/library/functions.html#float" title="(in Python v2.7)"><em>float</em></a>) – time step in seconds</p></li>
<li><p><strong>options</strong> – <code class="xref py py-class docutils literal notranslate"><span class="pre">TimeStepperOptions</span></code> instance containing parameter values.</p></li>
<li><p><strong>bnd_conditions</strong> (<a class="reference external" href="https://docs.python.org/2.7/library/stdtypes.html#dict" title="(in Python v2.7)"><em>dict</em></a>) – Dictionary of boundary conditions passed to the equation</p></li>
<li><p><strong>terms_to_add</strong> (<em>'all'</em><em> or </em><em>list</em><em> of </em><em>'implicit'</em><em>, </em><em>'explicit'</em><em>, </em><em>'source'.</em>) – Defines which terms of the equation are to be
added to this solver. Default ‘all’ implies [‘implicit’, ‘explicit’, ‘source’].</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="thetis.rungekutta.ERKMidpointAbstract">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">thetis.rungekutta.</span></span><span class="sig-name descname"><span class="pre">ERKMidpointAbstract</span></span><a class="reference internal" href="_modules/thetis/rungekutta.html#ERKMidpointAbstract"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#thetis.rungekutta.ERKMidpointAbstract" title="Link to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#thetis.rungekutta.AbstractRKScheme" title="thetis.rungekutta.AbstractRKScheme"><code class="xref py py-class docutils literal notranslate"><span class="pre">AbstractRKScheme</span></code></a></p>
<dl class="py attribute">
<dt class="sig sig-object py" id="thetis.rungekutta.ERKMidpointAbstract.a">
<span class="sig-name descname"><span class="pre">a</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">[[0.0,</span> <span class="pre">0.0],</span> <span class="pre">[0.5,</span> <span class="pre">0.0]]</span></em><a class="headerlink" href="#thetis.rungekutta.ERKMidpointAbstract.a" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="thetis.rungekutta.ERKMidpointAbstract.b">
<span class="sig-name descname"><span class="pre">b</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">[0.0,</span> <span class="pre">1.0]</span></em><a class="headerlink" href="#thetis.rungekutta.ERKMidpointAbstract.b" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="thetis.rungekutta.ERKMidpointAbstract.c">
<span class="sig-name descname"><span class="pre">c</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">[0.0,</span> <span class="pre">0.5]</span></em><a class="headerlink" href="#thetis.rungekutta.ERKMidpointAbstract.c" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="thetis.rungekutta.ERKMidpointAbstract.cfl_coeff">
<span class="sig-name descname"><span class="pre">cfl_coeff</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">1.0</span></em><a class="headerlink" href="#thetis.rungekutta.ERKMidpointAbstract.cfl_coeff" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="thetis.rungekutta.ESDIRKMidpoint">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">thetis.rungekutta.</span></span><span class="sig-name descname"><span class="pre">ESDIRKMidpoint</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">equation</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">solution</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fields</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dt</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">options</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">bnd_conditions</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">terms_to_add</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'all'</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/rungekutta.html#ESDIRKMidpoint"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#thetis.rungekutta.ESDIRKMidpoint" title="Link to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#thetis.rungekutta.DIRKGeneric" title="thetis.rungekutta.DIRKGeneric"><code class="xref py py-class docutils literal notranslate"><span class="pre">DIRKGeneric</span></code></a>, <a class="reference internal" href="#thetis.rungekutta.ESDIRKMidpointAbstract" title="thetis.rungekutta.ESDIRKMidpointAbstract"><code class="xref py py-class docutils literal notranslate"><span class="pre">ESDIRKMidpointAbstract</span></code></a></p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>equation</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">Equation</span></code> object) – the equation to solve</p></li>
<li><p><strong>solution</strong> – <code class="xref py py-class docutils literal notranslate"><span class="pre">Function</span></code> where solution will be stored</p></li>
<li><p><strong>fields</strong> (dict of <code class="xref py py-class docutils literal notranslate"><span class="pre">Function</span></code> or <code class="xref py py-class docutils literal notranslate"><span class="pre">Constant</span></code> objects) – Dictionary of fields that are passed to the equation</p></li>
<li><p><strong>dt</strong> (<a class="reference external" href="https://docs.python.org/2.7/library/functions.html#float" title="(in Python v2.7)"><em>float</em></a>) – time step in seconds</p></li>
<li><p><strong>options</strong> – <code class="xref py py-class docutils literal notranslate"><span class="pre">TimeStepperOptions</span></code> instance containing parameter values.</p></li>
<li><p><strong>bnd_conditions</strong> (<a class="reference external" href="https://docs.python.org/2.7/library/stdtypes.html#dict" title="(in Python v2.7)"><em>dict</em></a>) – Dictionary of boundary conditions passed to the equation</p></li>
<li><p><strong>terms_to_add</strong> (<em>'all'</em><em> or </em><em>list</em><em> of </em><em>'implicit'</em><em>, </em><em>'explicit'</em><em>, </em><em>'source'.</em>) – Defines which terms of the equation are to be
added to this solver. Default ‘all’ implies [‘implicit’, ‘explicit’, ‘source’].</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="thetis.rungekutta.ESDIRKMidpointAbstract">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">thetis.rungekutta.</span></span><span class="sig-name descname"><span class="pre">ESDIRKMidpointAbstract</span></span><a class="reference internal" href="_modules/thetis/rungekutta.html#ESDIRKMidpointAbstract"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#thetis.rungekutta.ESDIRKMidpointAbstract" title="Link to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#thetis.rungekutta.AbstractRKScheme" title="thetis.rungekutta.AbstractRKScheme"><code class="xref py py-class docutils literal notranslate"><span class="pre">AbstractRKScheme</span></code></a></p>
<dl class="py attribute">
<dt class="sig sig-object py" id="thetis.rungekutta.ESDIRKMidpointAbstract.a">
<span class="sig-name descname"><span class="pre">a</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">[[0.0,</span> <span class="pre">0.0],</span> <span class="pre">[0.0,</span> <span class="pre">0.5]]</span></em><a class="headerlink" href="#thetis.rungekutta.ESDIRKMidpointAbstract.a" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="thetis.rungekutta.ESDIRKMidpointAbstract.b">
<span class="sig-name descname"><span class="pre">b</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">[0.0,</span> <span class="pre">1.0]</span></em><a class="headerlink" href="#thetis.rungekutta.ESDIRKMidpointAbstract.b" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="thetis.rungekutta.ESDIRKMidpointAbstract.c">
<span class="sig-name descname"><span class="pre">c</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">[0.0,</span> <span class="pre">0.5]</span></em><a class="headerlink" href="#thetis.rungekutta.ESDIRKMidpointAbstract.c" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="thetis.rungekutta.ESDIRKMidpointAbstract.cfl_coeff">
<span class="sig-name descname"><span class="pre">cfl_coeff</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">1.0</span></em><a class="headerlink" href="#thetis.rungekutta.ESDIRKMidpointAbstract.cfl_coeff" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="thetis.rungekutta.ESDIRKTrapezoid">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">thetis.rungekutta.</span></span><span class="sig-name descname"><span class="pre">ESDIRKTrapezoid</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">equation</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">solution</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fields</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dt</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">options</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">bnd_conditions</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">terms_to_add</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'all'</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/rungekutta.html#ESDIRKTrapezoid"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#thetis.rungekutta.ESDIRKTrapezoid" title="Link to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#thetis.rungekutta.DIRKGeneric" title="thetis.rungekutta.DIRKGeneric"><code class="xref py py-class docutils literal notranslate"><span class="pre">DIRKGeneric</span></code></a>, <a class="reference internal" href="#thetis.rungekutta.ESDIRKTrapezoidAbstract" title="thetis.rungekutta.ESDIRKTrapezoidAbstract"><code class="xref py py-class docutils literal notranslate"><span class="pre">ESDIRKTrapezoidAbstract</span></code></a></p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>equation</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">Equation</span></code> object) – the equation to solve</p></li>
<li><p><strong>solution</strong> – <code class="xref py py-class docutils literal notranslate"><span class="pre">Function</span></code> where solution will be stored</p></li>
<li><p><strong>fields</strong> (dict of <code class="xref py py-class docutils literal notranslate"><span class="pre">Function</span></code> or <code class="xref py py-class docutils literal notranslate"><span class="pre">Constant</span></code> objects) – Dictionary of fields that are passed to the equation</p></li>
<li><p><strong>dt</strong> (<a class="reference external" href="https://docs.python.org/2.7/library/functions.html#float" title="(in Python v2.7)"><em>float</em></a>) – time step in seconds</p></li>
<li><p><strong>options</strong> – <code class="xref py py-class docutils literal notranslate"><span class="pre">TimeStepperOptions</span></code> instance containing parameter values.</p></li>
<li><p><strong>bnd_conditions</strong> (<a class="reference external" href="https://docs.python.org/2.7/library/stdtypes.html#dict" title="(in Python v2.7)"><em>dict</em></a>) – Dictionary of boundary conditions passed to the equation</p></li>
<li><p><strong>terms_to_add</strong> (<em>'all'</em><em> or </em><em>list</em><em> of </em><em>'implicit'</em><em>, </em><em>'explicit'</em><em>, </em><em>'source'.</em>) – Defines which terms of the equation are to be
added to this solver. Default ‘all’ implies [‘implicit’, ‘explicit’, ‘source’].</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="thetis.rungekutta.ESDIRKTrapezoidAbstract">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">thetis.rungekutta.</span></span><span class="sig-name descname"><span class="pre">ESDIRKTrapezoidAbstract</span></span><a class="reference internal" href="_modules/thetis/rungekutta.html#ESDIRKTrapezoidAbstract"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#thetis.rungekutta.ESDIRKTrapezoidAbstract" title="Link to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#thetis.rungekutta.AbstractRKScheme" title="thetis.rungekutta.AbstractRKScheme"><code class="xref py py-class docutils literal notranslate"><span class="pre">AbstractRKScheme</span></code></a></p>
<dl class="py attribute">
<dt class="sig sig-object py" id="thetis.rungekutta.ESDIRKTrapezoidAbstract.a">
<span class="sig-name descname"><span class="pre">a</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">[[0.0,</span> <span class="pre">0.0],</span> <span class="pre">[0.5,</span> <span class="pre">0.5]]</span></em><a class="headerlink" href="#thetis.rungekutta.ESDIRKTrapezoidAbstract.a" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="thetis.rungekutta.ESDIRKTrapezoidAbstract.b">
<span class="sig-name descname"><span class="pre">b</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">[0.5,</span> <span class="pre">0.5]</span></em><a class="headerlink" href="#thetis.rungekutta.ESDIRKTrapezoidAbstract.b" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="thetis.rungekutta.ESDIRKTrapezoidAbstract.c">
<span class="sig-name descname"><span class="pre">c</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">[0.0,</span> <span class="pre">1.0]</span></em><a class="headerlink" href="#thetis.rungekutta.ESDIRKTrapezoidAbstract.c" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="thetis.rungekutta.ESDIRKTrapezoidAbstract.cfl_coeff">
<span class="sig-name descname"><span class="pre">cfl_coeff</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">inf</span></em><a class="headerlink" href="#thetis.rungekutta.ESDIRKTrapezoidAbstract.cfl_coeff" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="thetis.rungekutta.ForwardEulerAbstract">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">thetis.rungekutta.</span></span><span class="sig-name descname"><span class="pre">ForwardEulerAbstract</span></span><a class="reference internal" href="_modules/thetis/rungekutta.html#ForwardEulerAbstract"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#thetis.rungekutta.ForwardEulerAbstract" title="Link to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#thetis.rungekutta.AbstractRKScheme" title="thetis.rungekutta.AbstractRKScheme"><code class="xref py py-class docutils literal notranslate"><span class="pre">AbstractRKScheme</span></code></a></p>
<p>Forward Euler method</p>
<dl class="py attribute">
<dt class="sig sig-object py" id="thetis.rungekutta.ForwardEulerAbstract.a">
<span class="sig-name descname"><span class="pre">a</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">[[0]]</span></em><a class="headerlink" href="#thetis.rungekutta.ForwardEulerAbstract.a" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="thetis.rungekutta.ForwardEulerAbstract.b">
<span class="sig-name descname"><span class="pre">b</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">[1.0]</span></em><a class="headerlink" href="#thetis.rungekutta.ForwardEulerAbstract.b" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="thetis.rungekutta.ForwardEulerAbstract.c">
<span class="sig-name descname"><span class="pre">c</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">[0]</span></em><a class="headerlink" href="#thetis.rungekutta.ForwardEulerAbstract.c" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="thetis.rungekutta.ForwardEulerAbstract.cfl_coeff">
<span class="sig-name descname"><span class="pre">cfl_coeff</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">1.0</span></em><a class="headerlink" href="#thetis.rungekutta.ForwardEulerAbstract.cfl_coeff" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="thetis.rungekutta.ImplicitMidpoint">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">thetis.rungekutta.</span></span><span class="sig-name descname"><span class="pre">ImplicitMidpoint</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">equation</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">solution</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fields</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dt</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">options</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">bnd_conditions</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">terms_to_add</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'all'</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/rungekutta.html#ImplicitMidpoint"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#thetis.rungekutta.ImplicitMidpoint" title="Link to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#thetis.rungekutta.DIRKGeneric" title="thetis.rungekutta.DIRKGeneric"><code class="xref py py-class docutils literal notranslate"><span class="pre">DIRKGeneric</span></code></a>, <a class="reference internal" href="#thetis.rungekutta.ImplicitMidpointAbstract" title="thetis.rungekutta.ImplicitMidpointAbstract"><code class="xref py py-class docutils literal notranslate"><span class="pre">ImplicitMidpointAbstract</span></code></a></p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>equation</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">Equation</span></code> object) – the equation to solve</p></li>
<li><p><strong>solution</strong> – <code class="xref py py-class docutils literal notranslate"><span class="pre">Function</span></code> where solution will be stored</p></li>
<li><p><strong>fields</strong> (dict of <code class="xref py py-class docutils literal notranslate"><span class="pre">Function</span></code> or <code class="xref py py-class docutils literal notranslate"><span class="pre">Constant</span></code> objects) – Dictionary of fields that are passed to the equation</p></li>
<li><p><strong>dt</strong> (<a class="reference external" href="https://docs.python.org/2.7/library/functions.html#float" title="(in Python v2.7)"><em>float</em></a>) – time step in seconds</p></li>
<li><p><strong>options</strong> – <code class="xref py py-class docutils literal notranslate"><span class="pre">TimeStepperOptions</span></code> instance containing parameter values.</p></li>
<li><p><strong>bnd_conditions</strong> (<a class="reference external" href="https://docs.python.org/2.7/library/stdtypes.html#dict" title="(in Python v2.7)"><em>dict</em></a>) – Dictionary of boundary conditions passed to the equation</p></li>
<li><p><strong>terms_to_add</strong> (<em>'all'</em><em> or </em><em>list</em><em> of </em><em>'implicit'</em><em>, </em><em>'explicit'</em><em>, </em><em>'source'.</em>) – Defines which terms of the equation are to be
added to this solver. Default ‘all’ implies [‘implicit’, ‘explicit’, ‘source’].</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="thetis.rungekutta.ImplicitMidpointAbstract">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">thetis.rungekutta.</span></span><span class="sig-name descname"><span class="pre">ImplicitMidpointAbstract</span></span><a class="reference internal" href="_modules/thetis/rungekutta.html#ImplicitMidpointAbstract"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#thetis.rungekutta.ImplicitMidpointAbstract" title="Link to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#thetis.rungekutta.AbstractRKScheme" title="thetis.rungekutta.AbstractRKScheme"><code class="xref py py-class docutils literal notranslate"><span class="pre">AbstractRKScheme</span></code></a></p>
<p>Implicit midpoint method, second order.</p>
<p>This method has the Butcher tableau</p>
<div class="math notranslate nohighlight">
\[\begin{split}\begin{array}{c|c}
0.5 &amp; 0.5 \\ \hline
    &amp; 1.0
\end{array}\end{split}\]</div>
<dl class="py attribute">
<dt class="sig sig-object py" id="thetis.rungekutta.ImplicitMidpointAbstract.a">
<span class="sig-name descname"><span class="pre">a</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">[[0.5]]</span></em><a class="headerlink" href="#thetis.rungekutta.ImplicitMidpointAbstract.a" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="thetis.rungekutta.ImplicitMidpointAbstract.b">
<span class="sig-name descname"><span class="pre">b</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">[1.0]</span></em><a class="headerlink" href="#thetis.rungekutta.ImplicitMidpointAbstract.b" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="thetis.rungekutta.ImplicitMidpointAbstract.c">
<span class="sig-name descname"><span class="pre">c</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">[0.5]</span></em><a class="headerlink" href="#thetis.rungekutta.ImplicitMidpointAbstract.c" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="thetis.rungekutta.ImplicitMidpointAbstract.cfl_coeff">
<span class="sig-name descname"><span class="pre">cfl_coeff</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">inf</span></em><a class="headerlink" href="#thetis.rungekutta.ImplicitMidpointAbstract.cfl_coeff" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="thetis.rungekutta.RungeKuttaTimeIntegrator">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">thetis.rungekutta.</span></span><span class="sig-name descname"><span class="pre">RungeKuttaTimeIntegrator</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">equation</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">solution</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fields</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dt</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">options</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/rungekutta.html#RungeKuttaTimeIntegrator"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#thetis.rungekutta.RungeKuttaTimeIntegrator" title="Link to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#thetis.timeintegrator.TimeIntegrator" title="thetis.timeintegrator.TimeIntegrator"><code class="xref py py-class docutils literal notranslate"><span class="pre">TimeIntegrator</span></code></a>, <code class="xref py py-class docutils literal notranslate"><span class="pre">ABC</span></code></p>
<p>Abstract base class for all Runge-Kutta time integrators</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>equation</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">Equation</span></code> object) – the equation to solve</p></li>
<li><p><strong>solution</strong> – <code class="xref py py-class docutils literal notranslate"><span class="pre">Function</span></code> where solution will be stored</p></li>
<li><p><strong>fields</strong> (dict of <code class="xref py py-class docutils literal notranslate"><span class="pre">Function</span></code> or <code class="xref py py-class docutils literal notranslate"><span class="pre">Constant</span></code> objects) – Dictionary of fields that are passed to the equation</p></li>
<li><p><strong>dt</strong> (<a class="reference external" href="https://docs.python.org/2.7/library/functions.html#float" title="(in Python v2.7)"><em>float</em></a>) – time step in seconds</p></li>
<li><p><strong>options</strong> – <code class="xref py py-class docutils literal notranslate"><span class="pre">TimeStepperOptions</span></code> instance containing parameter values</p></li>
</ul>
</dd>
</dl>
<dl class="py method">
<dt class="sig sig-object py" id="thetis.rungekutta.RungeKuttaTimeIntegrator.advance">
<span class="sig-name descname"><span class="pre">advance</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">t</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">update_forcings</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/rungekutta.html#RungeKuttaTimeIntegrator.advance"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#thetis.rungekutta.RungeKuttaTimeIntegrator.advance" title="Link to this definition">¶</a></dt>
<dd><p>Advances equations for one time step.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="thetis.rungekutta.RungeKuttaTimeIntegrator.get_final_solution">
<em class="property"><span class="pre">abstract</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">get_final_solution</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">additive</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/rungekutta.html#RungeKuttaTimeIntegrator.get_final_solution"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#thetis.rungekutta.RungeKuttaTimeIntegrator.get_final_solution" title="Link to this definition">¶</a></dt>
<dd><p>Evaluates the final solution</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="thetis.rungekutta.RungeKuttaTimeIntegrator.solve_stage">
<em class="property"><span class="pre">abstract</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">solve_stage</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">i_stage</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">t</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">update_forcings</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/rungekutta.html#RungeKuttaTimeIntegrator.solve_stage"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#thetis.rungekutta.RungeKuttaTimeIntegrator.solve_stage" title="Link to this definition">¶</a></dt>
<dd><p>Solves a single stage of step from t to t+dt.
All functions that the equation depends on must be at right state
corresponding to each sub-step.</p>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="thetis.rungekutta.SSPRK33">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">thetis.rungekutta.</span></span><span class="sig-name descname"><span class="pre">SSPRK33</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">equation</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">solution</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fields</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dt</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">options</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">bnd_conditions</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">terms_to_add</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'all'</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/rungekutta.html#SSPRK33"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#thetis.rungekutta.SSPRK33" title="Link to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#thetis.rungekutta.ERKGenericShuOsher" title="thetis.rungekutta.ERKGenericShuOsher"><code class="xref py py-class docutils literal notranslate"><span class="pre">ERKGenericShuOsher</span></code></a>, <a class="reference internal" href="#thetis.rungekutta.SSPRK33Abstract" title="thetis.rungekutta.SSPRK33Abstract"><code class="xref py py-class docutils literal notranslate"><span class="pre">SSPRK33Abstract</span></code></a></p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>equation</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">Equation</span></code> object) – the equation to solve</p></li>
<li><p><strong>solution</strong> – <code class="xref py py-class docutils literal notranslate"><span class="pre">Function</span></code> where solution will be stored</p></li>
<li><p><strong>fields</strong> (dict of <code class="xref py py-class docutils literal notranslate"><span class="pre">Function</span></code> or <code class="xref py py-class docutils literal notranslate"><span class="pre">Constant</span></code> objects) – Dictionary of fields that are passed to the equation</p></li>
<li><p><strong>dt</strong> (<a class="reference external" href="https://docs.python.org/2.7/library/functions.html#float" title="(in Python v2.7)"><em>float</em></a>) – time step in seconds</p></li>
<li><p><strong>options</strong> – <code class="xref py py-class docutils literal notranslate"><span class="pre">TimeStepperOptions</span></code> instance containing parameter values.</p></li>
<li><p><strong>bnd_conditions</strong> (<a class="reference external" href="https://docs.python.org/2.7/library/stdtypes.html#dict" title="(in Python v2.7)"><em>dict</em></a>) – Dictionary of boundary conditions passed to the equation</p></li>
<li><p><strong>terms_to_add</strong> (<em>'all'</em><em> or </em><em>list</em><em> of </em><em>'implicit'</em><em>, </em><em>'explicit'</em><em>, </em><em>'source'.</em>) – Defines which terms of the equation are to be
added to this solver. Default ‘all’ implies [‘implicit’, ‘explicit’, ‘source’].</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="thetis.rungekutta.SSPRK33Abstract">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">thetis.rungekutta.</span></span><span class="sig-name descname"><span class="pre">SSPRK33Abstract</span></span><a class="reference internal" href="_modules/thetis/rungekutta.html#SSPRK33Abstract"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#thetis.rungekutta.SSPRK33Abstract" title="Link to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#thetis.rungekutta.AbstractRKScheme" title="thetis.rungekutta.AbstractRKScheme"><code class="xref py py-class docutils literal notranslate"><span class="pre">AbstractRKScheme</span></code></a></p>
<p>3rd order Strong Stability Preserving Runge-Kutta scheme, SSP(3,3).</p>
<p>This scheme has Butcher tableau</p>
<div class="math notranslate nohighlight">
\[\begin{split}\begin{array}{c|ccc}
    0 &amp;                 \\
    1 &amp; 1               \\
  1/2 &amp; 1/4 &amp; 1/4 &amp;     \\ \hline
      &amp; 1/6 &amp; 1/6 &amp; 2/3
\end{array}\end{split}\]</div>
<p>CFL coefficient is 1.0</p>
<dl class="py attribute">
<dt class="sig sig-object py" id="thetis.rungekutta.SSPRK33Abstract.a">
<span class="sig-name descname"><span class="pre">a</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">[[0,</span> <span class="pre">0,</span> <span class="pre">0],</span> <span class="pre">[1.0,</span> <span class="pre">0,</span> <span class="pre">0],</span> <span class="pre">[0.25,</span> <span class="pre">0.25,</span> <span class="pre">0]]</span></em><a class="headerlink" href="#thetis.rungekutta.SSPRK33Abstract.a" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="thetis.rungekutta.SSPRK33Abstract.b">
<span class="sig-name descname"><span class="pre">b</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">[0.16666666666666666,</span> <span class="pre">0.16666666666666666,</span> <span class="pre">0.6666666666666666]</span></em><a class="headerlink" href="#thetis.rungekutta.SSPRK33Abstract.b" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="thetis.rungekutta.SSPRK33Abstract.c">
<span class="sig-name descname"><span class="pre">c</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">[0,</span> <span class="pre">1.0,</span> <span class="pre">0.5]</span></em><a class="headerlink" href="#thetis.rungekutta.SSPRK33Abstract.c" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="thetis.rungekutta.SSPRK33Abstract.cfl_coeff">
<span class="sig-name descname"><span class="pre">cfl_coeff</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">1.0</span></em><a class="headerlink" href="#thetis.rungekutta.SSPRK33Abstract.cfl_coeff" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="thetis.rungekutta.butcher_to_shuosher_form">
<span class="sig-prename descclassname"><span class="pre">thetis.rungekutta.</span></span><span class="sig-name descname"><span class="pre">butcher_to_shuosher_form</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">a</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">b</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/rungekutta.html#butcher_to_shuosher_form"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#thetis.rungekutta.butcher_to_shuosher_form" title="Link to this definition">¶</a></dt>
<dd><p>Converts Butcher tableau to Shu-Osher form.</p>
<p>The Shu-Osher form of a s-stage scheme is defined by two s+1 by s+1 arrays
<span class="math notranslate nohighlight">\(\alpha\)</span> and <span class="math notranslate nohighlight">\(\beta\)</span>:</p>
<div class="math notranslate nohighlight">
\[\begin{split}u^{0} &amp;= u^n \\
u^{(i)} &amp;= \sum_{j=0}^s \alpha_{i,j} u^{(j)} + \sum_{j=0}^s \beta_{i,j} F(u^{(j)}) \\
u^{n+1} &amp;= u^{(s)}\end{split}\]</div>
<p>The Shu-Osher form is not unique. Here we construct the form where beta
values are the diagonal entries (for DIRK schemes) or sub-diagonal entries
(for explicit schemes) of the concatenated Butcher tableau [<span class="math notranslate nohighlight">\(a\)</span>; <span class="math notranslate nohighlight">\(b\)</span>].</p>
<p>For more information see Ketchelson et al. (2009) <a class="reference external" href="http://dx.doi.org/10.1016/j.apnum.2008.03.034">http://dx.doi.org/10.1016/j.apnum.2008.03.034</a></p>
</dd></dl>

</section>
<section id="module-thetis.sediment_eq_2d">
<span id="thetis-sediment-eq-2d-module"></span><h2>thetis.sediment_eq_2d module<a class="headerlink" href="#module-thetis.sediment_eq_2d" title="Link to this heading">¶</a></h2>
<p>2D advection diffusion equation for sediment transport.</p>
<p>This can be either conservative <span class="math notranslate nohighlight">\(q=HT\)</span> or non-conservative <span class="math notranslate nohighlight">\(T\)</span> sediment and allows
for a separate source and sink term. The equation reads</p>
<div class="math notranslate nohighlight" id="equation-sediment-eq-2d">
<span class="eqno">(6)<a class="headerlink" href="#equation-sediment-eq-2d" title="Link to this equation">¶</a></span>\[\frac{\partial S}{\partial t}
+ \nabla_h \cdot (\textbf{u} S)
= \nabla_h \cdot (\mu_h \nabla_h S) + F_{source} - (F_{sink} S)\]</div>
<p>where <span class="math notranslate nohighlight">\(S\)</span> is <span class="math notranslate nohighlight">\(q\)</span> for conservative and <span class="math notranslate nohighlight">\(T\)</span> for non-conservative,
<span class="math notranslate nohighlight">\(\nabla_h\)</span> denotes horizontal gradient, <span class="math notranslate nohighlight">\(\textbf{u}\)</span> are the horizontal
velocities, and <span class="math notranslate nohighlight">\(\mu_h\)</span> denotes horizontal diffusivity.</p>
<dl class="py class">
<dt class="sig sig-object py" id="thetis.sediment_eq_2d.ConservativeSedimentAdvectionTerm">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">thetis.sediment_eq_2d.</span></span><span class="sig-name descname"><span class="pre">ConservativeSedimentAdvectionTerm</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">function_space</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">depth</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">options</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sediment_model</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">conservative</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/sediment_eq_2d.html#ConservativeSedimentAdvectionTerm"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#thetis.sediment_eq_2d.ConservativeSedimentAdvectionTerm" title="Link to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#thetis.sediment_eq_2d.SedimentTerm" title="thetis.sediment_eq_2d.SedimentTerm"><code class="xref py py-class docutils literal notranslate"><span class="pre">SedimentTerm</span></code></a>, <a class="reference internal" href="#thetis.tracer_eq_2d.ConservativeHorizontalAdvectionTerm" title="thetis.tracer_eq_2d.ConservativeHorizontalAdvectionTerm"><code class="xref py py-class docutils literal notranslate"><span class="pre">ConservativeHorizontalAdvectionTerm</span></code></a></p>
<p>Advection term for sediment equation</p>
<p>Same as <code class="xref py py-class docutils literal notranslate"><span class="pre">ConservativeHorizontalAdvectionTerm</span></code> but allows for equilibrium boundary condition
through get_bnd_conditions() inherited from <a class="reference internal" href="#thetis.sediment_eq_2d.SedimentTerm" title="thetis.sediment_eq_2d.SedimentTerm"><code class="xref py py-class docutils literal notranslate"><span class="pre">SedimentTerm</span></code></a>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>function_space</strong> – <code class="xref py py-class docutils literal notranslate"><span class="pre">FunctionSpace</span></code> where the solution belongs</p></li>
<li><p><strong>depth</strong> – <code class="xref py py-class docutils literal notranslate"><span class="pre">DepthExpression</span></code> containing depth info</p></li>
<li><p><strong>options</strong> – :class`ModelOptions2d` containing parameters</p></li>
<li><p><strong>conservative</strong> (<a class="reference external" href="https://docs.python.org/2.7/library/functions.html#bool" title="(in Python v2.7)"><em>bool</em></a>) – whether to use conservative tracer</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="thetis.sediment_eq_2d.SedimentAdvectionTerm">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">thetis.sediment_eq_2d.</span></span><span class="sig-name descname"><span class="pre">SedimentAdvectionTerm</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">function_space</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">depth</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">options</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sediment_model</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">conservative</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/sediment_eq_2d.html#SedimentAdvectionTerm"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#thetis.sediment_eq_2d.SedimentAdvectionTerm" title="Link to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#thetis.sediment_eq_2d.SedimentTerm" title="thetis.sediment_eq_2d.SedimentTerm"><code class="xref py py-class docutils literal notranslate"><span class="pre">SedimentTerm</span></code></a>, <a class="reference internal" href="#thetis.tracer_eq_2d.HorizontalAdvectionTerm" title="thetis.tracer_eq_2d.HorizontalAdvectionTerm"><code class="xref py py-class docutils literal notranslate"><span class="pre">HorizontalAdvectionTerm</span></code></a></p>
<p>Advection term for sediment equation</p>
<p>Same as <code class="xref py py-class docutils literal notranslate"><span class="pre">HorizontalAdvectionTerm</span></code> but allows for equilibrium boundary condition
through get_bnd_conditions() inherited from <a class="reference internal" href="#thetis.sediment_eq_2d.SedimentTerm" title="thetis.sediment_eq_2d.SedimentTerm"><code class="xref py py-class docutils literal notranslate"><span class="pre">SedimentTerm</span></code></a>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>function_space</strong> – <code class="xref py py-class docutils literal notranslate"><span class="pre">FunctionSpace</span></code> where the solution belongs</p></li>
<li><p><strong>depth</strong> – <code class="xref py py-class docutils literal notranslate"><span class="pre">DepthExpression</span></code> containing depth info</p></li>
<li><p><strong>options</strong> – :class`ModelOptions2d` containing parameters</p></li>
<li><p><strong>conservative</strong> (<a class="reference external" href="https://docs.python.org/2.7/library/functions.html#bool" title="(in Python v2.7)"><em>bool</em></a>) – whether to use conservative tracer</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="thetis.sediment_eq_2d.SedimentDepositionTerm">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">thetis.sediment_eq_2d.</span></span><span class="sig-name descname"><span class="pre">SedimentDepositionTerm</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">function_space</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">depth</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">options</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sediment_model</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">conservative</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/sediment_eq_2d.html#SedimentDepositionTerm"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#thetis.sediment_eq_2d.SedimentDepositionTerm" title="Link to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#thetis.sediment_eq_2d.SedimentTerm" title="thetis.sediment_eq_2d.SedimentTerm"><code class="xref py py-class docutils literal notranslate"><span class="pre">SedimentTerm</span></code></a></p>
<p>Deposition term for sediment equation</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>function_space</strong> – <code class="xref py py-class docutils literal notranslate"><span class="pre">FunctionSpace</span></code> where the solution belongs</p></li>
<li><p><strong>depth</strong> – <code class="xref py py-class docutils literal notranslate"><span class="pre">DepthExpression</span></code> containing depth info</p></li>
<li><p><strong>options</strong> – :class`ModelOptions2d` containing parameters</p></li>
<li><p><strong>conservative</strong> (<a class="reference external" href="https://docs.python.org/2.7/library/functions.html#bool" title="(in Python v2.7)"><em>bool</em></a>) – whether to use conservative tracer</p></li>
</ul>
</dd>
</dl>
<dl class="py method">
<dt class="sig sig-object py" id="thetis.sediment_eq_2d.SedimentDepositionTerm.residual">
<span class="sig-name descname"><span class="pre">residual</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">solution</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">solution_old</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fields</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fields_old</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">bnd_conditions</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/sediment_eq_2d.html#SedimentDepositionTerm.residual"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#thetis.sediment_eq_2d.SedimentDepositionTerm.residual" title="Link to this definition">¶</a></dt>
<dd><p>Returns an UFL form of the term.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>solution</strong> – solution <code class="xref py py-class docutils literal notranslate"><span class="pre">Function</span></code> of the corresponding equation</p></li>
<li><p><strong>solution_old</strong> – a time lagged solution <code class="xref py py-class docutils literal notranslate"><span class="pre">Function</span></code></p></li>
<li><p><strong>fields</strong> – a dictionary that provides all the remaining fields that the term depends on.
The keys of the dictionary should standard field names in <cite>field_metadata</cite></p></li>
<li><p><strong>fields_old</strong> – Time lagged dictionary of fields</p></li>
<li><p><strong>bnd_conditions</strong> – A dictionary describing boundary conditions.
E.g. {3: {‘elev_2d’: Constant(1.0)}} replaces elev_2d function by a constant on boundary ID 3.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="thetis.sediment_eq_2d.SedimentEquation2D">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">thetis.sediment_eq_2d.</span></span><span class="sig-name descname"><span class="pre">SedimentEquation2D</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">function_space</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">depth</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">options</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sediment_model</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">conservative</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/sediment_eq_2d.html#SedimentEquation2D"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#thetis.sediment_eq_2d.SedimentEquation2D" title="Link to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#thetis.equation.Equation" title="thetis.equation.Equation"><code class="xref py py-class docutils literal notranslate"><span class="pre">Equation</span></code></a></p>
<p>2D sediment advection-diffusion equation: <a class="reference internal" href="#equation-tracer-eq-2d">(16)</a> or <a class="reference internal" href="#equation-cons-tracer-eq-2d">(17)</a>
with sediment source and sink term</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>function_space</strong> – <code class="xref py py-class docutils literal notranslate"><span class="pre">FunctionSpace</span></code> where the solution belongs</p></li>
<li><p><strong>depth</strong> – <code class="xref py py-class docutils literal notranslate"><span class="pre">DepthExpression</span></code> containing depth info</p></li>
<li><p><strong>options</strong> – :class`ModelOptions2d` containing parameters</p></li>
<li><p><strong>conservative</strong> (<a class="reference external" href="https://docs.python.org/2.7/library/functions.html#bool" title="(in Python v2.7)"><em>bool</em></a>) – whether to use conservative tracer</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="thetis.sediment_eq_2d.SedimentErosionTerm">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">thetis.sediment_eq_2d.</span></span><span class="sig-name descname"><span class="pre">SedimentErosionTerm</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">function_space</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">depth</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">options</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sediment_model</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">conservative</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/sediment_eq_2d.html#SedimentErosionTerm"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#thetis.sediment_eq_2d.SedimentErosionTerm" title="Link to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#thetis.sediment_eq_2d.SedimentTerm" title="thetis.sediment_eq_2d.SedimentTerm"><code class="xref py py-class docutils literal notranslate"><span class="pre">SedimentTerm</span></code></a></p>
<p>Erosion term for sediment equation</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>function_space</strong> – <code class="xref py py-class docutils literal notranslate"><span class="pre">FunctionSpace</span></code> where the solution belongs</p></li>
<li><p><strong>depth</strong> – <code class="xref py py-class docutils literal notranslate"><span class="pre">DepthExpression</span></code> containing depth info</p></li>
<li><p><strong>options</strong> – :class`ModelOptions2d` containing parameters</p></li>
<li><p><strong>conservative</strong> (<a class="reference external" href="https://docs.python.org/2.7/library/functions.html#bool" title="(in Python v2.7)"><em>bool</em></a>) – whether to use conservative tracer</p></li>
</ul>
</dd>
</dl>
<dl class="py method">
<dt class="sig sig-object py" id="thetis.sediment_eq_2d.SedimentErosionTerm.residual">
<span class="sig-name descname"><span class="pre">residual</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">solution</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">solution_old</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fields</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fields_old</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">bnd_conditions</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/sediment_eq_2d.html#SedimentErosionTerm.residual"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#thetis.sediment_eq_2d.SedimentErosionTerm.residual" title="Link to this definition">¶</a></dt>
<dd><p>Returns an UFL form of the term.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>solution</strong> – solution <code class="xref py py-class docutils literal notranslate"><span class="pre">Function</span></code> of the corresponding equation</p></li>
<li><p><strong>solution_old</strong> – a time lagged solution <code class="xref py py-class docutils literal notranslate"><span class="pre">Function</span></code></p></li>
<li><p><strong>fields</strong> – a dictionary that provides all the remaining fields that the term depends on.
The keys of the dictionary should standard field names in <cite>field_metadata</cite></p></li>
<li><p><strong>fields_old</strong> – Time lagged dictionary of fields</p></li>
<li><p><strong>bnd_conditions</strong> – A dictionary describing boundary conditions.
E.g. {3: {‘elev_2d’: Constant(1.0)}} replaces elev_2d function by a constant on boundary ID 3.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="thetis.sediment_eq_2d.SedimentTerm">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">thetis.sediment_eq_2d.</span></span><span class="sig-name descname"><span class="pre">SedimentTerm</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">function_space</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">depth</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">options</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sediment_model</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">conservative</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/sediment_eq_2d.html#SedimentTerm"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#thetis.sediment_eq_2d.SedimentTerm" title="Link to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#thetis.tracer_eq_2d.TracerTerm" title="thetis.tracer_eq_2d.TracerTerm"><code class="xref py py-class docutils literal notranslate"><span class="pre">TracerTerm</span></code></a></p>
<p>Generic sediment term that provides commonly used members.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>function_space</strong> – <code class="xref py py-class docutils literal notranslate"><span class="pre">FunctionSpace</span></code> where the solution belongs</p></li>
<li><p><strong>depth</strong> – <code class="xref py py-class docutils literal notranslate"><span class="pre">DepthExpression</span></code> containing depth info</p></li>
<li><p><strong>options</strong> – :class`ModelOptions2d` containing parameters</p></li>
<li><p><strong>conservative</strong> (<a class="reference external" href="https://docs.python.org/2.7/library/functions.html#bool" title="(in Python v2.7)"><em>bool</em></a>) – whether to use conservative tracer</p></li>
</ul>
</dd>
</dl>
<dl class="py method">
<dt class="sig sig-object py" id="thetis.sediment_eq_2d.SedimentTerm.get_bnd_functions">
<span class="sig-name descname"><span class="pre">get_bnd_functions</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">c_in</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">uv_in</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">elev_in</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">bnd_id</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">bnd_conditions</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/sediment_eq_2d.html#SedimentTerm.get_bnd_functions"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#thetis.sediment_eq_2d.SedimentTerm.get_bnd_functions" title="Link to this definition">¶</a></dt>
<dd><p>Returns external values of tracer and uv for all supported
boundary conditions.</p>
<p>Volume flux (flux) and normal velocity (un) are defined positive out of
the domain.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>c_in</strong> – Internal value of tracer</p></li>
<li><p><strong>uv_in</strong> – Internal value of horizontal velocity</p></li>
<li><p><strong>elev_in</strong> – Internal value of elevation</p></li>
<li><p><strong>bnd_id</strong> (<a class="reference external" href="https://docs.python.org/2.7/library/functions.html#int" title="(in Python v2.7)"><em>int</em></a>) – boundary id</p></li>
<li><p><strong>bnd_conditions</strong> – dict of boundary conditions:
<code class="docutils literal notranslate"><span class="pre">{bnd_id:</span> <span class="pre">{field:</span> <span class="pre">value,</span> <span class="pre">...},</span> <span class="pre">...}</span></code></p></li>
</ul>
</dd>
</dl>
</dd></dl>

</dd></dl>

</section>
<section id="module-thetis.sediment_model">
<span id="thetis-sediment-model-module"></span><h2>thetis.sediment_model module<a class="headerlink" href="#module-thetis.sediment_model" title="Link to this heading">¶</a></h2>
<dl class="py class">
<dt class="sig sig-object py" id="thetis.sediment_model.CorrectiveVelocityFactor">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">thetis.sediment_model.</span></span><span class="sig-name descname"><span class="pre">CorrectiveVelocityFactor</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">depth</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ksp</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">settling_velocity</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ustar</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">a</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/sediment_model.html#CorrectiveVelocityFactor"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#thetis.sediment_model.CorrectiveVelocityFactor" title="Link to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference external" href="https://docs.python.org/2.7/library/functions.html#object" title="(in Python v2.7)"><code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></a></p>
<p>Set up advective velocity factor <cite>self.velocity_correction_factor</cite>
which accounts for mismatch between depth-averaged product of
velocity with sediment and product of depth-averaged velocity
with depth-averaged sediment.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>depth</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">Function</span></code>) – Depth of fluid</p></li>
<li><p><strong>ksp</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">Constant</span></code>) – Grain roughness coefficient</p></li>
<li><p><strong>settling_velocity</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">Constant</span></code>) – Settling velocity of the sediment particles</p></li>
<li><p><strong>ustar</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">Expression</span> <span class="pre">of</span> <span class="pre">functions</span></code>) – Shear velocity</p></li>
<li><p><strong>a</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">Constant</span></code>) – Factor of bottom bed reference height</p></li>
</ul>
</dd>
</dl>
<dl class="py method">
<dt class="sig sig-object py" id="thetis.sediment_model.CorrectiveVelocityFactor.update">
<span class="sig-name descname"><span class="pre">update</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/sediment_model.html#CorrectiveVelocityFactor.update"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#thetis.sediment_model.CorrectiveVelocityFactor.update" title="Link to this definition">¶</a></dt>
<dd><p>Update <cite>self.velocity_correction_factor</cite> using the updated values for velocity</p>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="thetis.sediment_model.SedimentModel">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">thetis.sediment_model.</span></span><span class="sig-name descname"><span class="pre">SedimentModel</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">options</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mesh2d</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">uv</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">elev</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">depth</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/sediment_model.html#SedimentModel"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#thetis.sediment_model.SedimentModel" title="Link to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference external" href="https://docs.python.org/2.7/library/functions.html#object" title="(in Python v2.7)"><code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></a></p>
<p>Set up a full morphological model simulation based on provided velocity and elevation functions.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>options</strong> (<a class="reference internal" href="#thetis.options.ModelOptions2d" title="thetis.options.ModelOptions2d"><code class="xref py py-class docutils literal notranslate"><span class="pre">ModelOptions2d</span></code></a> instance) – Model options.</p></li>
<li><p><strong>mesh2d</strong> – <code class="xref py py-class docutils literal notranslate"><span class="pre">Mesh</span></code> object of the 2D mesh</p></li>
<li><p><strong>uv</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">Function</span></code>) – the velocity solution during the simulation</p></li>
<li><p><strong>elev</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">Function</span></code>) – the elevation solution during the simulation</p></li>
<li><p><strong>depth</strong> – a <code class="xref py py-class docutils literal notranslate"><span class="pre">DepthExpression</span></code> instance to evaluate the current depth</p></li>
</ul>
</dd>
</dl>
<p>The <a class="reference internal" href="#thetis.sediment_model.SedimentModel" title="thetis.sediment_model.SedimentModel"><code class="xref py py-class docutils literal notranslate"><span class="pre">SedimentModel</span></code></a> provides various expressions to be used in a suspended sediment and/or
the Exner equation. NOTE that the functions used in these expressions need to be updated
with the current values of the uv and elev fields by calling <code class="xref py py-func docutils literal notranslate"><span class="pre">SedimentModel.update()</span></code>. This is not done
in the initialisation of the sediment model, so that the <a class="reference internal" href="#thetis.sediment_model.SedimentModel" title="thetis.sediment_model.SedimentModel"><code class="xref py py-class docutils literal notranslate"><span class="pre">SedimentModel</span></code></a> can be created before
initial conditions have been assigned to uv and elev. After the initial conditions have been
assigned a call to update is required to ensure that the initial values are reflected in
the <a class="reference internal" href="#thetis.sediment_model.SedimentModel" title="thetis.sediment_model.SedimentModel"><code class="xref py py-class docutils literal notranslate"><span class="pre">SedimentModel</span></code></a> terms.</p>
<dl class="py method">
<dt class="sig sig-object py" id="thetis.sediment_model.SedimentModel.get_advective_velocity_correction_factor">
<span class="sig-name descname"><span class="pre">get_advective_velocity_correction_factor</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/sediment_model.html#SedimentModel.get_advective_velocity_correction_factor"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#thetis.sediment_model.SedimentModel.get_advective_velocity_correction_factor" title="Link to this definition">¶</a></dt>
<dd><p>Returns correction factor for the advective velocity in the sediment equations</p>
<p>With <a class="reference internal" href="#thetis.options.SedimentModelOptions.use_advective_velocity_correction" title="thetis.options.SedimentModelOptions.use_advective_velocity_correction"><code class="xref py py-attr docutils literal notranslate"><span class="pre">SedimentModelOptions.use_advective_velocity_correction</span></code></a>, this applies a correction to
the supplied velocity solution <cite>uv</cite> to take into account the mismatch between
depth-averaged product of velocity with sediment and product of depth-averaged
velocity with depth-averaged sediment.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="thetis.sediment_model.SedimentModel.get_bedload_term">
<span class="sig-name descname"><span class="pre">get_bedload_term</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">bathymetry</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/sediment_model.html#SedimentModel.get_bedload_term"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#thetis.sediment_model.SedimentModel.get_bedload_term" title="Link to this definition">¶</a></dt>
<dd><p>Returns expression for bedload transport <span class="math notranslate nohighlight">\((qbx, qby)\)</span> to be used in the Exner equation.
Note bathymetry is the function which is solved for in the exner equation.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>bathymetry</strong> – Bathymetry of the domain. Bathymetry stands for
the bedlevel (positive downwards).</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="thetis.sediment_model.SedimentModel.get_deposition_coefficient">
<span class="sig-name descname"><span class="pre">get_deposition_coefficient</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/sediment_model.html#SedimentModel.get_deposition_coefficient"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#thetis.sediment_model.SedimentModel.get_deposition_coefficient" title="Link to this definition">¶</a></dt>
<dd><p>Returns coefficient <span class="math notranslate nohighlight">\(C\)</span> such that <span class="math notranslate nohighlight">\(C/H*sediment\)</span> is deposition term in sediment equation</p>
<p>If sediment field is depth-averaged, <span class="math notranslate nohighlight">\(C*sediment\)</span> is (total) deposition (over the column)
as it appears in the Exner equation, but deposition term in sediment equation needs
averaging: <span class="math notranslate nohighlight">\(C*sediment/H\)</span>
If sediment field is depth-integrated, <span class="math notranslate nohighlight">\(C*sediment/H\)</span> is (total) deposition (over the column)
as it appears in the Exner equation, and is the same in the sediment equation.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="thetis.sediment_model.SedimentModel.get_equilibrium_tracer">
<span class="sig-name descname"><span class="pre">get_equilibrium_tracer</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/sediment_model.html#SedimentModel.get_equilibrium_tracer"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#thetis.sediment_model.SedimentModel.get_equilibrium_tracer" title="Link to this definition">¶</a></dt>
<dd><p>Returns expression for (depth-averaged) equilibrium tracer.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="thetis.sediment_model.SedimentModel.get_erosion_term">
<span class="sig-name descname"><span class="pre">get_erosion_term</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/sediment_model.html#SedimentModel.get_erosion_term"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#thetis.sediment_model.SedimentModel.get_erosion_term" title="Link to this definition">¶</a></dt>
<dd><p>Returns expression for (depth-integrated) erosion.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="thetis.sediment_model.SedimentModel.get_sediment_slide_term">
<span class="sig-name descname"><span class="pre">get_sediment_slide_term</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">bathymetry</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/sediment_model.html#SedimentModel.get_sediment_slide_term"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#thetis.sediment_model.SedimentModel.get_sediment_slide_term" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="thetis.sediment_model.SedimentModel.update">
<span class="sig-name descname"><span class="pre">update</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/sediment_model.html#SedimentModel.update"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#thetis.sediment_model.SedimentModel.update" title="Link to this definition">¶</a></dt>
<dd><p>Update all functions used by <a class="reference internal" href="#thetis.sediment_model.SedimentModel" title="thetis.sediment_model.SedimentModel"><code class="xref py py-class docutils literal notranslate"><span class="pre">SedimentModel</span></code></a></p>
<p>This repeats all projection and interpolations steps based on the current values
of the <cite>uv</cite> and <cite>elev</cite> functions, provided in __init__.</p>
</dd></dl>

</dd></dl>

</section>
<section id="module-thetis.shallowwater_eq">
<span id="thetis-shallowwater-eq-module"></span><h2>thetis.shallowwater_eq module<a class="headerlink" href="#module-thetis.shallowwater_eq" title="Link to this heading">¶</a></h2>
<p>Depth averaged shallow water equations</p>
<section id="equations">
<h3>Equations<a class="headerlink" href="#equations" title="Link to this heading">¶</a></h3>
<p>The state variables are water elevation, <span class="math notranslate nohighlight">\(\eta\)</span>, and depth averaged
velocity <span class="math notranslate nohighlight">\(\bar{\textbf{u}}\)</span>.</p>
<p>Denoting the total water depth by <span class="math notranslate nohighlight">\(H=\eta + h\)</span>, the non-conservative form of
the free surface equation is</p>
<div class="math notranslate nohighlight" id="equation-swe-freesurf">
<span class="eqno">(7)<a class="headerlink" href="#equation-swe-freesurf" title="Link to this equation">¶</a></span>\[\frac{\partial \eta}{\partial t} + \nabla \cdot (H \bar{\textbf{u}}) = 0\]</div>
<p>The non-conservative momentum equation reads</p>
<div class="math notranslate nohighlight" id="equation-swe-momentum">
<span class="eqno">(8)<a class="headerlink" href="#equation-swe-momentum" title="Link to this equation">¶</a></span>\[\frac{\partial \bar{\textbf{u}}}{\partial t} +
\bar{\textbf{u}} \cdot \nabla\bar{\textbf{u}} +
f\textbf{e}_z\wedge \bar{\textbf{u}} +
g \nabla \eta +
\nabla \left(\frac{p_a}{\rho_0} \right) +
g \frac{1}{H}\int_{-h}^\eta \nabla r dz
= \nabla \cdot \big( \nu_h ( \nabla \bar{\textbf{u}} + (\nabla \bar{\textbf{u}})^T )\big) +
\frac{\nu_h \nabla(H)}{H} \cdot ( \nabla \bar{\textbf{u}} + (\nabla \bar{\textbf{u}})^T ),\]</div>
<p>where <span class="math notranslate nohighlight">\(g\)</span> is the gravitational acceleration, <span class="math notranslate nohighlight">\(f\)</span> is the Coriolis
frequency, <span class="math notranslate nohighlight">\(\wedge\)</span> is the cross product, <span class="math notranslate nohighlight">\(\textbf{e}_z\)</span> is a vertical unit vector,
<span class="math notranslate nohighlight">\(p_a\)</span> is the atmospheric pressure at the free surface, and <span class="math notranslate nohighlight">\(\nu_h\)</span>
is viscosity. Water density is given by <span class="math notranslate nohighlight">\(\rho = \rho'(T, S, p) + \rho_0\)</span>,
where <span class="math notranslate nohighlight">\(\rho_0\)</span> is a constant reference density.</p>
<p>Above <span class="math notranslate nohighlight">\(r\)</span> denotes the baroclinic head</p>
<div class="math notranslate nohighlight">
\[r = \frac{1}{\rho_0} \int_{z}^\eta  \rho' d\zeta.\]</div>
<p>In the case of purely barotropic problems the <span class="math notranslate nohighlight">\(r\)</span> and the internal pressure
gradient are omitted.</p>
<p>If the option <code class="xref py py-attr docutils literal notranslate"><span class="pre">ModelOptions.use_nonlinear_equations</span></code> is <code class="docutils literal notranslate"><span class="pre">False</span></code>, we solve the linear shallow water
equations (i.e. wave equation):</p>
<div class="math notranslate nohighlight" id="equation-swe-freesurf-linear">
<span class="eqno">(9)<a class="headerlink" href="#equation-swe-freesurf-linear" title="Link to this equation">¶</a></span>\[\frac{\partial \eta}{\partial t} + \nabla \cdot (h \bar{\textbf{u}}) = 0\]</div>
<div class="math notranslate nohighlight" id="equation-swe-momentum-linear">
<span class="eqno">(10)<a class="headerlink" href="#equation-swe-momentum-linear" title="Link to this equation">¶</a></span>\[\frac{\partial \bar{\textbf{u}}}{\partial t} +
f\textbf{e}_z\wedge \bar{\textbf{u}} +
g \nabla \eta
= \nabla \cdot \big( \nu_h ( \nabla \bar{\textbf{u}} + (\nabla \bar{\textbf{u}})^T )\big) +
\frac{\nu_h \nabla(H)}{H} \cdot ( \nabla \bar{\textbf{u}} + (\nabla \bar{\textbf{u}})^T ).\]</div>
<p>In case of a 3D problem with mode splitting, we use a simplified 2D
system that contains nothing but the rotational external gravity waves:</p>
<div class="math notranslate nohighlight" id="equation-swe-freesurf-modesplit">
<span class="eqno">(11)<a class="headerlink" href="#equation-swe-freesurf-modesplit" title="Link to this equation">¶</a></span>\[\frac{\partial \eta}{\partial t} + \nabla \cdot (H \bar{\textbf{u}}) = 0\]</div>
<div class="math notranslate nohighlight" id="equation-swe-momentum-modesplit">
<span class="eqno">(12)<a class="headerlink" href="#equation-swe-momentum-modesplit" title="Link to this equation">¶</a></span>\[\frac{\partial \bar{\textbf{u}}}{\partial t} +
f\textbf{e}_z\wedge \bar{\textbf{u}} +
g \nabla \eta
= \textbf{G},\]</div>
<p>where <span class="math notranslate nohighlight">\(\textbf{G}\)</span> is a source term used to couple the 2D and 3D momentum
equations.</p>
</section>
<section id="boundary-conditions">
<h3>Boundary Conditions<a class="headerlink" href="#boundary-conditions" title="Link to this heading">¶</a></h3>
<p>All boundary conditions are imposed weakly by providing external values for
<span class="math notranslate nohighlight">\(\eta\)</span> and <span class="math notranslate nohighlight">\(\bar{\textbf{u}}\)</span>.</p>
<p>Boundary conditions are set with a dictionary that defines all prescribed
variables at each open boundary.
For example, to assign elevation and volume flux on boundary <code class="docutils literal notranslate"><span class="pre">1</span></code> we set</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">swe_bnd_funcs</span> <span class="o">=</span> <span class="p">{}</span>
<span class="n">swe_bnd_funcs</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;elev&#39;</span><span class="p">:</span><span class="n">myfunc1</span><span class="p">,</span> <span class="s1">&#39;flux&#39;</span><span class="p">:</span><span class="n">myfunc2</span><span class="p">}</span>
</pre></div>
</div>
<p>where <code class="docutils literal notranslate"><span class="pre">myfunc1</span></code> and <code class="docutils literal notranslate"><span class="pre">myfunc2</span></code> are <code class="xref py py-class docutils literal notranslate"><span class="pre">Constant</span></code> or <code class="xref py py-class docutils literal notranslate"><span class="pre">Function</span></code>
objects.</p>
<p>The user can provide <span class="math notranslate nohighlight">\(\eta\)</span> and/or <span class="math notranslate nohighlight">\(\bar{\textbf{u}}\)</span> values.
Supported combinations are:</p>
<ul class="simple">
<li><p><em>unspecified</em> : impermeable (land) boundary, implies symmetric <span class="math notranslate nohighlight">\(\eta\)</span> condition and zero normal velocity</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">'elev'</span></code>: elevation only, symmetric velocity (usually unstable)</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">'uv'</span></code>: 2d velocity vector <span class="math notranslate nohighlight">\(\bar{\textbf{u}}=(u, v)\)</span> (in mesh coordinates), symmetric elevation</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">'un'</span></code>: normal velocity (scalar, positive out of domain), symmetric elevation</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">'flux'</span></code>: normal volume flux (scalar, positive out of domain), symmetric elevation</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">'elev'</span></code> and <code class="docutils literal notranslate"><span class="pre">'uv'</span></code>: water elevation and 2d velocity vector</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">'elev'</span></code> and <code class="docutils literal notranslate"><span class="pre">'un'</span></code>: water elevation and normal velocity</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">'elev'</span></code> and <code class="docutils literal notranslate"><span class="pre">'flux'</span></code>: water elevation and normal flux</p></li>
</ul>
<p>The boundary conditions are assigned to the <a class="reference internal" href="#thetis.solver2d.FlowSolver2d" title="thetis.solver2d.FlowSolver2d"><code class="xref py py-class docutils literal notranslate"><span class="pre">FlowSolver2d</span></code></a> or
<a class="reference internal" href="#thetis.solver.FlowSolver" title="thetis.solver.FlowSolver"><code class="xref py py-class docutils literal notranslate"><span class="pre">FlowSolver</span></code></a> objects:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">solver_obj</span> <span class="o">=</span> <span class="n">solver2d</span><span class="o">.</span><span class="n">FlowSolver2d</span><span class="p">(</span><span class="o">...</span><span class="p">)</span>
<span class="o">...</span>
<span class="n">solver_obj</span><span class="o">.</span><span class="n">bnd_functions</span><span class="p">[</span><span class="s1">&#39;shallow_water&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">swe_bnd_funcs</span>
</pre></div>
</div>
<p>Internally the boundary conditions passed to the <a class="reference internal" href="#thetis.equation.Term.residual" title="thetis.equation.Term.residual"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Term.residual()</span></code></a> method
of each term:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">adv_term</span> <span class="o">=</span> <span class="n">shallowwater_eq</span><span class="o">.</span><span class="n">HorizontalAdvectionTerm</span><span class="p">(</span><span class="o">...</span><span class="p">)</span>
<span class="n">adv_form</span> <span class="o">=</span> <span class="n">adv_term</span><span class="o">.</span><span class="n">residual</span><span class="p">(</span><span class="o">...</span><span class="p">,</span> <span class="n">bnd_conditions</span><span class="o">=</span><span class="n">swe_bnd_funcs</span><span class="p">)</span>
</pre></div>
</div>
</section>
<section id="wetting-and-drying">
<h3>Wetting and drying<a class="headerlink" href="#wetting-and-drying" title="Link to this heading">¶</a></h3>
<p>If the option <code class="xref py py-attr docutils literal notranslate"><span class="pre">ModelOptions.use_wetting_and_drying</span></code> is <code class="docutils literal notranslate"><span class="pre">True</span></code>, then wetting and
drying is included through the formulation of Karna et al. (2011).</p>
<p>The method introduces a modified bathymetry <span class="math notranslate nohighlight">\(\tilde{h} = h + f(H)\)</span>, which ensures
positive total water depth, with <span class="math notranslate nohighlight">\(f(H)\)</span> defined by</p>
<div class="math notranslate nohighlight">
\[f(H) = \frac{1}{2}(\sqrt{H^2 + \alpha^2} - H),\]</div>
<p>introducing a wetting-drying parameter <span class="math notranslate nohighlight">\(\alpha\)</span>, with dimensions of length. This
results in a modified total water depth <span class="math notranslate nohighlight">\(\tilde{H}=H+f(H)\)</span>.</p>
<p>The value for <span class="math notranslate nohighlight">\(\alpha\)</span> is specified by the user through the
option <code class="xref py py-attr docutils literal notranslate"><span class="pre">ModelOptions.wetting_and_drying_alpha</span></code>, in units of meters. The default value
for <code class="xref py py-attr docutils literal notranslate"><span class="pre">ModelOptions.wetting_and_drying_alpha</span></code> is 0.5, but the appropriate value is problem
specific and should be set by the user.</p>
<p>An approximate method for selecting a suitable value for <span class="math notranslate nohighlight">\(\alpha\)</span> is suggested
by Karna et al. (2011). Defining <span class="math notranslate nohighlight">\(L_x\)</span> as the horizontal length scale of the
mesh elements at the wet-dry front, it can be reasoned that <span class="math notranslate nohighlight">\(\alpha \approx |L_x
\nabla h|\)</span> yields a suitable choice. Smaller <span class="math notranslate nohighlight">\(\alpha\)</span> leads to a more accurate
solution to the shallow water equations in wet regions, but if <span class="math notranslate nohighlight">\(\alpha\)</span> is too
small the simulation will become unstable.</p>
<p>When wetting and drying is turned on, two things occur:</p>
<blockquote>
<div><ol class="arabic simple">
<li><p>All instances of the height, <span class="math notranslate nohighlight">\(H\)</span>, are replaced by <span class="math notranslate nohighlight">\(\tilde{H}\)</span> (as defined above);</p></li>
<li><p>An additional displacement term <span class="math notranslate nohighlight">\(\frac{\partial \tilde{h}}{\partial t}\)</span> is added to the bathymetry in the free surface equation.</p></li>
</ol>
</div></blockquote>
<p>The free surface and momentum equations then become:</p>
<div class="math notranslate nohighlight" id="equation-swe-freesurf-wd">
<span class="eqno">(13)<a class="headerlink" href="#equation-swe-freesurf-wd" title="Link to this equation">¶</a></span>\[\frac{\partial \eta}{\partial t} + \frac{\partial \tilde{h}}{\partial t} + \nabla \cdot (\tilde{H} \bar{\textbf{u}}) = 0,\]</div>
<div class="math notranslate nohighlight" id="equation-swe-momentum-wd">
<span class="eqno">(14)<a class="headerlink" href="#equation-swe-momentum-wd" title="Link to this equation">¶</a></span>\[\frac{\partial \bar{\textbf{u}}}{\partial t} +
\bar{\textbf{u}} \cdot \nabla\bar{\textbf{u}} +
f\textbf{e}_z\wedge \bar{\textbf{u}} +
g \nabla \eta +
g \frac{1}{\tilde{H}}\int_{-h}^\eta \nabla r dz
= \nabla \cdot \big( \nu_h ( \nabla \bar{\textbf{u}} + (\nabla \bar{\textbf{u}})^T )\big) +
\frac{\nu_h \nabla(\tilde{H})}{\tilde{H}} \cdot ( \nabla \bar{\textbf{u}} + (\nabla \bar{\textbf{u}})^T ).\]</div>
</section>
<dl class="py class">
<dt class="sig sig-object py" id="thetis.shallowwater_eq.AtmosphericPressureTerm">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">thetis.shallowwater_eq.</span></span><span class="sig-name descname"><span class="pre">AtmosphericPressureTerm</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">u_test</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">u_space</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">eta_space</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">depth</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">options</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/shallowwater_eq.html#AtmosphericPressureTerm"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#thetis.shallowwater_eq.AtmosphericPressureTerm" title="Link to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#thetis.shallowwater_eq.ShallowWaterMomentumTerm" title="thetis.shallowwater_eq.ShallowWaterMomentumTerm"><code class="xref py py-class docutils literal notranslate"><span class="pre">ShallowWaterMomentumTerm</span></code></a></p>
<p>Atmospheric pressure term, <span class="math notranslate nohighlight">\(\nabla (p_a / \rho_0)\)</span></p>
<p>Here <span class="math notranslate nohighlight">\(p_a\)</span> is a user-defined atmospheric pressure <code class="xref py py-class docutils literal notranslate"><span class="pre">Function</span></code>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>function_space</strong> – the <code class="xref py py-class docutils literal notranslate"><span class="pre">FunctionSpace</span></code> the solution belongs to</p></li>
<li><p><strong>test_function</strong> – custom <code class="xref py py-class docutils literal notranslate"><span class="pre">TestFunction</span></code>.</p></li>
<li><p><strong>trial_function</strong> – custom <code class="xref py py-class docutils literal notranslate"><span class="pre">TrialFunction</span></code>.</p></li>
</ul>
</dd>
</dl>
<dl class="py method">
<dt class="sig sig-object py" id="thetis.shallowwater_eq.AtmosphericPressureTerm.residual">
<span class="sig-name descname"><span class="pre">residual</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">uv</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">eta</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">uv_old</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">eta_old</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fields</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fields_old</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">bnd_conditions</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/shallowwater_eq.html#AtmosphericPressureTerm.residual"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#thetis.shallowwater_eq.AtmosphericPressureTerm.residual" title="Link to this definition">¶</a></dt>
<dd><p>Returns an UFL form of the term.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>solution</strong> – solution <code class="xref py py-class docutils literal notranslate"><span class="pre">Function</span></code> of the corresponding equation</p></li>
<li><p><strong>solution_old</strong> – a time lagged solution <code class="xref py py-class docutils literal notranslate"><span class="pre">Function</span></code></p></li>
<li><p><strong>fields</strong> – a dictionary that provides all the remaining fields that the term depends on.
The keys of the dictionary should standard field names in <cite>field_metadata</cite></p></li>
<li><p><strong>fields_old</strong> – Time lagged dictionary of fields</p></li>
<li><p><strong>bnd_conditions</strong> – A dictionary describing boundary conditions.
E.g. {3: {‘elev_2d’: Constant(1.0)}} replaces elev_2d function by a constant on boundary ID 3.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="thetis.shallowwater_eq.BaseShallowWaterEquation">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">thetis.shallowwater_eq.</span></span><span class="sig-name descname"><span class="pre">BaseShallowWaterEquation</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">function_space</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">depth</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">options</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/shallowwater_eq.html#BaseShallowWaterEquation"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#thetis.shallowwater_eq.BaseShallowWaterEquation" title="Link to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#thetis.equation.Equation" title="thetis.equation.Equation"><code class="xref py py-class docutils literal notranslate"><span class="pre">Equation</span></code></a></p>
<p>Abstract base class for ShallowWaterEquations, ShallowWaterMomentumEquation
and FreeSurfaceEquation.</p>
<p>Provides common functionality to compute time steps and add either momentum
or continuity terms.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>function_space</strong> – the <code class="xref py py-class docutils literal notranslate"><span class="pre">FunctionSpace</span></code> the solution belongs to</p>
</dd>
</dl>
<dl class="py method">
<dt class="sig sig-object py" id="thetis.shallowwater_eq.BaseShallowWaterEquation.add_continuity_terms">
<span class="sig-name descname"><span class="pre">add_continuity_terms</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/shallowwater_eq.html#BaseShallowWaterEquation.add_continuity_terms"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#thetis.shallowwater_eq.BaseShallowWaterEquation.add_continuity_terms" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="thetis.shallowwater_eq.BaseShallowWaterEquation.add_momentum_terms">
<span class="sig-name descname"><span class="pre">add_momentum_terms</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">tidal_farms</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/shallowwater_eq.html#BaseShallowWaterEquation.add_momentum_terms"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#thetis.shallowwater_eq.BaseShallowWaterEquation.add_momentum_terms" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="thetis.shallowwater_eq.BaseShallowWaterEquation.residual_uv_eta">
<span class="sig-name descname"><span class="pre">residual_uv_eta</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">label</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">uv</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">eta</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">uv_old</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">eta_old</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fields</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fields_old</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">bnd_conditions</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/shallowwater_eq.html#BaseShallowWaterEquation.residual_uv_eta"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#thetis.shallowwater_eq.BaseShallowWaterEquation.residual_uv_eta" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="thetis.shallowwater_eq.BottomDrag3DTerm">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">thetis.shallowwater_eq.</span></span><span class="sig-name descname"><span class="pre">BottomDrag3DTerm</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">u_test</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">u_space</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">eta_space</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">depth</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">options</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/shallowwater_eq.html#BottomDrag3DTerm"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#thetis.shallowwater_eq.BottomDrag3DTerm" title="Link to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#thetis.shallowwater_eq.ShallowWaterMomentumTerm" title="thetis.shallowwater_eq.ShallowWaterMomentumTerm"><code class="xref py py-class docutils literal notranslate"><span class="pre">ShallowWaterMomentumTerm</span></code></a></p>
<p>Bottom drag term consistent with the 3D mode,
<span class="math notranslate nohighlight">\(C_D \| \textbf{u}_b \| \textbf{u}_b\)</span></p>
<p>Here <span class="math notranslate nohighlight">\(\textbf{u}_b\)</span> is the bottom velocity used in the 3D mode, and
<span class="math notranslate nohighlight">\(C_D\)</span> the corresponding bottom drag.
These fields are computed in the 3D model.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>function_space</strong> – the <code class="xref py py-class docutils literal notranslate"><span class="pre">FunctionSpace</span></code> the solution belongs to</p></li>
<li><p><strong>test_function</strong> – custom <code class="xref py py-class docutils literal notranslate"><span class="pre">TestFunction</span></code>.</p></li>
<li><p><strong>trial_function</strong> – custom <code class="xref py py-class docutils literal notranslate"><span class="pre">TrialFunction</span></code>.</p></li>
</ul>
</dd>
</dl>
<dl class="py method">
<dt class="sig sig-object py" id="thetis.shallowwater_eq.BottomDrag3DTerm.residual">
<span class="sig-name descname"><span class="pre">residual</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">uv</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">eta</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">uv_old</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">eta_old</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fields</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fields_old</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">bnd_conditions</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/shallowwater_eq.html#BottomDrag3DTerm.residual"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#thetis.shallowwater_eq.BottomDrag3DTerm.residual" title="Link to this definition">¶</a></dt>
<dd><p>Returns an UFL form of the term.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>solution</strong> – solution <code class="xref py py-class docutils literal notranslate"><span class="pre">Function</span></code> of the corresponding equation</p></li>
<li><p><strong>solution_old</strong> – a time lagged solution <code class="xref py py-class docutils literal notranslate"><span class="pre">Function</span></code></p></li>
<li><p><strong>fields</strong> – a dictionary that provides all the remaining fields that the term depends on.
The keys of the dictionary should standard field names in <cite>field_metadata</cite></p></li>
<li><p><strong>fields_old</strong> – Time lagged dictionary of fields</p></li>
<li><p><strong>bnd_conditions</strong> – A dictionary describing boundary conditions.
E.g. {3: {‘elev_2d’: Constant(1.0)}} replaces elev_2d function by a constant on boundary ID 3.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="thetis.shallowwater_eq.ContinuitySourceTerm">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">thetis.shallowwater_eq.</span></span><span class="sig-name descname"><span class="pre">ContinuitySourceTerm</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">eta_test</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">eta_space</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">u_space</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">depth</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">options</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/shallowwater_eq.html#ContinuitySourceTerm"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#thetis.shallowwater_eq.ContinuitySourceTerm" title="Link to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#thetis.shallowwater_eq.ShallowWaterContinuityTerm" title="thetis.shallowwater_eq.ShallowWaterContinuityTerm"><code class="xref py py-class docutils literal notranslate"><span class="pre">ShallowWaterContinuityTerm</span></code></a></p>
<p>Generic source term in the depth-averaged continuity equation</p>
<p>The weak form reads</p>
<div class="math notranslate nohighlight">
\[F_s = \int_\Omega S \phi dx\]</div>
<p>where <span class="math notranslate nohighlight">\(S\)</span> is a user defined scalar <code class="xref py py-class docutils literal notranslate"><span class="pre">Function</span></code>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>function_space</strong> – the <code class="xref py py-class docutils literal notranslate"><span class="pre">FunctionSpace</span></code> the solution belongs to</p></li>
<li><p><strong>test_function</strong> – custom <code class="xref py py-class docutils literal notranslate"><span class="pre">TestFunction</span></code>.</p></li>
<li><p><strong>trial_function</strong> – custom <code class="xref py py-class docutils literal notranslate"><span class="pre">TrialFunction</span></code>.</p></li>
</ul>
</dd>
</dl>
<dl class="py method">
<dt class="sig sig-object py" id="thetis.shallowwater_eq.ContinuitySourceTerm.residual">
<span class="sig-name descname"><span class="pre">residual</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">uv</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">eta</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">uv_old</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">eta_old</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fields</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fields_old</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">bnd_conditions</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/shallowwater_eq.html#ContinuitySourceTerm.residual"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#thetis.shallowwater_eq.ContinuitySourceTerm.residual" title="Link to this definition">¶</a></dt>
<dd><p>Returns an UFL form of the term.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>solution</strong> – solution <code class="xref py py-class docutils literal notranslate"><span class="pre">Function</span></code> of the corresponding equation</p></li>
<li><p><strong>solution_old</strong> – a time lagged solution <code class="xref py py-class docutils literal notranslate"><span class="pre">Function</span></code></p></li>
<li><p><strong>fields</strong> – a dictionary that provides all the remaining fields that the term depends on.
The keys of the dictionary should standard field names in <cite>field_metadata</cite></p></li>
<li><p><strong>fields_old</strong> – Time lagged dictionary of fields</p></li>
<li><p><strong>bnd_conditions</strong> – A dictionary describing boundary conditions.
E.g. {3: {‘elev_2d’: Constant(1.0)}} replaces elev_2d function by a constant on boundary ID 3.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="thetis.shallowwater_eq.CoriolisTerm">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">thetis.shallowwater_eq.</span></span><span class="sig-name descname"><span class="pre">CoriolisTerm</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">u_test</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">u_space</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">eta_space</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">depth</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">options</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/shallowwater_eq.html#CoriolisTerm"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#thetis.shallowwater_eq.CoriolisTerm" title="Link to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#thetis.shallowwater_eq.ShallowWaterMomentumTerm" title="thetis.shallowwater_eq.ShallowWaterMomentumTerm"><code class="xref py py-class docutils literal notranslate"><span class="pre">ShallowWaterMomentumTerm</span></code></a></p>
<p>Coriolis term, <span class="math notranslate nohighlight">\(f\textbf{e}_z\wedge \bar{\textbf{u}}\)</span></p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>function_space</strong> – the <code class="xref py py-class docutils literal notranslate"><span class="pre">FunctionSpace</span></code> the solution belongs to</p></li>
<li><p><strong>test_function</strong> – custom <code class="xref py py-class docutils literal notranslate"><span class="pre">TestFunction</span></code>.</p></li>
<li><p><strong>trial_function</strong> – custom <code class="xref py py-class docutils literal notranslate"><span class="pre">TrialFunction</span></code>.</p></li>
</ul>
</dd>
</dl>
<dl class="py method">
<dt class="sig sig-object py" id="thetis.shallowwater_eq.CoriolisTerm.residual">
<span class="sig-name descname"><span class="pre">residual</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">uv</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">eta</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">uv_old</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">eta_old</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fields</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fields_old</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">bnd_conditions</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/shallowwater_eq.html#CoriolisTerm.residual"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#thetis.shallowwater_eq.CoriolisTerm.residual" title="Link to this definition">¶</a></dt>
<dd><p>Returns an UFL form of the term.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>solution</strong> – solution <code class="xref py py-class docutils literal notranslate"><span class="pre">Function</span></code> of the corresponding equation</p></li>
<li><p><strong>solution_old</strong> – a time lagged solution <code class="xref py py-class docutils literal notranslate"><span class="pre">Function</span></code></p></li>
<li><p><strong>fields</strong> – a dictionary that provides all the remaining fields that the term depends on.
The keys of the dictionary should standard field names in <cite>field_metadata</cite></p></li>
<li><p><strong>fields_old</strong> – Time lagged dictionary of fields</p></li>
<li><p><strong>bnd_conditions</strong> – A dictionary describing boundary conditions.
E.g. {3: {‘elev_2d’: Constant(1.0)}} replaces elev_2d function by a constant on boundary ID 3.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="thetis.shallowwater_eq.ExternalPressureGradientTerm">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">thetis.shallowwater_eq.</span></span><span class="sig-name descname"><span class="pre">ExternalPressureGradientTerm</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">u_test</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">u_space</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">eta_space</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">depth</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">options</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/shallowwater_eq.html#ExternalPressureGradientTerm"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#thetis.shallowwater_eq.ExternalPressureGradientTerm" title="Link to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#thetis.shallowwater_eq.ShallowWaterMomentumTerm" title="thetis.shallowwater_eq.ShallowWaterMomentumTerm"><code class="xref py py-class docutils literal notranslate"><span class="pre">ShallowWaterMomentumTerm</span></code></a></p>
<p>External pressure gradient term, <span class="math notranslate nohighlight">\(g \nabla \eta\)</span></p>
<p>The weak form reads</p>
<div class="math notranslate nohighlight">
\[\int_\Omega g \nabla \eta \cdot \boldsymbol{\psi} dx
= \int_\Gamma g \eta^* \text{jump}(\boldsymbol{\psi} \cdot \textbf{n}) dS
- \int_\Omega g \eta \nabla \cdot \boldsymbol{\psi} dx\]</div>
<p>where the right hand side has been integrated by parts; <span class="math notranslate nohighlight">\(\textbf{n}\)</span>
denotes the unit normal of the element interfaces, <span class="math notranslate nohighlight">\(n^*\)</span> is value at
the interface obtained from an approximate Riemann solver.</p>
<p>If <span class="math notranslate nohighlight">\(\eta\)</span> belongs to a discontinuous function space, the form on the
right hand side is used.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>function_space</strong> – the <code class="xref py py-class docutils literal notranslate"><span class="pre">FunctionSpace</span></code> the solution belongs to</p></li>
<li><p><strong>test_function</strong> – custom <code class="xref py py-class docutils literal notranslate"><span class="pre">TestFunction</span></code>.</p></li>
<li><p><strong>trial_function</strong> – custom <code class="xref py py-class docutils literal notranslate"><span class="pre">TrialFunction</span></code>.</p></li>
</ul>
</dd>
</dl>
<dl class="py method">
<dt class="sig sig-object py" id="thetis.shallowwater_eq.ExternalPressureGradientTerm.residual">
<span class="sig-name descname"><span class="pre">residual</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">uv</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">eta</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">uv_old</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">eta_old</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fields</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fields_old</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">bnd_conditions</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/shallowwater_eq.html#ExternalPressureGradientTerm.residual"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#thetis.shallowwater_eq.ExternalPressureGradientTerm.residual" title="Link to this definition">¶</a></dt>
<dd><p>Returns an UFL form of the term.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>solution</strong> – solution <code class="xref py py-class docutils literal notranslate"><span class="pre">Function</span></code> of the corresponding equation</p></li>
<li><p><strong>solution_old</strong> – a time lagged solution <code class="xref py py-class docutils literal notranslate"><span class="pre">Function</span></code></p></li>
<li><p><strong>fields</strong> – a dictionary that provides all the remaining fields that the term depends on.
The keys of the dictionary should standard field names in <cite>field_metadata</cite></p></li>
<li><p><strong>fields_old</strong> – Time lagged dictionary of fields</p></li>
<li><p><strong>bnd_conditions</strong> – A dictionary describing boundary conditions.
E.g. {3: {‘elev_2d’: Constant(1.0)}} replaces elev_2d function by a constant on boundary ID 3.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="thetis.shallowwater_eq.FreeSurfaceEquation">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">thetis.shallowwater_eq.</span></span><span class="sig-name descname"><span class="pre">FreeSurfaceEquation</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">eta_test</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">eta_space</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">u_space</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">depth</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">options</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/shallowwater_eq.html#FreeSurfaceEquation"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#thetis.shallowwater_eq.FreeSurfaceEquation" title="Link to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#thetis.shallowwater_eq.BaseShallowWaterEquation" title="thetis.shallowwater_eq.BaseShallowWaterEquation"><code class="xref py py-class docutils literal notranslate"><span class="pre">BaseShallowWaterEquation</span></code></a></p>
<p>2D free surface equation <a class="reference internal" href="#equation-swe-freesurf">(7)</a> in non-conservative form.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>eta_test</strong> – test function of the elevation function space</p></li>
<li><p><strong>eta_space</strong> – elevation function space</p></li>
<li><p><strong>u_space</strong> – velocity function space</p></li>
<li><p><strong>function_space</strong> – Mixed function space where the solution belongs</p></li>
<li><p><strong>depth</strong> – <dl class="field-list simple">
<dt class="field-odd">class<span class="colon">:</span></dt>
<dd class="field-odd"><p><cite>DepthExpression</cite> containing depth info</p>
</dd>
</dl>
</p></li>
<li><p><strong>options</strong> – <a class="reference internal" href="#thetis.utility.AttrDict" title="thetis.utility.AttrDict"><code class="xref py py-class docutils literal notranslate"><span class="pre">AttrDict</span></code></a> object containing all circulation model options</p></li>
</ul>
</dd>
</dl>
<dl class="py method">
<dt class="sig sig-object py" id="thetis.shallowwater_eq.FreeSurfaceEquation.mass_term">
<span class="sig-name descname"><span class="pre">mass_term</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">solution</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/shallowwater_eq.html#FreeSurfaceEquation.mass_term"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#thetis.shallowwater_eq.FreeSurfaceEquation.mass_term" title="Link to this definition">¶</a></dt>
<dd><p>Returns default mass matrix term for the solution function space.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>UFL form of the mass term</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="thetis.shallowwater_eq.FreeSurfaceEquation.residual">
<span class="sig-name descname"><span class="pre">residual</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">label</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">solution</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">solution_old</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fields</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fields_old</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">bnd_conditions</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/shallowwater_eq.html#FreeSurfaceEquation.residual"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#thetis.shallowwater_eq.FreeSurfaceEquation.residual" title="Link to this definition">¶</a></dt>
<dd><p>Returns an UFL form of the residual by summing up all the terms with the desired label.</p>
<p>Sign convention: all terms are assumed to be on the right hand side of the equation: d(u)/dt = term.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>label</strong> – string defining the type of terms to sum up. Currently one of
‘source’|’explicit’|’implicit’|’nonlinear’. Can be a list of multiple labels, or ‘all’ in which
case all defined terms are summed.</p></li>
<li><p><strong>solution</strong> – solution <code class="xref py py-class docutils literal notranslate"><span class="pre">Function</span></code> of the corresponding equation</p></li>
<li><p><strong>solution_old</strong> – a time lagged solution <code class="xref py py-class docutils literal notranslate"><span class="pre">Function</span></code></p></li>
<li><p><strong>fields</strong> – a dictionary that provides all the remaining fields that the term depends on.
The keys of the dictionary should standard field names in <cite>field_metadata</cite></p></li>
<li><p><strong>fields_old</strong> – Time lagged dictionary of fields</p></li>
<li><p><strong>bnd_conditions</strong> – A dictionary describing boundary conditions.
E.g. {3: {‘elev_2d’: Constant(1.0)}} replaces elev_2d function by a constant on boundary ID 3.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="thetis.shallowwater_eq.HUDivTerm">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">thetis.shallowwater_eq.</span></span><span class="sig-name descname"><span class="pre">HUDivTerm</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">eta_test</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">eta_space</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">u_space</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">depth</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">options</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/shallowwater_eq.html#HUDivTerm"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#thetis.shallowwater_eq.HUDivTerm" title="Link to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#thetis.shallowwater_eq.ShallowWaterContinuityTerm" title="thetis.shallowwater_eq.ShallowWaterContinuityTerm"><code class="xref py py-class docutils literal notranslate"><span class="pre">ShallowWaterContinuityTerm</span></code></a></p>
<p>Divergence term, <span class="math notranslate nohighlight">\(\nabla \cdot (H \bar{\textbf{u}})\)</span></p>
<p>The weak form reads</p>
<div class="math notranslate nohighlight">
\[\int_\Omega \nabla \cdot (H \bar{\textbf{u}}) \phi dx
= \int_\Gamma (H^* \bar{\textbf{u}}^*) \cdot \text{jump}(\phi \textbf{n}) dS
- \int_\Omega H (\bar{\textbf{u}}\cdot\nabla \phi) dx\]</div>
<p>where the right hand side has been integrated by parts; <span class="math notranslate nohighlight">\(\textbf{n}\)</span>
denotes the unit normal of the element interfaces, and <span class="math notranslate nohighlight">\(\text{jump}\)</span>
and <span class="math notranslate nohighlight">\(\text{avg}\)</span> denote the jump and average operators across the
interface. <span class="math notranslate nohighlight">\(H^*, \bar{\textbf{u}}^*\)</span> are values at the interface
obtained from an approximate Riemann solver.</p>
<p>If <span class="math notranslate nohighlight">\(\bar{\textbf{u}}\)</span> belongs to a discontinuous function space,
the form on the right hand side is used.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>function_space</strong> – the <code class="xref py py-class docutils literal notranslate"><span class="pre">FunctionSpace</span></code> the solution belongs to</p></li>
<li><p><strong>test_function</strong> – custom <code class="xref py py-class docutils literal notranslate"><span class="pre">TestFunction</span></code>.</p></li>
<li><p><strong>trial_function</strong> – custom <code class="xref py py-class docutils literal notranslate"><span class="pre">TrialFunction</span></code>.</p></li>
</ul>
</dd>
</dl>
<dl class="py method">
<dt class="sig sig-object py" id="thetis.shallowwater_eq.HUDivTerm.residual">
<span class="sig-name descname"><span class="pre">residual</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">uv</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">eta</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">uv_old</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">eta_old</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fields</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fields_old</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">bnd_conditions</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/shallowwater_eq.html#HUDivTerm.residual"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#thetis.shallowwater_eq.HUDivTerm.residual" title="Link to this definition">¶</a></dt>
<dd><p>Returns an UFL form of the term.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>solution</strong> – solution <code class="xref py py-class docutils literal notranslate"><span class="pre">Function</span></code> of the corresponding equation</p></li>
<li><p><strong>solution_old</strong> – a time lagged solution <code class="xref py py-class docutils literal notranslate"><span class="pre">Function</span></code></p></li>
<li><p><strong>fields</strong> – a dictionary that provides all the remaining fields that the term depends on.
The keys of the dictionary should standard field names in <cite>field_metadata</cite></p></li>
<li><p><strong>fields_old</strong> – Time lagged dictionary of fields</p></li>
<li><p><strong>bnd_conditions</strong> – A dictionary describing boundary conditions.
E.g. {3: {‘elev_2d’: Constant(1.0)}} replaces elev_2d function by a constant on boundary ID 3.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="thetis.shallowwater_eq.HorizontalAdvectionTerm">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">thetis.shallowwater_eq.</span></span><span class="sig-name descname"><span class="pre">HorizontalAdvectionTerm</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">u_test</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">u_space</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">eta_space</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">depth</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">options</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/shallowwater_eq.html#HorizontalAdvectionTerm"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#thetis.shallowwater_eq.HorizontalAdvectionTerm" title="Link to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#thetis.shallowwater_eq.ShallowWaterMomentumTerm" title="thetis.shallowwater_eq.ShallowWaterMomentumTerm"><code class="xref py py-class docutils literal notranslate"><span class="pre">ShallowWaterMomentumTerm</span></code></a></p>
<p>Advection of momentum term, <span class="math notranslate nohighlight">\(\bar{\textbf{u}} \cdot \nabla\bar{\textbf{u}}\)</span></p>
<p>The weak form is</p>
<div class="math notranslate nohighlight">
\[\int_\Omega \bar{\textbf{u}} \cdot \nabla\bar{\textbf{u}} \cdot \boldsymbol{\psi} dx
= - \int_\Omega \nabla_h \cdot (\bar{\textbf{u}} \boldsymbol{\psi}) \cdot \bar{\textbf{u}} dx
+ \int_\Gamma \text{avg}(\bar{\textbf{u}}) \cdot \text{jump}(\boldsymbol{\psi}
(\bar{\textbf{u}}\cdot\textbf{n})) dS\]</div>
<p>where the right hand side has been integrated by parts;
<span class="math notranslate nohighlight">\(\textbf{n}\)</span> is the unit normal of
the element interfaces, and <span class="math notranslate nohighlight">\(\text{jump}\)</span> and <span class="math notranslate nohighlight">\(\text{avg}\)</span> denote the
jump and average operators across the interface.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>function_space</strong> – the <code class="xref py py-class docutils literal notranslate"><span class="pre">FunctionSpace</span></code> the solution belongs to</p></li>
<li><p><strong>test_function</strong> – custom <code class="xref py py-class docutils literal notranslate"><span class="pre">TestFunction</span></code>.</p></li>
<li><p><strong>trial_function</strong> – custom <code class="xref py py-class docutils literal notranslate"><span class="pre">TrialFunction</span></code>.</p></li>
</ul>
</dd>
</dl>
<dl class="py method">
<dt class="sig sig-object py" id="thetis.shallowwater_eq.HorizontalAdvectionTerm.residual">
<span class="sig-name descname"><span class="pre">residual</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">uv</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">eta</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">uv_old</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">eta_old</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fields</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fields_old</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">bnd_conditions</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/shallowwater_eq.html#HorizontalAdvectionTerm.residual"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#thetis.shallowwater_eq.HorizontalAdvectionTerm.residual" title="Link to this definition">¶</a></dt>
<dd><p>Returns an UFL form of the term.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>solution</strong> – solution <code class="xref py py-class docutils literal notranslate"><span class="pre">Function</span></code> of the corresponding equation</p></li>
<li><p><strong>solution_old</strong> – a time lagged solution <code class="xref py py-class docutils literal notranslate"><span class="pre">Function</span></code></p></li>
<li><p><strong>fields</strong> – a dictionary that provides all the remaining fields that the term depends on.
The keys of the dictionary should standard field names in <cite>field_metadata</cite></p></li>
<li><p><strong>fields_old</strong> – Time lagged dictionary of fields</p></li>
<li><p><strong>bnd_conditions</strong> – A dictionary describing boundary conditions.
E.g. {3: {‘elev_2d’: Constant(1.0)}} replaces elev_2d function by a constant on boundary ID 3.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="thetis.shallowwater_eq.HorizontalViscosityTerm">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">thetis.shallowwater_eq.</span></span><span class="sig-name descname"><span class="pre">HorizontalViscosityTerm</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">u_test</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">u_space</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">eta_space</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">depth</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">options</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/shallowwater_eq.html#HorizontalViscosityTerm"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#thetis.shallowwater_eq.HorizontalViscosityTerm" title="Link to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#thetis.shallowwater_eq.ShallowWaterMomentumTerm" title="thetis.shallowwater_eq.ShallowWaterMomentumTerm"><code class="xref py py-class docutils literal notranslate"><span class="pre">ShallowWaterMomentumTerm</span></code></a></p>
<p>Viscosity of momentum term</p>
<p>If option <code class="xref py py-attr docutils literal notranslate"><span class="pre">ModelOptions.use_grad_div_viscosity_term</span></code> is <code class="docutils literal notranslate"><span class="pre">True</span></code>, we
use the symmetric viscous stress <span class="math notranslate nohighlight">\(\boldsymbol{\tau}_\nu = \nu_h ( \nabla \bar{\textbf{u}} + (\nabla \bar{\textbf{u}})^T )\)</span>.
Using the symmetric interior penalty method the weak form then reads</p>
<div class="math notranslate nohighlight">
\[\begin{split}\int_\Omega -\nabla \cdot \boldsymbol{\tau}_\nu \cdot \boldsymbol{\psi} dx
=&amp; \int_\Omega (\nabla \boldsymbol{\psi}) : \boldsymbol{\tau}_\nu dx \\
&amp;- \int_\Gamma \text{jump}(\boldsymbol{\psi} \textbf{n}) \cdot \text{avg}(\boldsymbol{\tau}_\nu) dS
- \int_\Gamma \text{avg}(\nu_h)\big(\text{jump}(\bar{\textbf{u}} \textbf{n}) + \text{jump}(\bar{\textbf{u}} \textbf{n})^T\big) \cdot \text{avg}(\nabla \boldsymbol{\psi}) dS \\
&amp;+ \int_\Gamma \sigma \text{avg}(\nu_h) \big(\text{jump}(\bar{\textbf{u}} \textbf{n}) + \text{jump}(\bar{\textbf{u}} \textbf{n})^T\big) \cdot \text{jump}(\boldsymbol{\psi} \textbf{n}) dS\end{split}\]</div>
<p>where <span class="math notranslate nohighlight">\(\sigma\)</span> is a penalty parameter, see Hillewaert (2013).</p>
<p>If option <code class="xref py py-attr docutils literal notranslate"><span class="pre">ModelOptions.use_grad_div_viscosity_term</span></code> is <code class="docutils literal notranslate"><span class="pre">False</span></code>,
we use viscous stress <span class="math notranslate nohighlight">\(\boldsymbol{\tau}_\nu = \nu_h \nabla \bar{\textbf{u}}\)</span>.
In this case the weak form is</p>
<div class="math notranslate nohighlight">
\[\begin{split}\int_\Omega -\nabla \cdot \boldsymbol{\tau}_\nu \cdot \boldsymbol{\psi} dx
=&amp; \int_\Omega (\nabla \boldsymbol{\psi}) : \boldsymbol{\tau}_\nu dx \\
&amp;- \int_\Gamma \text{jump}(\boldsymbol{\psi} \textbf{n}) \cdot \text{avg}(\boldsymbol{\tau}_\nu) dS
- \int_\Gamma \text{avg}(\nu_h)\text{jump}(\bar{\textbf{u}} \textbf{n}) \cdot \text{avg}(\nabla \boldsymbol{\psi}) dS \\
&amp;+ \int_\Gamma \sigma \text{avg}(\nu_h) \text{jump}(\bar{\textbf{u}} \textbf{n}) \cdot \text{jump}(\boldsymbol{\psi} \textbf{n}) dS\end{split}\]</div>
<p>If option <code class="xref py py-attr docutils literal notranslate"><span class="pre">ModelOptions.use_grad_depth_viscosity_term</span></code> is <code class="docutils literal notranslate"><span class="pre">True</span></code>, we also include
the term</p>
<div class="math notranslate nohighlight">
\[\boldsymbol{\tau}_{\nabla H} = - \frac{\nu_h \nabla(H)}{H} \cdot ( \nabla \bar{\textbf{u}} + (\nabla \bar{\textbf{u}})^T )\]</div>
<p>as a source term.</p>
<p>Hillewaert, Koen (2013). Development of the discontinuous Galerkin method
for high-resolution, large scale CFD and acoustics in industrial
geometries. PhD Thesis. Université catholique de Louvain.
<a class="reference external" href="https://dial.uclouvain.be/pr/boreal/object/boreal:128254/">https://dial.uclouvain.be/pr/boreal/object/boreal:128254/</a></p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>function_space</strong> – the <code class="xref py py-class docutils literal notranslate"><span class="pre">FunctionSpace</span></code> the solution belongs to</p></li>
<li><p><strong>test_function</strong> – custom <code class="xref py py-class docutils literal notranslate"><span class="pre">TestFunction</span></code>.</p></li>
<li><p><strong>trial_function</strong> – custom <code class="xref py py-class docutils literal notranslate"><span class="pre">TrialFunction</span></code>.</p></li>
</ul>
</dd>
</dl>
<dl class="py method">
<dt class="sig sig-object py" id="thetis.shallowwater_eq.HorizontalViscosityTerm.residual">
<span class="sig-name descname"><span class="pre">residual</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">uv</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">eta</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">uv_old</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">eta_old</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fields</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fields_old</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">bnd_conditions</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/shallowwater_eq.html#HorizontalViscosityTerm.residual"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#thetis.shallowwater_eq.HorizontalViscosityTerm.residual" title="Link to this definition">¶</a></dt>
<dd><p>Returns an UFL form of the term.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>solution</strong> – solution <code class="xref py py-class docutils literal notranslate"><span class="pre">Function</span></code> of the corresponding equation</p></li>
<li><p><strong>solution_old</strong> – a time lagged solution <code class="xref py py-class docutils literal notranslate"><span class="pre">Function</span></code></p></li>
<li><p><strong>fields</strong> – a dictionary that provides all the remaining fields that the term depends on.
The keys of the dictionary should standard field names in <cite>field_metadata</cite></p></li>
<li><p><strong>fields_old</strong> – Time lagged dictionary of fields</p></li>
<li><p><strong>bnd_conditions</strong> – A dictionary describing boundary conditions.
E.g. {3: {‘elev_2d’: Constant(1.0)}} replaces elev_2d function by a constant on boundary ID 3.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="thetis.shallowwater_eq.LinearDragTerm">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">thetis.shallowwater_eq.</span></span><span class="sig-name descname"><span class="pre">LinearDragTerm</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">u_test</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">u_space</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">eta_space</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">depth</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">options</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/shallowwater_eq.html#LinearDragTerm"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#thetis.shallowwater_eq.LinearDragTerm" title="Link to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#thetis.shallowwater_eq.ShallowWaterMomentumTerm" title="thetis.shallowwater_eq.ShallowWaterMomentumTerm"><code class="xref py py-class docutils literal notranslate"><span class="pre">ShallowWaterMomentumTerm</span></code></a></p>
<p>Linear friction term, <span class="math notranslate nohighlight">\(C \bar{\textbf{u}}\)</span></p>
<p>Here <span class="math notranslate nohighlight">\(C\)</span> is a user-defined drag coefficient.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>function_space</strong> – the <code class="xref py py-class docutils literal notranslate"><span class="pre">FunctionSpace</span></code> the solution belongs to</p></li>
<li><p><strong>test_function</strong> – custom <code class="xref py py-class docutils literal notranslate"><span class="pre">TestFunction</span></code>.</p></li>
<li><p><strong>trial_function</strong> – custom <code class="xref py py-class docutils literal notranslate"><span class="pre">TrialFunction</span></code>.</p></li>
</ul>
</dd>
</dl>
<dl class="py method">
<dt class="sig sig-object py" id="thetis.shallowwater_eq.LinearDragTerm.residual">
<span class="sig-name descname"><span class="pre">residual</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">uv</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">eta</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">uv_old</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">eta_old</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fields</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fields_old</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">bnd_conditions</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/shallowwater_eq.html#LinearDragTerm.residual"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#thetis.shallowwater_eq.LinearDragTerm.residual" title="Link to this definition">¶</a></dt>
<dd><p>Returns an UFL form of the term.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>solution</strong> – solution <code class="xref py py-class docutils literal notranslate"><span class="pre">Function</span></code> of the corresponding equation</p></li>
<li><p><strong>solution_old</strong> – a time lagged solution <code class="xref py py-class docutils literal notranslate"><span class="pre">Function</span></code></p></li>
<li><p><strong>fields</strong> – a dictionary that provides all the remaining fields that the term depends on.
The keys of the dictionary should standard field names in <cite>field_metadata</cite></p></li>
<li><p><strong>fields_old</strong> – Time lagged dictionary of fields</p></li>
<li><p><strong>bnd_conditions</strong> – A dictionary describing boundary conditions.
E.g. {3: {‘elev_2d’: Constant(1.0)}} replaces elev_2d function by a constant on boundary ID 3.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="thetis.shallowwater_eq.ModeSplit2DEquations">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">thetis.shallowwater_eq.</span></span><span class="sig-name descname"><span class="pre">ModeSplit2DEquations</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">function_space</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">depth</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">options</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/shallowwater_eq.html#ModeSplit2DEquations"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#thetis.shallowwater_eq.ModeSplit2DEquations" title="Link to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#thetis.shallowwater_eq.BaseShallowWaterEquation" title="thetis.shallowwater_eq.BaseShallowWaterEquation"><code class="xref py py-class docutils literal notranslate"><span class="pre">BaseShallowWaterEquation</span></code></a></p>
<p>2D depth-averaged shallow water equations for mode splitting schemes.</p>
<p>Defines the equations <a class="reference internal" href="#equation-swe-freesurf-modesplit">(11)</a> -
<a class="reference internal" href="#equation-swe-momentum-modesplit">(12)</a>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>function_space</strong> – Mixed function space where the solution belongs</p></li>
<li><p><strong>depth</strong> – <dl class="field-list simple">
<dt class="field-odd">class<span class="colon">:</span></dt>
<dd class="field-odd"><p><cite>DepthExpression</cite> containing depth info</p>
</dd>
</dl>
</p></li>
<li><p><strong>options</strong> – <a class="reference internal" href="#thetis.utility.AttrDict" title="thetis.utility.AttrDict"><code class="xref py py-class docutils literal notranslate"><span class="pre">AttrDict</span></code></a> object containing all circulation model options</p></li>
</ul>
</dd>
</dl>
<dl class="py method">
<dt class="sig sig-object py" id="thetis.shallowwater_eq.ModeSplit2DEquations.add_momentum_terms">
<span class="sig-name descname"><span class="pre">add_momentum_terms</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/shallowwater_eq.html#ModeSplit2DEquations.add_momentum_terms"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#thetis.shallowwater_eq.ModeSplit2DEquations.add_momentum_terms" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="thetis.shallowwater_eq.ModeSplit2DEquations.residual">
<span class="sig-name descname"><span class="pre">residual</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">label</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">solution</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">solution_old</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fields</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fields_old</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">bnd_conditions</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/shallowwater_eq.html#ModeSplit2DEquations.residual"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#thetis.shallowwater_eq.ModeSplit2DEquations.residual" title="Link to this definition">¶</a></dt>
<dd><p>Returns an UFL form of the residual by summing up all the terms with the desired label.</p>
<p>Sign convention: all terms are assumed to be on the right hand side of the equation: d(u)/dt = term.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>label</strong> – string defining the type of terms to sum up. Currently one of
‘source’|’explicit’|’implicit’|’nonlinear’. Can be a list of multiple labels, or ‘all’ in which
case all defined terms are summed.</p></li>
<li><p><strong>solution</strong> – solution <code class="xref py py-class docutils literal notranslate"><span class="pre">Function</span></code> of the corresponding equation</p></li>
<li><p><strong>solution_old</strong> – a time lagged solution <code class="xref py py-class docutils literal notranslate"><span class="pre">Function</span></code></p></li>
<li><p><strong>fields</strong> – a dictionary that provides all the remaining fields that the term depends on.
The keys of the dictionary should standard field names in <cite>field_metadata</cite></p></li>
<li><p><strong>fields_old</strong> – Time lagged dictionary of fields</p></li>
<li><p><strong>bnd_conditions</strong> – A dictionary describing boundary conditions.
E.g. {3: {‘elev_2d’: Constant(1.0)}} replaces elev_2d function by a constant on boundary ID 3.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="thetis.shallowwater_eq.MomentumSourceTerm">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">thetis.shallowwater_eq.</span></span><span class="sig-name descname"><span class="pre">MomentumSourceTerm</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">u_test</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">u_space</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">eta_space</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">depth</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">options</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/shallowwater_eq.html#MomentumSourceTerm"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#thetis.shallowwater_eq.MomentumSourceTerm" title="Link to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#thetis.shallowwater_eq.ShallowWaterMomentumTerm" title="thetis.shallowwater_eq.ShallowWaterMomentumTerm"><code class="xref py py-class docutils literal notranslate"><span class="pre">ShallowWaterMomentumTerm</span></code></a></p>
<p>Generic source term in the shallow water momentum equation</p>
<p>The weak form reads</p>
<div class="math notranslate nohighlight">
\[F_s = \int_\Omega \boldsymbol{\tau} \cdot \boldsymbol{\psi} dx\]</div>
<p>where <span class="math notranslate nohighlight">\(\boldsymbol{\tau}\)</span> is a user defined vector valued <code class="xref py py-class docutils literal notranslate"><span class="pre">Function</span></code>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>function_space</strong> – the <code class="xref py py-class docutils literal notranslate"><span class="pre">FunctionSpace</span></code> the solution belongs to</p></li>
<li><p><strong>test_function</strong> – custom <code class="xref py py-class docutils literal notranslate"><span class="pre">TestFunction</span></code>.</p></li>
<li><p><strong>trial_function</strong> – custom <code class="xref py py-class docutils literal notranslate"><span class="pre">TrialFunction</span></code>.</p></li>
</ul>
</dd>
</dl>
<dl class="py method">
<dt class="sig sig-object py" id="thetis.shallowwater_eq.MomentumSourceTerm.residual">
<span class="sig-name descname"><span class="pre">residual</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">uv</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">eta</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">uv_old</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">eta_old</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fields</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fields_old</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">bnd_conditions</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/shallowwater_eq.html#MomentumSourceTerm.residual"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#thetis.shallowwater_eq.MomentumSourceTerm.residual" title="Link to this definition">¶</a></dt>
<dd><p>Returns an UFL form of the term.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>solution</strong> – solution <code class="xref py py-class docutils literal notranslate"><span class="pre">Function</span></code> of the corresponding equation</p></li>
<li><p><strong>solution_old</strong> – a time lagged solution <code class="xref py py-class docutils literal notranslate"><span class="pre">Function</span></code></p></li>
<li><p><strong>fields</strong> – a dictionary that provides all the remaining fields that the term depends on.
The keys of the dictionary should standard field names in <cite>field_metadata</cite></p></li>
<li><p><strong>fields_old</strong> – Time lagged dictionary of fields</p></li>
<li><p><strong>bnd_conditions</strong> – A dictionary describing boundary conditions.
E.g. {3: {‘elev_2d’: Constant(1.0)}} replaces elev_2d function by a constant on boundary ID 3.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="thetis.shallowwater_eq.QuadraticDragTerm">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">thetis.shallowwater_eq.</span></span><span class="sig-name descname"><span class="pre">QuadraticDragTerm</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">u_test</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">u_space</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">eta_space</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">depth</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">options</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/shallowwater_eq.html#QuadraticDragTerm"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#thetis.shallowwater_eq.QuadraticDragTerm" title="Link to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#thetis.shallowwater_eq.ShallowWaterMomentumTerm" title="thetis.shallowwater_eq.ShallowWaterMomentumTerm"><code class="xref py py-class docutils literal notranslate"><span class="pre">ShallowWaterMomentumTerm</span></code></a></p>
<p>Quadratic Manning bottom friction term
<span class="math notranslate nohighlight">\(C_D \| \bar{\textbf{u}} \| \bar{\textbf{u}}\)</span></p>
<p>where the drag coefficient is computed with the Manning formula</p>
<div class="math notranslate nohighlight">
\[C_D = g \frac{\mu^2}{H^{1/3}}\]</div>
<p>if the Manning coefficient <span class="math notranslate nohighlight">\(\mu\)</span> is defined (see field <code class="xref py py-attr docutils literal notranslate"><span class="pre">manning_drag_coefficient</span></code>).
Otherwise <span class="math notranslate nohighlight">\(C_D\)</span> is taken as a constant (see field <code class="xref py py-attr docutils literal notranslate"><span class="pre">quadratic_drag_coefficient</span></code>).</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>function_space</strong> – the <code class="xref py py-class docutils literal notranslate"><span class="pre">FunctionSpace</span></code> the solution belongs to</p></li>
<li><p><strong>test_function</strong> – custom <code class="xref py py-class docutils literal notranslate"><span class="pre">TestFunction</span></code>.</p></li>
<li><p><strong>trial_function</strong> – custom <code class="xref py py-class docutils literal notranslate"><span class="pre">TrialFunction</span></code>.</p></li>
</ul>
</dd>
</dl>
<dl class="py method">
<dt class="sig sig-object py" id="thetis.shallowwater_eq.QuadraticDragTerm.residual">
<span class="sig-name descname"><span class="pre">residual</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">uv</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">eta</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">uv_old</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">eta_old</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fields</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fields_old</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">bnd_conditions</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/shallowwater_eq.html#QuadraticDragTerm.residual"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#thetis.shallowwater_eq.QuadraticDragTerm.residual" title="Link to this definition">¶</a></dt>
<dd><p>Returns an UFL form of the term.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>solution</strong> – solution <code class="xref py py-class docutils literal notranslate"><span class="pre">Function</span></code> of the corresponding equation</p></li>
<li><p><strong>solution_old</strong> – a time lagged solution <code class="xref py py-class docutils literal notranslate"><span class="pre">Function</span></code></p></li>
<li><p><strong>fields</strong> – a dictionary that provides all the remaining fields that the term depends on.
The keys of the dictionary should standard field names in <cite>field_metadata</cite></p></li>
<li><p><strong>fields_old</strong> – Time lagged dictionary of fields</p></li>
<li><p><strong>bnd_conditions</strong> – A dictionary describing boundary conditions.
E.g. {3: {‘elev_2d’: Constant(1.0)}} replaces elev_2d function by a constant on boundary ID 3.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="thetis.shallowwater_eq.ShallowWaterContinuityTerm">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">thetis.shallowwater_eq.</span></span><span class="sig-name descname"><span class="pre">ShallowWaterContinuityTerm</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">eta_test</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">eta_space</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">u_space</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">depth</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">options</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/shallowwater_eq.html#ShallowWaterContinuityTerm"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#thetis.shallowwater_eq.ShallowWaterContinuityTerm" title="Link to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#thetis.shallowwater_eq.ShallowWaterTerm" title="thetis.shallowwater_eq.ShallowWaterTerm"><code class="xref py py-class docutils literal notranslate"><span class="pre">ShallowWaterTerm</span></code></a></p>
<p>Generic term in the depth-integrated continuity equation that provides commonly used
members and mapping for boundary functions.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>function_space</strong> – the <code class="xref py py-class docutils literal notranslate"><span class="pre">FunctionSpace</span></code> the solution belongs to</p></li>
<li><p><strong>test_function</strong> – custom <code class="xref py py-class docutils literal notranslate"><span class="pre">TestFunction</span></code>.</p></li>
<li><p><strong>trial_function</strong> – custom <code class="xref py py-class docutils literal notranslate"><span class="pre">TrialFunction</span></code>.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="thetis.shallowwater_eq.ShallowWaterEquations">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">thetis.shallowwater_eq.</span></span><span class="sig-name descname"><span class="pre">ShallowWaterEquations</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">function_space</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">depth</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">options</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">tidal_farms</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/shallowwater_eq.html#ShallowWaterEquations"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#thetis.shallowwater_eq.ShallowWaterEquations" title="Link to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#thetis.shallowwater_eq.BaseShallowWaterEquation" title="thetis.shallowwater_eq.BaseShallowWaterEquation"><code class="xref py py-class docutils literal notranslate"><span class="pre">BaseShallowWaterEquation</span></code></a></p>
<p>2D depth-averaged shallow water equations in non-conservative form.</p>
<p>This defines the full 2D SWE equations <a class="reference internal" href="#equation-swe-freesurf">(7)</a> -
<a class="reference internal" href="#equation-swe-momentum">(8)</a>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>function_space</strong> – Mixed function space where the solution belongs</p></li>
<li><p><strong>depth</strong> – <dl class="field-list simple">
<dt class="field-odd">class<span class="colon">:</span></dt>
<dd class="field-odd"><p><cite>DepthExpression</cite> containing depth info</p>
</dd>
</dl>
</p></li>
<li><p><strong>options</strong> – <a class="reference internal" href="#thetis.utility.AttrDict" title="thetis.utility.AttrDict"><code class="xref py py-class docutils literal notranslate"><span class="pre">AttrDict</span></code></a> object containing all circulation model options</p></li>
</ul>
</dd>
</dl>
<dl class="py method">
<dt class="sig sig-object py" id="thetis.shallowwater_eq.ShallowWaterEquations.mass_term">
<span class="sig-name descname"><span class="pre">mass_term</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">solution</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/shallowwater_eq.html#ShallowWaterEquations.mass_term"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#thetis.shallowwater_eq.ShallowWaterEquations.mass_term" title="Link to this definition">¶</a></dt>
<dd><p>Returns default mass matrix term for the solution function space.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>UFL form of the mass term</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="thetis.shallowwater_eq.ShallowWaterEquations.residual">
<span class="sig-name descname"><span class="pre">residual</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">label</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">solution</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">solution_old</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fields</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fields_old</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">bnd_conditions</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/shallowwater_eq.html#ShallowWaterEquations.residual"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#thetis.shallowwater_eq.ShallowWaterEquations.residual" title="Link to this definition">¶</a></dt>
<dd><p>Returns an UFL form of the residual by summing up all the terms with the desired label.</p>
<p>Sign convention: all terms are assumed to be on the right hand side of the equation: d(u)/dt = term.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>label</strong> – string defining the type of terms to sum up. Currently one of
‘source’|’explicit’|’implicit’|’nonlinear’. Can be a list of multiple labels, or ‘all’ in which
case all defined terms are summed.</p></li>
<li><p><strong>solution</strong> – solution <code class="xref py py-class docutils literal notranslate"><span class="pre">Function</span></code> of the corresponding equation</p></li>
<li><p><strong>solution_old</strong> – a time lagged solution <code class="xref py py-class docutils literal notranslate"><span class="pre">Function</span></code></p></li>
<li><p><strong>fields</strong> – a dictionary that provides all the remaining fields that the term depends on.
The keys of the dictionary should standard field names in <cite>field_metadata</cite></p></li>
<li><p><strong>fields_old</strong> – Time lagged dictionary of fields</p></li>
<li><p><strong>bnd_conditions</strong> – A dictionary describing boundary conditions.
E.g. {3: {‘elev_2d’: Constant(1.0)}} replaces elev_2d function by a constant on boundary ID 3.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="thetis.shallowwater_eq.ShallowWaterMomentumEquation">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">thetis.shallowwater_eq.</span></span><span class="sig-name descname"><span class="pre">ShallowWaterMomentumEquation</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">u_test</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">u_space</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">eta_space</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">depth</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">options</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">tidal_farms</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/shallowwater_eq.html#ShallowWaterMomentumEquation"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#thetis.shallowwater_eq.ShallowWaterMomentumEquation" title="Link to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#thetis.shallowwater_eq.BaseShallowWaterEquation" title="thetis.shallowwater_eq.BaseShallowWaterEquation"><code class="xref py py-class docutils literal notranslate"><span class="pre">BaseShallowWaterEquation</span></code></a></p>
<p>2D depth averaged momentum equation <a class="reference internal" href="#equation-swe-momentum">(8)</a> in non-conservative
form.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>u_test</strong> – test function of the velocity function space</p></li>
<li><p><strong>u_space</strong> – velocity function space</p></li>
<li><p><strong>eta_space</strong> – elevation function space</p></li>
<li><p><strong>depth</strong> – <dl class="field-list simple">
<dt class="field-odd">class<span class="colon">:</span></dt>
<dd class="field-odd"><p><cite>DepthExpression</cite> containing depth info</p>
</dd>
</dl>
</p></li>
<li><p><strong>options</strong> – <a class="reference internal" href="#thetis.utility.AttrDict" title="thetis.utility.AttrDict"><code class="xref py py-class docutils literal notranslate"><span class="pre">AttrDict</span></code></a> object containing all circulation model options</p></li>
</ul>
</dd>
</dl>
<dl class="py method">
<dt class="sig sig-object py" id="thetis.shallowwater_eq.ShallowWaterMomentumEquation.residual">
<span class="sig-name descname"><span class="pre">residual</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">label</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">solution</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">solution_old</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fields</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fields_old</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">bnd_conditions</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/shallowwater_eq.html#ShallowWaterMomentumEquation.residual"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#thetis.shallowwater_eq.ShallowWaterMomentumEquation.residual" title="Link to this definition">¶</a></dt>
<dd><p>Returns an UFL form of the residual by summing up all the terms with the desired label.</p>
<p>Sign convention: all terms are assumed to be on the right hand side of the equation: d(u)/dt = term.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>label</strong> – string defining the type of terms to sum up. Currently one of
‘source’|’explicit’|’implicit’|’nonlinear’. Can be a list of multiple labels, or ‘all’ in which
case all defined terms are summed.</p></li>
<li><p><strong>solution</strong> – solution <code class="xref py py-class docutils literal notranslate"><span class="pre">Function</span></code> of the corresponding equation</p></li>
<li><p><strong>solution_old</strong> – a time lagged solution <code class="xref py py-class docutils literal notranslate"><span class="pre">Function</span></code></p></li>
<li><p><strong>fields</strong> – a dictionary that provides all the remaining fields that the term depends on.
The keys of the dictionary should standard field names in <cite>field_metadata</cite></p></li>
<li><p><strong>fields_old</strong> – Time lagged dictionary of fields</p></li>
<li><p><strong>bnd_conditions</strong> – A dictionary describing boundary conditions.
E.g. {3: {‘elev_2d’: Constant(1.0)}} replaces elev_2d function by a constant on boundary ID 3.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="thetis.shallowwater_eq.ShallowWaterMomentumTerm">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">thetis.shallowwater_eq.</span></span><span class="sig-name descname"><span class="pre">ShallowWaterMomentumTerm</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">u_test</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">u_space</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">eta_space</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">depth</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">options</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/shallowwater_eq.html#ShallowWaterMomentumTerm"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#thetis.shallowwater_eq.ShallowWaterMomentumTerm" title="Link to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#thetis.shallowwater_eq.ShallowWaterTerm" title="thetis.shallowwater_eq.ShallowWaterTerm"><code class="xref py py-class docutils literal notranslate"><span class="pre">ShallowWaterTerm</span></code></a></p>
<p>Generic term in the shallow water momentum equation that provides commonly used
members and mapping for boundary functions.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>function_space</strong> – the <code class="xref py py-class docutils literal notranslate"><span class="pre">FunctionSpace</span></code> the solution belongs to</p></li>
<li><p><strong>test_function</strong> – custom <code class="xref py py-class docutils literal notranslate"><span class="pre">TestFunction</span></code>.</p></li>
<li><p><strong>trial_function</strong> – custom <code class="xref py py-class docutils literal notranslate"><span class="pre">TrialFunction</span></code>.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="thetis.shallowwater_eq.ShallowWaterTerm">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">thetis.shallowwater_eq.</span></span><span class="sig-name descname"><span class="pre">ShallowWaterTerm</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">space</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">depth</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">options</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/shallowwater_eq.html#ShallowWaterTerm"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#thetis.shallowwater_eq.ShallowWaterTerm" title="Link to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#thetis.equation.Term" title="thetis.equation.Term"><code class="xref py py-class docutils literal notranslate"><span class="pre">Term</span></code></a></p>
<p>Generic term in the shallow water equations that provides commonly used
members and mapping for boundary functions.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>function_space</strong> – the <code class="xref py py-class docutils literal notranslate"><span class="pre">FunctionSpace</span></code> the solution belongs to</p></li>
<li><p><strong>test_function</strong> – custom <code class="xref py py-class docutils literal notranslate"><span class="pre">TestFunction</span></code>.</p></li>
<li><p><strong>trial_function</strong> – custom <code class="xref py py-class docutils literal notranslate"><span class="pre">TrialFunction</span></code>.</p></li>
</ul>
</dd>
</dl>
<dl class="py method">
<dt class="sig sig-object py" id="thetis.shallowwater_eq.ShallowWaterTerm.get_bnd_functions">
<span class="sig-name descname"><span class="pre">get_bnd_functions</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">eta_in</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">uv_in</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">bnd_id</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">bnd_conditions</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/shallowwater_eq.html#ShallowWaterTerm.get_bnd_functions"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#thetis.shallowwater_eq.ShallowWaterTerm.get_bnd_functions" title="Link to this definition">¶</a></dt>
<dd><p>Returns external values of elev and uv for all supported
boundary conditions.</p>
<p>Volume flux (flux) and normal velocity (un) are defined positive out of
the domain.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="thetis.shallowwater_eq.ShallowWaterTerm.impose_dynamic_bnd">
<span class="sig-name descname"><span class="pre">impose_dynamic_bnd</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">bnd_funcs</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">bnd_id</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/shallowwater_eq.html#ShallowWaterTerm.impose_dynamic_bnd"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#thetis.shallowwater_eq.ShallowWaterTerm.impose_dynamic_bnd" title="Link to this definition">¶</a></dt>
<dd><p>Check if the prognostic variables have been specified on the boundary.</p>
<p>If any prognostic value has been specified, dynamic boundary terms
will be evaluated. If not, a closed boundary is assumed (which implies
e.g. that volume flux boundary terms are omitted).</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>bnd_funcs</strong> – None or dictionary of boundary coefficients.</p></li>
<li><p><strong>bnd_id</strong> – Boundary marker id</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>True if elev or uv is defined, otherwise False.</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="thetis.shallowwater_eq.WindStressTerm">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">thetis.shallowwater_eq.</span></span><span class="sig-name descname"><span class="pre">WindStressTerm</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">u_test</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">u_space</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">eta_space</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">depth</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">options</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/shallowwater_eq.html#WindStressTerm"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#thetis.shallowwater_eq.WindStressTerm" title="Link to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#thetis.shallowwater_eq.ShallowWaterMomentumTerm" title="thetis.shallowwater_eq.ShallowWaterMomentumTerm"><code class="xref py py-class docutils literal notranslate"><span class="pre">ShallowWaterMomentumTerm</span></code></a></p>
<p>Wind stress term, <span class="math notranslate nohighlight">\(-\tau_w/(H \rho_0)\)</span></p>
<p>Here <span class="math notranslate nohighlight">\(\tau_w\)</span> is a user-defined wind stress <code class="xref py py-class docutils literal notranslate"><span class="pre">Function</span></code>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>function_space</strong> – the <code class="xref py py-class docutils literal notranslate"><span class="pre">FunctionSpace</span></code> the solution belongs to</p></li>
<li><p><strong>test_function</strong> – custom <code class="xref py py-class docutils literal notranslate"><span class="pre">TestFunction</span></code>.</p></li>
<li><p><strong>trial_function</strong> – custom <code class="xref py py-class docutils literal notranslate"><span class="pre">TrialFunction</span></code>.</p></li>
</ul>
</dd>
</dl>
<dl class="py method">
<dt class="sig sig-object py" id="thetis.shallowwater_eq.WindStressTerm.residual">
<span class="sig-name descname"><span class="pre">residual</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">uv</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">eta</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">uv_old</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">eta_old</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fields</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fields_old</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">bnd_conditions</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/shallowwater_eq.html#WindStressTerm.residual"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#thetis.shallowwater_eq.WindStressTerm.residual" title="Link to this definition">¶</a></dt>
<dd><p>Returns an UFL form of the term.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>solution</strong> – solution <code class="xref py py-class docutils literal notranslate"><span class="pre">Function</span></code> of the corresponding equation</p></li>
<li><p><strong>solution_old</strong> – a time lagged solution <code class="xref py py-class docutils literal notranslate"><span class="pre">Function</span></code></p></li>
<li><p><strong>fields</strong> – a dictionary that provides all the remaining fields that the term depends on.
The keys of the dictionary should standard field names in <cite>field_metadata</cite></p></li>
<li><p><strong>fields_old</strong> – Time lagged dictionary of fields</p></li>
<li><p><strong>bnd_conditions</strong> – A dictionary describing boundary conditions.
E.g. {3: {‘elev_2d’: Constant(1.0)}} replaces elev_2d function by a constant on boundary ID 3.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

</dd></dl>

</section>
<section id="module-thetis.solver">
<span id="thetis-solver-module"></span><h2>thetis.solver module<a class="headerlink" href="#module-thetis.solver" title="Link to this heading">¶</a></h2>
<p>Module for three dimensional baroclinic solver</p>
<dl class="py class">
<dt class="sig sig-object py" id="thetis.solver.FlowSolver">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">thetis.solver.</span></span><span class="sig-name descname"><span class="pre">FlowSolver</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">mesh2d</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">bathymetry_2d</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n_layers</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">options</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">extrude_options</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">keep_log</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/solver.html#FlowSolver"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#thetis.solver.FlowSolver" title="Link to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#thetis.utility.FrozenClass" title="thetis.utility.FrozenClass"><code class="xref py py-class docutils literal notranslate"><span class="pre">FrozenClass</span></code></a></p>
<p>Main object for 3D solver</p>
<p><strong>Example</strong></p>
<p>Create 2D mesh</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span><span class="w"> </span><span class="nn">thetis</span><span class="w"> </span><span class="kn">import</span> <span class="o">*</span>
<span class="n">mesh2d</span> <span class="o">=</span> <span class="n">RectangleMesh</span><span class="p">(</span><span class="mi">20</span><span class="p">,</span> <span class="mi">20</span><span class="p">,</span> <span class="mf">10e3</span><span class="p">,</span> <span class="mf">10e3</span><span class="p">)</span>
</pre></div>
</div>
<p>Create bathymetry function, set a constant value</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">fs_p1</span> <span class="o">=</span> <span class="n">FunctionSpace</span><span class="p">(</span><span class="n">mesh2d</span><span class="p">,</span> <span class="s1">&#39;CG&#39;</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
<span class="n">bathymetry_2d</span> <span class="o">=</span> <span class="n">Function</span><span class="p">(</span><span class="n">fs_p1</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="s1">&#39;Bathymetry&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">assign</span><span class="p">(</span><span class="mf">10.0</span><span class="p">)</span>
</pre></div>
</div>
<p>Create a 3D model with 6 uniform levels, and set some options
(see <a class="reference internal" href="#thetis.options.ModelOptions3d" title="thetis.options.ModelOptions3d"><code class="xref py py-class docutils literal notranslate"><span class="pre">ModelOptions3d</span></code></a>)</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">solver_obj</span> <span class="o">=</span> <span class="n">solver</span><span class="o">.</span><span class="n">FlowSolver</span><span class="p">(</span><span class="n">mesh2d</span><span class="p">,</span> <span class="n">bathymetry_2d</span><span class="p">,</span> <span class="n">n_layers</span><span class="o">=</span><span class="mi">6</span><span class="p">)</span>
<span class="n">options</span> <span class="o">=</span> <span class="n">solver_obj</span><span class="o">.</span><span class="n">options</span>
<span class="n">options</span><span class="o">.</span><span class="n">element_family</span> <span class="o">=</span> <span class="s1">&#39;dg-dg&#39;</span>
<span class="n">options</span><span class="o">.</span><span class="n">polynomial_degree</span> <span class="o">=</span> <span class="mi">1</span>
<span class="n">options</span><span class="o">.</span><span class="n">timestepper_type</span> <span class="o">=</span> <span class="s1">&#39;SSPRK22&#39;</span>
<span class="n">options</span><span class="o">.</span><span class="n">timestepper_options</span><span class="o">.</span><span class="n">use_automatic_timestep</span> <span class="o">=</span> <span class="kc">False</span>
<span class="n">options</span><span class="o">.</span><span class="n">solve_salinity</span> <span class="o">=</span> <span class="kc">False</span>
<span class="n">options</span><span class="o">.</span><span class="n">solve_temperature</span> <span class="o">=</span> <span class="kc">False</span>
<span class="n">options</span><span class="o">.</span><span class="n">simulation_export_time</span> <span class="o">=</span> <span class="mf">50.0</span>
<span class="n">options</span><span class="o">.</span><span class="n">simulation_end_time</span> <span class="o">=</span> <span class="mf">3600.</span>
<span class="n">options</span><span class="o">.</span><span class="n">timestep</span> <span class="o">=</span> <span class="mf">25.0</span>
</pre></div>
</div>
<p>Assign initial condition for water elevation</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">solver_obj</span><span class="o">.</span><span class="n">create_function_spaces</span><span class="p">()</span>
<span class="n">init_elev</span> <span class="o">=</span> <span class="n">Function</span><span class="p">(</span><span class="n">solver_obj</span><span class="o">.</span><span class="n">function_spaces</span><span class="o">.</span><span class="n">H_2d</span><span class="p">)</span>
<span class="n">coords</span> <span class="o">=</span> <span class="n">SpatialCoordinate</span><span class="p">(</span><span class="n">mesh2d</span><span class="p">)</span>
<span class="n">init_elev</span><span class="o">.</span><span class="n">project</span><span class="p">(</span><span class="mf">2.0</span><span class="o">*</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="p">((</span><span class="n">coords</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">-</span> <span class="mf">4e3</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span> <span class="o">+</span> <span class="p">(</span><span class="n">coords</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">-</span> <span class="mf">4.5e3</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span><span class="o">/</span><span class="mf">2.2e3</span><span class="o">**</span><span class="mi">2</span><span class="p">))</span>
<span class="n">solver_obj</span><span class="o">.</span><span class="n">assign_initial_conditions</span><span class="p">(</span><span class="n">elev</span><span class="o">=</span><span class="n">init_elev</span><span class="p">)</span>
</pre></div>
</div>
<p>Run simulation</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">solver_obj</span><span class="o">.</span><span class="n">iterate</span><span class="p">()</span>
</pre></div>
</div>
<p>See the manual for more complex examples.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>mesh2d</strong> – <code class="xref py py-class docutils literal notranslate"><span class="pre">Mesh</span></code> object of the 2D mesh</p></li>
<li><p><strong>bathymetry_2d</strong> (2D <code class="xref py py-class docutils literal notranslate"><span class="pre">Function</span></code>) – Bathymetry of the domain. Bathymetry stands for
the mean water depth (positive downwards).</p></li>
<li><p><strong>n_layers</strong> (<a class="reference external" href="https://docs.python.org/2.7/library/functions.html#int" title="(in Python v2.7)"><em>int</em></a>) – Number of layers in the vertical direction.
Elements are distributed uniformly over the vertical.</p></li>
<li><p><strong>options</strong> (<a class="reference internal" href="#thetis.options.ModelOptions3d" title="thetis.options.ModelOptions3d"><code class="xref py py-class docutils literal notranslate"><span class="pre">ModelOptions3d</span></code></a> instance) – Model options (optional). Model options can also be
changed directly via the <a class="reference internal" href="#thetis.solver.FlowSolver.options" title="thetis.solver.FlowSolver.options"><code class="xref py py-attr docutils literal notranslate"><span class="pre">options</span></code></a> class property.</p></li>
<li><p><strong>keep_log</strong> (<a class="reference external" href="https://docs.python.org/2.7/library/functions.html#bool" title="(in Python v2.7)"><em>bool</em></a>) – append to an existing log file, or overwrite it?</p></li>
</ul>
</dd>
</dl>
<dl class="py attribute">
<dt class="sig sig-object py" id="thetis.solver.FlowSolver.M_modesplit">
<span class="sig-name descname"><span class="pre">M_modesplit</span></span><a class="headerlink" href="#thetis.solver.FlowSolver.M_modesplit" title="Link to this definition">¶</a></dt>
<dd><p>Mode split ratio (int)</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="thetis.solver.FlowSolver.add_callback">
<span class="sig-name descname"><span class="pre">add_callback</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">callback</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">eval_interval</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'export'</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/solver.html#FlowSolver.add_callback"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#thetis.solver.FlowSolver.add_callback" title="Link to this definition">¶</a></dt>
<dd><p>Adds callback to solver object</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>callback</strong> – <a class="reference internal" href="#thetis.callback.DiagnosticCallback" title="thetis.callback.DiagnosticCallback"><code class="xref py py-class docutils literal notranslate"><span class="pre">DiagnosticCallback</span></code></a> instance</p></li>
<li><p><strong>eval_interval</strong> (<a class="reference external" href="https://docs.python.org/2.7/library/functions.html#str" title="(in Python v2.7)"><em>str</em></a>) – Determines when callback will be evaluated,
either ‘export’ or ‘timestep’ for evaluating after each export or
time step.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="thetis.solver.FlowSolver.add_new_field">
<span class="sig-name descname"><span class="pre">add_new_field</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">function</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">label</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">name</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">filename</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">shortname</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">unit</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'-'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">preproc_func</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/solver.html#FlowSolver.add_new_field"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#thetis.solver.FlowSolver.add_new_field" title="Link to this definition">¶</a></dt>
<dd><p>Add a field to <a class="reference internal" href="#thetis.solver.FlowSolver.fields" title="thetis.solver.FlowSolver.fields"><code class="xref py py-attr docutils literal notranslate"><span class="pre">fields</span></code></a>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>function</strong> – representation of the field as a <code class="xref py py-class docutils literal notranslate"><span class="pre">Function</span></code></p></li>
<li><p><strong>label</strong> – field label used internally by Thetis, e.g. ‘tracer_3d’</p></li>
<li><p><strong>name</strong> – human readable name for the tracer field, e.g. ‘Tracer concentration’</p></li>
<li><p><strong>filename</strong> – file name for outputs, e.g. ‘Tracer3d’</p></li>
<li><p><strong>shortname</strong> – short version of name, e.g. ‘Tracer’</p></li>
<li><p><strong>unit</strong> – units for field, e.g. ‘-’</p></li>
<li><p><strong>preproc_func</strong> – optional pre-processor function which will be called before exporting</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="thetis.solver.FlowSolver.assign_initial_conditions">
<span class="sig-name descname"><span class="pre">assign_initial_conditions</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">elev</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">salt</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">temp</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">uv_2d</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">uv_3d</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">tke</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">psi</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/solver.html#FlowSolver.assign_initial_conditions"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#thetis.solver.FlowSolver.assign_initial_conditions" title="Link to this definition">¶</a></dt>
<dd><p>Assigns initial conditions</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>elev</strong> (scalar 2D <code class="xref py py-class docutils literal notranslate"><span class="pre">Function</span></code>, <code class="xref py py-class docutils literal notranslate"><span class="pre">Constant</span></code>, or an expression) – Initial condition for water elevation</p></li>
<li><p><strong>salt</strong> (scalar 3D <code class="xref py py-class docutils literal notranslate"><span class="pre">Function</span></code>, <code class="xref py py-class docutils literal notranslate"><span class="pre">Constant</span></code>, or an expression) – Initial condition for salinity field</p></li>
<li><p><strong>temp</strong> (scalar 3D <code class="xref py py-class docutils literal notranslate"><span class="pre">Function</span></code>, <code class="xref py py-class docutils literal notranslate"><span class="pre">Constant</span></code>, or an expression) – Initial condition for temperature field</p></li>
<li><p><strong>uv_2d</strong> (vector valued 2D <code class="xref py py-class docutils literal notranslate"><span class="pre">Function</span></code>, <code class="xref py py-class docutils literal notranslate"><span class="pre">Constant</span></code>, or an expression) – Initial condition for depth averaged velocity</p></li>
<li><p><strong>uv_3d</strong> (vector valued 3D <code class="xref py py-class docutils literal notranslate"><span class="pre">Function</span></code>, <code class="xref py py-class docutils literal notranslate"><span class="pre">Constant</span></code>, or an expression) – Initial condition for horizontal velocity</p></li>
<li><p><strong>tke</strong> (scalar 3D <code class="xref py py-class docutils literal notranslate"><span class="pre">Function</span></code>, <code class="xref py py-class docutils literal notranslate"><span class="pre">Constant</span></code>, or an expression) – Initial condition for turbulent kinetic energy field</p></li>
<li><p><strong>psi</strong> (scalar 3D <code class="xref py py-class docutils literal notranslate"><span class="pre">Function</span></code>, <code class="xref py py-class docutils literal notranslate"><span class="pre">Constant</span></code>, or an expression) – Initial condition for turbulence generic length scale field</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="thetis.solver.FlowSolver.callbacks">
<span class="sig-name descname"><span class="pre">callbacks</span></span><a class="headerlink" href="#thetis.solver.FlowSolver.callbacks" title="Link to this definition">¶</a></dt>
<dd><p><a class="reference internal" href="#thetis.callback.CallbackManager" title="thetis.callback.CallbackManager"><code class="xref py py-class docutils literal notranslate"><span class="pre">CallbackManager</span></code></a> object that stores all callbacks</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="thetis.solver.FlowSolver.compute_dt_2d">
<span class="sig-name descname"><span class="pre">compute_dt_2d</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">u_scale</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/solver.html#FlowSolver.compute_dt_2d"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#thetis.solver.FlowSolver.compute_dt_2d" title="Link to this definition">¶</a></dt>
<dd><p>Computes maximum explicit time step from CFL condition.</p>
<div class="math notranslate nohighlight">
\[\Delta t = \frac{\Delta x}{U}\]</div>
<p>Assumes velocity scale <span class="math notranslate nohighlight">\(U = \sqrt{g H} + U_{scale}\)</span> where
<span class="math notranslate nohighlight">\(U_{scale}\)</span> is estimated advective velocity.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>u_scale</strong> (float or <code class="xref py py-class docutils literal notranslate"><span class="pre">Constant</span></code>) – User provided maximum advective velocity scale</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="thetis.solver.FlowSolver.compute_dt_diffusion">
<span class="sig-name descname"><span class="pre">compute_dt_diffusion</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">nu_scale</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/solver.html#FlowSolver.compute_dt_diffusion"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#thetis.solver.FlowSolver.compute_dt_diffusion" title="Link to this definition">¶</a></dt>
<dd><p>Computes maximum explicit time step for horizontal diffusion.</p>
<div class="math notranslate nohighlight">
\[\Delta t = \alpha \frac{(\Delta x)^2}{\nu_{scale}}\]</div>
<p>where <span class="math notranslate nohighlight">\(\nu_{scale}\)</span> is estimated diffusivity scale.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="thetis.solver.FlowSolver.compute_dt_h_advection">
<span class="sig-name descname"><span class="pre">compute_dt_h_advection</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">u_scale</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/solver.html#FlowSolver.compute_dt_h_advection"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#thetis.solver.FlowSolver.compute_dt_h_advection" title="Link to this definition">¶</a></dt>
<dd><p>Computes maximum explicit time step for horizontal advection</p>
<div class="math notranslate nohighlight">
\[\Delta t = \frac{\Delta x}{U_{scale}}\]</div>
<p>where <span class="math notranslate nohighlight">\(U_{scale}\)</span> is estimated horizontal advective velocity.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>u_scale</strong> (float or <code class="xref py py-class docutils literal notranslate"><span class="pre">Constant</span></code>) – User provided maximum horizontal velocity scale</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="thetis.solver.FlowSolver.compute_dt_v_advection">
<span class="sig-name descname"><span class="pre">compute_dt_v_advection</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">w_scale</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/solver.html#FlowSolver.compute_dt_v_advection"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#thetis.solver.FlowSolver.compute_dt_v_advection" title="Link to this definition">¶</a></dt>
<dd><p>Computes maximum explicit time step for vertical advection</p>
<div class="math notranslate nohighlight">
\[\Delta t = \frac{\Delta z}{W_{scale}}\]</div>
<p>where <span class="math notranslate nohighlight">\(W_{scale}\)</span> is estimated vertical advective velocity.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>w_scale</strong> (float or <code class="xref py py-class docutils literal notranslate"><span class="pre">Constant</span></code>) – User provided maximum vertical velocity scale</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="thetis.solver.FlowSolver.compute_dx_factor">
<span class="sig-name descname"><span class="pre">compute_dx_factor</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/solver.html#FlowSolver.compute_dx_factor"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#thetis.solver.FlowSolver.compute_dx_factor" title="Link to this definition">¶</a></dt>
<dd><p>Computes normalized distance between nodes in the horizontal direction</p>
<p>The factor depends on the finite element space and its polynomial
degree. It is used to compute maximal stable time steps.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="thetis.solver.FlowSolver.compute_dz_factor">
<span class="sig-name descname"><span class="pre">compute_dz_factor</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/solver.html#FlowSolver.compute_dz_factor"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#thetis.solver.FlowSolver.compute_dz_factor" title="Link to this definition">¶</a></dt>
<dd><p>Computes a normalized distance between nodes in the vertical direction</p>
<p>The factor depends on the finite element space and its polynomial
degree. It is used to compute maximal stable time steps.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="thetis.solver.FlowSolver.compute_mesh_stats">
<span class="sig-name descname"><span class="pre">compute_mesh_stats</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/solver.html#FlowSolver.compute_mesh_stats"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#thetis.solver.FlowSolver.compute_mesh_stats" title="Link to this definition">¶</a></dt>
<dd><p>Computes number of elements, nodes etc and prints to sdtout</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="thetis.solver.FlowSolver.create_equations">
<span class="sig-name descname"><span class="pre">create_equations</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/solver.html#FlowSolver.create_equations"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#thetis.solver.FlowSolver.create_equations" title="Link to this definition">¶</a></dt>
<dd><p>Creates equation instances</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="thetis.solver.FlowSolver.create_exporters">
<span class="sig-name descname"><span class="pre">create_exporters</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/solver.html#FlowSolver.create_exporters"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#thetis.solver.FlowSolver.create_exporters" title="Link to this definition">¶</a></dt>
<dd><p>Creates file exporters</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="thetis.solver.FlowSolver.create_fields">
<span class="sig-name descname"><span class="pre">create_fields</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/solver.html#FlowSolver.create_fields"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#thetis.solver.FlowSolver.create_fields" title="Link to this definition">¶</a></dt>
<dd><p>Creates all fields</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="thetis.solver.FlowSolver.create_function_spaces">
<span class="sig-name descname"><span class="pre">create_function_spaces</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/solver.html#FlowSolver.create_function_spaces"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#thetis.solver.FlowSolver.create_function_spaces" title="Link to this definition">¶</a></dt>
<dd><p>Creates function spaces</p>
<p>Function spaces are accessible via <a class="reference internal" href="#thetis.solver.FlowSolver.function_spaces" title="thetis.solver.FlowSolver.function_spaces"><code class="xref py py-attr docutils literal notranslate"><span class="pre">function_spaces</span></code></a>
object.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="thetis.solver.FlowSolver.create_timestepper">
<span class="sig-name descname"><span class="pre">create_timestepper</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/solver.html#FlowSolver.create_timestepper"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#thetis.solver.FlowSolver.create_timestepper" title="Link to this definition">¶</a></dt>
<dd><p>Creates time stepper instance</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="thetis.solver.FlowSolver.dt">
<span class="sig-name descname"><span class="pre">dt</span></span><a class="headerlink" href="#thetis.solver.FlowSolver.dt" title="Link to this definition">¶</a></dt>
<dd><p>Time step</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="thetis.solver.FlowSolver.dt_2d">
<span class="sig-name descname"><span class="pre">dt_2d</span></span><a class="headerlink" href="#thetis.solver.FlowSolver.dt_2d" title="Link to this definition">¶</a></dt>
<dd><p>Time of the 2D solver</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="thetis.solver.FlowSolver.export">
<span class="sig-name descname"><span class="pre">export</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/solver.html#FlowSolver.export"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#thetis.solver.FlowSolver.export" title="Link to this definition">¶</a></dt>
<dd><p>Export all fields to disk</p>
<p>Also evaluates all callbacks set to ‘export’ interval.</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="thetis.solver.FlowSolver.export_initial_state">
<span class="sig-name descname"><span class="pre">export_initial_state</span></span><a class="headerlink" href="#thetis.solver.FlowSolver.export_initial_state" title="Link to this definition">¶</a></dt>
<dd><p>Do export initial state. False if continuing a simulation</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="thetis.solver.FlowSolver.fields">
<span class="sig-name descname"><span class="pre">fields</span></span><a class="headerlink" href="#thetis.solver.FlowSolver.fields" title="Link to this definition">¶</a></dt>
<dd><p><a class="reference internal" href="#thetis.utility.FieldDict" title="thetis.utility.FieldDict"><code class="xref py py-class docutils literal notranslate"><span class="pre">FieldDict</span></code></a> that holds all functions needed by the solver
object</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="thetis.solver.FlowSolver.function_spaces">
<span class="sig-name descname"><span class="pre">function_spaces</span></span><a class="headerlink" href="#thetis.solver.FlowSolver.function_spaces" title="Link to this definition">¶</a></dt>
<dd><p><a class="reference internal" href="#thetis.utility.AttrDict" title="thetis.utility.AttrDict"><code class="xref py py-class docutils literal notranslate"><span class="pre">AttrDict</span></code></a> that holds all function spaces needed by the
solver object</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="thetis.solver.FlowSolver.initialize">
<span class="sig-name descname"><span class="pre">initialize</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/solver.html#FlowSolver.initialize"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#thetis.solver.FlowSolver.initialize" title="Link to this definition">¶</a></dt>
<dd><p>Creates function spaces, equations, time stepper and exporters</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="thetis.solver.FlowSolver.iterate">
<span class="sig-name descname"><span class="pre">iterate</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">update_forcings</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">update_forcings3d</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">export_func</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/solver.html#FlowSolver.iterate"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#thetis.solver.FlowSolver.iterate" title="Link to this definition">¶</a></dt>
<dd><p>Runs the simulation</p>
<p>Iterates over the time loop until time <code class="docutils literal notranslate"><span class="pre">options.simulation_end_time</span></code> is reached.
Exports fields to disk on <code class="docutils literal notranslate"><span class="pre">options.simulation_export_time</span></code> intervals.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>update_forcings</strong> – User-defined function that takes simulation
time as an argument and updates time-dependent boundary conditions
of the 2D system (if any).</p></li>
<li><p><strong>update_forcings_3d</strong> – User-defined function that takes simulation
time as an argument and updates time-dependent boundary conditions
of the 3D equations (if any).</p></li>
<li><p><strong>export_func</strong> – User-defined function (with no arguments) that will
be called on every export.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="thetis.solver.FlowSolver.load_state">
<span class="sig-name descname"><span class="pre">load_state</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">i_stored</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">outputdir</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">t</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">iteration</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">i_export</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">legacy_mode</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/solver.html#FlowSolver.load_state"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#thetis.solver.FlowSolver.load_state" title="Link to this definition">¶</a></dt>
<dd><p>Loads simulation state from hdf5 outputs.</p>
<p>Replaces <a class="reference internal" href="#thetis.solver.FlowSolver.assign_initial_conditions" title="thetis.solver.FlowSolver.assign_initial_conditions"><code class="xref py py-meth docutils literal notranslate"><span class="pre">assign_initial_conditions()</span></code></a> in model initialization.</p>
<p>For example, continue simulation from export 40,</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">solver_obj</span><span class="o">.</span><span class="n">load_state</span><span class="p">(</span><span class="mi">40</span><span class="p">)</span>
</pre></div>
</div>
<p>Continue simulation from another output directory,</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">solver_obj</span><span class="o">.</span><span class="n">load_state</span><span class="p">(</span><span class="mi">40</span><span class="p">,</span> <span class="n">outputdir</span><span class="o">=</span><span class="s1">&#39;outputs_spinup&#39;</span><span class="p">)</span>
</pre></div>
</div>
<p>Continue simulation from another output directory and reset the
counters,</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">solver_obj</span><span class="o">.</span><span class="n">load_state</span><span class="p">(</span><span class="mi">40</span><span class="p">,</span> <span class="n">outputdir</span><span class="o">=</span><span class="s1">&#39;outputs_spinup&#39;</span><span class="p">,</span>
    <span class="n">iteration</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">t</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">i_export</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
</pre></div>
</div>
<p>Model state can be loaded if all prognostic state variables have been
stored in hdf5 format. Required state variables are: <cite>elev_2d</cite>,
<cite>uv_2d</cite>, <cite>uv_3d</cite>, <cite>salt_3d</cite>, <cite>temp_3d</cite>, <cite>tke_3d</cite>, and <cite>psi_3d</cite>.</p>
<p>Simulation time and iteration can be recovered automatically provided
that the model setup is the same (e.g. time step and export_time).</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>i_stored</strong> (<a class="reference external" href="https://docs.python.org/2.7/library/functions.html#int" title="(in Python v2.7)"><em>int</em></a>) – export index to load</p></li>
<li><p><strong>outputdir</strong> (<em>string</em>) – (optional) directory where files are read from.
By default <code class="docutils literal notranslate"><span class="pre">options.output_directory</span></code>.</p></li>
<li><p><strong>t</strong> (<a class="reference external" href="https://docs.python.org/2.7/library/functions.html#float" title="(in Python v2.7)"><em>float</em></a>) – simulation time. Overrides the time stamp inferred from
model options.</p></li>
<li><p><strong>iteration</strong> (<a class="reference external" href="https://docs.python.org/2.7/library/functions.html#int" title="(in Python v2.7)"><em>int</em></a>) – Overrides the iteration count inferred from model
options.</p></li>
<li><p><strong>i_export</strong> (<a class="reference external" href="https://docs.python.org/2.7/library/functions.html#int" title="(in Python v2.7)"><em>int</em></a>) – Set initial export index for the present run. By
default, <cite>i_stored</cite> is used.</p></li>
<li><p><strong>legacy_mode</strong> (<a class="reference external" href="https://docs.python.org/2.7/library/functions.html#bool" title="(in Python v2.7)"><em>bool</em></a>) – Load legacy <cite>DumbCheckpoint</cite> files.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="thetis.solver.FlowSolver.mesh">
<span class="sig-name descname"><span class="pre">mesh</span></span><a class="headerlink" href="#thetis.solver.FlowSolver.mesh" title="Link to this definition">¶</a></dt>
<dd><p>3D :class`Mesh`</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="thetis.solver.FlowSolver.mesh2d">
<span class="sig-name descname"><span class="pre">mesh2d</span></span><a class="headerlink" href="#thetis.solver.FlowSolver.mesh2d" title="Link to this definition">¶</a></dt>
<dd><p>2D :class`Mesh`</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="thetis.solver.FlowSolver.options">
<span class="sig-name descname"><span class="pre">options</span></span><a class="headerlink" href="#thetis.solver.FlowSolver.options" title="Link to this definition">¶</a></dt>
<dd><p>Dictionary of all options. A <a class="reference internal" href="#thetis.options.ModelOptions3d" title="thetis.options.ModelOptions3d"><code class="xref py py-class docutils literal notranslate"><span class="pre">ModelOptions3d</span></code></a> object.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="thetis.solver.FlowSolver.print_state">
<span class="sig-name descname"><span class="pre">print_state</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">cputime</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">print_header</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/solver.html#FlowSolver.print_state"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#thetis.solver.FlowSolver.print_state" title="Link to this definition">¶</a></dt>
<dd><p>Print a summary of the model state on stdout</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>cputime</strong> (<a class="reference external" href="https://docs.python.org/2.7/library/functions.html#float" title="(in Python v2.7)"><em>float</em></a>) – Measured CPU time in seconds</p></li>
<li><p><strong>print_header</strong> – Whether to print column header first</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="thetis.solver.FlowSolver.print_state_debug">
<span class="sig-name descname"><span class="pre">print_state_debug</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/solver.html#FlowSolver.print_state_debug"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#thetis.solver.FlowSolver.print_state_debug" title="Link to this definition">¶</a></dt>
<dd><p>Print min/max values of prognostic/diagnostic fields for debugging.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="thetis.solver.FlowSolver.set_time_step">
<span class="sig-name descname"><span class="pre">set_time_step</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/solver.html#FlowSolver.set_time_step"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#thetis.solver.FlowSolver.set_time_step" title="Link to this definition">¶</a></dt>
<dd><p>Sets the model the model time step</p>
<p>If the time integrator supports automatic time step, and
<code class="xref py py-attr docutils literal notranslate"><span class="pre">ModelOptions3d.timestepper_options.use_automatic_timestep</span></code> is
<cite>True</cite>, we compute the maximum time step allowed by the CFL condition.
Otherwise uses <code class="xref py py-attr docutils literal notranslate"><span class="pre">ModelOptions3d.timestep</span></code>.</p>
<p>Once the time step is determined, will adjust it to be an integer
fraction of export interval <code class="docutils literal notranslate"><span class="pre">options.simulation_export_time</span></code>.</p>
</dd></dl>

</dd></dl>

</section>
<section id="module-thetis.solver2d">
<span id="thetis-solver2d-module"></span><h2>thetis.solver2d module<a class="headerlink" href="#module-thetis.solver2d" title="Link to this heading">¶</a></h2>
<p>Module for 2D depth averaged solver</p>
<dl class="py class">
<dt class="sig sig-object py" id="thetis.solver2d.FlowSolver2d">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">thetis.solver2d.</span></span><span class="sig-name descname"><span class="pre">FlowSolver2d</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">mesh2d</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">bathymetry_2d</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">options</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">keep_log</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/solver2d.html#FlowSolver2d"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#thetis.solver2d.FlowSolver2d" title="Link to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#thetis.utility.FrozenClass" title="thetis.utility.FrozenClass"><code class="xref py py-class docutils literal notranslate"><span class="pre">FrozenClass</span></code></a></p>
<p>Main object for 2D depth averaged solver</p>
<p><strong>Example</strong></p>
<p>Create mesh</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span><span class="w"> </span><span class="nn">thetis</span><span class="w"> </span><span class="kn">import</span> <span class="o">*</span>
<span class="n">mesh2d</span> <span class="o">=</span> <span class="n">RectangleMesh</span><span class="p">(</span><span class="mi">20</span><span class="p">,</span> <span class="mi">20</span><span class="p">,</span> <span class="mf">10e3</span><span class="p">,</span> <span class="mf">10e3</span><span class="p">)</span>
</pre></div>
</div>
<p>Create bathymetry function, set a constant value</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">fs_p1</span> <span class="o">=</span> <span class="n">FunctionSpace</span><span class="p">(</span><span class="n">mesh2d</span><span class="p">,</span> <span class="s1">&#39;CG&#39;</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
<span class="n">bathymetry_2d</span> <span class="o">=</span> <span class="n">Function</span><span class="p">(</span><span class="n">fs_p1</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="s1">&#39;Bathymetry&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">assign</span><span class="p">(</span><span class="mf">10.0</span><span class="p">)</span>
</pre></div>
</div>
<p>Create solver object and set some options</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">solver_obj</span> <span class="o">=</span> <span class="n">solver2d</span><span class="o">.</span><span class="n">FlowSolver2d</span><span class="p">(</span><span class="n">mesh2d</span><span class="p">,</span> <span class="n">bathymetry_2d</span><span class="p">)</span>
<span class="n">options</span> <span class="o">=</span> <span class="n">solver_obj</span><span class="o">.</span><span class="n">options</span>
<span class="n">options</span><span class="o">.</span><span class="n">element_family</span> <span class="o">=</span> <span class="s1">&#39;dg-dg&#39;</span>
<span class="n">options</span><span class="o">.</span><span class="n">polynomial_degree</span> <span class="o">=</span> <span class="mi">1</span>
<span class="n">options</span><span class="o">.</span><span class="n">swe_timestepper_type</span> <span class="o">=</span> <span class="s1">&#39;CrankNicolson&#39;</span>
<span class="n">options</span><span class="o">.</span><span class="n">simulation_export_time</span> <span class="o">=</span> <span class="mf">50.0</span>
<span class="n">options</span><span class="o">.</span><span class="n">simulation_end_time</span> <span class="o">=</span> <span class="mf">3600.</span>
<span class="n">options</span><span class="o">.</span><span class="n">timestep</span> <span class="o">=</span> <span class="mf">25.0</span>
</pre></div>
</div>
<p>Assign initial condition for water elevation</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">solver_obj</span><span class="o">.</span><span class="n">create_function_spaces</span><span class="p">()</span>
<span class="n">init_elev</span> <span class="o">=</span> <span class="n">Function</span><span class="p">(</span><span class="n">solver_obj</span><span class="o">.</span><span class="n">function_spaces</span><span class="o">.</span><span class="n">H_2d</span><span class="p">)</span>
<span class="n">coords</span> <span class="o">=</span> <span class="n">SpatialCoordinate</span><span class="p">(</span><span class="n">mesh2d</span><span class="p">)</span>
<span class="n">init_elev</span><span class="o">.</span><span class="n">project</span><span class="p">(</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="p">((</span><span class="n">coords</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">-</span> <span class="mf">4e3</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span> <span class="o">+</span> <span class="p">(</span><span class="n">coords</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">-</span> <span class="mf">4.5e3</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span><span class="o">/</span><span class="mf">2.2e3</span><span class="o">**</span><span class="mi">2</span><span class="p">))</span>
<span class="n">solver_obj</span><span class="o">.</span><span class="n">assign_initial_conditions</span><span class="p">(</span><span class="n">elev</span><span class="o">=</span><span class="n">init_elev</span><span class="p">)</span>
</pre></div>
</div>
<p>Run simulation</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">solver_obj</span><span class="o">.</span><span class="n">iterate</span><span class="p">()</span>
</pre></div>
</div>
<p>See the manual for more complex examples.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>mesh2d</strong> – <code class="xref py py-class docutils literal notranslate"><span class="pre">Mesh</span></code> object of the 2D mesh</p></li>
<li><p><strong>bathymetry_2d</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">Function</span></code>) – Bathymetry of the domain. Bathymetry stands for
the mean water depth (positive downwards).</p></li>
<li><p><strong>options</strong> (<a class="reference internal" href="#thetis.options.ModelOptions2d" title="thetis.options.ModelOptions2d"><code class="xref py py-class docutils literal notranslate"><span class="pre">ModelOptions2d</span></code></a> instance) – Model options (optional). Model options can also be
changed directly via the <a class="reference internal" href="#thetis.solver2d.FlowSolver2d.options" title="thetis.solver2d.FlowSolver2d.options"><code class="xref py py-attr docutils literal notranslate"><span class="pre">options</span></code></a> class property.</p></li>
<li><p><strong>keep_log</strong> (<a class="reference external" href="https://docs.python.org/2.7/library/functions.html#bool" title="(in Python v2.7)"><em>bool</em></a>) – append to an existing log file, or overwrite it?</p></li>
</ul>
</dd>
</dl>
<dl class="py method">
<dt class="sig sig-object py" id="thetis.solver2d.FlowSolver2d.add_callback">
<span class="sig-name descname"><span class="pre">add_callback</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">callback</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">eval_interval</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'export'</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/solver2d.html#FlowSolver2d.add_callback"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#thetis.solver2d.FlowSolver2d.add_callback" title="Link to this definition">¶</a></dt>
<dd><p>Adds callback to solver object</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>callback</strong> – <a class="reference internal" href="#thetis.callback.DiagnosticCallback" title="thetis.callback.DiagnosticCallback"><code class="xref py py-class docutils literal notranslate"><span class="pre">DiagnosticCallback</span></code></a> instance</p></li>
<li><p><strong>eval_interval</strong> (<em>string</em>) – Determines when callback will be evaluated,
either ‘export’ or ‘timestep’ for evaluating after each export or
time step.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="thetis.solver2d.FlowSolver2d.add_new_field">
<span class="sig-name descname"><span class="pre">add_new_field</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">function</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">label</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">name</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">filename</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">shortname</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">unit</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'-'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">preproc_func</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/solver2d.html#FlowSolver2d.add_new_field"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#thetis.solver2d.FlowSolver2d.add_new_field" title="Link to this definition">¶</a></dt>
<dd><p>Add a field to <a class="reference internal" href="#thetis.solver2d.FlowSolver2d.fields" title="thetis.solver2d.FlowSolver2d.fields"><code class="xref py py-attr docutils literal notranslate"><span class="pre">fields</span></code></a>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>function</strong> – representation of the field as a <code class="xref py py-class docutils literal notranslate"><span class="pre">Function</span></code></p></li>
<li><p><strong>label</strong> – field label used internally by Thetis, e.g. ‘tracer_2d’</p></li>
<li><p><strong>name</strong> – human readable name for the tracer field, e.g. ‘Tracer concentration’</p></li>
<li><p><strong>filename</strong> – file name for outputs, e.g. ‘Tracer2d’</p></li>
<li><p><strong>shortname</strong> – short version of name, e.g. ‘Tracer’</p></li>
<li><p><strong>unit</strong> – units for field, e.g. ‘-’</p></li>
<li><p><strong>preproc_func</strong> – optional pre-processor function which will be called before exporting</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="thetis.solver2d.FlowSolver2d.assign_initial_conditions">
<span class="sig-name descname"><span class="pre">assign_initial_conditions</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">elev</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">uv</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sediment</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">tracers</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/solver2d.html#FlowSolver2d.assign_initial_conditions"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#thetis.solver2d.FlowSolver2d.assign_initial_conditions" title="Link to this definition">¶</a></dt>
<dd><p>Assigns initial conditions</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>elev</strong> (scalar <code class="xref py py-class docutils literal notranslate"><span class="pre">Function</span></code>, <code class="xref py py-class docutils literal notranslate"><span class="pre">Constant</span></code>, or an expression) – Initial condition for water elevation</p></li>
<li><p><strong>uv</strong> (vector valued <code class="xref py py-class docutils literal notranslate"><span class="pre">Function</span></code>, <code class="xref py py-class docutils literal notranslate"><span class="pre">Constant</span></code>, or an expression) – Initial condition for depth averaged velocity</p></li>
<li><p><strong>sediment</strong> (scalar valued <code class="xref py py-class docutils literal notranslate"><span class="pre">Function</span></code>, <code class="xref py py-class docutils literal notranslate"><span class="pre">Constant</span></code>, or an expression) – Initial condition for sediment concantration</p></li>
<li><p><strong>tracers</strong> (scalar valued <code class="xref py py-class docutils literal notranslate"><span class="pre">Function</span></code>s, <code class="xref py py-class docutils literal notranslate"><span class="pre">Constant</span></code>s, or an expressions) – Initial conditions for tracer fields</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="thetis.solver2d.FlowSolver2d.callbacks">
<span class="sig-name descname"><span class="pre">callbacks</span></span><a class="headerlink" href="#thetis.solver2d.FlowSolver2d.callbacks" title="Link to this definition">¶</a></dt>
<dd><p><a class="reference internal" href="#thetis.callback.CallbackManager" title="thetis.callback.CallbackManager"><code class="xref py py-class docutils literal notranslate"><span class="pre">CallbackManager</span></code></a> object that stores all callbacks</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="thetis.solver2d.FlowSolver2d.compute_mesh_stats">
<span class="sig-name descname"><span class="pre">compute_mesh_stats</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/solver2d.html#FlowSolver2d.compute_mesh_stats"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#thetis.solver2d.FlowSolver2d.compute_mesh_stats" title="Link to this definition">¶</a></dt>
<dd><p>Computes number of elements, nodes etc and prints to sdtout</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="thetis.solver2d.FlowSolver2d.compute_time_step">
<span class="sig-name descname"><span class="pre">compute_time_step</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">u_scale</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">Constant([0.],</span> <span class="pre">name='constant_43',</span> <span class="pre">count=43)</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/solver2d.html#FlowSolver2d.compute_time_step"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#thetis.solver2d.FlowSolver2d.compute_time_step" title="Link to this definition">¶</a></dt>
<dd><p>Computes maximum explicit time step from CFL condition.</p>
<div class="math notranslate nohighlight">
\[\Delta t = \frac{\Delta x}{U}\]</div>
<p>Assumes velocity scale <span class="math notranslate nohighlight">\(U = \sqrt{g H} + U_{scale}\)</span> where
<span class="math notranslate nohighlight">\(U_{scale}\)</span> is estimated advective velocity.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>u_scale</strong> (float or <code class="xref py py-class docutils literal notranslate"><span class="pre">Constant</span></code>) – User provided maximum advective velocity scale</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="thetis.solver2d.FlowSolver2d.create_equations">
<span class="sig-name descname"><span class="pre">create_equations</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/solver2d.html#FlowSolver2d.create_equations"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#thetis.solver2d.FlowSolver2d.create_equations" title="Link to this definition">¶</a></dt>
<dd><p>Creates equation instances</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="thetis.solver2d.FlowSolver2d.create_exporters">
<span class="sig-name descname"><span class="pre">create_exporters</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/solver2d.html#FlowSolver2d.create_exporters"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#thetis.solver2d.FlowSolver2d.create_exporters" title="Link to this definition">¶</a></dt>
<dd><p>Creates file exporters</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="thetis.solver2d.FlowSolver2d.create_fields">
<span class="sig-name descname"><span class="pre">create_fields</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/solver2d.html#FlowSolver2d.create_fields"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#thetis.solver2d.FlowSolver2d.create_fields" title="Link to this definition">¶</a></dt>
<dd><p>Creates field Functions</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="thetis.solver2d.FlowSolver2d.create_function_spaces">
<span class="sig-name descname"><span class="pre">create_function_spaces</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/solver2d.html#FlowSolver2d.create_function_spaces"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#thetis.solver2d.FlowSolver2d.create_function_spaces" title="Link to this definition">¶</a></dt>
<dd><p>Creates function spaces</p>
<p>Function spaces are accessible via <a class="reference internal" href="#thetis.solver2d.FlowSolver2d.function_spaces" title="thetis.solver2d.FlowSolver2d.function_spaces"><code class="xref py py-attr docutils literal notranslate"><span class="pre">function_spaces</span></code></a>
object.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="thetis.solver2d.FlowSolver2d.create_iterator">
<span class="sig-name descname"><span class="pre">create_iterator</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">update_forcings</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">export_func</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/solver2d.html#FlowSolver2d.create_iterator"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#thetis.solver2d.FlowSolver2d.create_iterator" title="Link to this definition">¶</a></dt>
<dd><p>Creates a generator to iterate through the simulation and return access
to time advancing function when time control is handled externally.</p>
<p>Iterates over the time loop until time <code class="docutils literal notranslate"><span class="pre">options.simulation_end_time</span></code> is reached.
Exports fields to disk on <code class="docutils literal notranslate"><span class="pre">options.simulation_export_time</span></code> intervals.</p>
<p>For example:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="k">for</span> <span class="n">t</span> <span class="ow">in</span> <span class="n">solver_obj</span><span class="o">.</span><span class="n">create_iterator</span><span class="p">():</span>
    <span class="c1"># user code</span>
</pre></div>
</div>
<p>or, to get per time-step control:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">thetis_timestepper</span> <span class="o">=</span> <span class="n">solver_obj</span><span class="o">.</span><span class="n">create_iterator</span><span class="p">()</span>

<span class="k">while</span> <span class="n">t_Thetis</span><span class="o">&lt;</span><span class="n">t_end</span> <span class="o">-</span> <span class="n">timestep</span> <span class="ow">and</span> <span class="o">....</span> <span class="p">:</span>
    <span class="n">t_Thetis</span> <span class="o">=</span> <span class="nb">next</span><span class="p">(</span><span class="n">thetis_timestepper</span><span class="p">)</span>
</pre></div>
</div>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>update_forcings</strong> – User-defined function that takes simulation
time as an argument and updates time-dependent boundary conditions
(if any).</p></li>
<li><p><strong>export_func</strong> – User-defined function (with no arguments) that will
be called on every export.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="thetis.solver2d.FlowSolver2d.create_timestepper">
<span class="sig-name descname"><span class="pre">create_timestepper</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/solver2d.html#FlowSolver2d.create_timestepper"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#thetis.solver2d.FlowSolver2d.create_timestepper" title="Link to this definition">¶</a></dt>
<dd><p>Creates time stepper instance</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="thetis.solver2d.FlowSolver2d.dt">
<span class="sig-name descname"><span class="pre">dt</span></span><a class="headerlink" href="#thetis.solver2d.FlowSolver2d.dt" title="Link to this definition">¶</a></dt>
<dd><p>Time step</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="thetis.solver2d.FlowSolver2d.export">
<span class="sig-name descname"><span class="pre">export</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/solver2d.html#FlowSolver2d.export"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#thetis.solver2d.FlowSolver2d.export" title="Link to this definition">¶</a></dt>
<dd><p>Export all fields to disk</p>
<p>Also evaluates all callbacks set to ‘export’ interval.</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="thetis.solver2d.FlowSolver2d.export_initial_state">
<span class="sig-name descname"><span class="pre">export_initial_state</span></span><a class="headerlink" href="#thetis.solver2d.FlowSolver2d.export_initial_state" title="Link to this definition">¶</a></dt>
<dd><p>Do export initial state. False if continuing a simulation</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="thetis.solver2d.FlowSolver2d.fields">
<span class="sig-name descname"><span class="pre">fields</span></span><a class="headerlink" href="#thetis.solver2d.FlowSolver2d.fields" title="Link to this definition">¶</a></dt>
<dd><p><a class="reference internal" href="#thetis.utility.FieldDict" title="thetis.utility.FieldDict"><code class="xref py py-class docutils literal notranslate"><span class="pre">FieldDict</span></code></a> that holds all functions needed by the solver
object</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="thetis.solver2d.FlowSolver2d.function_spaces">
<span class="sig-name descname"><span class="pre">function_spaces</span></span><a class="headerlink" href="#thetis.solver2d.FlowSolver2d.function_spaces" title="Link to this definition">¶</a></dt>
<dd><p><a class="reference internal" href="#thetis.utility.AttrDict" title="thetis.utility.AttrDict"><code class="xref py py-class docutils literal notranslate"><span class="pre">AttrDict</span></code></a> that holds all function spaces needed by the
solver object</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="thetis.solver2d.FlowSolver2d.get_exner_timestepper">
<span class="sig-name descname"><span class="pre">get_exner_timestepper</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">integrator</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/solver2d.html#FlowSolver2d.get_exner_timestepper"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#thetis.solver2d.FlowSolver2d.get_exner_timestepper" title="Link to this definition">¶</a></dt>
<dd><p>Gets exner timestepper object with appropriate parameters</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="thetis.solver2d.FlowSolver2d.get_fs_timestepper">
<span class="sig-name descname"><span class="pre">get_fs_timestepper</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">integrator</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/solver2d.html#FlowSolver2d.get_fs_timestepper"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#thetis.solver2d.FlowSolver2d.get_fs_timestepper" title="Link to this definition">¶</a></dt>
<dd><p>Gets free-surface correction timestepper object with appropriate parameters</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="thetis.solver2d.FlowSolver2d.get_sediment_timestepper">
<span class="sig-name descname"><span class="pre">get_sediment_timestepper</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">integrator</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/solver2d.html#FlowSolver2d.get_sediment_timestepper"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#thetis.solver2d.FlowSolver2d.get_sediment_timestepper" title="Link to this definition">¶</a></dt>
<dd><p>Gets sediment timestepper object with appropriate parameters</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="thetis.solver2d.FlowSolver2d.get_swe_timestepper">
<span class="sig-name descname"><span class="pre">get_swe_timestepper</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">integrator</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/solver2d.html#FlowSolver2d.get_swe_timestepper"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#thetis.solver2d.FlowSolver2d.get_swe_timestepper" title="Link to this definition">¶</a></dt>
<dd><p>Gets shallow water timestepper object with appropriate parameters</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="thetis.solver2d.FlowSolver2d.get_tracer_timestepper">
<span class="sig-name descname"><span class="pre">get_tracer_timestepper</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">integrator</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">system</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/solver2d.html#FlowSolver2d.get_tracer_timestepper"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#thetis.solver2d.FlowSolver2d.get_tracer_timestepper" title="Link to this definition">¶</a></dt>
<dd><p>Gets tracer timestepper object with appropriate parameters</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="thetis.solver2d.FlowSolver2d.initialize">
<span class="sig-name descname"><span class="pre">initialize</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/solver2d.html#FlowSolver2d.initialize"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#thetis.solver2d.FlowSolver2d.initialize" title="Link to this definition">¶</a></dt>
<dd><p>Creates function spaces, equations, time stepper and exporters</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="thetis.solver2d.FlowSolver2d.iterate">
<span class="sig-name descname"><span class="pre">iterate</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">update_forcings</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">export_func</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/solver2d.html#FlowSolver2d.iterate"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#thetis.solver2d.FlowSolver2d.iterate" title="Link to this definition">¶</a></dt>
<dd><p>Runs the simulation</p>
<p>Wrapper for function for <cite>create_iterator</cite> generator and automatically
iterates over the time loop until time <code class="docutils literal notranslate"><span class="pre">options.simulation_end_time</span></code> is reached.
Exports fields to disk on <code class="docutils literal notranslate"><span class="pre">options.simulation_export_time</span></code> intervals.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>update_forcings</strong> – User-defined function that takes simulation
time as an argument and updates time-dependent boundary conditions
(if any).</p></li>
<li><p><strong>export_func</strong> – User-defined function (with no arguments) that will
be called on every export.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="thetis.solver2d.FlowSolver2d.load_state">
<span class="sig-name descname"><span class="pre">load_state</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">i_stored</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">outputdir</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">t</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">iteration</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">i_export</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">legacy_mode</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/solver2d.html#FlowSolver2d.load_state"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#thetis.solver2d.FlowSolver2d.load_state" title="Link to this definition">¶</a></dt>
<dd><p>Loads simulation state from hdf5 outputs.</p>
<p>Replaces <a class="reference internal" href="#thetis.solver2d.FlowSolver2d.assign_initial_conditions" title="thetis.solver2d.FlowSolver2d.assign_initial_conditions"><code class="xref py py-meth docutils literal notranslate"><span class="pre">assign_initial_conditions()</span></code></a> in model initialization.</p>
<p>For example, continue simulation from export 40,</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">solver_obj</span><span class="o">.</span><span class="n">load_state</span><span class="p">(</span><span class="mi">40</span><span class="p">)</span>
</pre></div>
</div>
<p>Continue simulation from another output directory,</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">solver_obj</span><span class="o">.</span><span class="n">load_state</span><span class="p">(</span><span class="mi">40</span><span class="p">,</span> <span class="n">outputdir</span><span class="o">=</span><span class="s1">&#39;outputs_spinup&#39;</span><span class="p">)</span>
</pre></div>
</div>
<p>Continue simulation from another output directory and reset the
counters,</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">solver_obj</span><span class="o">.</span><span class="n">load_state</span><span class="p">(</span><span class="mi">40</span><span class="p">,</span> <span class="n">outputdir</span><span class="o">=</span><span class="s1">&#39;outputs_spinup&#39;</span><span class="p">,</span>
    <span class="n">iteration</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">t</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">i_export</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
</pre></div>
</div>
<p>Model state can be loaded if all prognostic state variables have been
stored in hdf5 format. For the hydrodynamics the required state
variables are: <cite>elev_2d</cite>, and <cite>uv_2d</cite>.</p>
<p>Simulation time and iteration can be recovered automatically provided
that the model setup is the same (e.g. time step and export_time).</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>i_stored</strong> (<a class="reference external" href="https://docs.python.org/2.7/library/functions.html#int" title="(in Python v2.7)"><em>int</em></a>) – export index to load</p></li>
<li><p><strong>outputdir</strong> (<em>string</em>) – (optional) directory where files are read from.
By default <code class="docutils literal notranslate"><span class="pre">options.output_directory</span></code>.</p></li>
<li><p><strong>t</strong> (<a class="reference external" href="https://docs.python.org/2.7/library/functions.html#float" title="(in Python v2.7)"><em>float</em></a>) – simulation time. Overrides the time stamp inferred from
model options.</p></li>
<li><p><strong>iteration</strong> (<a class="reference external" href="https://docs.python.org/2.7/library/functions.html#int" title="(in Python v2.7)"><em>int</em></a>) – Overrides the iteration count inferred from model
options.</p></li>
<li><p><strong>i_export</strong> (<a class="reference external" href="https://docs.python.org/2.7/library/functions.html#int" title="(in Python v2.7)"><em>int</em></a>) – Set initial export index for the present run. By
default, <cite>i_stored</cite> is used.</p></li>
<li><p><strong>legacy_mode</strong> (<a class="reference external" href="https://docs.python.org/2.7/library/functions.html#bool" title="(in Python v2.7)"><em>bool</em></a>) – Load legacy <cite>DumbCheckpoint</cite> files.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="thetis.solver2d.FlowSolver2d.options">
<span class="sig-name descname"><span class="pre">options</span></span><a class="headerlink" href="#thetis.solver2d.FlowSolver2d.options" title="Link to this definition">¶</a></dt>
<dd><p>Dictionary of all options. A <a class="reference internal" href="#thetis.options.ModelOptions2d" title="thetis.options.ModelOptions2d"><code class="xref py py-class docutils literal notranslate"><span class="pre">ModelOptions2d</span></code></a> object.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="thetis.solver2d.FlowSolver2d.print_state">
<span class="sig-name descname"><span class="pre">print_state</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">cputime</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">print_header</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/solver2d.html#FlowSolver2d.print_state"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#thetis.solver2d.FlowSolver2d.print_state" title="Link to this definition">¶</a></dt>
<dd><p>Print a summary of the model state on stdout</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>cputime</strong> (<a class="reference external" href="https://docs.python.org/2.7/library/functions.html#float" title="(in Python v2.7)"><em>float</em></a>) – Measured CPU time in seconds</p></li>
<li><p><strong>print_header</strong> – Whether to print column header first</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="thetis.solver2d.FlowSolver2d.sediment_model">
<span class="sig-name descname"><span class="pre">sediment_model</span></span><a class="headerlink" href="#thetis.solver2d.FlowSolver2d.sediment_model" title="Link to this definition">¶</a></dt>
<dd><p>set up option for sediment model</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="thetis.solver2d.FlowSolver2d.set_time_step">
<span class="sig-name descname"><span class="pre">set_time_step</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">alpha</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.05</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/solver2d.html#FlowSolver2d.set_time_step"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#thetis.solver2d.FlowSolver2d.set_time_step" title="Link to this definition">¶</a></dt>
<dd><p>Sets the model the model time step</p>
<p>If the time integrator supports automatic time step, and
<code class="xref py py-attr docutils literal notranslate"><span class="pre">ModelOptions2d.timestepper_options.use_automatic_timestep</span></code> is
<cite>True</cite>, we compute the maximum time step allowed by the CFL condition.
Otherwise uses <code class="xref py py-attr docutils literal notranslate"><span class="pre">ModelOptions2d.timestep</span></code>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>alpha</strong> (<a class="reference external" href="https://docs.python.org/2.7/library/functions.html#float" title="(in Python v2.7)"><em>float</em></a>) – CFL number scaling factor</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="thetis.solver2d.FlowSolver2d.set_wetting_and_drying_alpha">
<span class="sig-name descname"><span class="pre">set_wetting_and_drying_alpha</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/solver2d.html#FlowSolver2d.set_wetting_and_drying_alpha"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#thetis.solver2d.FlowSolver2d.set_wetting_and_drying_alpha" title="Link to this definition">¶</a></dt>
<dd><blockquote>
<div><p>Compute a wetting and drying parameter <span class="math notranslate nohighlight">\(\alpha\)</span> which ensures positive water
depth using the approximate method suggested by Karna et al. (2011).</p>
<p>This method takes</p>
</div></blockquote>
<dl>
<dt>..math::</dt><dd><blockquote>
<div><p>alpha approx mid L_x nabla h mid,</p>
</div></blockquote>
<p>where <span class="math notranslate nohighlight">\(L_x\)</span> is the horizontal length scale of the mesh elements at the wet-dry
front and <span class="math notranslate nohighlight">\(h\)</span> is the bathymetry profile.</p>
<p>This expression is interpolated into <span class="math notranslate nohighlight">\(\mathbb P1\)</span> space in order to remove noise. Note
that we use the <cite>interpolate</cite> method, rather than the <cite>project</cite> method, in order to avoid
introducing new extrema.</p>
<p>NOTE: The minimum and maximum values at which to cap the alpha parameter may be specified via
<code class="xref py py-attr docutils literal notranslate"><span class="pre">ModelOptions2d.wetting_and_drying_alpha_min</span></code> and
<code class="xref py py-attr docutils literal notranslate"><span class="pre">ModelOptions2d.wetting_and_drying_alpha_max</span></code>.</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

</section>
<section id="module-thetis.stability_functions">
<span id="thetis-stability-functions-module"></span><h2>thetis.stability_functions module<a class="headerlink" href="#module-thetis.stability_functions" title="Link to this heading">¶</a></h2>
<p>Implements turbulence closure model stability functions.</p>
<div class="math notranslate nohighlight">
\[\begin{split}S_m &amp;= S_m(\alpha_M, \alpha_N) \\
S_\rho &amp;= S_\rho(\alpha_M, \alpha_N)\end{split}\]</div>
<p>where <span class="math notranslate nohighlight">\(\alpha_M, \alpha_N\)</span> are the normalized shear and buoyancy frequency</p>
<blockquote>
<div><div class="math notranslate nohighlight">
\[\begin{split}\alpha_M &amp;= \frac{k^2}{\varepsilon^2} M^2 \\
\alpha_N &amp;= \frac{k^2}{\varepsilon^2} N^2\end{split}\]</div>
</div></blockquote>
<p>The following stability functions have been implemented</p>
<ul class="simple">
<li><p>Canuto A</p></li>
<li><p>Canuto B</p></li>
<li><p>Kantha-Clayson</p></li>
<li><p>Cheng</p></li>
</ul>
<p>References:</p>
<p>Umlauf, L. and Burchard, H. (2005). Second-order turbulence closure models
for geophysical boundary layers. A review of recent work. Continental Shelf
Research, 25(7-8):795–827. <a class="reference external" href="http://dx.doi.org/10.1016/j.csr.2004.08.004">http://dx.doi.org/10.1016/j.csr.2004.08.004</a></p>
<p>Burchard, H. and Bolding, K. (2001). Comparative Analysis of Four
Second-Moment Turbulence Closure Models for the Oceanic Mixed Layer. Journal of
Physical Oceanography, 31(8):1943–1968.
<a class="reference external" href="http://dx.doi.org/10.1175/1520-0485(2001)031">http://dx.doi.org/10.1175/1520-0485(2001)031</a></p>
<p>Umlauf, L. and Burchard, H. (2003). A generic length-scale equation for
geophysical turbulence models. Journal of Marine Research, 61:235–265(31).
<a class="reference external" href="http://dx.doi.org/10.1357/002224003322005087">http://dx.doi.org/10.1357/002224003322005087</a></p>
<dl class="py class">
<dt class="sig sig-object py" id="thetis.stability_functions.GOTMStabilityFunctionCanutoA">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">thetis.stability_functions.</span></span><span class="sig-name descname"><span class="pre">GOTMStabilityFunctionCanutoA</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">lim_alpha_shear</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">lim_alpha_buoy</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">smooth_alpha_buoy_lim</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">alpha_buoy_crit</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">-1.2</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/stability_functions.html#GOTMStabilityFunctionCanutoA"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#thetis.stability_functions.GOTMStabilityFunctionCanutoA" title="Link to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">GOTMStabilityFunctionBase</span></code></p>
<p>Canuto et al. (2001) version A stability functions</p>
<p>Parameters are from Umlauf and Buchard (2005), Table 1</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>lim_alpha_shear</strong> (<a class="reference external" href="https://docs.python.org/2.7/library/functions.html#bool" title="(in Python v2.7)"><em>bool</em></a>) – limit maximum <span class="math notranslate nohighlight">\(\alpha_M\)</span> values
(see Umlauf and Burchard (2005) eq. 44)</p></li>
<li><p><strong>lim_alpha_buoy</strong> (<a class="reference external" href="https://docs.python.org/2.7/library/functions.html#bool" title="(in Python v2.7)"><em>bool</em></a>) – limit minimum (negative) <span class="math notranslate nohighlight">\(\alpha_N\)</span> values
(see Umlauf and Burchard (2005))</p></li>
<li><p><strong>smooth_alpha_buoy_lim</strong> (<a class="reference external" href="https://docs.python.org/2.7/library/functions.html#bool" title="(in Python v2.7)"><em>bool</em></a>) – if <span class="math notranslate nohighlight">\(\alpha_N\)</span> is limited, apply a
smooth limiter (see Burchard and Bolding (2001) eq. 19). Otherwise
<span class="math notranslate nohighlight">\(\alpha_N\)</span> is clipped at minimum value.</p></li>
<li><p><strong>alpha_buoy_crit</strong> (<a class="reference external" href="https://docs.python.org/2.7/library/functions.html#float" title="(in Python v2.7)"><em>float</em></a>) – parameter for <span class="math notranslate nohighlight">\(\alpha_N\)</span> smooth limiter</p></li>
</ul>
</dd>
</dl>
<dl class="py attribute">
<dt class="sig sig-object py" id="thetis.stability_functions.GOTMStabilityFunctionCanutoA.cb1">
<span class="sig-name descname"><span class="pre">cb1</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">5.95</span></em><a class="headerlink" href="#thetis.stability_functions.GOTMStabilityFunctionCanutoA.cb1" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="thetis.stability_functions.GOTMStabilityFunctionCanutoA.cb2">
<span class="sig-name descname"><span class="pre">cb2</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">0.6</span></em><a class="headerlink" href="#thetis.stability_functions.GOTMStabilityFunctionCanutoA.cb2" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="thetis.stability_functions.GOTMStabilityFunctionCanutoA.cb3">
<span class="sig-name descname"><span class="pre">cb3</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">1.0</span></em><a class="headerlink" href="#thetis.stability_functions.GOTMStabilityFunctionCanutoA.cb3" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="thetis.stability_functions.GOTMStabilityFunctionCanutoA.cb4">
<span class="sig-name descname"><span class="pre">cb4</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">0.0</span></em><a class="headerlink" href="#thetis.stability_functions.GOTMStabilityFunctionCanutoA.cb4" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="thetis.stability_functions.GOTMStabilityFunctionCanutoA.cb5">
<span class="sig-name descname"><span class="pre">cb5</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">0.3333</span></em><a class="headerlink" href="#thetis.stability_functions.GOTMStabilityFunctionCanutoA.cb5" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="thetis.stability_functions.GOTMStabilityFunctionCanutoA.cbb">
<span class="sig-name descname"><span class="pre">cbb</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">0.72</span></em><a class="headerlink" href="#thetis.stability_functions.GOTMStabilityFunctionCanutoA.cbb" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="thetis.stability_functions.GOTMStabilityFunctionCanutoA.cc1">
<span class="sig-name descname"><span class="pre">cc1</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">5.0</span></em><a class="headerlink" href="#thetis.stability_functions.GOTMStabilityFunctionCanutoA.cc1" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="thetis.stability_functions.GOTMStabilityFunctionCanutoA.cc2">
<span class="sig-name descname"><span class="pre">cc2</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">0.8</span></em><a class="headerlink" href="#thetis.stability_functions.GOTMStabilityFunctionCanutoA.cc2" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="thetis.stability_functions.GOTMStabilityFunctionCanutoA.cc3">
<span class="sig-name descname"><span class="pre">cc3</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">1.968</span></em><a class="headerlink" href="#thetis.stability_functions.GOTMStabilityFunctionCanutoA.cc3" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="thetis.stability_functions.GOTMStabilityFunctionCanutoA.cc4">
<span class="sig-name descname"><span class="pre">cc4</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">1.136</span></em><a class="headerlink" href="#thetis.stability_functions.GOTMStabilityFunctionCanutoA.cc4" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="thetis.stability_functions.GOTMStabilityFunctionCanutoA.cc5">
<span class="sig-name descname"><span class="pre">cc5</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">0.0</span></em><a class="headerlink" href="#thetis.stability_functions.GOTMStabilityFunctionCanutoA.cc5" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="thetis.stability_functions.GOTMStabilityFunctionCanutoA.cc6">
<span class="sig-name descname"><span class="pre">cc6</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">0.4</span></em><a class="headerlink" href="#thetis.stability_functions.GOTMStabilityFunctionCanutoA.cc6" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="thetis.stability_functions.GOTMStabilityFunctionCanutoA.name">
<span class="sig-name descname"><span class="pre">name</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">'Canuto</span> <span class="pre">A'</span></em><a class="headerlink" href="#thetis.stability_functions.GOTMStabilityFunctionCanutoA.name" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="thetis.stability_functions.GOTMStabilityFunctionCanutoB">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">thetis.stability_functions.</span></span><span class="sig-name descname"><span class="pre">GOTMStabilityFunctionCanutoB</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">lim_alpha_shear</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">lim_alpha_buoy</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">smooth_alpha_buoy_lim</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">alpha_buoy_crit</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">-1.2</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/stability_functions.html#GOTMStabilityFunctionCanutoB"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#thetis.stability_functions.GOTMStabilityFunctionCanutoB" title="Link to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">GOTMStabilityFunctionBase</span></code></p>
<p>Canuto et al. (2001) version B stability functions</p>
<p>Parameters are from Umlauf and Buchard (2005), Table 1</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>lim_alpha_shear</strong> (<a class="reference external" href="https://docs.python.org/2.7/library/functions.html#bool" title="(in Python v2.7)"><em>bool</em></a>) – limit maximum <span class="math notranslate nohighlight">\(\alpha_M\)</span> values
(see Umlauf and Burchard (2005) eq. 44)</p></li>
<li><p><strong>lim_alpha_buoy</strong> (<a class="reference external" href="https://docs.python.org/2.7/library/functions.html#bool" title="(in Python v2.7)"><em>bool</em></a>) – limit minimum (negative) <span class="math notranslate nohighlight">\(\alpha_N\)</span> values
(see Umlauf and Burchard (2005))</p></li>
<li><p><strong>smooth_alpha_buoy_lim</strong> (<a class="reference external" href="https://docs.python.org/2.7/library/functions.html#bool" title="(in Python v2.7)"><em>bool</em></a>) – if <span class="math notranslate nohighlight">\(\alpha_N\)</span> is limited, apply a
smooth limiter (see Burchard and Bolding (2001) eq. 19). Otherwise
<span class="math notranslate nohighlight">\(\alpha_N\)</span> is clipped at minimum value.</p></li>
<li><p><strong>alpha_buoy_crit</strong> (<a class="reference external" href="https://docs.python.org/2.7/library/functions.html#float" title="(in Python v2.7)"><em>float</em></a>) – parameter for <span class="math notranslate nohighlight">\(\alpha_N\)</span> smooth limiter</p></li>
</ul>
</dd>
</dl>
<dl class="py attribute">
<dt class="sig sig-object py" id="thetis.stability_functions.GOTMStabilityFunctionCanutoB.cb1">
<span class="sig-name descname"><span class="pre">cb1</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">5.6</span></em><a class="headerlink" href="#thetis.stability_functions.GOTMStabilityFunctionCanutoB.cb1" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="thetis.stability_functions.GOTMStabilityFunctionCanutoB.cb2">
<span class="sig-name descname"><span class="pre">cb2</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">0.6</span></em><a class="headerlink" href="#thetis.stability_functions.GOTMStabilityFunctionCanutoB.cb2" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="thetis.stability_functions.GOTMStabilityFunctionCanutoB.cb3">
<span class="sig-name descname"><span class="pre">cb3</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">1.0</span></em><a class="headerlink" href="#thetis.stability_functions.GOTMStabilityFunctionCanutoB.cb3" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="thetis.stability_functions.GOTMStabilityFunctionCanutoB.cb4">
<span class="sig-name descname"><span class="pre">cb4</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">0.0</span></em><a class="headerlink" href="#thetis.stability_functions.GOTMStabilityFunctionCanutoB.cb4" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="thetis.stability_functions.GOTMStabilityFunctionCanutoB.cb5">
<span class="sig-name descname"><span class="pre">cb5</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">0.3333</span></em><a class="headerlink" href="#thetis.stability_functions.GOTMStabilityFunctionCanutoB.cb5" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="thetis.stability_functions.GOTMStabilityFunctionCanutoB.cbb">
<span class="sig-name descname"><span class="pre">cbb</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">0.477</span></em><a class="headerlink" href="#thetis.stability_functions.GOTMStabilityFunctionCanutoB.cbb" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="thetis.stability_functions.GOTMStabilityFunctionCanutoB.cc1">
<span class="sig-name descname"><span class="pre">cc1</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">5.0</span></em><a class="headerlink" href="#thetis.stability_functions.GOTMStabilityFunctionCanutoB.cc1" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="thetis.stability_functions.GOTMStabilityFunctionCanutoB.cc2">
<span class="sig-name descname"><span class="pre">cc2</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">0.6983</span></em><a class="headerlink" href="#thetis.stability_functions.GOTMStabilityFunctionCanutoB.cc2" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="thetis.stability_functions.GOTMStabilityFunctionCanutoB.cc3">
<span class="sig-name descname"><span class="pre">cc3</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">1.9664</span></em><a class="headerlink" href="#thetis.stability_functions.GOTMStabilityFunctionCanutoB.cc3" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="thetis.stability_functions.GOTMStabilityFunctionCanutoB.cc4">
<span class="sig-name descname"><span class="pre">cc4</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">1.094</span></em><a class="headerlink" href="#thetis.stability_functions.GOTMStabilityFunctionCanutoB.cc4" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="thetis.stability_functions.GOTMStabilityFunctionCanutoB.cc5">
<span class="sig-name descname"><span class="pre">cc5</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">0.0</span></em><a class="headerlink" href="#thetis.stability_functions.GOTMStabilityFunctionCanutoB.cc5" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="thetis.stability_functions.GOTMStabilityFunctionCanutoB.cc6">
<span class="sig-name descname"><span class="pre">cc6</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">0.495</span></em><a class="headerlink" href="#thetis.stability_functions.GOTMStabilityFunctionCanutoB.cc6" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="thetis.stability_functions.GOTMStabilityFunctionCanutoB.name">
<span class="sig-name descname"><span class="pre">name</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">'Canuto</span> <span class="pre">B'</span></em><a class="headerlink" href="#thetis.stability_functions.GOTMStabilityFunctionCanutoB.name" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="thetis.stability_functions.GOTMStabilityFunctionCheng">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">thetis.stability_functions.</span></span><span class="sig-name descname"><span class="pre">GOTMStabilityFunctionCheng</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">lim_alpha_shear</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">lim_alpha_buoy</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">smooth_alpha_buoy_lim</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">alpha_buoy_crit</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">-1.2</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/stability_functions.html#GOTMStabilityFunctionCheng"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#thetis.stability_functions.GOTMStabilityFunctionCheng" title="Link to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">GOTMStabilityFunctionBase</span></code></p>
<p>Cheng et al. (2002) quasi-equilibrium stability functions</p>
<p>Parameters are from Umlauf and Buchard (2005), Table 1</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>lim_alpha_shear</strong> (<a class="reference external" href="https://docs.python.org/2.7/library/functions.html#bool" title="(in Python v2.7)"><em>bool</em></a>) – limit maximum <span class="math notranslate nohighlight">\(\alpha_M\)</span> values
(see Umlauf and Burchard (2005) eq. 44)</p></li>
<li><p><strong>lim_alpha_buoy</strong> (<a class="reference external" href="https://docs.python.org/2.7/library/functions.html#bool" title="(in Python v2.7)"><em>bool</em></a>) – limit minimum (negative) <span class="math notranslate nohighlight">\(\alpha_N\)</span> values
(see Umlauf and Burchard (2005))</p></li>
<li><p><strong>smooth_alpha_buoy_lim</strong> (<a class="reference external" href="https://docs.python.org/2.7/library/functions.html#bool" title="(in Python v2.7)"><em>bool</em></a>) – if <span class="math notranslate nohighlight">\(\alpha_N\)</span> is limited, apply a
smooth limiter (see Burchard and Bolding (2001) eq. 19). Otherwise
<span class="math notranslate nohighlight">\(\alpha_N\)</span> is clipped at minimum value.</p></li>
<li><p><strong>alpha_buoy_crit</strong> (<a class="reference external" href="https://docs.python.org/2.7/library/functions.html#float" title="(in Python v2.7)"><em>float</em></a>) – parameter for <span class="math notranslate nohighlight">\(\alpha_N\)</span> smooth limiter</p></li>
</ul>
</dd>
</dl>
<dl class="py attribute">
<dt class="sig sig-object py" id="thetis.stability_functions.GOTMStabilityFunctionCheng.cb1">
<span class="sig-name descname"><span class="pre">cb1</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">5.52</span></em><a class="headerlink" href="#thetis.stability_functions.GOTMStabilityFunctionCheng.cb1" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="thetis.stability_functions.GOTMStabilityFunctionCheng.cb2">
<span class="sig-name descname"><span class="pre">cb2</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">0.2134</span></em><a class="headerlink" href="#thetis.stability_functions.GOTMStabilityFunctionCheng.cb2" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="thetis.stability_functions.GOTMStabilityFunctionCheng.cb3">
<span class="sig-name descname"><span class="pre">cb3</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">0.357</span></em><a class="headerlink" href="#thetis.stability_functions.GOTMStabilityFunctionCheng.cb3" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="thetis.stability_functions.GOTMStabilityFunctionCheng.cb4">
<span class="sig-name descname"><span class="pre">cb4</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">0.0</span></em><a class="headerlink" href="#thetis.stability_functions.GOTMStabilityFunctionCheng.cb4" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="thetis.stability_functions.GOTMStabilityFunctionCheng.cb5">
<span class="sig-name descname"><span class="pre">cb5</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">0.3333</span></em><a class="headerlink" href="#thetis.stability_functions.GOTMStabilityFunctionCheng.cb5" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="thetis.stability_functions.GOTMStabilityFunctionCheng.cbb">
<span class="sig-name descname"><span class="pre">cbb</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">0.82</span></em><a class="headerlink" href="#thetis.stability_functions.GOTMStabilityFunctionCheng.cbb" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="thetis.stability_functions.GOTMStabilityFunctionCheng.cc1">
<span class="sig-name descname"><span class="pre">cc1</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">5.0</span></em><a class="headerlink" href="#thetis.stability_functions.GOTMStabilityFunctionCheng.cc1" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="thetis.stability_functions.GOTMStabilityFunctionCheng.cc2">
<span class="sig-name descname"><span class="pre">cc2</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">0.7983</span></em><a class="headerlink" href="#thetis.stability_functions.GOTMStabilityFunctionCheng.cc2" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="thetis.stability_functions.GOTMStabilityFunctionCheng.cc3">
<span class="sig-name descname"><span class="pre">cc3</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">1.968</span></em><a class="headerlink" href="#thetis.stability_functions.GOTMStabilityFunctionCheng.cc3" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="thetis.stability_functions.GOTMStabilityFunctionCheng.cc4">
<span class="sig-name descname"><span class="pre">cc4</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">1.136</span></em><a class="headerlink" href="#thetis.stability_functions.GOTMStabilityFunctionCheng.cc4" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="thetis.stability_functions.GOTMStabilityFunctionCheng.cc5">
<span class="sig-name descname"><span class="pre">cc5</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">0.0</span></em><a class="headerlink" href="#thetis.stability_functions.GOTMStabilityFunctionCheng.cc5" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="thetis.stability_functions.GOTMStabilityFunctionCheng.cc6">
<span class="sig-name descname"><span class="pre">cc6</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">0.5</span></em><a class="headerlink" href="#thetis.stability_functions.GOTMStabilityFunctionCheng.cc6" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="thetis.stability_functions.GOTMStabilityFunctionCheng.name">
<span class="sig-name descname"><span class="pre">name</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">'Cheng'</span></em><a class="headerlink" href="#thetis.stability_functions.GOTMStabilityFunctionCheng.name" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="thetis.stability_functions.GOTMStabilityFunctionKanthaClayson">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">thetis.stability_functions.</span></span><span class="sig-name descname"><span class="pre">GOTMStabilityFunctionKanthaClayson</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">lim_alpha_shear</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">lim_alpha_buoy</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">smooth_alpha_buoy_lim</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">alpha_buoy_crit</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">-1.2</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/stability_functions.html#GOTMStabilityFunctionKanthaClayson"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#thetis.stability_functions.GOTMStabilityFunctionKanthaClayson" title="Link to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">GOTMStabilityFunctionBase</span></code></p>
<p>Kantha and Clayson (1994) quasi-equilibrium stability functions</p>
<p>Parameters are from Umlauf and Buchard (2005), Table 1</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>lim_alpha_shear</strong> (<a class="reference external" href="https://docs.python.org/2.7/library/functions.html#bool" title="(in Python v2.7)"><em>bool</em></a>) – limit maximum <span class="math notranslate nohighlight">\(\alpha_M\)</span> values
(see Umlauf and Burchard (2005) eq. 44)</p></li>
<li><p><strong>lim_alpha_buoy</strong> (<a class="reference external" href="https://docs.python.org/2.7/library/functions.html#bool" title="(in Python v2.7)"><em>bool</em></a>) – limit minimum (negative) <span class="math notranslate nohighlight">\(\alpha_N\)</span> values
(see Umlauf and Burchard (2005))</p></li>
<li><p><strong>smooth_alpha_buoy_lim</strong> (<a class="reference external" href="https://docs.python.org/2.7/library/functions.html#bool" title="(in Python v2.7)"><em>bool</em></a>) – if <span class="math notranslate nohighlight">\(\alpha_N\)</span> is limited, apply a
smooth limiter (see Burchard and Bolding (2001) eq. 19). Otherwise
<span class="math notranslate nohighlight">\(\alpha_N\)</span> is clipped at minimum value.</p></li>
<li><p><strong>alpha_buoy_crit</strong> (<a class="reference external" href="https://docs.python.org/2.7/library/functions.html#float" title="(in Python v2.7)"><em>float</em></a>) – parameter for <span class="math notranslate nohighlight">\(\alpha_N\)</span> smooth limiter</p></li>
</ul>
</dd>
</dl>
<dl class="py attribute">
<dt class="sig sig-object py" id="thetis.stability_functions.GOTMStabilityFunctionKanthaClayson.cb1">
<span class="sig-name descname"><span class="pre">cb1</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">3.728</span></em><a class="headerlink" href="#thetis.stability_functions.GOTMStabilityFunctionKanthaClayson.cb1" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="thetis.stability_functions.GOTMStabilityFunctionKanthaClayson.cb2">
<span class="sig-name descname"><span class="pre">cb2</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">0.7</span></em><a class="headerlink" href="#thetis.stability_functions.GOTMStabilityFunctionKanthaClayson.cb2" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="thetis.stability_functions.GOTMStabilityFunctionKanthaClayson.cb3">
<span class="sig-name descname"><span class="pre">cb3</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">0.7</span></em><a class="headerlink" href="#thetis.stability_functions.GOTMStabilityFunctionKanthaClayson.cb3" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="thetis.stability_functions.GOTMStabilityFunctionKanthaClayson.cb4">
<span class="sig-name descname"><span class="pre">cb4</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">0.0</span></em><a class="headerlink" href="#thetis.stability_functions.GOTMStabilityFunctionKanthaClayson.cb4" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="thetis.stability_functions.GOTMStabilityFunctionKanthaClayson.cb5">
<span class="sig-name descname"><span class="pre">cb5</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">0.2</span></em><a class="headerlink" href="#thetis.stability_functions.GOTMStabilityFunctionKanthaClayson.cb5" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="thetis.stability_functions.GOTMStabilityFunctionKanthaClayson.cbb">
<span class="sig-name descname"><span class="pre">cbb</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">0.6102</span></em><a class="headerlink" href="#thetis.stability_functions.GOTMStabilityFunctionKanthaClayson.cbb" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="thetis.stability_functions.GOTMStabilityFunctionKanthaClayson.cc1">
<span class="sig-name descname"><span class="pre">cc1</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">6.0</span></em><a class="headerlink" href="#thetis.stability_functions.GOTMStabilityFunctionKanthaClayson.cc1" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="thetis.stability_functions.GOTMStabilityFunctionKanthaClayson.cc2">
<span class="sig-name descname"><span class="pre">cc2</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">0.32</span></em><a class="headerlink" href="#thetis.stability_functions.GOTMStabilityFunctionKanthaClayson.cc2" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="thetis.stability_functions.GOTMStabilityFunctionKanthaClayson.cc3">
<span class="sig-name descname"><span class="pre">cc3</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">0.0</span></em><a class="headerlink" href="#thetis.stability_functions.GOTMStabilityFunctionKanthaClayson.cc3" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="thetis.stability_functions.GOTMStabilityFunctionKanthaClayson.cc4">
<span class="sig-name descname"><span class="pre">cc4</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">0.0</span></em><a class="headerlink" href="#thetis.stability_functions.GOTMStabilityFunctionKanthaClayson.cc4" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="thetis.stability_functions.GOTMStabilityFunctionKanthaClayson.cc5">
<span class="sig-name descname"><span class="pre">cc5</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">0.0</span></em><a class="headerlink" href="#thetis.stability_functions.GOTMStabilityFunctionKanthaClayson.cc5" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="thetis.stability_functions.GOTMStabilityFunctionKanthaClayson.cc6">
<span class="sig-name descname"><span class="pre">cc6</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">0.0</span></em><a class="headerlink" href="#thetis.stability_functions.GOTMStabilityFunctionKanthaClayson.cc6" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="thetis.stability_functions.GOTMStabilityFunctionKanthaClayson.name">
<span class="sig-name descname"><span class="pre">name</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">'Kantha</span> <span class="pre">Clayson'</span></em><a class="headerlink" href="#thetis.stability_functions.GOTMStabilityFunctionKanthaClayson.name" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="thetis.stability_functions.StabilityFunctionBase">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">thetis.stability_functions.</span></span><span class="sig-name descname"><span class="pre">StabilityFunctionBase</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">lim_alpha_shear</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">lim_alpha_buoy</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">smooth_alpha_buoy_lim</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">alpha_buoy_crit</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">-1.2</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/stability_functions.html#StabilityFunctionBase"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#thetis.stability_functions.StabilityFunctionBase" title="Link to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">ABC</span></code></p>
<p>Base class for all stability functions</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>lim_alpha_shear</strong> (<a class="reference external" href="https://docs.python.org/2.7/library/functions.html#bool" title="(in Python v2.7)"><em>bool</em></a>) – limit maximum <span class="math notranslate nohighlight">\(\alpha_M\)</span> values
(see Umlauf and Burchard (2005) eq. 44)</p></li>
<li><p><strong>lim_alpha_buoy</strong> (<a class="reference external" href="https://docs.python.org/2.7/library/functions.html#bool" title="(in Python v2.7)"><em>bool</em></a>) – limit minimum (negative) <span class="math notranslate nohighlight">\(\alpha_N\)</span> values
(see Umlauf and Burchard (2005))</p></li>
<li><p><strong>smooth_alpha_buoy_lim</strong> (<a class="reference external" href="https://docs.python.org/2.7/library/functions.html#bool" title="(in Python v2.7)"><em>bool</em></a>) – if <span class="math notranslate nohighlight">\(\alpha_N\)</span> is limited, apply a
smooth limiter (see Burchard and Bolding (2001) eq. 19). Otherwise
<span class="math notranslate nohighlight">\(\alpha_N\)</span> is clipped at minimum value.</p></li>
<li><p><strong>alpha_buoy_crit</strong> (<a class="reference external" href="https://docs.python.org/2.7/library/functions.html#float" title="(in Python v2.7)"><em>float</em></a>) – parameter for <span class="math notranslate nohighlight">\(\alpha_N\)</span> smooth limiter</p></li>
</ul>
</dd>
</dl>
<dl class="py method">
<dt class="sig sig-object py" id="thetis.stability_functions.StabilityFunctionBase.compute_alpha_shear_steady">
<span class="sig-name descname"><span class="pre">compute_alpha_shear_steady</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">ri_st</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">analytical</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/stability_functions.html#StabilityFunctionBase.compute_alpha_shear_steady"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#thetis.stability_functions.StabilityFunctionBase.compute_alpha_shear_steady" title="Link to this definition">¶</a></dt>
<dd><p>Compute the steady-state <span class="math notranslate nohighlight">\(\alpha_M\)</span>.</p>
<p>Under steady-state conditions, the stability functions satisfy:</p>
<div class="math notranslate nohighlight">
\[S_m \alpha_M - S_\rho \alpha_M Ri_{st} = 1.0\]</div>
<p>(Umlauf and Buchard, 2005, eq A.15) from which <span class="math notranslate nohighlight">\(\alpha_M\)</span> can be
solved for given gradient Richardson number <span class="math notranslate nohighlight">\(Ri_{st}\)</span>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>ri_st</strong> (<a class="reference external" href="https://docs.python.org/2.7/library/functions.html#float" title="(in Python v2.7)"><em>float</em></a>) – Gradient Richardson number</p></li>
<li><p><strong>analytical</strong> (<a class="reference external" href="https://docs.python.org/2.7/library/functions.html#bool" title="(in Python v2.7)"><em>bool</em></a>) – If True (default), solve analytically using the
coefficients of the stability function. Otherwise, solve
<span class="math notranslate nohighlight">\(\alpha_M\)</span> numerically from the equilibrium condition.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="thetis.stability_functions.StabilityFunctionBase.compute_c3_minus">
<span class="sig-name descname"><span class="pre">compute_c3_minus</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">c1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">c2</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ri_st</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/stability_functions.html#StabilityFunctionBase.compute_c3_minus"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#thetis.stability_functions.StabilityFunctionBase.compute_c3_minus" title="Link to this definition">¶</a></dt>
<dd><p>Compute c3_minus parameter from c1 and c2 parameters.</p>
<p>c3_minus is solved from equation</p>
<div class="math notranslate nohighlight">
\[Ri_{st} = \frac{s_m}{s_h} \frac{c2 - c1}{c2 - c3_{-}}\]</div>
<p>where <span class="math notranslate nohighlight">\(Ri_{st}\)</span> is the steady state gradient Richardson number.
(see Burchard and Bolding, 2001, eq 32)</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="thetis.stability_functions.StabilityFunctionBase.compute_cmu0">
<span class="sig-name descname"><span class="pre">compute_cmu0</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">analytical</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/stability_functions.html#StabilityFunctionBase.compute_cmu0"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#thetis.stability_functions.StabilityFunctionBase.compute_cmu0" title="Link to this definition">¶</a></dt>
<dd><p>Compute parameter <span class="math notranslate nohighlight">\(c_\mu^0\)</span></p>
<p>See: Umlauf and Buchard (2005) eq A.22</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>analytical</strong> (<a class="reference external" href="https://docs.python.org/2.7/library/functions.html#bool" title="(in Python v2.7)"><em>bool</em></a>) – If True (default), solve analytically using the
coefficients of the stability function. Otherwise, solve
<span class="math notranslate nohighlight">\(\alpha_M\)</span> numerically from the equilibrium condition.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="thetis.stability_functions.StabilityFunctionBase.compute_kappa">
<span class="sig-name descname"><span class="pre">compute_kappa</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">sigma_psi</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cmu0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">c1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">c2</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/stability_functions.html#StabilityFunctionBase.compute_kappa"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#thetis.stability_functions.StabilityFunctionBase.compute_kappa" title="Link to this definition">¶</a></dt>
<dd><p>Computes von Karman constant from the Psi Schmidt number.</p>
<p>See: Umlauf and Burchard (2003) eq (14)</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>sigma_psi</strong> – Psi Schmidt number</p></li>
<li><p><strong>c2</strong> (<em>cmu0</em><em>, </em><em>n</em><em>, </em><em>c1</em><em>,</em>) – GLS model parameters</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="thetis.stability_functions.StabilityFunctionBase.compute_length_clim">
<span class="sig-name descname"><span class="pre">compute_length_clim</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">cmu0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ri_st</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/stability_functions.html#StabilityFunctionBase.compute_length_clim"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#thetis.stability_functions.StabilityFunctionBase.compute_length_clim" title="Link to this definition">¶</a></dt>
<dd><p>Computes the Galpering length scale limit.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>cmu0</strong> – parameter <span class="math notranslate nohighlight">\(c_\mu^0\)</span></p></li>
<li><p><strong>ri_st</strong> – gradient Richardson number</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="thetis.stability_functions.StabilityFunctionBase.compute_sigma_psi">
<span class="sig-name descname"><span class="pre">compute_sigma_psi</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">kappa</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cmu0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">c1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">c2</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/stability_functions.html#StabilityFunctionBase.compute_sigma_psi"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#thetis.stability_functions.StabilityFunctionBase.compute_sigma_psi" title="Link to this definition">¶</a></dt>
<dd><p>Computes the Psi Schmidt number from von Karman constant.</p>
<p>See: Umlauf and Burchard (2003) eq (14)</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>kappa</strong> – von Karman constant</p></li>
<li><p><strong>c2</strong> (<em>cmu0</em><em>, </em><em>n</em><em>, </em><em>c1</em><em>,</em>) – GLS model parameters</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="thetis.stability_functions.StabilityFunctionBase.eval_funcs">
<span class="sig-name descname"><span class="pre">eval_funcs</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">alpha_buoy</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">alpha_shear</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/stability_functions.html#StabilityFunctionBase.eval_funcs"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#thetis.stability_functions.StabilityFunctionBase.eval_funcs" title="Link to this definition">¶</a></dt>
<dd><p>Evaluate (unlimited) stability functions</p>
<p>See: Burchard and Petersen (1999) eqns (30) and (31)</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>alpha_buoy</strong> – normalized buoyancy frequency <span class="math notranslate nohighlight">\(\alpha_N\)</span></p></li>
<li><p><strong>alpha_shear</strong> – normalized shear frequency <span class="math notranslate nohighlight">\(\alpha_M\)</span></p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><span class="math notranslate nohighlight">\(S_m\)</span>, <span class="math notranslate nohighlight">\(S_\rho\)</span></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="thetis.stability_functions.StabilityFunctionBase.evaluate">
<span class="sig-name descname"><span class="pre">evaluate</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">shear2</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">buoy2</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">k</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">eps</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/stability_functions.html#StabilityFunctionBase.evaluate"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#thetis.stability_functions.StabilityFunctionBase.evaluate" title="Link to this definition">¶</a></dt>
<dd><p>Evaluate stability functions from dimensional variables.</p>
<p>Applies limiters on <span class="math notranslate nohighlight">\(\alpha_N\)</span> and <span class="math notranslate nohighlight">\(\alpha_M\)</span>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>shear2</strong> – shear frequency squared, <span class="math notranslate nohighlight">\(M^2\)</span></p></li>
<li><p><strong>buoy2</strong> – buoyancy frequency squared,:math:<cite>N^2</cite></p></li>
<li><p><strong>k</strong> – turbulent kinetic energy, <span class="math notranslate nohighlight">\(k\)</span></p></li>
<li><p><strong>eps</strong> – TKE dissipation rate, <span class="math notranslate nohighlight">\(\varepsilon\)</span></p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="thetis.stability_functions.StabilityFunctionBase.get_alpha_buoy_min">
<span class="sig-name descname"><span class="pre">get_alpha_buoy_min</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/stability_functions.html#StabilityFunctionBase.get_alpha_buoy_min"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#thetis.stability_functions.StabilityFunctionBase.get_alpha_buoy_min" title="Link to this definition">¶</a></dt>
<dd><p>Compute minimum normalized buoyancy frequency <span class="math notranslate nohighlight">\(\alpha_N\)</span></p>
<p>See: Umlauf and Buchard (2005), Table 3</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="thetis.stability_functions.StabilityFunctionBase.get_alpha_buoy_smooth_min">
<span class="sig-name descname"><span class="pre">get_alpha_buoy_smooth_min</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">alpha_buoy</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/stability_functions.html#StabilityFunctionBase.get_alpha_buoy_smooth_min"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#thetis.stability_functions.StabilityFunctionBase.get_alpha_buoy_smooth_min" title="Link to this definition">¶</a></dt>
<dd><p>Compute smoothed minimum for normalized buoyancy frequency</p>
<p>See: Burchard and Petersen (1999), eq (19)</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>alpha_buoy</strong> – normalized buoyancy frequency <span class="math notranslate nohighlight">\(\alpha_N\)</span></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="thetis.stability_functions.StabilityFunctionBase.get_alpha_shear_max">
<span class="sig-name descname"><span class="pre">get_alpha_shear_max</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">alpha_buoy</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">alpha_shear</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/stability_functions.html#StabilityFunctionBase.get_alpha_shear_max"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#thetis.stability_functions.StabilityFunctionBase.get_alpha_shear_max" title="Link to this definition">¶</a></dt>
<dd><p>Compute maximum normalized shear frequency <span class="math notranslate nohighlight">\(\alpha_M\)</span></p>
<p>from Umlauf and Buchard (2005) eq (44)</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>alpha_buoy</strong> – normalized buoyancy frequency <span class="math notranslate nohighlight">\(\alpha_N\)</span></p></li>
<li><p><strong>alpha_shear</strong> – normalized shear frequency <span class="math notranslate nohighlight">\(\alpha_M\)</span></p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="thetis.stability_functions.StabilityFunctionBase.name">
<em class="property"><span class="pre">abstract</span><span class="w"> </span><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">name</span></span><a class="headerlink" href="#thetis.stability_functions.StabilityFunctionBase.name" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="thetis.stability_functions.StabilityFunctionCanutoA">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">thetis.stability_functions.</span></span><span class="sig-name descname"><span class="pre">StabilityFunctionCanutoA</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">lim_alpha_shear</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">lim_alpha_buoy</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">smooth_alpha_buoy_lim</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">alpha_buoy_crit</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">-1.2</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/stability_functions.html#StabilityFunctionCanutoA"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#thetis.stability_functions.StabilityFunctionCanutoA" title="Link to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">CanutoStabilityFunctionBase</span></code></p>
<p>Canuto A stability function as defined in the Canuto (2001) paper.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>lim_alpha_shear</strong> (<a class="reference external" href="https://docs.python.org/2.7/library/functions.html#bool" title="(in Python v2.7)"><em>bool</em></a>) – limit maximum <span class="math notranslate nohighlight">\(\alpha_M\)</span> values
(see Umlauf and Burchard (2005) eq. 44)</p></li>
<li><p><strong>lim_alpha_buoy</strong> (<a class="reference external" href="https://docs.python.org/2.7/library/functions.html#bool" title="(in Python v2.7)"><em>bool</em></a>) – limit minimum (negative) <span class="math notranslate nohighlight">\(\alpha_N\)</span> values
(see Umlauf and Burchard (2005))</p></li>
<li><p><strong>smooth_alpha_buoy_lim</strong> (<a class="reference external" href="https://docs.python.org/2.7/library/functions.html#bool" title="(in Python v2.7)"><em>bool</em></a>) – if <span class="math notranslate nohighlight">\(\alpha_N\)</span> is limited, apply a
smooth limiter (see Burchard and Bolding (2001) eq. 19). Otherwise
<span class="math notranslate nohighlight">\(\alpha_N\)</span> is clipped at minimum value.</p></li>
<li><p><strong>alpha_buoy_crit</strong> (<a class="reference external" href="https://docs.python.org/2.7/library/functions.html#float" title="(in Python v2.7)"><em>float</em></a>) – parameter for <span class="math notranslate nohighlight">\(\alpha_N\)</span> smooth limiter</p></li>
</ul>
</dd>
</dl>
<dl class="py attribute">
<dt class="sig sig-object py" id="thetis.stability_functions.StabilityFunctionCanutoA.l1">
<span class="sig-name descname"><span class="pre">l1</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">0.107</span></em><a class="headerlink" href="#thetis.stability_functions.StabilityFunctionCanutoA.l1" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="thetis.stability_functions.StabilityFunctionCanutoA.l2">
<span class="sig-name descname"><span class="pre">l2</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">0.0032</span></em><a class="headerlink" href="#thetis.stability_functions.StabilityFunctionCanutoA.l2" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="thetis.stability_functions.StabilityFunctionCanutoA.l3">
<span class="sig-name descname"><span class="pre">l3</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">0.0864</span></em><a class="headerlink" href="#thetis.stability_functions.StabilityFunctionCanutoA.l3" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="thetis.stability_functions.StabilityFunctionCanutoA.l4">
<span class="sig-name descname"><span class="pre">l4</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">0.12</span></em><a class="headerlink" href="#thetis.stability_functions.StabilityFunctionCanutoA.l4" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="thetis.stability_functions.StabilityFunctionCanutoA.l5">
<span class="sig-name descname"><span class="pre">l5</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">11.9</span></em><a class="headerlink" href="#thetis.stability_functions.StabilityFunctionCanutoA.l5" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="thetis.stability_functions.StabilityFunctionCanutoA.l6">
<span class="sig-name descname"><span class="pre">l6</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">0.4</span></em><a class="headerlink" href="#thetis.stability_functions.StabilityFunctionCanutoA.l6" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="thetis.stability_functions.StabilityFunctionCanutoA.l7">
<span class="sig-name descname"><span class="pre">l7</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">0</span></em><a class="headerlink" href="#thetis.stability_functions.StabilityFunctionCanutoA.l7" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="thetis.stability_functions.StabilityFunctionCanutoA.l8">
<span class="sig-name descname"><span class="pre">l8</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">0.48</span></em><a class="headerlink" href="#thetis.stability_functions.StabilityFunctionCanutoA.l8" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="thetis.stability_functions.StabilityFunctionCanutoA.name">
<span class="sig-name descname"><span class="pre">name</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">'Canuto</span> <span class="pre">A'</span></em><a class="headerlink" href="#thetis.stability_functions.StabilityFunctionCanutoA.name" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="thetis.stability_functions.StabilityFunctionCanutoB">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">thetis.stability_functions.</span></span><span class="sig-name descname"><span class="pre">StabilityFunctionCanutoB</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">lim_alpha_shear</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">lim_alpha_buoy</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">smooth_alpha_buoy_lim</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">alpha_buoy_crit</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">-1.2</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/stability_functions.html#StabilityFunctionCanutoB"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#thetis.stability_functions.StabilityFunctionCanutoB" title="Link to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">CanutoStabilityFunctionBase</span></code></p>
<p>Canuto B stability function as defined in the Canuto (2001) paper.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>lim_alpha_shear</strong> (<a class="reference external" href="https://docs.python.org/2.7/library/functions.html#bool" title="(in Python v2.7)"><em>bool</em></a>) – limit maximum <span class="math notranslate nohighlight">\(\alpha_M\)</span> values
(see Umlauf and Burchard (2005) eq. 44)</p></li>
<li><p><strong>lim_alpha_buoy</strong> (<a class="reference external" href="https://docs.python.org/2.7/library/functions.html#bool" title="(in Python v2.7)"><em>bool</em></a>) – limit minimum (negative) <span class="math notranslate nohighlight">\(\alpha_N\)</span> values
(see Umlauf and Burchard (2005))</p></li>
<li><p><strong>smooth_alpha_buoy_lim</strong> (<a class="reference external" href="https://docs.python.org/2.7/library/functions.html#bool" title="(in Python v2.7)"><em>bool</em></a>) – if <span class="math notranslate nohighlight">\(\alpha_N\)</span> is limited, apply a
smooth limiter (see Burchard and Bolding (2001) eq. 19). Otherwise
<span class="math notranslate nohighlight">\(\alpha_N\)</span> is clipped at minimum value.</p></li>
<li><p><strong>alpha_buoy_crit</strong> (<a class="reference external" href="https://docs.python.org/2.7/library/functions.html#float" title="(in Python v2.7)"><em>float</em></a>) – parameter for <span class="math notranslate nohighlight">\(\alpha_N\)</span> smooth limiter</p></li>
</ul>
</dd>
</dl>
<dl class="py attribute">
<dt class="sig sig-object py" id="thetis.stability_functions.StabilityFunctionCanutoB.l1">
<span class="sig-name descname"><span class="pre">l1</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">0.127</span></em><a class="headerlink" href="#thetis.stability_functions.StabilityFunctionCanutoB.l1" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="thetis.stability_functions.StabilityFunctionCanutoB.l2">
<span class="sig-name descname"><span class="pre">l2</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">0.00336</span></em><a class="headerlink" href="#thetis.stability_functions.StabilityFunctionCanutoB.l2" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="thetis.stability_functions.StabilityFunctionCanutoB.l3">
<span class="sig-name descname"><span class="pre">l3</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">0.0906</span></em><a class="headerlink" href="#thetis.stability_functions.StabilityFunctionCanutoB.l3" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="thetis.stability_functions.StabilityFunctionCanutoB.l4">
<span class="sig-name descname"><span class="pre">l4</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">0.101</span></em><a class="headerlink" href="#thetis.stability_functions.StabilityFunctionCanutoB.l4" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="thetis.stability_functions.StabilityFunctionCanutoB.l5">
<span class="sig-name descname"><span class="pre">l5</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">11.2</span></em><a class="headerlink" href="#thetis.stability_functions.StabilityFunctionCanutoB.l5" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="thetis.stability_functions.StabilityFunctionCanutoB.l6">
<span class="sig-name descname"><span class="pre">l6</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">0.4</span></em><a class="headerlink" href="#thetis.stability_functions.StabilityFunctionCanutoB.l6" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="thetis.stability_functions.StabilityFunctionCanutoB.l7">
<span class="sig-name descname"><span class="pre">l7</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">0</span></em><a class="headerlink" href="#thetis.stability_functions.StabilityFunctionCanutoB.l7" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="thetis.stability_functions.StabilityFunctionCanutoB.l8">
<span class="sig-name descname"><span class="pre">l8</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">0.318</span></em><a class="headerlink" href="#thetis.stability_functions.StabilityFunctionCanutoB.l8" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="thetis.stability_functions.StabilityFunctionCanutoB.name">
<span class="sig-name descname"><span class="pre">name</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">'Canuto</span> <span class="pre">B'</span></em><a class="headerlink" href="#thetis.stability_functions.StabilityFunctionCanutoB.name" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="thetis.stability_functions.StabilityFunctionCheng">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">thetis.stability_functions.</span></span><span class="sig-name descname"><span class="pre">StabilityFunctionCheng</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">lim_alpha_shear</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">lim_alpha_buoy</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">smooth_alpha_buoy_lim</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">alpha_buoy_crit</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">-1.2</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/stability_functions.html#StabilityFunctionCheng"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#thetis.stability_functions.StabilityFunctionCheng" title="Link to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">ChengStabilityFunctionBase</span></code></p>
<p>Cheng stability function as defined in the Cheng et al (2002) paper.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>lim_alpha_shear</strong> (<a class="reference external" href="https://docs.python.org/2.7/library/functions.html#bool" title="(in Python v2.7)"><em>bool</em></a>) – limit maximum <span class="math notranslate nohighlight">\(\alpha_M\)</span> values
(see Umlauf and Burchard (2005) eq. 44)</p></li>
<li><p><strong>lim_alpha_buoy</strong> (<a class="reference external" href="https://docs.python.org/2.7/library/functions.html#bool" title="(in Python v2.7)"><em>bool</em></a>) – limit minimum (negative) <span class="math notranslate nohighlight">\(\alpha_N\)</span> values
(see Umlauf and Burchard (2005))</p></li>
<li><p><strong>smooth_alpha_buoy_lim</strong> (<a class="reference external" href="https://docs.python.org/2.7/library/functions.html#bool" title="(in Python v2.7)"><em>bool</em></a>) – if <span class="math notranslate nohighlight">\(\alpha_N\)</span> is limited, apply a
smooth limiter (see Burchard and Bolding (2001) eq. 19). Otherwise
<span class="math notranslate nohighlight">\(\alpha_N\)</span> is clipped at minimum value.</p></li>
<li><p><strong>alpha_buoy_crit</strong> (<a class="reference external" href="https://docs.python.org/2.7/library/functions.html#float" title="(in Python v2.7)"><em>float</em></a>) – parameter for <span class="math notranslate nohighlight">\(\alpha_N\)</span> smooth limiter</p></li>
</ul>
</dd>
</dl>
<dl class="py attribute">
<dt class="sig sig-object py" id="thetis.stability_functions.StabilityFunctionCheng.l1">
<span class="sig-name descname"><span class="pre">l1</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">0.107</span></em><a class="headerlink" href="#thetis.stability_functions.StabilityFunctionCheng.l1" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="thetis.stability_functions.StabilityFunctionCheng.l2">
<span class="sig-name descname"><span class="pre">l2</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">0.0032</span></em><a class="headerlink" href="#thetis.stability_functions.StabilityFunctionCheng.l2" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="thetis.stability_functions.StabilityFunctionCheng.l3">
<span class="sig-name descname"><span class="pre">l3</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">0.0864</span></em><a class="headerlink" href="#thetis.stability_functions.StabilityFunctionCheng.l3" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="thetis.stability_functions.StabilityFunctionCheng.l4">
<span class="sig-name descname"><span class="pre">l4</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">0.1</span></em><a class="headerlink" href="#thetis.stability_functions.StabilityFunctionCheng.l4" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="thetis.stability_functions.StabilityFunctionCheng.l5">
<span class="sig-name descname"><span class="pre">l5</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">11.04</span></em><a class="headerlink" href="#thetis.stability_functions.StabilityFunctionCheng.l5" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="thetis.stability_functions.StabilityFunctionCheng.l6">
<span class="sig-name descname"><span class="pre">l6</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">0.786</span></em><a class="headerlink" href="#thetis.stability_functions.StabilityFunctionCheng.l6" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="thetis.stability_functions.StabilityFunctionCheng.l7">
<span class="sig-name descname"><span class="pre">l7</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">0.643</span></em><a class="headerlink" href="#thetis.stability_functions.StabilityFunctionCheng.l7" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="thetis.stability_functions.StabilityFunctionCheng.l8">
<span class="sig-name descname"><span class="pre">l8</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">0.547</span></em><a class="headerlink" href="#thetis.stability_functions.StabilityFunctionCheng.l8" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="thetis.stability_functions.StabilityFunctionCheng.name">
<span class="sig-name descname"><span class="pre">name</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">'Cheng'</span></em><a class="headerlink" href="#thetis.stability_functions.StabilityFunctionCheng.name" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="thetis.stability_functions.compute_normalized_frequencies">
<span class="sig-prename descclassname"><span class="pre">thetis.stability_functions.</span></span><span class="sig-name descname"><span class="pre">compute_normalized_frequencies</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">shear2</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">buoy2</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">k</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">eps</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">verbose</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/stability_functions.html#compute_normalized_frequencies"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#thetis.stability_functions.compute_normalized_frequencies" title="Link to this definition">¶</a></dt>
<dd><p>Computes normalized buoyancy and shear frequency squared.</p>
<div class="math notranslate nohighlight">
\[\begin{split}\alpha_M &amp;= \frac{k^2}{\varepsilon^2} M^2 \\
\alpha_N &amp;= \frac{k^2}{\varepsilon^2} N^2\end{split}\]</div>
<p>From Burchard and Bolding (2001).</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>shear2</strong> – <span class="math notranslate nohighlight">\(M^2\)</span></p></li>
<li><p><strong>buoy2</strong> – <span class="math notranslate nohighlight">\(N^2\)</span></p></li>
<li><p><strong>k</strong> – turbulent kinetic energy</p></li>
<li><p><strong>eps</strong> – TKE dissipation rate</p></li>
</ul>
</dd>
</dl>
</dd></dl>

</section>
<section id="module-thetis.timeintegrator">
<span id="thetis-timeintegrator-module"></span><h2>thetis.timeintegrator module<a class="headerlink" href="#module-thetis.timeintegrator" title="Link to this heading">¶</a></h2>
<p>Generic time integration schemes to advance equations in time.</p>
<dl class="py class">
<dt class="sig sig-object py" id="thetis.timeintegrator.CrankNicolson">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">thetis.timeintegrator.</span></span><span class="sig-name descname"><span class="pre">CrankNicolson</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">equation</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">solution</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fields</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dt</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">options</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">bnd_conditions</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/timeintegrator.html#CrankNicolson"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#thetis.timeintegrator.CrankNicolson" title="Link to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#thetis.timeintegrator.TimeIntegrator" title="thetis.timeintegrator.TimeIntegrator"><code class="xref py py-class docutils literal notranslate"><span class="pre">TimeIntegrator</span></code></a></p>
<p>Standard Crank-Nicolson time integration scheme.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>equation</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">Equation</span></code> object) – the equation to solve</p></li>
<li><p><strong>solution</strong> – <code class="xref py py-class docutils literal notranslate"><span class="pre">Function</span></code> where solution will be stored</p></li>
<li><p><strong>fields</strong> (dict of <code class="xref py py-class docutils literal notranslate"><span class="pre">Function</span></code> or <code class="xref py py-class docutils literal notranslate"><span class="pre">Constant</span></code> objects) – Dictionary of fields that are passed to the equation</p></li>
<li><p><strong>dt</strong> (<a class="reference external" href="https://docs.python.org/2.7/library/functions.html#float" title="(in Python v2.7)"><em>float</em></a>) – time step in seconds</p></li>
<li><p><strong>options</strong> – <code class="xref py py-class docutils literal notranslate"><span class="pre">TimeStepperOptions</span></code> instance containing parameter values.</p></li>
<li><p><strong>bnd_conditions</strong> (<a class="reference external" href="https://docs.python.org/2.7/library/stdtypes.html#dict" title="(in Python v2.7)"><em>dict</em></a>) – Dictionary of boundary conditions passed to the equation</p></li>
</ul>
</dd>
</dl>
<dl class="py method">
<dt class="sig sig-object py" id="thetis.timeintegrator.CrankNicolson.advance">
<span class="sig-name descname"><span class="pre">advance</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">t</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">update_forcings</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/timeintegrator.html#CrankNicolson.advance"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#thetis.timeintegrator.CrankNicolson.advance" title="Link to this definition">¶</a></dt>
<dd><p>Advances equations for one time step.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="thetis.timeintegrator.CrankNicolson.advance_picard">
<span class="sig-name descname"><span class="pre">advance_picard</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">t</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">update_forcings</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">update_lagged</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">update_fields</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/timeintegrator.html#CrankNicolson.advance_picard"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#thetis.timeintegrator.CrankNicolson.advance_picard" title="Link to this definition">¶</a></dt>
<dd><p>Advances equations for one time step in a Picard iteration.</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="thetis.timeintegrator.CrankNicolson.cfl_coeff">
<span class="sig-name descname"><span class="pre">cfl_coeff</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">inf</span></em><a class="headerlink" href="#thetis.timeintegrator.CrankNicolson.cfl_coeff" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="thetis.timeintegrator.CrankNicolson.initialize">
<span class="sig-name descname"><span class="pre">initialize</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">solution</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/timeintegrator.html#CrankNicolson.initialize"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#thetis.timeintegrator.CrankNicolson.initialize" title="Link to this definition">¶</a></dt>
<dd><p>Assigns initial conditions to all required fields.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="thetis.timeintegrator.CrankNicolson.update_solver">
<span class="sig-name descname"><span class="pre">update_solver</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/timeintegrator.html#CrankNicolson.update_solver"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#thetis.timeintegrator.CrankNicolson.update_solver" title="Link to this definition">¶</a></dt>
<dd><p>Create solver objects</p>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="thetis.timeintegrator.ForwardEuler">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">thetis.timeintegrator.</span></span><span class="sig-name descname"><span class="pre">ForwardEuler</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">equation</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">solution</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fields</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dt</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">options</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">bnd_conditions</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/timeintegrator.html#ForwardEuler"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#thetis.timeintegrator.ForwardEuler" title="Link to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#thetis.timeintegrator.TimeIntegrator" title="thetis.timeintegrator.TimeIntegrator"><code class="xref py py-class docutils literal notranslate"><span class="pre">TimeIntegrator</span></code></a></p>
<p>Standard forward Euler time integration scheme.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>equation</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">Equation</span></code> object) – the equation to solve</p></li>
<li><p><strong>solution</strong> – <code class="xref py py-class docutils literal notranslate"><span class="pre">Function</span></code> where solution will be stored</p></li>
<li><p><strong>fields</strong> (dict of <code class="xref py py-class docutils literal notranslate"><span class="pre">Function</span></code> or <code class="xref py py-class docutils literal notranslate"><span class="pre">Constant</span></code> objects) – Dictionary of fields that are passed to the equation</p></li>
<li><p><strong>dt</strong> (<a class="reference external" href="https://docs.python.org/2.7/library/functions.html#float" title="(in Python v2.7)"><em>float</em></a>) – time step in seconds</p></li>
<li><p><strong>options</strong> – <code class="xref py py-class docutils literal notranslate"><span class="pre">TimeStepperOptions</span></code> instance containing parameter values.</p></li>
<li><p><strong>bnd_conditions</strong> (<a class="reference external" href="https://docs.python.org/2.7/library/stdtypes.html#dict" title="(in Python v2.7)"><em>dict</em></a>) – Dictionary of boundary conditions passed to the equation</p></li>
</ul>
</dd>
</dl>
<dl class="py method">
<dt class="sig sig-object py" id="thetis.timeintegrator.ForwardEuler.advance">
<span class="sig-name descname"><span class="pre">advance</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">t</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">update_forcings</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/timeintegrator.html#ForwardEuler.advance"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#thetis.timeintegrator.ForwardEuler.advance" title="Link to this definition">¶</a></dt>
<dd><p>Advances equations for one time step.</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="thetis.timeintegrator.ForwardEuler.cfl_coeff">
<span class="sig-name descname"><span class="pre">cfl_coeff</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">1.0</span></em><a class="headerlink" href="#thetis.timeintegrator.ForwardEuler.cfl_coeff" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="thetis.timeintegrator.ForwardEuler.initialize">
<span class="sig-name descname"><span class="pre">initialize</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">solution</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/timeintegrator.html#ForwardEuler.initialize"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#thetis.timeintegrator.ForwardEuler.initialize" title="Link to this definition">¶</a></dt>
<dd><p>Assigns initial conditions to all required fields.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="thetis.timeintegrator.ForwardEuler.update_solver">
<span class="sig-name descname"><span class="pre">update_solver</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/timeintegrator.html#ForwardEuler.update_solver"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#thetis.timeintegrator.ForwardEuler.update_solver" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="thetis.timeintegrator.LeapFrogAM3">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">thetis.timeintegrator.</span></span><span class="sig-name descname"><span class="pre">LeapFrogAM3</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">equation</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">solution</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fields</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dt</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">options</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">bnd_conditions</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">terms_to_add</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'all'</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/timeintegrator.html#LeapFrogAM3"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#thetis.timeintegrator.LeapFrogAM3" title="Link to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#thetis.timeintegrator.TimeIntegrator" title="thetis.timeintegrator.TimeIntegrator"><code class="xref py py-class docutils literal notranslate"><span class="pre">TimeIntegrator</span></code></a></p>
<p>Leap-Frog Adams-Moulton 3 ALE time integrator</p>
<p>Defined in (2.27)-(2.30) in [1]; (2.21)-(2.22) in [2]</p>
<p>[1] Shchepetkin and McWilliams (2005). The regional oceanic modeling system
(ROMS): a split-explicit, free-surface, topography-following-coordinate
oceanic model. Ocean Modelling, 9(4):347-404.
<a class="reference external" href="http://dx.doi.org/10.1016/j.ocemod.2013.04.010">http://dx.doi.org/10.1016/j.ocemod.2013.04.010</a></p>
<p>[2] Shchepetkin and McWilliams (2009). Computational Kernel Algorithms for
Fine-Scale, Multiprocess, Longtime Oceanic Simulations, 14:121-183.
<a class="reference external" href="http://dx.doi.org/10.1016/S1570-8659(08)01202-0">http://dx.doi.org/10.1016/S1570-8659(08)01202-0</a></p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>equation</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">Equation</span></code> object) – equation to solve</p></li>
<li><p><strong>solution</strong> – <code class="xref py py-class docutils literal notranslate"><span class="pre">Function</span></code> where solution will be stored</p></li>
<li><p><strong>fields</strong> (dict of <code class="xref py py-class docutils literal notranslate"><span class="pre">Function</span></code> or <code class="xref py py-class docutils literal notranslate"><span class="pre">Constant</span></code> objects) – Dictionary of fields that are passed to the equation</p></li>
<li><p><strong>dt</strong> (<a class="reference external" href="https://docs.python.org/2.7/library/functions.html#float" title="(in Python v2.7)"><em>float</em></a>) – time step in seconds</p></li>
<li><p><strong>options</strong> – <code class="xref py py-class docutils literal notranslate"><span class="pre">TimeStepperOptions</span></code> instance containing parameter values.</p></li>
<li><p><strong>bnd_conditions</strong> (<a class="reference external" href="https://docs.python.org/2.7/library/stdtypes.html#dict" title="(in Python v2.7)"><em>dict</em></a>) – Dictionary of boundary conditions passed to the equation</p></li>
<li><p><strong>terms_to_add</strong> (<em>'all'</em><em> or </em><em>list</em><em> of </em><em>'implicit'</em><em>, </em><em>'explicit'</em><em>, </em><em>'source'.</em>) – Defines which terms of the equation are to be
added to this solver. Default ‘all’ implies [‘implicit’, ‘explicit’, ‘source’].</p></li>
</ul>
</dd>
</dl>
<dl class="py method">
<dt class="sig sig-object py" id="thetis.timeintegrator.LeapFrogAM3.advance">
<span class="sig-name descname"><span class="pre">advance</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">t</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">update_forcings</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/timeintegrator.html#LeapFrogAM3.advance"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#thetis.timeintegrator.LeapFrogAM3.advance" title="Link to this definition">¶</a></dt>
<dd><p>Advances equations for one time step.</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="thetis.timeintegrator.LeapFrogAM3.cfl_coeff">
<span class="sig-name descname"><span class="pre">cfl_coeff</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">1.5874</span></em><a class="headerlink" href="#thetis.timeintegrator.LeapFrogAM3.cfl_coeff" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="thetis.timeintegrator.LeapFrogAM3.correct">
<span class="sig-name descname"><span class="pre">correct</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/timeintegrator.html#LeapFrogAM3.correct"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#thetis.timeintegrator.LeapFrogAM3.correct" title="Link to this definition">¶</a></dt>
<dd><p>Correction step from <span class="math notranslate nohighlight">\(t_{n}\)</span> to <span class="math notranslate nohighlight">\(t_{n+1}\)</span></p>
<p>Let <span class="math notranslate nohighlight">\(M_n\)</span> denote the mass matrix at time <span class="math notranslate nohighlight">\(t_{n}\)</span>.
The correction step is</p>
<div class="math notranslate nohighlight">
\[M_{n+1} T_{n+1} = M_{n} T_{n} + \Delta t L_{n+1/2}\]</div>
<p>This is Euler ALE step: LHS is evaluated in <span class="math notranslate nohighlight">\(\Omega_{n+1}\)</span>,
RHS in <span class="math notranslate nohighlight">\(\Omega_n\)</span>.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="thetis.timeintegrator.LeapFrogAM3.eval_rhs">
<span class="sig-name descname"><span class="pre">eval_rhs</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/timeintegrator.html#LeapFrogAM3.eval_rhs"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#thetis.timeintegrator.LeapFrogAM3.eval_rhs" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="thetis.timeintegrator.LeapFrogAM3.initialize">
<span class="sig-name descname"><span class="pre">initialize</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">solution</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/timeintegrator.html#LeapFrogAM3.initialize"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#thetis.timeintegrator.LeapFrogAM3.initialize" title="Link to this definition">¶</a></dt>
<dd><p>Assigns initial conditions to all required fields.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="thetis.timeintegrator.LeapFrogAM3.predict">
<span class="sig-name descname"><span class="pre">predict</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/timeintegrator.html#LeapFrogAM3.predict"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#thetis.timeintegrator.LeapFrogAM3.predict" title="Link to this definition">¶</a></dt>
<dd><p>Prediction step from <span class="math notranslate nohighlight">\(t_{n-1/2}\)</span> to <span class="math notranslate nohighlight">\(t_{n+1/2}\)</span></p>
<p>Let <span class="math notranslate nohighlight">\(M_n\)</span> denote the mass matrix at time <span class="math notranslate nohighlight">\(t_{n}\)</span>.
The prediction step is</p>
<div class="math notranslate nohighlight">
\[\begin{split}T_{n-1/2} &amp;= (1/2 - 2\gamma) T_{n-1} + (1/2 + 2 \gamma) T_{n} \\
M_n T_{n+1/2} &amp;= M_n T_{n-1/2} + \Delta t (1 - 2\gamma) M_n L_{n}\end{split}\]</div>
<p>This is computed in a fixed mesh: all terms are evaluated in
<span class="math notranslate nohighlight">\(\Omega_n\)</span>.</p>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="thetis.timeintegrator.PressureProjectionPicard">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">thetis.timeintegrator.</span></span><span class="sig-name descname"><span class="pre">PressureProjectionPicard</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">equation</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">equation_mom</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">solution</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fields</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dt</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">options</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">bnd_conditions</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/timeintegrator.html#PressureProjectionPicard"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#thetis.timeintegrator.PressureProjectionPicard" title="Link to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#thetis.timeintegrator.TimeIntegrator" title="thetis.timeintegrator.TimeIntegrator"><code class="xref py py-class docutils literal notranslate"><span class="pre">TimeIntegrator</span></code></a></p>
<p>Pressure projection scheme with Picard iteration for shallow water
equations</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>equation</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">Equation</span></code> object) – free surface equation</p></li>
<li><p><strong>equation_mom</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">Equation</span></code> object) – momentum equation</p></li>
<li><p><strong>solution</strong> – <code class="xref py py-class docutils literal notranslate"><span class="pre">Function</span></code> where solution will be stored</p></li>
<li><p><strong>fields</strong> (dict of <code class="xref py py-class docutils literal notranslate"><span class="pre">Function</span></code> or <code class="xref py py-class docutils literal notranslate"><span class="pre">Constant</span></code> objects) – Dictionary of fields that are passed to the equation</p></li>
<li><p><strong>dt</strong> (<a class="reference external" href="https://docs.python.org/2.7/library/functions.html#float" title="(in Python v2.7)"><em>float</em></a>) – time step in seconds</p></li>
<li><p><strong>options</strong> – <code class="xref py py-class docutils literal notranslate"><span class="pre">TimeStepperOptions</span></code> instance containing parameter values.</p></li>
<li><p><strong>bnd_conditions</strong> (<a class="reference external" href="https://docs.python.org/2.7/library/stdtypes.html#dict" title="(in Python v2.7)"><em>dict</em></a>) – Dictionary of boundary conditions passed to the equation</p></li>
</ul>
</dd>
</dl>
<dl class="py method">
<dt class="sig sig-object py" id="thetis.timeintegrator.PressureProjectionPicard.advance">
<span class="sig-name descname"><span class="pre">advance</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">t</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">update_forcings</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/timeintegrator.html#PressureProjectionPicard.advance"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#thetis.timeintegrator.PressureProjectionPicard.advance" title="Link to this definition">¶</a></dt>
<dd><p>Advances equations for one time step.</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="thetis.timeintegrator.PressureProjectionPicard.cfl_coeff">
<span class="sig-name descname"><span class="pre">cfl_coeff</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">1.0</span></em><a class="headerlink" href="#thetis.timeintegrator.PressureProjectionPicard.cfl_coeff" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="thetis.timeintegrator.PressureProjectionPicard.initialize">
<span class="sig-name descname"><span class="pre">initialize</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">solution</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/timeintegrator.html#PressureProjectionPicard.initialize"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#thetis.timeintegrator.PressureProjectionPicard.initialize" title="Link to this definition">¶</a></dt>
<dd><p>Assigns initial conditions to all required fields.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="thetis.timeintegrator.PressureProjectionPicard.update_solver">
<span class="sig-name descname"><span class="pre">update_solver</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/timeintegrator.html#PressureProjectionPicard.update_solver"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#thetis.timeintegrator.PressureProjectionPicard.update_solver" title="Link to this definition">¶</a></dt>
<dd><p>Create solver objects</p>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="thetis.timeintegrator.SSPRK22ALE">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">thetis.timeintegrator.</span></span><span class="sig-name descname"><span class="pre">SSPRK22ALE</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">equation</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">solution</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fields</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dt</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">options</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">bnd_conditions</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">terms_to_add</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'all'</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/timeintegrator.html#SSPRK22ALE"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#thetis.timeintegrator.SSPRK22ALE" title="Link to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#thetis.timeintegrator.TimeIntegrator" title="thetis.timeintegrator.TimeIntegrator"><code class="xref py py-class docutils literal notranslate"><span class="pre">TimeIntegrator</span></code></a></p>
<p>SSPRK(2,2) ALE time integrator for 3D fields</p>
<p>The scheme is</p>
<div class="math notranslate nohighlight">
\[\begin{split}u^{(1)} &amp;= u^{n} + \Delta t F(u^{n}) \\
u^{n+1} &amp;= u^{n} + \frac{\Delta t}{2}(F(u^{n}) +  F(u^{(1)}))\end{split}\]</div>
<p>Both stages are implemented as ALE updates from geometry <span class="math notranslate nohighlight">\(\Omega_n\)</span>
to <span class="math notranslate nohighlight">\(\Omega_{(1)}\)</span>, and <span class="math notranslate nohighlight">\(\Omega_{n+1}\)</span>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>equation</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">Equation</span></code> object) – equation to solve</p></li>
<li><p><strong>solution</strong> – <code class="xref py py-class docutils literal notranslate"><span class="pre">Function</span></code> where solution will be stored</p></li>
<li><p><strong>fields</strong> (dict of <code class="xref py py-class docutils literal notranslate"><span class="pre">Function</span></code> or <code class="xref py py-class docutils literal notranslate"><span class="pre">Constant</span></code> objects) – Dictionary of fields that are passed to the equation</p></li>
<li><p><strong>dt</strong> (<a class="reference external" href="https://docs.python.org/2.7/library/functions.html#float" title="(in Python v2.7)"><em>float</em></a>) – time step in seconds</p></li>
<li><p><strong>options</strong> – <code class="xref py py-class docutils literal notranslate"><span class="pre">TimeStepperOptions</span></code> instance containing parameter values.</p></li>
<li><p><strong>bnd_conditions</strong> (<a class="reference external" href="https://docs.python.org/2.7/library/stdtypes.html#dict" title="(in Python v2.7)"><em>dict</em></a>) – Dictionary of boundary conditions passed to the equation</p></li>
<li><p><strong>terms_to_add</strong> (<em>'all'</em><em> or </em><em>list</em><em> of </em><em>'implicit'</em><em>, </em><em>'explicit'</em><em>, </em><em>'source'.</em>) – Defines which terms of the equation are to be
added to this solver. Default ‘all’ implies [‘implicit’, ‘explicit’, ‘source’].</p></li>
</ul>
</dd>
</dl>
<dl class="py method">
<dt class="sig sig-object py" id="thetis.timeintegrator.SSPRK22ALE.advance">
<span class="sig-name descname"><span class="pre">advance</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">t</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">update_forcings</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/timeintegrator.html#SSPRK22ALE.advance"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#thetis.timeintegrator.SSPRK22ALE.advance" title="Link to this definition">¶</a></dt>
<dd><p>Advances equations for one time step.</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="thetis.timeintegrator.SSPRK22ALE.cfl_coeff">
<span class="sig-name descname"><span class="pre">cfl_coeff</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">1.0</span></em><a class="headerlink" href="#thetis.timeintegrator.SSPRK22ALE.cfl_coeff" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="thetis.timeintegrator.SSPRK22ALE.initialize">
<span class="sig-name descname"><span class="pre">initialize</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">solution</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/timeintegrator.html#SSPRK22ALE.initialize"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#thetis.timeintegrator.SSPRK22ALE.initialize" title="Link to this definition">¶</a></dt>
<dd><p>Assigns initial conditions to all required fields.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="thetis.timeintegrator.SSPRK22ALE.prepare_stage">
<span class="sig-name descname"><span class="pre">prepare_stage</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">i_stage</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">t</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">update_forcings</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/timeintegrator.html#SSPRK22ALE.prepare_stage"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#thetis.timeintegrator.SSPRK22ALE.prepare_stage" title="Link to this definition">¶</a></dt>
<dd><p>Preprocess stage i_stage.</p>
<p>This must be called prior to updating mesh geometry.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="thetis.timeintegrator.SSPRK22ALE.solve_stage">
<span class="sig-name descname"><span class="pre">solve_stage</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">i_stage</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/timeintegrator.html#SSPRK22ALE.solve_stage"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#thetis.timeintegrator.SSPRK22ALE.solve_stage" title="Link to this definition">¶</a></dt>
<dd><p>Solves i-th stage</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="thetis.timeintegrator.SSPRK22ALE.stage_one_prep">
<span class="sig-name descname"><span class="pre">stage_one_prep</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/timeintegrator.html#SSPRK22ALE.stage_one_prep"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#thetis.timeintegrator.SSPRK22ALE.stage_one_prep" title="Link to this definition">¶</a></dt>
<dd><p>Preprocess first stage: compute all forms on the old geometry</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="thetis.timeintegrator.SSPRK22ALE.stage_one_solve">
<span class="sig-name descname"><span class="pre">stage_one_solve</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/timeintegrator.html#SSPRK22ALE.stage_one_solve"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#thetis.timeintegrator.SSPRK22ALE.stage_one_solve" title="Link to this definition">¶</a></dt>
<dd><p>First stage: solve <span class="math notranslate nohighlight">\(u^{(1)}\)</span> given previous solution <span class="math notranslate nohighlight">\(u^n\)</span>.</p>
<p>This is a forward Euler ALE step between domains <span class="math notranslate nohighlight">\(\Omega^n\)</span> and <span class="math notranslate nohighlight">\(\Omega^{(1)}\)</span>:</p>
<div class="math notranslate nohighlight">
\[\int_{\Omega^{(1)}} u^{(1)} \psi dx = \int_{\Omega^n} u^n \psi dx + \Delta t \int_{\Omega^n} F(u^n) \psi dx\]</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="thetis.timeintegrator.SSPRK22ALE.stage_two_prep">
<span class="sig-name descname"><span class="pre">stage_two_prep</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/timeintegrator.html#SSPRK22ALE.stage_two_prep"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#thetis.timeintegrator.SSPRK22ALE.stage_two_prep" title="Link to this definition">¶</a></dt>
<dd><p>Preprocess 2nd stage: compute all forms on the old geometry</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="thetis.timeintegrator.SSPRK22ALE.stage_two_solve">
<span class="sig-name descname"><span class="pre">stage_two_solve</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/timeintegrator.html#SSPRK22ALE.stage_two_solve"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#thetis.timeintegrator.SSPRK22ALE.stage_two_solve" title="Link to this definition">¶</a></dt>
<dd><p>2nd stage: solve <span class="math notranslate nohighlight">\(u^{n+1}\)</span> given previous solutions <span class="math notranslate nohighlight">\(u^n, u^{(1)}\)</span>.</p>
<p>This is an ALE step:</p>
<div class="math notranslate nohighlight">
\[\begin{split}\int_{\Omega^{n+1}} u^{n+1} \psi dx &amp;= \int_{\Omega^n} u^n \psi dx \\
    &amp;+ \frac{\Delta t}{2} \int_{\Omega^n} F(u^n) \psi dx \\
    &amp;+ \frac{\Delta t}{2} \int_{\Omega^{(1)}} F(u^{(1)}) \psi dx\end{split}\]</div>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="thetis.timeintegrator.SteadyState">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">thetis.timeintegrator.</span></span><span class="sig-name descname"><span class="pre">SteadyState</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">equation</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">solution</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fields</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dt</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">options</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">bnd_conditions</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/timeintegrator.html#SteadyState"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#thetis.timeintegrator.SteadyState" title="Link to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#thetis.timeintegrator.TimeIntegrator" title="thetis.timeintegrator.TimeIntegrator"><code class="xref py py-class docutils literal notranslate"><span class="pre">TimeIntegrator</span></code></a></p>
<p>Time integrator that solves the steady state equations, leaving out the
mass terms</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>equation</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">Equation</span></code> object) – the equation to solve</p></li>
<li><p><strong>solution</strong> – <code class="xref py py-class docutils literal notranslate"><span class="pre">Function</span></code> where solution will be stored</p></li>
<li><p><strong>fields</strong> (dict of <code class="xref py py-class docutils literal notranslate"><span class="pre">Function</span></code> or <code class="xref py py-class docutils literal notranslate"><span class="pre">Constant</span></code> objects) – Dictionary of fields that are passed to the equation</p></li>
<li><p><strong>dt</strong> (<a class="reference external" href="https://docs.python.org/2.7/library/functions.html#float" title="(in Python v2.7)"><em>float</em></a>) – time step in seconds</p></li>
<li><p><strong>options</strong> – <code class="xref py py-class docutils literal notranslate"><span class="pre">TimeStepperOptions</span></code> instance containing parameter values.</p></li>
<li><p><strong>bnd_conditions</strong> (<a class="reference external" href="https://docs.python.org/2.7/library/stdtypes.html#dict" title="(in Python v2.7)"><em>dict</em></a>) – Dictionary of boundary conditions passed to the equation</p></li>
</ul>
</dd>
</dl>
<dl class="py method">
<dt class="sig sig-object py" id="thetis.timeintegrator.SteadyState.advance">
<span class="sig-name descname"><span class="pre">advance</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">t</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">update_forcings</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/timeintegrator.html#SteadyState.advance"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#thetis.timeintegrator.SteadyState.advance" title="Link to this definition">¶</a></dt>
<dd><p>Advances equations for one time step.</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="thetis.timeintegrator.SteadyState.cfl_coeff">
<span class="sig-name descname"><span class="pre">cfl_coeff</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">inf</span></em><a class="headerlink" href="#thetis.timeintegrator.SteadyState.cfl_coeff" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="thetis.timeintegrator.SteadyState.initialize">
<span class="sig-name descname"><span class="pre">initialize</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">solution</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/timeintegrator.html#SteadyState.initialize"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#thetis.timeintegrator.SteadyState.initialize" title="Link to this definition">¶</a></dt>
<dd><p>Assigns initial conditions to all required fields.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="thetis.timeintegrator.SteadyState.update_solver">
<span class="sig-name descname"><span class="pre">update_solver</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/timeintegrator.html#SteadyState.update_solver"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#thetis.timeintegrator.SteadyState.update_solver" title="Link to this definition">¶</a></dt>
<dd><p>Create solver objects</p>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="thetis.timeintegrator.TimeIntegrator">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">thetis.timeintegrator.</span></span><span class="sig-name descname"><span class="pre">TimeIntegrator</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">equation</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">solution</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fields</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dt</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">options</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/timeintegrator.html#TimeIntegrator"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#thetis.timeintegrator.TimeIntegrator" title="Link to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#thetis.timeintegrator.TimeIntegratorBase" title="thetis.timeintegrator.TimeIntegratorBase"><code class="xref py py-class docutils literal notranslate"><span class="pre">TimeIntegratorBase</span></code></a></p>
<p>Base class for all time integrator objects that march a single equation</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>equation</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">Equation</span></code> object) – the equation to solve</p></li>
<li><p><strong>solution</strong> – <code class="xref py py-class docutils literal notranslate"><span class="pre">Function</span></code> where solution will be stored</p></li>
<li><p><strong>fields</strong> (dict of <code class="xref py py-class docutils literal notranslate"><span class="pre">Function</span></code> or <code class="xref py py-class docutils literal notranslate"><span class="pre">Constant</span></code> objects) – Dictionary of fields that are passed to the equation</p></li>
<li><p><strong>dt</strong> (<a class="reference external" href="https://docs.python.org/2.7/library/functions.html#float" title="(in Python v2.7)"><em>float</em></a>) – time step in seconds</p></li>
<li><p><strong>options</strong> – <code class="xref py py-class docutils literal notranslate"><span class="pre">TimeStepperOptions</span></code> instance containing parameter values</p></li>
</ul>
</dd>
</dl>
<dl class="py method">
<dt class="sig sig-object py" id="thetis.timeintegrator.TimeIntegrator.advance_picard">
<span class="sig-name descname"><span class="pre">advance_picard</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">t</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">update_forcings</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">update_lagged</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">update_fields</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/timeintegrator.html#TimeIntegrator.advance_picard"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#thetis.timeintegrator.TimeIntegrator.advance_picard" title="Link to this definition">¶</a></dt>
<dd><p>Advances equations for one time step within a Picard iteration</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>t</strong> (<a class="reference external" href="https://docs.python.org/2.7/library/functions.html#float" title="(in Python v2.7)"><em>float</em></a>) – simulation time</p></li>
<li><p><strong>update_forcings</strong> – user-defined function that takes the simulation
time and updates any time-dependent boundary conditions</p></li>
<li><p><strong>update_lagged</strong> – should the old solution be updated?</p></li>
<li><p><strong>update_fields</strong> – should the fields be updated?</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="thetis.timeintegrator.TimeIntegrator.create_fields_old">
<span class="sig-name descname"><span class="pre">create_fields_old</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/timeintegrator.html#TimeIntegrator.create_fields_old"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#thetis.timeintegrator.TimeIntegrator.create_fields_old" title="Link to this definition">¶</a></dt>
<dd><p>Create a copy of fields dictionary to store beginning of timestep values</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="thetis.timeintegrator.TimeIntegrator.set_dt">
<span class="sig-name descname"><span class="pre">set_dt</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">dt</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/timeintegrator.html#TimeIntegrator.set_dt"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#thetis.timeintegrator.TimeIntegrator.set_dt" title="Link to this definition">¶</a></dt>
<dd><p>Update time step</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="thetis.timeintegrator.TimeIntegrator.update_fields_old">
<span class="sig-name descname"><span class="pre">update_fields_old</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/timeintegrator.html#TimeIntegrator.update_fields_old"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#thetis.timeintegrator.TimeIntegrator.update_fields_old" title="Link to this definition">¶</a></dt>
<dd><p>Update the values of fields_old with those of fields</p>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="thetis.timeintegrator.TimeIntegratorBase">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">thetis.timeintegrator.</span></span><span class="sig-name descname"><span class="pre">TimeIntegratorBase</span></span><a class="reference internal" href="_modules/thetis/timeintegrator.html#TimeIntegratorBase"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#thetis.timeintegrator.TimeIntegratorBase" title="Link to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">ABC</span></code></p>
<p>Abstract class that defines the API for all time integrators</p>
<p>Both <a class="reference internal" href="#thetis.timeintegrator.TimeIntegrator" title="thetis.timeintegrator.TimeIntegrator"><code class="xref py py-class docutils literal notranslate"><span class="pre">TimeIntegrator</span></code></a> and <code class="xref py py-class docutils literal notranslate"><span class="pre">CoupledTimeIntegrator</span></code> inherit
from this class.</p>
<dl class="py method">
<dt class="sig sig-object py" id="thetis.timeintegrator.TimeIntegratorBase.advance">
<em class="property"><span class="pre">abstract</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">advance</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">t</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">update_forcings</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/timeintegrator.html#TimeIntegratorBase.advance"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#thetis.timeintegrator.TimeIntegratorBase.advance" title="Link to this definition">¶</a></dt>
<dd><p>Advances equations for one time step</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>t</strong> (<a class="reference external" href="https://docs.python.org/2.7/library/functions.html#float" title="(in Python v2.7)"><em>float</em></a>) – simulation time</p></li>
<li><p><strong>update_forcings</strong> – user-defined function that takes the simulation
time and updates any time-dependent boundary conditions</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="thetis.timeintegrator.TimeIntegratorBase.initialize">
<em class="property"><span class="pre">abstract</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">initialize</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">init_solution</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/timeintegrator.html#TimeIntegratorBase.initialize"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#thetis.timeintegrator.TimeIntegratorBase.initialize" title="Link to this definition">¶</a></dt>
<dd><p>Initialize the time integrator</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>init_solution</strong> – initial solution</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

</section>
<section id="module-thetis.timezone">
<span id="thetis-timezone-module"></span><h2>thetis.timezone module<a class="headerlink" href="#module-thetis.timezone" title="Link to this heading">¶</a></h2>
<p>Timezone definitions and conversion methods</p>
<dl class="py class">
<dt class="sig sig-object py" id="thetis.timezone.FixedTimeZone">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">thetis.timezone.</span></span><span class="sig-name descname"><span class="pre">FixedTimeZone</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">offset</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">name</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/timezone.html#FixedTimeZone"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#thetis.timezone.FixedTimeZone" title="Link to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">_FixedOffset</span></code></p>
<p>Class that represents a fixed time zone defined by UTC offset in hours.</p>
<p>arg int offset: timezone UTC offset in hours
arg str name: timezone name</p>
<dl class="py method">
<dt class="sig sig-object py" id="thetis.timezone.FixedTimeZone.tzname">
<span class="sig-name descname"><span class="pre">tzname</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">dt</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/timezone.html#FixedTimeZone.tzname"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#thetis.timezone.FixedTimeZone.tzname" title="Link to this definition">¶</a></dt>
<dd><p>datetime -&gt; string name of time zone.</p>
</dd></dl>

</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="thetis.timezone.datetime_to_epoch">
<span class="sig-prename descclassname"><span class="pre">thetis.timezone.</span></span><span class="sig-name descname"><span class="pre">datetime_to_epoch</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">t</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/timezone.html#datetime_to_epoch"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#thetis.timezone.datetime_to_epoch" title="Link to this definition">¶</a></dt>
<dd><p>Convert python datetime object to epoch time stamp.</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="thetis.timezone.epoch_to_datetime">
<span class="sig-prename descclassname"><span class="pre">thetis.timezone.</span></span><span class="sig-name descname"><span class="pre">epoch_to_datetime</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">t</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/timezone.html#epoch_to_datetime"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#thetis.timezone.epoch_to_datetime" title="Link to this definition">¶</a></dt>
<dd><p>Convert python datetime object to epoch time stamp.</p>
</dd></dl>

</section>
<section id="module-thetis.tracer_eq">
<span id="thetis-tracer-eq-module"></span><h2>thetis.tracer_eq module<a class="headerlink" href="#module-thetis.tracer_eq" title="Link to this heading">¶</a></h2>
<p>3D advection diffusion equation for tracers.</p>
<p>The advection-diffusion equation of tracer <span class="math notranslate nohighlight">\(T\)</span> in conservative form reads</p>
<div class="math notranslate nohighlight" id="equation-tracer-eq">
<span class="eqno">(15)<a class="headerlink" href="#equation-tracer-eq" title="Link to this equation">¶</a></span>\[\frac{\partial T}{\partial t}
 + \nabla_h \cdot (\textbf{u} T)
 + \frac{\partial (w T)}{\partial z}
 = \nabla_h \cdot (\mu_h \nabla_h T)
 + \frac{\partial}{\partial z} \Big(\mu \frac{\partial T}{\partial z}\Big)\]</div>
<p>where <span class="math notranslate nohighlight">\(\nabla_h\)</span> denotes horizontal gradient, <span class="math notranslate nohighlight">\(\textbf{u}\)</span> and
<span class="math notranslate nohighlight">\(w\)</span> are the horizontal and vertical velocities, respectively, and
<span class="math notranslate nohighlight">\(\mu_h\)</span> and <span class="math notranslate nohighlight">\(\mu\)</span> denote horizontal and vertical diffusivity.</p>
<dl class="py class">
<dt class="sig sig-object py" id="thetis.tracer_eq.HorizontalAdvectionTerm">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">thetis.tracer_eq.</span></span><span class="sig-name descname"><span class="pre">HorizontalAdvectionTerm</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">function_space</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">bathymetry</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">v_elem_size</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">h_elem_size</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">use_symmetric_surf_bnd</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">use_lax_friedrichs</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sipg_factor</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">Constant([1.],</span> <span class="pre">name='constant_10',</span> <span class="pre">count=10)</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sipg_factor_vertical</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">Constant([1.],</span> <span class="pre">name='constant_11',</span> <span class="pre">count=11)</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/tracer_eq.html#HorizontalAdvectionTerm"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#thetis.tracer_eq.HorizontalAdvectionTerm" title="Link to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#thetis.tracer_eq.TracerTerm" title="thetis.tracer_eq.TracerTerm"><code class="xref py py-class docutils literal notranslate"><span class="pre">TracerTerm</span></code></a></p>
<p>Horizontal advection term <span class="math notranslate nohighlight">\(\nabla_h \cdot (\textbf{u} T)\)</span></p>
<p>The weak formulation reads</p>
<div class="math notranslate nohighlight">
\[\int_\Omega \nabla_h \cdot (\textbf{u} T) \phi dx
    = -\int_\Omega T\textbf{u} \cdot \nabla_h \phi dx
    + \int_{\mathcal{I}_h\cup\mathcal{I}_v}
        T^{\text{up}} \text{avg}(\textbf{u}) \cdot
        \text{jump}(\phi \textbf{n}_h) dS\]</div>
<p>where the right hand side has been integrated by parts;
<span class="math notranslate nohighlight">\(\mathcal{I}_h,\mathcal{I}_v\)</span> denote the set of horizontal and
vertical facets,
<span class="math notranslate nohighlight">\(\textbf{n}_h\)</span> is the horizontal projection of the unit normal vector,
<span class="math notranslate nohighlight">\(T^{\text{up}}\)</span> is the upwind value, and <span class="math notranslate nohighlight">\(\text{jump}\)</span> and
<span class="math notranslate nohighlight">\(\text{avg}\)</span> denote the jump and average operators across the
interface.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>function_space</strong> – <code class="xref py py-class docutils literal notranslate"><span class="pre">FunctionSpace</span></code> where the solution belongs</p></li>
<li><p><strong>bathymetry</strong> (3D <code class="xref py py-class docutils literal notranslate"><span class="pre">Function</span></code> or <code class="xref py py-class docutils literal notranslate"><span class="pre">Constant</span></code>) – bathymetry of the domain</p></li>
<li><p><strong>v_elem_size</strong> – scalar <code class="xref py py-class docutils literal notranslate"><span class="pre">Function</span></code> that defines the vertical
element size</p></li>
<li><p><strong>h_elem_size</strong> – scalar <code class="xref py py-class docutils literal notranslate"><span class="pre">Function</span></code> that defines the horizontal
element size</p></li>
<li><p><strong>use_symmetric_surf_bnd</strong> (<a class="reference external" href="https://docs.python.org/2.7/library/functions.html#bool" title="(in Python v2.7)"><em>bool</em></a>) – If True, use symmetric surface boundary
condition in the horizontal advection term</p></li>
<li><p><strong>sipg_factor</strong> – <dl class="field-list simple">
<dt class="field-odd">class<span class="colon">:</span></dt>
<dd class="field-odd"><p><cite>Constant</cite> or :class: <cite>Function</cite> horizontal SIPG penalty scaling factor</p>
</dd>
</dl>
</p></li>
<li><p><strong>sipg_factor_vertical</strong> – <dl class="field-list simple">
<dt class="field-odd">class<span class="colon">:</span></dt>
<dd class="field-odd"><p><cite>Constant</cite> or :class: <cite>Function</cite> vertical SIPG penalty scaling factor</p>
</dd>
</dl>
</p></li>
</ul>
</dd>
</dl>
<dl class="py method">
<dt class="sig sig-object py" id="thetis.tracer_eq.HorizontalAdvectionTerm.residual">
<span class="sig-name descname"><span class="pre">residual</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">solution</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">solution_old</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fields</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fields_old</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">bnd_conditions</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/tracer_eq.html#HorizontalAdvectionTerm.residual"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#thetis.tracer_eq.HorizontalAdvectionTerm.residual" title="Link to this definition">¶</a></dt>
<dd><p>Returns an UFL form of the term.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>solution</strong> – solution <code class="xref py py-class docutils literal notranslate"><span class="pre">Function</span></code> of the corresponding equation</p></li>
<li><p><strong>solution_old</strong> – a time lagged solution <code class="xref py py-class docutils literal notranslate"><span class="pre">Function</span></code></p></li>
<li><p><strong>fields</strong> – a dictionary that provides all the remaining fields that the term depends on.
The keys of the dictionary should standard field names in <cite>field_metadata</cite></p></li>
<li><p><strong>fields_old</strong> – Time lagged dictionary of fields</p></li>
<li><p><strong>bnd_conditions</strong> – A dictionary describing boundary conditions.
E.g. {3: {‘elev_2d’: Constant(1.0)}} replaces elev_2d function by a constant on boundary ID 3.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="thetis.tracer_eq.HorizontalDiffusionTerm">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">thetis.tracer_eq.</span></span><span class="sig-name descname"><span class="pre">HorizontalDiffusionTerm</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">function_space</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">bathymetry</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">v_elem_size</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">h_elem_size</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">use_symmetric_surf_bnd</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">use_lax_friedrichs</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sipg_factor</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">Constant([1.],</span> <span class="pre">name='constant_10',</span> <span class="pre">count=10)</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sipg_factor_vertical</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">Constant([1.],</span> <span class="pre">name='constant_11',</span> <span class="pre">count=11)</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/tracer_eq.html#HorizontalDiffusionTerm"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#thetis.tracer_eq.HorizontalDiffusionTerm" title="Link to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#thetis.tracer_eq.TracerTerm" title="thetis.tracer_eq.TracerTerm"><code class="xref py py-class docutils literal notranslate"><span class="pre">TracerTerm</span></code></a></p>
<p>Horizontal diffusion term <span class="math notranslate nohighlight">\(-\nabla_h \cdot (\mu_h \nabla_h T)\)</span></p>
<p>Using the symmetric interior penalty method the weak form becomes</p>
<div class="math notranslate nohighlight">
\[\begin{split}\int_\Omega \nabla_h \cdot (\mu_h \nabla_h T) \phi dx
=&amp; -\int_\Omega \mu_h (\nabla_h \phi) \cdot (\nabla_h T) dx \\
&amp;+ \int_{\mathcal{I}_h\cup\mathcal{I}_v} \text{jump}(\phi \textbf{n}_h)
\cdot \text{avg}(\mu_h \nabla_h T) dS
+ \int_{\mathcal{I}_h\cup\mathcal{I}_v} \text{jump}(T \textbf{n}_h)
\cdot \text{avg}(\mu_h  \nabla \phi) dS \\
&amp;- \int_{\mathcal{I}_h\cup\mathcal{I}_v} \sigma \text{avg}(\mu_h) \text{jump}(T \textbf{n}_h) \cdot
    \text{jump}(\phi \textbf{n}_h) dS\end{split}\]</div>
<p>where <span class="math notranslate nohighlight">\(\sigma\)</span> is a penalty parameter, see Hillewaert (2013).</p>
<p>Hillewaert, Koen (2013). Development of the discontinuous Galerkin method
for high-resolution, large scale CFD and acoustics in industrial
geometries. PhD Thesis. Université catholique de Louvain.
<a class="reference external" href="https://dial.uclouvain.be/pr/boreal/object/boreal:128254/">https://dial.uclouvain.be/pr/boreal/object/boreal:128254/</a></p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>function_space</strong> – <code class="xref py py-class docutils literal notranslate"><span class="pre">FunctionSpace</span></code> where the solution belongs</p></li>
<li><p><strong>bathymetry</strong> (3D <code class="xref py py-class docutils literal notranslate"><span class="pre">Function</span></code> or <code class="xref py py-class docutils literal notranslate"><span class="pre">Constant</span></code>) – bathymetry of the domain</p></li>
<li><p><strong>v_elem_size</strong> – scalar <code class="xref py py-class docutils literal notranslate"><span class="pre">Function</span></code> that defines the vertical
element size</p></li>
<li><p><strong>h_elem_size</strong> – scalar <code class="xref py py-class docutils literal notranslate"><span class="pre">Function</span></code> that defines the horizontal
element size</p></li>
<li><p><strong>use_symmetric_surf_bnd</strong> (<a class="reference external" href="https://docs.python.org/2.7/library/functions.html#bool" title="(in Python v2.7)"><em>bool</em></a>) – If True, use symmetric surface boundary
condition in the horizontal advection term</p></li>
<li><p><strong>sipg_factor</strong> – <dl class="field-list simple">
<dt class="field-odd">class<span class="colon">:</span></dt>
<dd class="field-odd"><p><cite>Constant</cite> or :class: <cite>Function</cite> horizontal SIPG penalty scaling factor</p>
</dd>
</dl>
</p></li>
<li><p><strong>sipg_factor_vertical</strong> – <dl class="field-list simple">
<dt class="field-odd">class<span class="colon">:</span></dt>
<dd class="field-odd"><p><cite>Constant</cite> or :class: <cite>Function</cite> vertical SIPG penalty scaling factor</p>
</dd>
</dl>
</p></li>
</ul>
</dd>
</dl>
<dl class="py method">
<dt class="sig sig-object py" id="thetis.tracer_eq.HorizontalDiffusionTerm.residual">
<span class="sig-name descname"><span class="pre">residual</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">solution</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">solution_old</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fields</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fields_old</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">bnd_conditions</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/tracer_eq.html#HorizontalDiffusionTerm.residual"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#thetis.tracer_eq.HorizontalDiffusionTerm.residual" title="Link to this definition">¶</a></dt>
<dd><p>Returns an UFL form of the term.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>solution</strong> – solution <code class="xref py py-class docutils literal notranslate"><span class="pre">Function</span></code> of the corresponding equation</p></li>
<li><p><strong>solution_old</strong> – a time lagged solution <code class="xref py py-class docutils literal notranslate"><span class="pre">Function</span></code></p></li>
<li><p><strong>fields</strong> – a dictionary that provides all the remaining fields that the term depends on.
The keys of the dictionary should standard field names in <cite>field_metadata</cite></p></li>
<li><p><strong>fields_old</strong> – Time lagged dictionary of fields</p></li>
<li><p><strong>bnd_conditions</strong> – A dictionary describing boundary conditions.
E.g. {3: {‘elev_2d’: Constant(1.0)}} replaces elev_2d function by a constant on boundary ID 3.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="thetis.tracer_eq.SourceTerm">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">thetis.tracer_eq.</span></span><span class="sig-name descname"><span class="pre">SourceTerm</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">function_space</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">bathymetry</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">v_elem_size</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">h_elem_size</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">use_symmetric_surf_bnd</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">use_lax_friedrichs</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sipg_factor</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">Constant([1.],</span> <span class="pre">name='constant_10',</span> <span class="pre">count=10)</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sipg_factor_vertical</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">Constant([1.],</span> <span class="pre">name='constant_11',</span> <span class="pre">count=11)</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/tracer_eq.html#SourceTerm"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#thetis.tracer_eq.SourceTerm" title="Link to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#thetis.tracer_eq.TracerTerm" title="thetis.tracer_eq.TracerTerm"><code class="xref py py-class docutils literal notranslate"><span class="pre">TracerTerm</span></code></a></p>
<p>Generic source term</p>
<p>The weak form reads</p>
<div class="math notranslate nohighlight">
\[F_s = \int_\Omega \sigma \phi dx\]</div>
<p>where <span class="math notranslate nohighlight">\(\sigma\)</span> is a user defined scalar <code class="xref py py-class docutils literal notranslate"><span class="pre">Function</span></code>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>function_space</strong> – <code class="xref py py-class docutils literal notranslate"><span class="pre">FunctionSpace</span></code> where the solution belongs</p></li>
<li><p><strong>bathymetry</strong> (3D <code class="xref py py-class docutils literal notranslate"><span class="pre">Function</span></code> or <code class="xref py py-class docutils literal notranslate"><span class="pre">Constant</span></code>) – bathymetry of the domain</p></li>
<li><p><strong>v_elem_size</strong> – scalar <code class="xref py py-class docutils literal notranslate"><span class="pre">Function</span></code> that defines the vertical
element size</p></li>
<li><p><strong>h_elem_size</strong> – scalar <code class="xref py py-class docutils literal notranslate"><span class="pre">Function</span></code> that defines the horizontal
element size</p></li>
<li><p><strong>use_symmetric_surf_bnd</strong> (<a class="reference external" href="https://docs.python.org/2.7/library/functions.html#bool" title="(in Python v2.7)"><em>bool</em></a>) – If True, use symmetric surface boundary
condition in the horizontal advection term</p></li>
<li><p><strong>sipg_factor</strong> – <dl class="field-list simple">
<dt class="field-odd">class<span class="colon">:</span></dt>
<dd class="field-odd"><p><cite>Constant</cite> or :class: <cite>Function</cite> horizontal SIPG penalty scaling factor</p>
</dd>
</dl>
</p></li>
<li><p><strong>sipg_factor_vertical</strong> – <dl class="field-list simple">
<dt class="field-odd">class<span class="colon">:</span></dt>
<dd class="field-odd"><p><cite>Constant</cite> or :class: <cite>Function</cite> vertical SIPG penalty scaling factor</p>
</dd>
</dl>
</p></li>
</ul>
</dd>
</dl>
<dl class="py method">
<dt class="sig sig-object py" id="thetis.tracer_eq.SourceTerm.residual">
<span class="sig-name descname"><span class="pre">residual</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">solution</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">solution_old</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fields</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fields_old</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">bnd_conditions</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/tracer_eq.html#SourceTerm.residual"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#thetis.tracer_eq.SourceTerm.residual" title="Link to this definition">¶</a></dt>
<dd><p>Returns an UFL form of the term.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>solution</strong> – solution <code class="xref py py-class docutils literal notranslate"><span class="pre">Function</span></code> of the corresponding equation</p></li>
<li><p><strong>solution_old</strong> – a time lagged solution <code class="xref py py-class docutils literal notranslate"><span class="pre">Function</span></code></p></li>
<li><p><strong>fields</strong> – a dictionary that provides all the remaining fields that the term depends on.
The keys of the dictionary should standard field names in <cite>field_metadata</cite></p></li>
<li><p><strong>fields_old</strong> – Time lagged dictionary of fields</p></li>
<li><p><strong>bnd_conditions</strong> – A dictionary describing boundary conditions.
E.g. {3: {‘elev_2d’: Constant(1.0)}} replaces elev_2d function by a constant on boundary ID 3.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="thetis.tracer_eq.TracerEquation">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">thetis.tracer_eq.</span></span><span class="sig-name descname"><span class="pre">TracerEquation</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">function_space</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">bathymetry</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">v_elem_size</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">h_elem_size</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">use_symmetric_surf_bnd</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">use_lax_friedrichs</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sipg_factor</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">Constant([10.],</span> <span class="pre">name='constant_12',</span> <span class="pre">count=12)</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sipg_factor_vertical</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">Constant([10.],</span> <span class="pre">name='constant_13',</span> <span class="pre">count=13)</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/tracer_eq.html#TracerEquation"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#thetis.tracer_eq.TracerEquation" title="Link to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#thetis.equation.Equation" title="thetis.equation.Equation"><code class="xref py py-class docutils literal notranslate"><span class="pre">Equation</span></code></a></p>
<p>3D tracer advection-diffusion equation <a class="reference internal" href="#equation-tracer-eq">(15)</a> in conservative form</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>function_space</strong> – <code class="xref py py-class docutils literal notranslate"><span class="pre">FunctionSpace</span></code> where the solution belongs</p></li>
<li><p><strong>bathymetry</strong> (3D <code class="xref py py-class docutils literal notranslate"><span class="pre">Function</span></code> or <code class="xref py py-class docutils literal notranslate"><span class="pre">Constant</span></code>) – bathymetry of the domain</p></li>
<li><p><strong>v_elem_size</strong> – scalar <code class="xref py py-class docutils literal notranslate"><span class="pre">Function</span></code> that defines the vertical
element size</p></li>
<li><p><strong>h_elem_size</strong> – scalar <code class="xref py py-class docutils literal notranslate"><span class="pre">Function</span></code> that defines the horizontal
element size</p></li>
<li><p><strong>use_symmetric_surf_bnd</strong> (<a class="reference external" href="https://docs.python.org/2.7/library/functions.html#bool" title="(in Python v2.7)"><em>bool</em></a>) – If True, use symmetric surface boundary
condition in the horizontal advection term</p></li>
<li><p><strong>sipg_factor</strong> – <dl class="field-list simple">
<dt class="field-odd">class<span class="colon">:</span></dt>
<dd class="field-odd"><p><cite>Constant</cite> or :class: <cite>Function</cite> horizontal SIPG penalty scaling factor</p>
</dd>
</dl>
</p></li>
<li><p><strong>sipg_factor_vertical</strong> – <dl class="field-list simple">
<dt class="field-odd">class<span class="colon">:</span></dt>
<dd class="field-odd"><p><cite>Constant</cite> or :class: <cite>Function</cite> vertical SIPG penalty scaling factor</p>
</dd>
</dl>
</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="thetis.tracer_eq.TracerTerm">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">thetis.tracer_eq.</span></span><span class="sig-name descname"><span class="pre">TracerTerm</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">function_space</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">bathymetry</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">v_elem_size</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">h_elem_size</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">use_symmetric_surf_bnd</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">use_lax_friedrichs</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sipg_factor</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">Constant([1.],</span> <span class="pre">name='constant_10',</span> <span class="pre">count=10)</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sipg_factor_vertical</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">Constant([1.],</span> <span class="pre">name='constant_11',</span> <span class="pre">count=11)</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/tracer_eq.html#TracerTerm"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#thetis.tracer_eq.TracerTerm" title="Link to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#thetis.equation.Term" title="thetis.equation.Term"><code class="xref py py-class docutils literal notranslate"><span class="pre">Term</span></code></a></p>
<p>Generic tracer term that provides commonly used members and mapping for
boundary functions.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>function_space</strong> – <code class="xref py py-class docutils literal notranslate"><span class="pre">FunctionSpace</span></code> where the solution belongs</p></li>
<li><p><strong>bathymetry</strong> (3D <code class="xref py py-class docutils literal notranslate"><span class="pre">Function</span></code> or <code class="xref py py-class docutils literal notranslate"><span class="pre">Constant</span></code>) – bathymetry of the domain</p></li>
<li><p><strong>v_elem_size</strong> – scalar <code class="xref py py-class docutils literal notranslate"><span class="pre">Function</span></code> that defines the vertical
element size</p></li>
<li><p><strong>h_elem_size</strong> – scalar <code class="xref py py-class docutils literal notranslate"><span class="pre">Function</span></code> that defines the horizontal
element size</p></li>
<li><p><strong>use_symmetric_surf_bnd</strong> (<a class="reference external" href="https://docs.python.org/2.7/library/functions.html#bool" title="(in Python v2.7)"><em>bool</em></a>) – If True, use symmetric surface boundary
condition in the horizontal advection term</p></li>
<li><p><strong>sipg_factor</strong> – <dl class="field-list simple">
<dt class="field-odd">class<span class="colon">:</span></dt>
<dd class="field-odd"><p><cite>Constant</cite> or :class: <cite>Function</cite> horizontal SIPG penalty scaling factor</p>
</dd>
</dl>
</p></li>
<li><p><strong>sipg_factor_vertical</strong> – <dl class="field-list simple">
<dt class="field-odd">class<span class="colon">:</span></dt>
<dd class="field-odd"><p><cite>Constant</cite> or :class: <cite>Function</cite> vertical SIPG penalty scaling factor</p>
</dd>
</dl>
</p></li>
</ul>
</dd>
</dl>
<dl class="py method">
<dt class="sig sig-object py" id="thetis.tracer_eq.TracerTerm.get_bnd_functions">
<span class="sig-name descname"><span class="pre">get_bnd_functions</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">c_in</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">uv_in</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">elev_in</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">bnd_id</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">bnd_conditions</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/tracer_eq.html#TracerTerm.get_bnd_functions"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#thetis.tracer_eq.TracerTerm.get_bnd_functions" title="Link to this definition">¶</a></dt>
<dd><p>Returns external values of tracer and uv for all supported
boundary conditions.</p>
<p>Volume flux (flux) and normal velocity (un) are defined positive out of
the domain.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>c_in</strong> – Internal value of tracer</p></li>
<li><p><strong>uv_in</strong> – Internal value of horizontal velocity</p></li>
<li><p><strong>elev_in</strong> – Internal value of elevation</p></li>
<li><p><strong>bnd_id</strong> (<a class="reference external" href="https://docs.python.org/2.7/library/functions.html#int" title="(in Python v2.7)"><em>int</em></a>) – boundary id</p></li>
<li><p><strong>bnd_conditions</strong> – dict of boundary conditions:
<code class="docutils literal notranslate"><span class="pre">{bnd_id:</span> <span class="pre">{field:</span> <span class="pre">value,</span> <span class="pre">...},</span> <span class="pre">...}</span></code></p></li>
</ul>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="thetis.tracer_eq.VerticalAdvectionTerm">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">thetis.tracer_eq.</span></span><span class="sig-name descname"><span class="pre">VerticalAdvectionTerm</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">function_space</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">bathymetry</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">v_elem_size</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">h_elem_size</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">use_symmetric_surf_bnd</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">use_lax_friedrichs</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sipg_factor</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">Constant([1.],</span> <span class="pre">name='constant_10',</span> <span class="pre">count=10)</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sipg_factor_vertical</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">Constant([1.],</span> <span class="pre">name='constant_11',</span> <span class="pre">count=11)</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/tracer_eq.html#VerticalAdvectionTerm"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#thetis.tracer_eq.VerticalAdvectionTerm" title="Link to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#thetis.tracer_eq.TracerTerm" title="thetis.tracer_eq.TracerTerm"><code class="xref py py-class docutils literal notranslate"><span class="pre">TracerTerm</span></code></a></p>
<p>Vertical advection term <span class="math notranslate nohighlight">\(\partial (w T)/(\partial z)\)</span></p>
<p>The weak form reads</p>
<div class="math notranslate nohighlight">
\[\int_\Omega \frac{\partial (w T)}{\partial z} \phi dx
= - \int_\Omega T w \frac{\partial \phi}{\partial z} dx
+ \int_{\mathcal{I}_v} T^{\text{up}} \text{avg}(w) \text{jump}(\phi n_z) dS\]</div>
<p>where the right hand side has been integrated by parts;
<span class="math notranslate nohighlight">\(\mathcal{I}_v\)</span> denotes the set of vertical facets,
<span class="math notranslate nohighlight">\(n_z\)</span> is the vertical projection of the unit normal vector,
<span class="math notranslate nohighlight">\(T^{\text{up}}\)</span> is the
upwind value, and <span class="math notranslate nohighlight">\(\text{jump}\)</span> and <span class="math notranslate nohighlight">\(\text{avg}\)</span> denote the
jump and average operators across the interface.</p>
<p>In the case of ALE moving mesh we substitute <span class="math notranslate nohighlight">\(w\)</span> with <span class="math notranslate nohighlight">\(w - w_m\)</span>,
<span class="math notranslate nohighlight">\(w_m\)</span> being the mesh velocity.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>function_space</strong> – <code class="xref py py-class docutils literal notranslate"><span class="pre">FunctionSpace</span></code> where the solution belongs</p></li>
<li><p><strong>bathymetry</strong> (3D <code class="xref py py-class docutils literal notranslate"><span class="pre">Function</span></code> or <code class="xref py py-class docutils literal notranslate"><span class="pre">Constant</span></code>) – bathymetry of the domain</p></li>
<li><p><strong>v_elem_size</strong> – scalar <code class="xref py py-class docutils literal notranslate"><span class="pre">Function</span></code> that defines the vertical
element size</p></li>
<li><p><strong>h_elem_size</strong> – scalar <code class="xref py py-class docutils literal notranslate"><span class="pre">Function</span></code> that defines the horizontal
element size</p></li>
<li><p><strong>use_symmetric_surf_bnd</strong> (<a class="reference external" href="https://docs.python.org/2.7/library/functions.html#bool" title="(in Python v2.7)"><em>bool</em></a>) – If True, use symmetric surface boundary
condition in the horizontal advection term</p></li>
<li><p><strong>sipg_factor</strong> – <dl class="field-list simple">
<dt class="field-odd">class<span class="colon">:</span></dt>
<dd class="field-odd"><p><cite>Constant</cite> or :class: <cite>Function</cite> horizontal SIPG penalty scaling factor</p>
</dd>
</dl>
</p></li>
<li><p><strong>sipg_factor_vertical</strong> – <dl class="field-list simple">
<dt class="field-odd">class<span class="colon">:</span></dt>
<dd class="field-odd"><p><cite>Constant</cite> or :class: <cite>Function</cite> vertical SIPG penalty scaling factor</p>
</dd>
</dl>
</p></li>
</ul>
</dd>
</dl>
<dl class="py method">
<dt class="sig sig-object py" id="thetis.tracer_eq.VerticalAdvectionTerm.residual">
<span class="sig-name descname"><span class="pre">residual</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">solution</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">solution_old</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fields</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fields_old</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">bnd_conditions</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/tracer_eq.html#VerticalAdvectionTerm.residual"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#thetis.tracer_eq.VerticalAdvectionTerm.residual" title="Link to this definition">¶</a></dt>
<dd><p>Returns an UFL form of the term.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>solution</strong> – solution <code class="xref py py-class docutils literal notranslate"><span class="pre">Function</span></code> of the corresponding equation</p></li>
<li><p><strong>solution_old</strong> – a time lagged solution <code class="xref py py-class docutils literal notranslate"><span class="pre">Function</span></code></p></li>
<li><p><strong>fields</strong> – a dictionary that provides all the remaining fields that the term depends on.
The keys of the dictionary should standard field names in <cite>field_metadata</cite></p></li>
<li><p><strong>fields_old</strong> – Time lagged dictionary of fields</p></li>
<li><p><strong>bnd_conditions</strong> – A dictionary describing boundary conditions.
E.g. {3: {‘elev_2d’: Constant(1.0)}} replaces elev_2d function by a constant on boundary ID 3.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="thetis.tracer_eq.VerticalDiffusionTerm">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">thetis.tracer_eq.</span></span><span class="sig-name descname"><span class="pre">VerticalDiffusionTerm</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">function_space</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">bathymetry</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">v_elem_size</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">h_elem_size</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">use_symmetric_surf_bnd</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">use_lax_friedrichs</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sipg_factor</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">Constant([1.],</span> <span class="pre">name='constant_10',</span> <span class="pre">count=10)</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sipg_factor_vertical</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">Constant([1.],</span> <span class="pre">name='constant_11',</span> <span class="pre">count=11)</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/tracer_eq.html#VerticalDiffusionTerm"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#thetis.tracer_eq.VerticalDiffusionTerm" title="Link to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#thetis.tracer_eq.TracerTerm" title="thetis.tracer_eq.TracerTerm"><code class="xref py py-class docutils literal notranslate"><span class="pre">TracerTerm</span></code></a></p>
<p>Vertical diffusion term <span class="math notranslate nohighlight">\(-\frac{\partial}{\partial z} \Big(\mu \frac{T}{\partial z}\Big)\)</span></p>
<p>Using the symmetric interior penalty method the weak form becomes</p>
<div class="math notranslate nohighlight">
\[\begin{split}\int_\Omega \frac{\partial}{\partial z} \Big(\mu \frac{T}{\partial z}\Big) \phi dx
=&amp; -\int_\Omega \mu \frac{\partial T}{\partial z} \frac{\partial \phi}{\partial z} dz \\
&amp;+ \int_{\mathcal{I}_{h}} \text{jump}(\phi n_z) \text{avg}\Big(\mu \frac{\partial T}{\partial z}\Big) dS
+ \int_{\mathcal{I}_{h}} \text{jump}(T n_z) \text{avg}\Big(\mu \frac{\partial \phi}{\partial z}\Big) dS \\
&amp;- \int_{\mathcal{I}_{h}} \sigma \text{avg}(\mu) \text{jump}(T n_z) \cdot
    \text{jump}(\phi n_z) dS\end{split}\]</div>
<p>where <span class="math notranslate nohighlight">\(\sigma\)</span> is a penalty parameter, see Hillewaert (2013).</p>
<p>Hillewaert, Koen (2013). Development of the discontinuous Galerkin method
for high-resolution, large scale CFD and acoustics in industrial
geometries. PhD Thesis. Université catholique de Louvain.
<a class="reference external" href="https://dial.uclouvain.be/pr/boreal/object/boreal:128254/">https://dial.uclouvain.be/pr/boreal/object/boreal:128254/</a></p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>function_space</strong> – <code class="xref py py-class docutils literal notranslate"><span class="pre">FunctionSpace</span></code> where the solution belongs</p></li>
<li><p><strong>bathymetry</strong> (3D <code class="xref py py-class docutils literal notranslate"><span class="pre">Function</span></code> or <code class="xref py py-class docutils literal notranslate"><span class="pre">Constant</span></code>) – bathymetry of the domain</p></li>
<li><p><strong>v_elem_size</strong> – scalar <code class="xref py py-class docutils literal notranslate"><span class="pre">Function</span></code> that defines the vertical
element size</p></li>
<li><p><strong>h_elem_size</strong> – scalar <code class="xref py py-class docutils literal notranslate"><span class="pre">Function</span></code> that defines the horizontal
element size</p></li>
<li><p><strong>use_symmetric_surf_bnd</strong> (<a class="reference external" href="https://docs.python.org/2.7/library/functions.html#bool" title="(in Python v2.7)"><em>bool</em></a>) – If True, use symmetric surface boundary
condition in the horizontal advection term</p></li>
<li><p><strong>sipg_factor</strong> – <dl class="field-list simple">
<dt class="field-odd">class<span class="colon">:</span></dt>
<dd class="field-odd"><p><cite>Constant</cite> or :class: <cite>Function</cite> horizontal SIPG penalty scaling factor</p>
</dd>
</dl>
</p></li>
<li><p><strong>sipg_factor_vertical</strong> – <dl class="field-list simple">
<dt class="field-odd">class<span class="colon">:</span></dt>
<dd class="field-odd"><p><cite>Constant</cite> or :class: <cite>Function</cite> vertical SIPG penalty scaling factor</p>
</dd>
</dl>
</p></li>
</ul>
</dd>
</dl>
<dl class="py method">
<dt class="sig sig-object py" id="thetis.tracer_eq.VerticalDiffusionTerm.residual">
<span class="sig-name descname"><span class="pre">residual</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">solution</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">solution_old</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fields</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fields_old</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">bnd_conditions</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/tracer_eq.html#VerticalDiffusionTerm.residual"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#thetis.tracer_eq.VerticalDiffusionTerm.residual" title="Link to this definition">¶</a></dt>
<dd><p>Returns an UFL form of the term.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>solution</strong> – solution <code class="xref py py-class docutils literal notranslate"><span class="pre">Function</span></code> of the corresponding equation</p></li>
<li><p><strong>solution_old</strong> – a time lagged solution <code class="xref py py-class docutils literal notranslate"><span class="pre">Function</span></code></p></li>
<li><p><strong>fields</strong> – a dictionary that provides all the remaining fields that the term depends on.
The keys of the dictionary should standard field names in <cite>field_metadata</cite></p></li>
<li><p><strong>fields_old</strong> – Time lagged dictionary of fields</p></li>
<li><p><strong>bnd_conditions</strong> – A dictionary describing boundary conditions.
E.g. {3: {‘elev_2d’: Constant(1.0)}} replaces elev_2d function by a constant on boundary ID 3.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

</dd></dl>

</section>
<section id="module-thetis.tracer_eq_2d">
<span id="thetis-tracer-eq-2d-module"></span><h2>thetis.tracer_eq_2d module<a class="headerlink" href="#module-thetis.tracer_eq_2d" title="Link to this heading">¶</a></h2>
<p>2D advection diffusion equation for tracers.</p>
<p>The advection-diffusion equation of tracer <span class="math notranslate nohighlight">\(T\)</span> in non-conservative form reads</p>
<div class="math notranslate nohighlight" id="equation-tracer-eq-2d">
<span class="eqno">(16)<a class="headerlink" href="#equation-tracer-eq-2d" title="Link to this equation">¶</a></span>\[\frac{\partial T}{\partial t}
+ \nabla_h \cdot (\textbf{u} T)
= \nabla_h \cdot (\mu_h \nabla_h T)\]</div>
<p>where <span class="math notranslate nohighlight">\(\nabla_h\)</span> denotes horizontal gradient, <span class="math notranslate nohighlight">\(\textbf{u}\)</span> are the horizontal
velocities, and
<span class="math notranslate nohighlight">\(\mu_h\)</span> denotes horizontal diffusivity.</p>
<p>The advection-diffusion equation of depth-integrated tracer <span class="math notranslate nohighlight">\(q=HT\)</span> in conservative form reads</p>
<div class="math notranslate nohighlight" id="equation-cons-tracer-eq-2d">
<span class="eqno">(17)<a class="headerlink" href="#equation-cons-tracer-eq-2d" title="Link to this equation">¶</a></span>\[\frac{\partial q}{\partial t}
+ \nabla_h \cdot (\textbf{u} q)
= \nabla_h \cdot (\mu_h \nabla_h q)\]</div>
<p>where <span class="math notranslate nohighlight">\(\nabla_h\)</span> denotes horizontal gradient, <span class="math notranslate nohighlight">\(\textbf{u}\)</span> are the horizontal
velocities, and
<span class="math notranslate nohighlight">\(\mu_h\)</span> denotes horizontal diffusivity.</p>
<dl class="py class">
<dt class="sig sig-object py" id="thetis.tracer_eq_2d.ConservativeHorizontalAdvectionTerm">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">thetis.tracer_eq_2d.</span></span><span class="sig-name descname"><span class="pre">ConservativeHorizontalAdvectionTerm</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">index</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">label</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">function_space</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">depth</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">options</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">test_function</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">trial_function</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/tracer_eq_2d.html#ConservativeHorizontalAdvectionTerm"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#thetis.tracer_eq_2d.ConservativeHorizontalAdvectionTerm" title="Link to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#thetis.tracer_eq_2d.ConservativeTracerTerm" title="thetis.tracer_eq_2d.ConservativeTracerTerm"><code class="xref py py-class docutils literal notranslate"><span class="pre">ConservativeTracerTerm</span></code></a></p>
<p>Advection of tracer term, <span class="math notranslate nohighlight">\(\nabla \cdot \bar{\textbf{u}} \nabla q\)</span></p>
<p>The weak form is</p>
<div class="math notranslate nohighlight">
\[\int_\Omega \boldsymbol{\psi} \nabla\cdot \bar{\textbf{u}} \nabla q  dx
= - \int_\Omega \left(\nabla_h \boldsymbol{\psi})\right) \cdot \bar{\textbf{u}} \cdot q dx
+ \int_\Gamma \text{avg}(q\bar{\textbf{u}}\cdot\textbf{n}) \cdot \text{jump}(\boldsymbol{\psi}) dS\]</div>
<p>where the right hand side has been integrated by parts;
<span class="math notranslate nohighlight">\(\textbf{n}\)</span> is the unit normal of
the element interfaces, and <span class="math notranslate nohighlight">\(\text{jump}\)</span> and <span class="math notranslate nohighlight">\(\text{avg}\)</span> denote the
jump and average operators across the interface.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>index</strong> – index for this tracer component within the vector</p></li>
<li><p><strong>label</strong> – label for this tracer component</p></li>
<li><p><strong>function_space</strong> – <code class="xref py py-class docutils literal notranslate"><span class="pre">FunctionSpace</span></code> where the solution belongs</p></li>
<li><p><strong>depth</strong> – <dl class="field-list simple">
<dt class="field-odd">class<span class="colon">:</span></dt>
<dd class="field-odd"><p><cite>DepthExpression</cite> containing depth info</p>
</dd>
</dl>
</p></li>
<li><p><strong>options</strong> – :class`ModelOptions2d` containing parameters</p></li>
<li><p><strong>test_function</strong> – custom <code class="xref py py-class docutils literal notranslate"><span class="pre">TestFunction</span></code>.</p></li>
<li><p><strong>trial_function</strong> – custom <code class="xref py py-class docutils literal notranslate"><span class="pre">TrialFunction</span></code>.</p></li>
</ul>
</dd>
</dl>
<dl class="py method">
<dt class="sig sig-object py" id="thetis.tracer_eq_2d.ConservativeHorizontalAdvectionTerm.residual">
<span class="sig-name descname"><span class="pre">residual</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">solution</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">solution_old</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fields</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fields_old</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">bnd_conditions</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/tracer_eq_2d.html#ConservativeHorizontalAdvectionTerm.residual"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#thetis.tracer_eq_2d.ConservativeHorizontalAdvectionTerm.residual" title="Link to this definition">¶</a></dt>
<dd><p>Returns an UFL form of the term.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>solution</strong> – solution <code class="xref py py-class docutils literal notranslate"><span class="pre">Function</span></code> of the corresponding equation</p></li>
<li><p><strong>solution_old</strong> – a time lagged solution <code class="xref py py-class docutils literal notranslate"><span class="pre">Function</span></code></p></li>
<li><p><strong>fields</strong> – a dictionary that provides all the remaining fields that the term depends on.
The keys of the dictionary should standard field names in <cite>field_metadata</cite></p></li>
<li><p><strong>fields_old</strong> – Time lagged dictionary of fields</p></li>
<li><p><strong>bnd_conditions</strong> – A dictionary describing boundary conditions.
E.g. {3: {‘elev_2d’: Constant(1.0)}} replaces elev_2d function by a constant on boundary ID 3.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="thetis.tracer_eq_2d.ConservativeHorizontalDiffusionTerm">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">thetis.tracer_eq_2d.</span></span><span class="sig-name descname"><span class="pre">ConservativeHorizontalDiffusionTerm</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">index</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">label</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">function_space</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">depth</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">options</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">test_function</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">trial_function</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/tracer_eq_2d.html#ConservativeHorizontalDiffusionTerm"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#thetis.tracer_eq_2d.ConservativeHorizontalDiffusionTerm" title="Link to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#thetis.tracer_eq_2d.ConservativeTracerTerm" title="thetis.tracer_eq_2d.ConservativeTracerTerm"><code class="xref py py-class docutils literal notranslate"><span class="pre">ConservativeTracerTerm</span></code></a>, <a class="reference internal" href="#thetis.tracer_eq_2d.HorizontalDiffusionTerm" title="thetis.tracer_eq_2d.HorizontalDiffusionTerm"><code class="xref py py-class docutils literal notranslate"><span class="pre">HorizontalDiffusionTerm</span></code></a></p>
<p>Horizontal diffusion term <span class="math notranslate nohighlight">\(-\nabla_h \cdot (\mu_h \nabla_h q)\)</span></p>
<p>Using the symmetric interior penalty method the weak form becomes</p>
<div class="math notranslate nohighlight">
\[\begin{split}-\int_\Omega \nabla_h \cdot (\mu_h \nabla_h q) \phi dx
=&amp; \int_\Omega \mu_h (\nabla_h \phi) \cdot (\nabla_h q) dx \\
&amp;- \int_{\mathcal{I}_h\cup\mathcal{I}_v} \text{jump}(\phi \textbf{n}_h)
\cdot \text{avg}(\mu_h \nabla_h q) dS
- \int_{\mathcal{I}_h\cup\mathcal{I}_v} \text{jump}(q \textbf{n}_h)
\cdot \text{avg}(\mu_h  \nabla \phi) dS \\
&amp;+ \int_{\mathcal{I}_h\cup\mathcal{I}_v} \sigma \text{avg}(\mu_h) \text{jump}(q \textbf{n}_h) \cdot
    \text{jump}(\phi \textbf{n}_h) dS \\
&amp;- \int_\Gamma \mu_h (\nabla_h \phi) \cdot \textbf{n}_h ds\end{split}\]</div>
<p>where <span class="math notranslate nohighlight">\(\sigma\)</span> is a penalty parameter, see Hillewaert (2013).</p>
<p>Hillewaert, Koen (2013). Development of the discontinuous Galerkin method
for high-resolution, large scale CFD and acoustics in industrial
geometries. PhD Thesis. Université catholique de Louvain.
<a class="reference external" href="https://dial.uclouvain.be/pr/boreal/object/boreal:128254/">https://dial.uclouvain.be/pr/boreal/object/boreal:128254/</a></p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>index</strong> – index for this tracer component within the vector</p></li>
<li><p><strong>label</strong> – label for this tracer component</p></li>
<li><p><strong>function_space</strong> – <code class="xref py py-class docutils literal notranslate"><span class="pre">FunctionSpace</span></code> where the solution belongs</p></li>
<li><p><strong>depth</strong> – <dl class="field-list simple">
<dt class="field-odd">class<span class="colon">:</span></dt>
<dd class="field-odd"><p><cite>DepthExpression</cite> containing depth info</p>
</dd>
</dl>
</p></li>
<li><p><strong>options</strong> – :class`ModelOptions2d` containing parameters</p></li>
<li><p><strong>test_function</strong> – custom <code class="xref py py-class docutils literal notranslate"><span class="pre">TestFunction</span></code>.</p></li>
<li><p><strong>trial_function</strong> – custom <code class="xref py py-class docutils literal notranslate"><span class="pre">TrialFunction</span></code>.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="thetis.tracer_eq_2d.ConservativeSourceTerm">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">thetis.tracer_eq_2d.</span></span><span class="sig-name descname"><span class="pre">ConservativeSourceTerm</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">index</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">label</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">function_space</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">depth</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">options</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">test_function</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">trial_function</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/tracer_eq_2d.html#ConservativeSourceTerm"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#thetis.tracer_eq_2d.ConservativeSourceTerm" title="Link to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#thetis.tracer_eq_2d.ConservativeTracerTerm" title="thetis.tracer_eq_2d.ConservativeTracerTerm"><code class="xref py py-class docutils literal notranslate"><span class="pre">ConservativeTracerTerm</span></code></a></p>
<p>Generic source term</p>
<p>The weak form reads</p>
<div class="math notranslate nohighlight">
\[F_s = \int_\Omega \sigma \phi dx\]</div>
<p>where <span class="math notranslate nohighlight">\(\sigma\)</span> is a user defined scalar <code class="xref py py-class docutils literal notranslate"><span class="pre">Function</span></code>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>index</strong> – index for this tracer component within the vector</p></li>
<li><p><strong>label</strong> – label for this tracer component</p></li>
<li><p><strong>function_space</strong> – <code class="xref py py-class docutils literal notranslate"><span class="pre">FunctionSpace</span></code> where the solution belongs</p></li>
<li><p><strong>depth</strong> – <dl class="field-list simple">
<dt class="field-odd">class<span class="colon">:</span></dt>
<dd class="field-odd"><p><cite>DepthExpression</cite> containing depth info</p>
</dd>
</dl>
</p></li>
<li><p><strong>options</strong> – :class`ModelOptions2d` containing parameters</p></li>
<li><p><strong>test_function</strong> – custom <code class="xref py py-class docutils literal notranslate"><span class="pre">TestFunction</span></code>.</p></li>
<li><p><strong>trial_function</strong> – custom <code class="xref py py-class docutils literal notranslate"><span class="pre">TrialFunction</span></code>.</p></li>
</ul>
</dd>
</dl>
<dl class="py method">
<dt class="sig sig-object py" id="thetis.tracer_eq_2d.ConservativeSourceTerm.residual">
<span class="sig-name descname"><span class="pre">residual</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">solution</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">solution_old</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fields</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fields_old</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">bnd_conditions</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/tracer_eq_2d.html#ConservativeSourceTerm.residual"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#thetis.tracer_eq_2d.ConservativeSourceTerm.residual" title="Link to this definition">¶</a></dt>
<dd><p>Returns an UFL form of the term.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>solution</strong> – solution <code class="xref py py-class docutils literal notranslate"><span class="pre">Function</span></code> of the corresponding equation</p></li>
<li><p><strong>solution_old</strong> – a time lagged solution <code class="xref py py-class docutils literal notranslate"><span class="pre">Function</span></code></p></li>
<li><p><strong>fields</strong> – a dictionary that provides all the remaining fields that the term depends on.
The keys of the dictionary should standard field names in <cite>field_metadata</cite></p></li>
<li><p><strong>fields_old</strong> – Time lagged dictionary of fields</p></li>
<li><p><strong>bnd_conditions</strong> – A dictionary describing boundary conditions.
E.g. {3: {‘elev_2d’: Constant(1.0)}} replaces elev_2d function by a constant on boundary ID 3.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="thetis.tracer_eq_2d.ConservativeTracerTerm">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">thetis.tracer_eq_2d.</span></span><span class="sig-name descname"><span class="pre">ConservativeTracerTerm</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">index</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">label</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">function_space</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">depth</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">options</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">test_function</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">trial_function</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/tracer_eq_2d.html#ConservativeTracerTerm"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#thetis.tracer_eq_2d.ConservativeTracerTerm" title="Link to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#thetis.tracer_eq_2d.TracerTerm" title="thetis.tracer_eq_2d.TracerTerm"><code class="xref py py-class docutils literal notranslate"><span class="pre">TracerTerm</span></code></a></p>
<p>Generic depth-integrated tracer term that provides commonly used members and mapping for
boundary functions.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>index</strong> – index for this tracer component within the vector</p></li>
<li><p><strong>label</strong> – label for this tracer component</p></li>
<li><p><strong>function_space</strong> – <code class="xref py py-class docutils literal notranslate"><span class="pre">FunctionSpace</span></code> where the solution belongs</p></li>
<li><p><strong>depth</strong> – <dl class="field-list simple">
<dt class="field-odd">class<span class="colon">:</span></dt>
<dd class="field-odd"><p><cite>DepthExpression</cite> containing depth info</p>
</dd>
</dl>
</p></li>
<li><p><strong>options</strong> – :class`ModelOptions2d` containing parameters</p></li>
<li><p><strong>test_function</strong> – custom <code class="xref py py-class docutils literal notranslate"><span class="pre">TestFunction</span></code>.</p></li>
<li><p><strong>trial_function</strong> – custom <code class="xref py py-class docutils literal notranslate"><span class="pre">TrialFunction</span></code>.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="thetis.tracer_eq_2d.HorizontalAdvectionTerm">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">thetis.tracer_eq_2d.</span></span><span class="sig-name descname"><span class="pre">HorizontalAdvectionTerm</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">index</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">label</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">function_space</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">depth</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">options</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">test_function</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">trial_function</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/tracer_eq_2d.html#HorizontalAdvectionTerm"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#thetis.tracer_eq_2d.HorizontalAdvectionTerm" title="Link to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#thetis.tracer_eq_2d.TracerTerm" title="thetis.tracer_eq_2d.TracerTerm"><code class="xref py py-class docutils literal notranslate"><span class="pre">TracerTerm</span></code></a></p>
<p>Advection of tracer term, <span class="math notranslate nohighlight">\(\bar{\textbf{u}} \cdot \nabla T\)</span></p>
<p>The weak form is</p>
<div class="math notranslate nohighlight">
\[\int_\Omega \bar{\textbf{u}} \cdot \boldsymbol{\psi} \cdot \nabla T  dx
= - \int_\Omega \nabla_h \cdot (\bar{\textbf{u}} \boldsymbol{\psi}) \cdot T dx
+ \int_\Gamma \text{avg}(T) \cdot \text{jump}(\boldsymbol{\psi}
(\bar{\textbf{u}}\cdot\textbf{n})) dS\]</div>
<p>where the right hand side has been integrated by parts;
<span class="math notranslate nohighlight">\(\textbf{n}\)</span> is the unit normal of
the element interfaces, and <span class="math notranslate nohighlight">\(\text{jump}\)</span> and <span class="math notranslate nohighlight">\(\text{avg}\)</span> denote the
jump and average operators across the interface.</p>
<p>For the continuous Galerkin method we use</p>
<div class="math notranslate nohighlight">
\[\int_\Omega \bar{\textbf{u}} \cdot \boldsymbol{\psi} \cdot \nabla T  dx
= - \int_\Omega \nabla_h \cdot (\bar{\textbf{u}} \boldsymbol{\psi}) \cdot T dx.\]</div>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>index</strong> – index for this tracer component within the vector</p></li>
<li><p><strong>label</strong> – label for this tracer component</p></li>
<li><p><strong>function_space</strong> – <code class="xref py py-class docutils literal notranslate"><span class="pre">FunctionSpace</span></code> where the solution belongs</p></li>
<li><p><strong>depth</strong> – <code class="xref py py-class docutils literal notranslate"><span class="pre">DepthExpression</span></code> containing depth info</p></li>
<li><p><strong>options</strong> – :class`ModelOptions2d` containing parameters</p></li>
<li><p><strong>test_function</strong> – custom <code class="xref py py-class docutils literal notranslate"><span class="pre">TestFunction</span></code></p></li>
<li><p><strong>trial_function</strong> – custom <code class="xref py py-class docutils literal notranslate"><span class="pre">TrialFunction</span></code></p></li>
</ul>
</dd>
</dl>
<dl class="py method">
<dt class="sig sig-object py" id="thetis.tracer_eq_2d.HorizontalAdvectionTerm.residual">
<span class="sig-name descname"><span class="pre">residual</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">solution</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">solution_old</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fields</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fields_old</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">bnd_conditions</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/tracer_eq_2d.html#HorizontalAdvectionTerm.residual"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#thetis.tracer_eq_2d.HorizontalAdvectionTerm.residual" title="Link to this definition">¶</a></dt>
<dd><p>Returns an UFL form of the term.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>solution</strong> – solution <code class="xref py py-class docutils literal notranslate"><span class="pre">Function</span></code> of the corresponding equation</p></li>
<li><p><strong>solution_old</strong> – a time lagged solution <code class="xref py py-class docutils literal notranslate"><span class="pre">Function</span></code></p></li>
<li><p><strong>fields</strong> – a dictionary that provides all the remaining fields that the term depends on.
The keys of the dictionary should standard field names in <cite>field_metadata</cite></p></li>
<li><p><strong>fields_old</strong> – Time lagged dictionary of fields</p></li>
<li><p><strong>bnd_conditions</strong> – A dictionary describing boundary conditions.
E.g. {3: {‘elev_2d’: Constant(1.0)}} replaces elev_2d function by a constant on boundary ID 3.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="thetis.tracer_eq_2d.HorizontalDiffusionTerm">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">thetis.tracer_eq_2d.</span></span><span class="sig-name descname"><span class="pre">HorizontalDiffusionTerm</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">index</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">label</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">function_space</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">depth</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">options</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">test_function</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">trial_function</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/tracer_eq_2d.html#HorizontalDiffusionTerm"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#thetis.tracer_eq_2d.HorizontalDiffusionTerm" title="Link to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#thetis.tracer_eq_2d.TracerTerm" title="thetis.tracer_eq_2d.TracerTerm"><code class="xref py py-class docutils literal notranslate"><span class="pre">TracerTerm</span></code></a></p>
<p>Horizontal diffusion term <span class="math notranslate nohighlight">\(-\nabla_h \cdot (\mu_h \nabla_h T)\)</span></p>
<p>Using the symmetric interior penalty method the weak form becomes</p>
<div class="math notranslate nohighlight">
\[\begin{split}-\int_\Omega \nabla_h \cdot (\mu_h \nabla_h T) \phi dx
=&amp; \int_\Omega \mu_h (\nabla_h \phi) \cdot (\nabla_h T) dx \\
&amp;- \int_{\mathcal{I}_h\cup\mathcal{I}_v} \text{jump}(\phi \textbf{n}_h)
\cdot \text{avg}(\mu_h \nabla_h T) dS
- \int_{\mathcal{I}_h\cup\mathcal{I}_v} \text{jump}(T \textbf{n}_h)
\cdot \text{avg}(\mu_h  \nabla \phi) dS \\
&amp;+ \int_{\mathcal{I}_h\cup\mathcal{I}_v} \sigma \text{avg}(\mu_h) \text{jump}(T \textbf{n}_h)
\cdot \text{jump}(\phi \textbf{n}_h) dS \\
&amp;- \int_\Gamma \mu_h (\nabla_h \phi) \cdot \textbf{n}_h ds\end{split}\]</div>
<p>where <span class="math notranslate nohighlight">\(\sigma\)</span> is a penalty parameter, see Hillewaert (2013).</p>
<p>For the continuous Galerkin method we use</p>
<div class="math notranslate nohighlight">
\[-\int_\Omega \nabla_h \cdot (\mu_h \nabla_h T) \phi dx
= \int_\Omega \mu_h (\nabla_h \phi) \cdot (\nabla_h T) dx.\]</div>
<p>Hillewaert, Koen (2013). Development of the discontinuous Galerkin method
for high-resolution, large scale CFD and acoustics in industrial
geometries. PhD Thesis. Université catholique de Louvain.
<a class="reference external" href="https://dial.uclouvain.be/pr/boreal/object/boreal:128254/">https://dial.uclouvain.be/pr/boreal/object/boreal:128254/</a></p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>index</strong> – index for this tracer component within the vector</p></li>
<li><p><strong>label</strong> – label for this tracer component</p></li>
<li><p><strong>function_space</strong> – <code class="xref py py-class docutils literal notranslate"><span class="pre">FunctionSpace</span></code> where the solution belongs</p></li>
<li><p><strong>depth</strong> – <code class="xref py py-class docutils literal notranslate"><span class="pre">DepthExpression</span></code> containing depth info</p></li>
<li><p><strong>options</strong> – :class`ModelOptions2d` containing parameters</p></li>
<li><p><strong>test_function</strong> – custom <code class="xref py py-class docutils literal notranslate"><span class="pre">TestFunction</span></code></p></li>
<li><p><strong>trial_function</strong> – custom <code class="xref py py-class docutils literal notranslate"><span class="pre">TrialFunction</span></code></p></li>
</ul>
</dd>
</dl>
<dl class="py method">
<dt class="sig sig-object py" id="thetis.tracer_eq_2d.HorizontalDiffusionTerm.residual">
<span class="sig-name descname"><span class="pre">residual</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">solution</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">solution_old</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fields</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fields_old</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">bnd_conditions</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/tracer_eq_2d.html#HorizontalDiffusionTerm.residual"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#thetis.tracer_eq_2d.HorizontalDiffusionTerm.residual" title="Link to this definition">¶</a></dt>
<dd><p>Returns an UFL form of the term.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>solution</strong> – solution <code class="xref py py-class docutils literal notranslate"><span class="pre">Function</span></code> of the corresponding equation</p></li>
<li><p><strong>solution_old</strong> – a time lagged solution <code class="xref py py-class docutils literal notranslate"><span class="pre">Function</span></code></p></li>
<li><p><strong>fields</strong> – a dictionary that provides all the remaining fields that the term depends on.
The keys of the dictionary should standard field names in <cite>field_metadata</cite></p></li>
<li><p><strong>fields_old</strong> – Time lagged dictionary of fields</p></li>
<li><p><strong>bnd_conditions</strong> – A dictionary describing boundary conditions.
E.g. {3: {‘elev_2d’: Constant(1.0)}} replaces elev_2d function by a constant on boundary ID 3.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="thetis.tracer_eq_2d.SourceTerm">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">thetis.tracer_eq_2d.</span></span><span class="sig-name descname"><span class="pre">SourceTerm</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">index</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">label</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">function_space</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">depth</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">options</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">test_function</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">trial_function</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/tracer_eq_2d.html#SourceTerm"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#thetis.tracer_eq_2d.SourceTerm" title="Link to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#thetis.tracer_eq_2d.TracerTerm" title="thetis.tracer_eq_2d.TracerTerm"><code class="xref py py-class docutils literal notranslate"><span class="pre">TracerTerm</span></code></a></p>
<p>Generic source term</p>
<p>The weak form reads</p>
<div class="math notranslate nohighlight">
\[F_s = \int_\Omega \sigma \phi dx\]</div>
<p>where <span class="math notranslate nohighlight">\(\sigma\)</span> is a user defined scalar <code class="xref py py-class docutils literal notranslate"><span class="pre">Function</span></code>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>index</strong> – index for this tracer component within the vector</p></li>
<li><p><strong>label</strong> – label for this tracer component</p></li>
<li><p><strong>function_space</strong> – <code class="xref py py-class docutils literal notranslate"><span class="pre">FunctionSpace</span></code> where the solution belongs</p></li>
<li><p><strong>depth</strong> – <code class="xref py py-class docutils literal notranslate"><span class="pre">DepthExpression</span></code> containing depth info</p></li>
<li><p><strong>options</strong> – :class`ModelOptions2d` containing parameters</p></li>
<li><p><strong>test_function</strong> – custom <code class="xref py py-class docutils literal notranslate"><span class="pre">TestFunction</span></code></p></li>
<li><p><strong>trial_function</strong> – custom <code class="xref py py-class docutils literal notranslate"><span class="pre">TrialFunction</span></code></p></li>
</ul>
</dd>
</dl>
<dl class="py method">
<dt class="sig sig-object py" id="thetis.tracer_eq_2d.SourceTerm.residual">
<span class="sig-name descname"><span class="pre">residual</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">solution</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">solution_old</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fields</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fields_old</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">bnd_conditions</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/tracer_eq_2d.html#SourceTerm.residual"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#thetis.tracer_eq_2d.SourceTerm.residual" title="Link to this definition">¶</a></dt>
<dd><p>Returns an UFL form of the term.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>solution</strong> – solution <code class="xref py py-class docutils literal notranslate"><span class="pre">Function</span></code> of the corresponding equation</p></li>
<li><p><strong>solution_old</strong> – a time lagged solution <code class="xref py py-class docutils literal notranslate"><span class="pre">Function</span></code></p></li>
<li><p><strong>fields</strong> – a dictionary that provides all the remaining fields that the term depends on.
The keys of the dictionary should standard field names in <cite>field_metadata</cite></p></li>
<li><p><strong>fields_old</strong> – Time lagged dictionary of fields</p></li>
<li><p><strong>bnd_conditions</strong> – A dictionary describing boundary conditions.
E.g. {3: {‘elev_2d’: Constant(1.0)}} replaces elev_2d function by a constant on boundary ID 3.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="thetis.tracer_eq_2d.TracerEquation2D">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">thetis.tracer_eq_2d.</span></span><span class="sig-name descname"><span class="pre">TracerEquation2D</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">system</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">function_space</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">depth</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">options</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">velocity</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/tracer_eq_2d.html#TracerEquation2D"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#thetis.tracer_eq_2d.TracerEquation2D" title="Link to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#thetis.equation.Equation" title="thetis.equation.Equation"><code class="xref py py-class docutils literal notranslate"><span class="pre">Equation</span></code></a></p>
<p>Several 2D tracer advection-diffusion equations <a class="reference internal" href="#equation-tracer-eq">(15)</a> in
conservative or non-conservative form, solved as a mixed system.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>system</strong> – comma separated tracer fields under consideration</p></li>
<li><p><strong>function_space</strong> – <code class="xref py py-class docutils literal notranslate"><span class="pre">FunctionSpace</span></code> where the solution belongs</p></li>
<li><p><strong>depth</strong> – <dl class="field-list simple">
<dt class="field-odd">class<span class="colon">:</span></dt>
<dd class="field-odd"><p><cite>DepthExpression</cite> containing depth info</p>
</dd>
</dl>
</p></li>
<li><p><strong>options</strong> – :class`ModelOptions2d` containing parameters</p></li>
<li><p><strong>velocity</strong> – velocity field associated with the shallow water model</p></li>
</ul>
</dd>
</dl>
<dl class="py method">
<dt class="sig sig-object py" id="thetis.tracer_eq_2d.TracerEquation2D.add_conservative_terms">
<span class="sig-name descname"><span class="pre">add_conservative_terms</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/tracer_eq_2d.html#TracerEquation2D.add_conservative_terms"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#thetis.tracer_eq_2d.TracerEquation2D.add_conservative_terms" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="thetis.tracer_eq_2d.TracerEquation2D.add_nonconservative_terms">
<span class="sig-name descname"><span class="pre">add_nonconservative_terms</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/tracer_eq_2d.html#TracerEquation2D.add_nonconservative_terms"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#thetis.tracer_eq_2d.TracerEquation2D.add_nonconservative_terms" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="thetis.tracer_eq_2d.TracerEquation2D.apply_supg">
<span class="sig-name descname"><span class="pre">apply_supg</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">test_function</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/tracer_eq_2d.html#TracerEquation2D.apply_supg"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#thetis.tracer_eq_2d.TracerEquation2D.apply_supg" title="Link to this definition">¶</a></dt>
<dd><p>Apply SUPG stabilization in the sense of modifying the test function.</p>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="thetis.tracer_eq_2d.TracerTerm">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">thetis.tracer_eq_2d.</span></span><span class="sig-name descname"><span class="pre">TracerTerm</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">index</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">label</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">function_space</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">depth</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">options</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">test_function</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">trial_function</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/tracer_eq_2d.html#TracerTerm"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#thetis.tracer_eq_2d.TracerTerm" title="Link to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#thetis.equation.Term" title="thetis.equation.Term"><code class="xref py py-class docutils literal notranslate"><span class="pre">Term</span></code></a></p>
<p>Generic tracer term that provides commonly used members and mapping for
boundary functions.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>index</strong> – index for this tracer component within the vector</p></li>
<li><p><strong>label</strong> – label for this tracer component</p></li>
<li><p><strong>function_space</strong> – <code class="xref py py-class docutils literal notranslate"><span class="pre">FunctionSpace</span></code> where the solution belongs</p></li>
<li><p><strong>depth</strong> – <code class="xref py py-class docutils literal notranslate"><span class="pre">DepthExpression</span></code> containing depth info</p></li>
<li><p><strong>options</strong> – :class`ModelOptions2d` containing parameters</p></li>
<li><p><strong>test_function</strong> – custom <code class="xref py py-class docutils literal notranslate"><span class="pre">TestFunction</span></code></p></li>
<li><p><strong>trial_function</strong> – custom <code class="xref py py-class docutils literal notranslate"><span class="pre">TrialFunction</span></code></p></li>
</ul>
</dd>
</dl>
<dl class="py method">
<dt class="sig sig-object py" id="thetis.tracer_eq_2d.TracerTerm.component">
<span class="sig-name descname"><span class="pre">component</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">f</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/tracer_eq_2d.html#TracerTerm.component"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#thetis.tracer_eq_2d.TracerTerm.component" title="Link to this definition">¶</a></dt>
<dd><p>Return the component of a function corresponding to this tracer.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="thetis.tracer_eq_2d.TracerTerm.get_bnd_functions">
<span class="sig-name descname"><span class="pre">get_bnd_functions</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">c_in</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">uv_in</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">elev_in</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">bnd_id</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">bnd_conditions</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/tracer_eq_2d.html#TracerTerm.get_bnd_functions"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#thetis.tracer_eq_2d.TracerTerm.get_bnd_functions" title="Link to this definition">¶</a></dt>
<dd><p>Returns external values of tracer and uv for all supported
boundary conditions.</p>
<p>Volume flux (flux) and normal velocity (un) are defined positive out of
the domain.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>c_in</strong> – Internal value of tracer</p></li>
<li><p><strong>uv_in</strong> – Internal value of horizontal velocity</p></li>
<li><p><strong>elev_in</strong> – Internal value of elevation</p></li>
<li><p><strong>bnd_id</strong> (<a class="reference external" href="https://docs.python.org/2.7/library/functions.html#int" title="(in Python v2.7)"><em>int</em></a>) – boundary id</p></li>
<li><p><strong>bnd_conditions</strong> – dict of boundary conditions:
<code class="docutils literal notranslate"><span class="pre">{bnd_id:</span> <span class="pre">{field:</span> <span class="pre">value,</span> <span class="pre">...},</span> <span class="pre">...}</span></code></p></li>
</ul>
</dd>
</dl>
</dd></dl>

</dd></dl>

</section>
<section id="module-thetis.turbines">
<span id="thetis-turbines-module"></span><h2>thetis.turbines module<a class="headerlink" href="#module-thetis.turbines" title="Link to this heading">¶</a></h2>
<p>Classes related to tidal turbine farms in Thetis.</p>
<dl class="py class">
<dt class="sig sig-object py" id="thetis.turbines.ConstantThrustTurbine">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">thetis.turbines.</span></span><span class="sig-name descname"><span class="pre">ConstantThrustTurbine</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">options</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">upwind_correction</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/turbines.html#ConstantThrustTurbine"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#thetis.turbines.ConstantThrustTurbine" title="Link to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#thetis.turbines.TidalTurbine" title="thetis.turbines.TidalTurbine"><code class="xref py py-class docutils literal notranslate"><span class="pre">TidalTurbine</span></code></a></p>
<dl class="py method">
<dt class="sig sig-object py" id="thetis.turbines.ConstantThrustTurbine.power_coefficient">
<span class="sig-name descname"><span class="pre">power_coefficient</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">uv</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/turbines.html#ConstantThrustTurbine.power_coefficient"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#thetis.turbines.ConstantThrustTurbine.power_coefficient" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="thetis.turbines.ConstantThrustTurbine.thrust_coefficient">
<span class="sig-name descname"><span class="pre">thrust_coefficient</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">uv</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/turbines.html#ConstantThrustTurbine.thrust_coefficient"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#thetis.turbines.ConstantThrustTurbine.thrust_coefficient" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="thetis.turbines.DiscreteTidalTurbineFarm">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">thetis.turbines.</span></span><span class="sig-name descname"><span class="pre">DiscreteTidalTurbineFarm</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">mesh</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dx</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">options</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/turbines.html#DiscreteTidalTurbineFarm"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#thetis.turbines.DiscreteTidalTurbineFarm" title="Link to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#thetis.turbines.TidalTurbineFarm" title="thetis.turbines.TidalTurbineFarm"><code class="xref py py-class docutils literal notranslate"><span class="pre">TidalTurbineFarm</span></code></a></p>
<p>Class that can be used for the addition of turbines in the turbine density field</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>mesh</strong> – mesh domain</p></li>
<li><p><strong>dx</strong> – measure to integrate power output, n/o turbines</p></li>
<li><p><strong>options</strong> – a <code class="xref py py-class docutils literal notranslate"><span class="pre">TidalTurbineFarmOptions</span></code> options dictionary</p></li>
</ul>
</dd>
</dl>
<dl class="py method">
<dt class="sig sig-object py" id="thetis.turbines.DiscreteTidalTurbineFarm.add_turbines">
<span class="sig-name descname"><span class="pre">add_turbines</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">coordinates</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/turbines.html#DiscreteTidalTurbineFarm.add_turbines"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#thetis.turbines.DiscreteTidalTurbineFarm.add_turbines" title="Link to this definition">¶</a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>coords</strong> – Array with turbine coordinates to be positioned</p></li>
<li><p><strong>function</strong> – turbine density function to be adapted</p></li>
<li><p><strong>mesh</strong> – computational mesh domain</p></li>
<li><p><strong>radius</strong> – radius where the bump will be applied</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>updated turbine density field</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="thetis.turbines.MinimumDistanceConstraints">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">thetis.turbines.</span></span><span class="sig-name descname"><span class="pre">MinimumDistanceConstraints</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">turbine_positions</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">minimum_distance</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/turbines.html#MinimumDistanceConstraints"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#thetis.turbines.MinimumDistanceConstraints" title="Link to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">InequalityConstraint</span></code></p>
<p>This class implements minimum distance constraints between turbines.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>This class subclasses <code class="docutils literal notranslate"><span class="pre">pyadjoint.InequalityConstraint</span></code>. The
following methods must be implemented:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">length(self)</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">function(self,</span> <span class="pre">m)</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">jacobian(self,</span> <span class="pre">m)</span></code></p></li>
</ul>
</div>
<p>Create MinimumDistanceConstraints</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>turbine_positions</strong> – list of [x,y] where x and y are either float or Constant</p></li>
<li><p><strong>minimum_distance</strong> – The minimum distance allowed between turbines.</p></li>
</ul>
</dd>
</dl>
<dl class="py method">
<dt class="sig sig-object py" id="thetis.turbines.MinimumDistanceConstraints.function">
<span class="sig-name descname"><span class="pre">function</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">m</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/turbines.html#MinimumDistanceConstraints.function"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#thetis.turbines.MinimumDistanceConstraints.function" title="Link to this definition">¶</a></dt>
<dd><p>Return an object which must be positive for the point to be feasible.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>m</strong> (<em>numpy.ndarray.</em>) – The serialized paramaterisation of the turbines.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>numpy.ndarray – each entry must be positive for the positions to be
feasible.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="thetis.turbines.MinimumDistanceConstraints.jacobian">
<span class="sig-name descname"><span class="pre">jacobian</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">m</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/turbines.html#MinimumDistanceConstraints.jacobian"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#thetis.turbines.MinimumDistanceConstraints.jacobian" title="Link to this definition">¶</a></dt>
<dd><p>Returns the gradient of the constraint function.</p>
<p>Return a list of vector-like objects representing the gradient of the
constraint function with respect to the parameter m.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>m</strong> (<em>numpy.ndarray.</em>) – The serialized paramaterisation of the turbines.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>numpy.ndarray – the gradient of the constraint function with
respect to each input parameter m.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="thetis.turbines.MinimumDistanceConstraints.length">
<span class="sig-name descname"><span class="pre">length</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/turbines.html#MinimumDistanceConstraints.length"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#thetis.turbines.MinimumDistanceConstraints.length" title="Link to this definition">¶</a></dt>
<dd><p>Returns the number of constraints <code class="docutils literal notranslate"><span class="pre">len(function(m))</span></code>.</p>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="thetis.turbines.TabulatedThrustTurbine">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">thetis.turbines.</span></span><span class="sig-name descname"><span class="pre">TabulatedThrustTurbine</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">options</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">upwind_correction</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/turbines.html#TabulatedThrustTurbine"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#thetis.turbines.TabulatedThrustTurbine" title="Link to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#thetis.turbines.TidalTurbine" title="thetis.turbines.TidalTurbine"><code class="xref py py-class docutils literal notranslate"><span class="pre">TidalTurbine</span></code></a></p>
<dl class="py method">
<dt class="sig sig-object py" id="thetis.turbines.TabulatedThrustTurbine.power_coefficient">
<span class="sig-name descname"><span class="pre">power_coefficient</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">uv</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/turbines.html#TabulatedThrustTurbine.power_coefficient"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#thetis.turbines.TabulatedThrustTurbine.power_coefficient" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="thetis.turbines.TabulatedThrustTurbine.thrust_coefficient">
<span class="sig-name descname"><span class="pre">thrust_coefficient</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">uv</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/turbines.html#TabulatedThrustTurbine.thrust_coefficient"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#thetis.turbines.TabulatedThrustTurbine.thrust_coefficient" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="thetis.turbines.TidalTurbine">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">thetis.turbines.</span></span><span class="sig-name descname"><span class="pre">TidalTurbine</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">options</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">upwind_correction</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/turbines.html#TidalTurbine"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#thetis.turbines.TidalTurbine" title="Link to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference external" href="https://docs.python.org/2.7/library/functions.html#object" title="(in Python v2.7)"><code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></a></p>
<dl class="py method">
<dt class="sig sig-object py" id="thetis.turbines.TidalTurbine.friction_coefficient">
<span class="sig-name descname"><span class="pre">friction_coefficient</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">uv</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">depth</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/turbines.html#TidalTurbine.friction_coefficient"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#thetis.turbines.TidalTurbine.friction_coefficient" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="thetis.turbines.TidalTurbine.power">
<span class="sig-name descname"><span class="pre">power</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">uv</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">depth</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/turbines.html#TidalTurbine.power"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#thetis.turbines.TidalTurbine.power" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="thetis.turbines.TidalTurbine.velocity_correction">
<span class="sig-name descname"><span class="pre">velocity_correction</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">uv</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">depth</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/turbines.html#TidalTurbine.velocity_correction"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#thetis.turbines.TidalTurbine.velocity_correction" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="thetis.turbines.TidalTurbineFarm">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">thetis.turbines.</span></span><span class="sig-name descname"><span class="pre">TidalTurbineFarm</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">turbine_density</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dx</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">options</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/turbines.html#TidalTurbineFarm"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#thetis.turbines.TidalTurbineFarm" title="Link to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference external" href="https://docs.python.org/2.7/library/functions.html#object" title="(in Python v2.7)"><code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></a></p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>turbine_density</strong> – turbine distribution density field or expression</p></li>
<li><p><strong>dx</strong> – measure to integrate power output, n/o turbines</p></li>
<li><p><strong>options</strong> – a <code class="xref py py-class docutils literal notranslate"><span class="pre">TidalTurbineFarmOptions</span></code> options dictionary</p></li>
</ul>
</dd>
</dl>
<dl class="py method">
<dt class="sig sig-object py" id="thetis.turbines.TidalTurbineFarm.friction_coefficient">
<span class="sig-name descname"><span class="pre">friction_coefficient</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">uv</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">depth</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/turbines.html#TidalTurbineFarm.friction_coefficient"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#thetis.turbines.TidalTurbineFarm.friction_coefficient" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="thetis.turbines.TidalTurbineFarm.number_of_turbines">
<span class="sig-name descname"><span class="pre">number_of_turbines</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/turbines.html#TidalTurbineFarm.number_of_turbines"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#thetis.turbines.TidalTurbineFarm.number_of_turbines" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="thetis.turbines.TidalTurbineFarm.power_output">
<span class="sig-name descname"><span class="pre">power_output</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">uv</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">depth</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/turbines.html#TidalTurbineFarm.power_output"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#thetis.turbines.TidalTurbineFarm.power_output" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="thetis.turbines.TurbineFunctionalCallback">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">thetis.turbines.</span></span><span class="sig-name descname"><span class="pre">TurbineFunctionalCallback</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">solver_obj</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/turbines.html#TurbineFunctionalCallback"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#thetis.turbines.TurbineFunctionalCallback" title="Link to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#thetis.callback.DiagnosticCallback" title="thetis.callback.DiagnosticCallback"><code class="xref py py-class docutils literal notranslate"><span class="pre">DiagnosticCallback</span></code></a></p>
<p><a class="reference internal" href="#thetis.callback.DiagnosticCallback" title="thetis.callback.DiagnosticCallback"><code class="xref py py-class docutils literal notranslate"><span class="pre">DiagnosticCallback</span></code></a> that evaluates the performance of each tidal turbine farm.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>solver_obj</strong> – a <a class="reference internal" href="#thetis.solver2d.FlowSolver2d" title="thetis.solver2d.FlowSolver2d"><code class="xref py py-class docutils literal notranslate"><span class="pre">FlowSolver2d</span></code></a> object containing the tidal_turbine_farms</p></li>
<li><p><strong>kwargs</strong> – see <code class="xref py py-class docutils literal notranslate"><span class="pre">DiagnosticCallback</span></code></p></li>
</ul>
</dd>
</dl>
<dl class="py method">
<dt class="sig sig-object py" id="thetis.turbines.TurbineFunctionalCallback.message_str">
<span class="sig-name descname"><span class="pre">message_str</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">current_power</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">average_power</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">average_profit</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/turbines.html#TurbineFunctionalCallback.message_str"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#thetis.turbines.TurbineFunctionalCallback.message_str" title="Link to this definition">¶</a></dt>
<dd><p>A string representation.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>args</strong> – If provided, these will be the return value from
<code class="xref py py-meth docutils literal notranslate"><span class="pre">__call__()</span></code>.</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="thetis.turbines.TurbineFunctionalCallback.name">
<span class="sig-name descname"><span class="pre">name</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">'turbine'</span></em><a class="headerlink" href="#thetis.turbines.TurbineFunctionalCallback.name" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="thetis.turbines.TurbineFunctionalCallback.variable_names">
<span class="sig-name descname"><span class="pre">variable_names</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">['current_power',</span> <span class="pre">'average_power',</span> <span class="pre">'average_profit']</span></em><a class="headerlink" href="#thetis.turbines.TurbineFunctionalCallback.variable_names" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="thetis.turbines.TurbineOptimisationCallback">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">thetis.turbines.</span></span><span class="sig-name descname"><span class="pre">TurbineOptimisationCallback</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">solver_obj</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">turbine_functional_callback</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/turbines.html#TurbineOptimisationCallback"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#thetis.turbines.TurbineOptimisationCallback" title="Link to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#thetis.optimisation.DiagnosticOptimisationCallback" title="thetis.optimisation.DiagnosticOptimisationCallback"><code class="xref py py-class docutils literal notranslate"><span class="pre">DiagnosticOptimisationCallback</span></code></a></p>
<p><code class="xref py py-class docutils literal notranslate"><span class="pre">DiagnosticOptimisationCallback</span></code> that evaluates the performance of each tidal turbine farm during an optimisation.</p>
<p>See the <code class="xref py py-mod docutils literal notranslate"><span class="pre">optimisation</span></code> module for more info about the use of OptimisationCallbacks.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>solver_obj</strong> – a <a class="reference internal" href="#thetis.solver2d.FlowSolver2d" title="thetis.solver2d.FlowSolver2d"><code class="xref py py-class docutils literal notranslate"><span class="pre">FlowSolver2d</span></code></a> object</p></li>
<li><p><strong>turbine_functional_callback</strong> – a <a class="reference internal" href="#thetis.turbines.TurbineFunctionalCallback" title="thetis.turbines.TurbineFunctionalCallback"><code class="xref py py-class docutils literal notranslate"><span class="pre">TurbineFunctionalCallback</span></code></a> used in the forward model</p></li>
</ul>
</dd>
<dt class="field-even">Args kwargs<span class="colon">:</span></dt>
<dd class="field-even"><p>see <a class="reference internal" href="#thetis.optimisation.DiagnosticOptimisationCallback" title="thetis.optimisation.DiagnosticOptimisationCallback"><code class="xref py py-class docutils literal notranslate"><span class="pre">DiagnosticOptimisationCallback</span></code></a></p>
</dd>
</dl>
<dl class="py method">
<dt class="sig sig-object py" id="thetis.turbines.TurbineOptimisationCallback.compute_values">
<span class="sig-name descname"><span class="pre">compute_values</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/turbines.html#TurbineOptimisationCallback.compute_values"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#thetis.turbines.TurbineOptimisationCallback.compute_values" title="Link to this definition">¶</a></dt>
<dd><p>Compute diagnostic values.</p>
<p>This method is to be implemented in concrete subclasses of a <a class="reference internal" href="#thetis.optimisation.DiagnosticOptimisationCallback" title="thetis.optimisation.DiagnosticOptimisationCallback"><code class="xref py py-class docutils literal notranslate"><span class="pre">DiagnosticOptimisationCallback</span></code></a>.
The number of arguments varies depending on which of the 6 [eval|derivative|hessian]_cb_[pre|post] callbacks
this is used as. The last argument always contains the current controls. In the “pre” callbacks this is
the only argument. In all “post” callbacks the 0th argument is the current functional value. eval_cb_post
is given two arguments: functional and controls. derivative_cb_post and hessian_cb_post are given three
arguments with args[1] being the derivative/hessian just calculated.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="thetis.turbines.TurbineOptimisationCallback.message_str">
<span class="sig-name descname"><span class="pre">message_str</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">cost</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">average_power</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">average_profit</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/turbines.html#TurbineOptimisationCallback.message_str"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#thetis.turbines.TurbineOptimisationCallback.message_str" title="Link to this definition">¶</a></dt>
<dd><p>A string representation.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>args</strong> – If provided, these will be the return value from
<code class="xref py py-meth docutils literal notranslate"><span class="pre">__call__()</span></code>.</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="thetis.turbines.TurbineOptimisationCallback.name">
<span class="sig-name descname"><span class="pre">name</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">'farm_optimisation'</span></em><a class="headerlink" href="#thetis.turbines.TurbineOptimisationCallback.name" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="thetis.turbines.TurbineOptimisationCallback.variable_names">
<span class="sig-name descname"><span class="pre">variable_names</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">['cost',</span> <span class="pre">'average_power',</span> <span class="pre">'average_profit']</span></em><a class="headerlink" href="#thetis.turbines.TurbineOptimisationCallback.variable_names" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="thetis.turbines.linearly_interpolate_table">
<span class="sig-prename descclassname"><span class="pre">thetis.turbines.</span></span><span class="sig-name descname"><span class="pre">linearly_interpolate_table</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x_list</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y_list</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y_final</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">x</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/turbines.html#linearly_interpolate_table"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#thetis.turbines.linearly_interpolate_table" title="Link to this definition">¶</a></dt>
<dd><p>Return UFL expression that linearly interpolates between y-values in x-points</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>x_list</strong> – (1D) x-points</p></li>
<li><p><strong>y_list</strong> – y-values in those points</p></li>
<li><p><strong>y_final</strong> – value for x&gt;x_list[-1]</p></li>
<li><p><strong>x</strong> – point to interpolate (assumed x&gt;x_list[0])</p></li>
</ul>
</dd>
</dl>
</dd></dl>

</section>
<section id="module-thetis.turbulence">
<span id="thetis-turbulence-module"></span><h2>thetis.turbulence module<a class="headerlink" href="#module-thetis.turbulence" title="Link to this heading">¶</a></h2>
<section id="generic-length-scale-turbulence-closure-model">
<h3>Generic Length Scale Turbulence Closure model<a class="headerlink" href="#generic-length-scale-turbulence-closure-model" title="Link to this heading">¶</a></h3>
<p>This model solves two dynamic equations, for turbulent kinetic energy
(TKE, <span class="math notranslate nohighlight">\(k\)</span>) and one for an additional variable, the generic length scale
<span class="math notranslate nohighlight">\(\psi\)</span> [1]:</p>
<div class="math notranslate nohighlight" id="equation-turb-tke-eq">
<span class="eqno">(18)<a class="headerlink" href="#equation-turb-tke-eq" title="Link to this equation">¶</a></span>\[\frac{\partial k}{\partial t} + \nabla_h \cdot (\textbf{u} k)
    + \frac{\partial (w k)}{\partial z}
    = \frac{\partial}{\partial z}\left(\frac{\nu}{\sigma_k} \frac{\partial k}{\partial z}\right)
    + P + B - \varepsilon\]</div>
<div class="math notranslate nohighlight" id="equation-turb-psi-eq">
<span class="eqno">(19)<a class="headerlink" href="#equation-turb-psi-eq" title="Link to this equation">¶</a></span>\[\frac{\partial \psi}{\partial t} + \nabla_h \cdot (\textbf{u} \psi)
    + \frac{\partial (w \psi)}{\partial z}
    = \frac{\partial}{\partial z}\left(\frac{\nu}{\sigma_\psi} \frac{\partial \psi}{\partial z}\right)
    + \frac{\psi}{k} (c_1 P + c_3 B - c_2 \varepsilon f_{wall})\]</div>
<p>with the production <span class="math notranslate nohighlight">\(P\)</span> and buoyancy production <span class="math notranslate nohighlight">\(B\)</span> are</p>
<div class="math notranslate nohighlight">
\[\begin{split}P &amp;= \nu M^2 \\
B &amp;= -\mu N^2\end{split}\]</div>
<p>where <span class="math notranslate nohighlight">\(M\)</span> and <span class="math notranslate nohighlight">\(N\)</span> are the shear and buoyancy frequencies</p>
<div class="math notranslate nohighlight">
\[\begin{split}M^2 &amp;= \left(\frac{\partial u}{\partial z}\right)^2
    + \left(\frac{\partial v}{\partial z}\right)^2 \\
N^2 &amp;= -\frac{g}{\rho_0}\frac{\partial \rho}{\partial z}\end{split}\]</div>
<p>The generic length scale variable is defined as</p>
<div class="math notranslate nohighlight">
\[\psi = (c_\mu^0)^p k^m l^n\]</div>
<p>where <span class="math notranslate nohighlight">\(p, m, n\)</span> are parameters and <span class="math notranslate nohighlight">\(c_\mu^0\)</span> is an empirical constant.</p>
<p>The parameters <span class="math notranslate nohighlight">\(c_1,c_2,c_3,f_{wall}\)</span> depend on the chosen closure.
The parameter <span class="math notranslate nohighlight">\(c_3\)</span> takes two values: <span class="math notranslate nohighlight">\(c_3^-\)</span> in stably stratified
regime, and <span class="math notranslate nohighlight">\(c_3^+\)</span> in unstably stratified cases.</p>
<p>Turbulent length scale <span class="math notranslate nohighlight">\(l\)</span>, and the TKE dissipation rate
<span class="math notranslate nohighlight">\(\varepsilon\)</span> are obtained diagnostically as</p>
<div class="math notranslate nohighlight">
\[\begin{split}l &amp;= (c_\mu^0)^3 k^{3/2} \varepsilon^{-1} \\
\varepsilon &amp;= (c_\mu^0)^{3+p/n} k^{3/2 + m/n} \psi^{-1/n}\end{split}\]</div>
<p>Finally the vertical eddy viscosity and diffusivity are also computed
diagnostically</p>
<div class="math notranslate nohighlight">
\[\begin{split}\nu &amp;= \sqrt{2k} l S_m \\
\mu &amp;= \sqrt{2k} l S_\rho\end{split}\]</div>
<p>Stability functions <span class="math notranslate nohighlight">\(S_m\)</span> and <span class="math notranslate nohighlight">\(S_\rho\)</span> are defined in [2] or [3].
Implementation follows [4].</p>
<section id="supported-closures">
<h4>Supported closures<a class="headerlink" href="#supported-closures" title="Link to this heading">¶</a></h4>
<p>The GLS model parameters are controlled via the <a class="reference internal" href="#thetis.options.GLSModelOptions" title="thetis.options.GLSModelOptions"><code class="xref py py-class docutils literal notranslate"><span class="pre">GLSModelOptions</span></code></a> class.</p>
<p>The parameters can be accessed from the solver object:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">solver</span> <span class="o">=</span> <span class="n">FlowSolver</span><span class="p">(</span><span class="o">...</span><span class="p">)</span>
<span class="n">solver</span><span class="o">.</span><span class="n">options</span><span class="o">.</span><span class="n">turbulence_model_type</span> <span class="o">=</span> <span class="s1">&#39;gls&#39;</span>  <span class="c1"># activate GLS model (default)</span>
<span class="n">turbulence_model_options</span> <span class="o">=</span> <span class="n">solver</span><span class="o">.</span><span class="n">options</span><span class="o">.</span><span class="n">turbulence_model_options</span>
<span class="n">turbulence_model_options</span><span class="o">.</span><span class="n">closure_name</span> <span class="o">=</span> <span class="s1">&#39;k-omega&#39;</span>
<span class="n">turbulence_model_options</span><span class="o">.</span><span class="n">stability_function_name</span> <span class="o">=</span> <span class="s1">&#39;CB&#39;</span>
<span class="n">turbulence_model_options</span><span class="o">.</span><span class="n">compute_c3_minus</span> <span class="o">=</span> <span class="kc">True</span>
</pre></div>
</div>
<p>Currently the following closures have been implemented:</p>
<ul class="simple">
<li><dl class="simple">
<dt><span class="math notranslate nohighlight">\(k-\varepsilon\)</span> model</dt><dd><p>This closure is obtained with <span class="math notranslate nohighlight">\(p=3, m=3/2, n=-1\)</span>, resulting in
<span class="math notranslate nohighlight">\(\psi=\varepsilon\)</span>.
To use this option set <code class="docutils literal notranslate"><span class="pre">closure_name</span> <span class="pre">=</span> <span class="pre">k-epsilon</span></code></p>
</dd>
</dl>
</li>
<li><dl class="simple">
<dt><span class="math notranslate nohighlight">\(k-\omega\)</span> model</dt><dd><p>This closure is obtained with <span class="math notranslate nohighlight">\(p=-1, m=1/2, n=-1\)</span>, resulting in
<span class="math notranslate nohighlight">\(\psi=\omega\)</span>.
To use this option set <code class="docutils literal notranslate"><span class="pre">closure_name</span> <span class="pre">=</span> <span class="pre">k-omega</span></code></p>
</dd>
</dl>
</li>
<li><dl class="simple">
<dt>GLS model A</dt><dd><p>This closure is obtained with <span class="math notranslate nohighlight">\(p=2, m=1, n=-2/3\)</span>, resulting in
<span class="math notranslate nohighlight">\(\psi=\omega\)</span>.
To use this option set <code class="docutils literal notranslate"><span class="pre">closure_name</span> <span class="pre">=</span> <span class="pre">gen</span></code></p>
</dd>
</dl>
</li>
</ul>
<p>The following stability functions have been implemented</p>
<ul class="simple">
<li><dl class="simple">
<dt>Canuto A [3]</dt><dd><p>To use this option set <code class="docutils literal notranslate"><span class="pre">closure_name</span> <span class="pre">=</span> <span class="pre">CA</span></code></p>
</dd>
</dl>
</li>
<li><dl class="simple">
<dt>Canuto B [3]</dt><dd><p>To use this option set <code class="docutils literal notranslate"><span class="pre">closure_name</span> <span class="pre">=</span> <span class="pre">CB</span></code></p>
</dd>
</dl>
</li>
<li><dl class="simple">
<dt>Kantha-Clayson [2]</dt><dd><p>To use this option set <code class="docutils literal notranslate"><span class="pre">closure_name</span> <span class="pre">=</span> <span class="pre">KC</span></code></p>
</dd>
</dl>
</li>
<li><dl class="simple">
<dt>Cheng [6]</dt><dd><p>To use this option set <code class="docutils literal notranslate"><span class="pre">closure_name</span> <span class="pre">=</span> <span class="pre">CH</span></code></p>
</dd>
</dl>
</li>
</ul>
<p>See <a class="reference internal" href="#module-thetis.stability_functions" title="thetis.stability_functions"><code class="xref py py-mod docutils literal notranslate"><span class="pre">stability_functions</span></code></a> for more information.</p>
<dl class="simple">
<dt>[1] Umlauf, L. and Burchard, H. (2003). A generic length-scale equation for</dt><dd><p>geophysical turbulence models. Journal of Marine Research, 61:235–265(31).
<a class="reference external" href="http://dx.doi.org/10.1357/002224003322005087">http://dx.doi.org/10.1357/002224003322005087</a></p>
</dd>
<dt>[2] Kantha, L. H. and Clayson, C. A. (1994). An improved mixed layer model for</dt><dd><p>geophysical applications. Journal of Geophysical Research: Oceans,
99(C12):25235–25266.
<a class="reference external" href="http://dx.doi.org/10.1029/94JC02257">http://dx.doi.org/10.1029/94JC02257</a></p>
</dd>
<dt>[3] Canuto et al. (2001). Ocean Turbulence. Part I: One-Point Closure Model -</dt><dd><p>Momentum and Heat Vertical Diffusivities. Journal of Physical Oceanography,
31(6):1413-1426.
<a class="reference external" href="http://dx.doi.org/10.1175/1520-0485(2001)031">http://dx.doi.org/10.1175/1520-0485(2001)031</a></p>
</dd>
<dt>[4] Warner et al. (2005). Performance of four turbulence closure models</dt><dd><p>implemented using a generic length scale method. Ocean Modelling,
8(1-2):81–113.
<a class="reference external" href="http://dx.doi.org/10.1016/j.ocemod.2003.12.003">http://dx.doi.org/10.1016/j.ocemod.2003.12.003</a></p>
</dd>
<dt>[5] Umlauf, L. and Burchard, H. (2005). Second-order turbulence closure models</dt><dd><p>for geophysical boundary layers. A review of recent work. Continental Shelf
Research, 25(7-8):795–827.
<a class="reference external" href="http://dx.doi.org/10.1016/j.csr.2004.08.004">http://dx.doi.org/10.1016/j.csr.2004.08.004</a></p>
</dd>
<dt>[6] Cheng et al. (2002). An improved model for the turbulent PBL.</dt><dd><p>J. Atmos. Sci., 59:1550-1565.
<a class="reference external" href="http://dx.doi.org/10.1175/1520-0469(2002)059%3C1550:AIMFTT%3E2.0.CO;2">http://dx.doi.org/10.1175/1520-0469(2002)059%3C1550:AIMFTT%3E2.0.CO;2</a></p>
</dd>
<dt>[7] Burchard and Petersen (1999). Models of turbulence in the marine</dt><dd><p>environment - a comparative study of two-equation turbulence models.
Journal of Marine Systems, 21(1-4):29-53.
<a class="reference external" href="http://dx.doi.org/10.1016/S0924-7963(99)00004-4">http://dx.doi.org/10.1016/S0924-7963(99)00004-4</a></p>
</dd>
</dl>
</section>
</section>
<dl class="py class">
<dt class="sig sig-object py" id="thetis.turbulence.BuoyFrequencySolver">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">thetis.turbulence.</span></span><span class="sig-name descname"><span class="pre">BuoyFrequencySolver</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">rho</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n2</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n2_tmp</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">relaxation</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">minval</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1e-12</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/turbulence.html#BuoyFrequencySolver"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#thetis.turbulence.BuoyFrequencySolver" title="Link to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference external" href="https://docs.python.org/2.7/library/functions.html#object" title="(in Python v2.7)"><code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></a></p>
<p>Computes buoyancy frequency squared form the given horizontal
velocity field.</p>
<div class="math notranslate nohighlight">
\[N^2 = -\frac{g}{\rho_0}\frac{\partial \rho}{\partial z}\]</div>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>rho</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">Function</span></code>) – water density field</p></li>
<li><p><strong>n2</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">Function</span></code>) – <span class="math notranslate nohighlight">\(N^2\)</span> field</p></li>
<li><p><strong>n2_tmp</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">Function</span></code>) – temporary field</p></li>
<li><p><strong>relaxation</strong> (<a class="reference external" href="https://docs.python.org/2.7/library/functions.html#float" title="(in Python v2.7)"><em>float</em></a>) – relaxation coefficient for mixing old and new
values N2 = relaxation*N2_new + (1-relaxation)*N2_old</p></li>
<li><p><strong>minval</strong> (<a class="reference external" href="https://docs.python.org/2.7/library/functions.html#float" title="(in Python v2.7)"><em>float</em></a>) – minimum value for <span class="math notranslate nohighlight">\(N^2\)</span></p></li>
</ul>
</dd>
</dl>
<dl class="py method">
<dt class="sig sig-object py" id="thetis.turbulence.BuoyFrequencySolver.solve">
<span class="sig-name descname"><span class="pre">solve</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">init_solve</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/turbulence.html#BuoyFrequencySolver.solve"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#thetis.turbulence.BuoyFrequencySolver.solve" title="Link to this definition">¶</a></dt>
<dd><p>Computes buoyancy frequency</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>init_solve</strong> (<a class="reference external" href="https://docs.python.org/2.7/library/functions.html#bool" title="(in Python v2.7)"><em>bool</em></a>) – Set to True if solving for the first time, skips
relaxation</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="thetis.turbulence.GLSVerticalDiffusionTerm">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">thetis.turbulence.</span></span><span class="sig-name descname"><span class="pre">GLSVerticalDiffusionTerm</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">function_space</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">schmidt_nb</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">bathymetry</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">v_elem_size</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">h_elem_size</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sipg_factor</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">Constant([1.],</span> <span class="pre">name='constant_42',</span> <span class="pre">count=42)</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/turbulence.html#GLSVerticalDiffusionTerm"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#thetis.turbulence.GLSVerticalDiffusionTerm" title="Link to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#thetis.tracer_eq.VerticalDiffusionTerm" title="thetis.tracer_eq.VerticalDiffusionTerm"><code class="xref py py-class docutils literal notranslate"><span class="pre">VerticalDiffusionTerm</span></code></a></p>
<p>Vertical diffusion term where the diffusivity is replaced by
viscosity/Schmidt number.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>function_space</strong> – <code class="xref py py-class docutils literal notranslate"><span class="pre">FunctionSpace</span></code> where the solution belongs</p></li>
<li><p><strong>schmidt_nb</strong> – the Schmidt number of TKE or Psi</p></li>
<li><p><strong>bathymetry</strong> (3D <code class="xref py py-class docutils literal notranslate"><span class="pre">Function</span></code> or <code class="xref py py-class docutils literal notranslate"><span class="pre">Constant</span></code>) – bathymetry of the domain</p></li>
<li><p><strong>v_elem_size</strong> – scalar <code class="xref py py-class docutils literal notranslate"><span class="pre">Function</span></code> that defines the vertical
element size</p></li>
<li><p><strong>h_elem_size</strong> – scalar <code class="xref py py-class docutils literal notranslate"><span class="pre">Function</span></code> that defines the horizontal
element size</p></li>
<li><p><strong>sipg_factor</strong> – <dl class="field-list simple">
<dt class="field-odd">class<span class="colon">:</span></dt>
<dd class="field-odd"><p><cite>Constant</cite> or :class: <cite>Function</cite> vertical SIPG penalty scaling factor</p>
</dd>
</dl>
</p></li>
</ul>
</dd>
</dl>
<dl class="py method">
<dt class="sig sig-object py" id="thetis.turbulence.GLSVerticalDiffusionTerm.residual">
<span class="sig-name descname"><span class="pre">residual</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">solution</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">solution_old</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fields</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fields_old</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">bnd_conditions</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/turbulence.html#GLSVerticalDiffusionTerm.residual"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#thetis.turbulence.GLSVerticalDiffusionTerm.residual" title="Link to this definition">¶</a></dt>
<dd><p>Returns an UFL form of the term.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>solution</strong> – solution <code class="xref py py-class docutils literal notranslate"><span class="pre">Function</span></code> of the corresponding equation</p></li>
<li><p><strong>solution_old</strong> – a time lagged solution <code class="xref py py-class docutils literal notranslate"><span class="pre">Function</span></code></p></li>
<li><p><strong>fields</strong> – a dictionary that provides all the remaining fields that the term depends on.
The keys of the dictionary should standard field names in <cite>field_metadata</cite></p></li>
<li><p><strong>fields_old</strong> – Time lagged dictionary of fields</p></li>
<li><p><strong>bnd_conditions</strong> – A dictionary describing boundary conditions.
E.g. {3: {‘elev_2d’: Constant(1.0)}} replaces elev_2d function by a constant on boundary ID 3.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="thetis.turbulence.GenericLengthScaleModel">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">thetis.turbulence.</span></span><span class="sig-name descname"><span class="pre">GenericLengthScaleModel</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">solver</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">k_field</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">psi_field</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">uv_field</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">rho_field</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">l_field</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">epsilon_field</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">eddy_diffusivity</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">eddy_viscosity</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n2</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">m2</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">options</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/turbulence.html#GenericLengthScaleModel"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#thetis.turbulence.GenericLengthScaleModel" title="Link to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#thetis.turbulence.TurbulenceModel" title="thetis.turbulence.TurbulenceModel"><code class="xref py py-class docutils literal notranslate"><span class="pre">TurbulenceModel</span></code></a></p>
<p>Generic Length Scale turbulence closure model implementation</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>solver</strong> – FlowSolver object</p></li>
<li><p><strong>k_field</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">Function</span></code>) – turbulent kinetic energy (TKE) field</p></li>
<li><p><strong>psi_field</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">Function</span></code>) – generic length scale field</p></li>
<li><p><strong>uv_field</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">Function</span></code>) – horizontal velocity field</p></li>
<li><p><strong>rho_field</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">Function</span></code>) – water density field</p></li>
<li><p><strong>l_field</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">Function</span></code>) – turbulence length scale field</p></li>
<li><p><strong>epsilon_field</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">Function</span></code>) – TKE dissipation rate field</p></li>
<li><p><strong>eddy_diffusivity</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">Function</span></code>) – eddy diffusivity field</p></li>
<li><p><strong>eddy_viscosity</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">Function</span></code>) – eddy viscosity field</p></li>
<li><p><strong>n2</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">Function</span></code>) – field for buoyancy frequency squared</p></li>
<li><p><strong>m2</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">Function</span></code>) – field for vertical shear frequency squared</p></li>
<li><p><strong>options</strong> – GLS model options</p></li>
</ul>
</dd>
</dl>
<dl class="py method">
<dt class="sig sig-object py" id="thetis.turbulence.GenericLengthScaleModel.initialize">
<span class="sig-name descname"><span class="pre">initialize</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">l_init</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.01</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/turbulence.html#GenericLengthScaleModel.initialize"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#thetis.turbulence.GenericLengthScaleModel.initialize" title="Link to this definition">¶</a></dt>
<dd><p>Initialize turbulent fields.</p>
<p>k is set to k_min value. epsilon and psi are set to a value that
corresponds to l_init length scale.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>l_init</strong> – initial value for turbulent length scale.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="thetis.turbulence.GenericLengthScaleModel.postprocess">
<span class="sig-name descname"><span class="pre">postprocess</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/turbulence.html#GenericLengthScaleModel.postprocess"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#thetis.turbulence.GenericLengthScaleModel.postprocess" title="Link to this definition">¶</a></dt>
<dd><p>Updates all diagnostic variables that depend on the turbulence state
variables <span class="math notranslate nohighlight">\(k,\psi\)</span>.</p>
<p>To be called after updating the turbulence PDEs.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="thetis.turbulence.GenericLengthScaleModel.preprocess">
<span class="sig-name descname"><span class="pre">preprocess</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">init_solve</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/turbulence.html#GenericLengthScaleModel.preprocess"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#thetis.turbulence.GenericLengthScaleModel.preprocess" title="Link to this definition">¶</a></dt>
<dd><p>Computes all diagnostic variables that depend on the mean flow model
variables.</p>
<p>To be called before updating the turbulence PDEs.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="thetis.turbulence.GenericLengthScaleModel.print_debug">
<span class="sig-name descname"><span class="pre">print_debug</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/turbulence.html#GenericLengthScaleModel.print_debug"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#thetis.turbulence.GenericLengthScaleModel.print_debug" title="Link to this definition">¶</a></dt>
<dd><p>Print diagnostic field values for debugging.</p>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="thetis.turbulence.PacanowskiPhilanderModel">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">thetis.turbulence.</span></span><span class="sig-name descname"><span class="pre">PacanowskiPhilanderModel</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">solver</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">uv_field</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">rho_field</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">eddy_diffusivity</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">eddy_viscosity</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n2</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">m2</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">options</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/turbulence.html#PacanowskiPhilanderModel"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#thetis.turbulence.PacanowskiPhilanderModel" title="Link to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#thetis.turbulence.TurbulenceModel" title="thetis.turbulence.TurbulenceModel"><code class="xref py py-class docutils literal notranslate"><span class="pre">TurbulenceModel</span></code></a></p>
<p>Gradient Richardson number based model by Pacanowski and Philander (1981).</p>
<p>Given the gradient Richardson number <span class="math notranslate nohighlight">\(Ri\)</span> the eddy viscosity and
diffusivity are computed diagnostically as</p>
<div class="math notranslate nohighlight">
\[\begin{split}\nu &amp;= \frac{\nu_{max}}{(1 + \alpha Ri)^n} \\
\mu &amp;= \frac{\nu}{1 + \alpha Ri}\end{split}\]</div>
<p>where <span class="math notranslate nohighlight">\(\nu_{max},\alpha,n\)</span> are constant parameters.
In unstably stratified cases where <span class="math notranslate nohighlight">\(Ri&lt;0\)</span>, value <span class="math notranslate nohighlight">\(Ri=0\)</span> is used.</p>
<p>Pacanowski and Philander (1981). Parameterization of vertical mixing in
numerical models of tropical oceans. Journal of Physical Oceanography,
11(11):1443-1451.
<a class="reference external" href="http://dx.doi.org/10.1175/1520-0485(1981)011%3C1443:POVMIN%3E2.0.CO;2">http://dx.doi.org/10.1175/1520-0485(1981)011%3C1443:POVMIN%3E2.0.CO;2</a></p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>solver</strong> – FlowSolver object</p></li>
<li><p><strong>uv_field</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">Function</span></code>) – horizontal velocity field</p></li>
<li><p><strong>rho_field</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">Function</span></code>) – water density field</p></li>
<li><p><strong>eddy_diffusivity</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">Function</span></code>) – eddy diffusivity field</p></li>
<li><p><strong>eddy_viscosity</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">Function</span></code>) – eddy viscosity field</p></li>
<li><p><strong>n2</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">Function</span></code>) – field for buoyancy frequency squared</p></li>
<li><p><strong>m2</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">Function</span></code>) – field for vertical shear frequency squared</p></li>
<li><p><strong>options</strong> – model options</p></li>
</ul>
</dd>
</dl>
<dl class="py method">
<dt class="sig sig-object py" id="thetis.turbulence.PacanowskiPhilanderModel.initialize">
<span class="sig-name descname"><span class="pre">initialize</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/turbulence.html#PacanowskiPhilanderModel.initialize"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#thetis.turbulence.PacanowskiPhilanderModel.initialize" title="Link to this definition">¶</a></dt>
<dd><p>Initializes fields</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="thetis.turbulence.PacanowskiPhilanderModel.postprocess">
<span class="sig-name descname"><span class="pre">postprocess</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/turbulence.html#PacanowskiPhilanderModel.postprocess"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#thetis.turbulence.PacanowskiPhilanderModel.postprocess" title="Link to this definition">¶</a></dt>
<dd><p>Updates all diagnostic variables that depend on the turbulence state
variables.</p>
<p>To be called after evaluating the equations.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="thetis.turbulence.PacanowskiPhilanderModel.preprocess">
<span class="sig-name descname"><span class="pre">preprocess</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">init_solve</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/turbulence.html#PacanowskiPhilanderModel.preprocess"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#thetis.turbulence.PacanowskiPhilanderModel.preprocess" title="Link to this definition">¶</a></dt>
<dd><p>Computes all diagnostic variables that depend on the mean flow model
variables.</p>
<p>To be called before updating the turbulence PDEs.</p>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="thetis.turbulence.PsiEquation">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">thetis.turbulence.</span></span><span class="sig-name descname"><span class="pre">PsiEquation</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">function_space</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">gls_model</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">bathymetry</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">v_elem_size</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">h_elem_size</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/turbulence.html#PsiEquation"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#thetis.turbulence.PsiEquation" title="Link to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#thetis.equation.Equation" title="thetis.equation.Equation"><code class="xref py py-class docutils literal notranslate"><span class="pre">Equation</span></code></a></p>
<p>Generic length scale equation <a class="reference internal" href="#equation-turb-psi-eq">(19)</a> without advection terms.</p>
<p>Advection of <span class="math notranslate nohighlight">\(\psi\)</span> is implemented using the standard tracer equation.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>function_space</strong> – <code class="xref py py-class docutils literal notranslate"><span class="pre">FunctionSpace</span></code> where the solution belongs</p></li>
<li><p><strong>gls_model</strong> – <a class="reference internal" href="#thetis.turbulence.GenericLengthScaleModel" title="thetis.turbulence.GenericLengthScaleModel"><code class="xref py py-class docutils literal notranslate"><span class="pre">GenericLengthScaleModel</span></code></a> object</p></li>
<li><p><strong>bathymetry</strong> (3D <code class="xref py py-class docutils literal notranslate"><span class="pre">Function</span></code> or <code class="xref py py-class docutils literal notranslate"><span class="pre">Constant</span></code>) – bathymetry of the domain</p></li>
<li><p><strong>v_elem_size</strong> – scalar <code class="xref py py-class docutils literal notranslate"><span class="pre">Function</span></code> that defines the vertical
element size</p></li>
<li><p><strong>h_elem_size</strong> – scalar <code class="xref py py-class docutils literal notranslate"><span class="pre">Function</span></code> that defines the horizontal
element size</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="thetis.turbulence.PsiSourceTerm">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">thetis.turbulence.</span></span><span class="sig-name descname"><span class="pre">PsiSourceTerm</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">function_space</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">gls_model</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">bathymetry</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">v_elem_size</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">h_elem_size</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/turbulence.html#PsiSourceTerm"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#thetis.turbulence.PsiSourceTerm" title="Link to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#thetis.tracer_eq.TracerTerm" title="thetis.tracer_eq.TracerTerm"><code class="xref py py-class docutils literal notranslate"><span class="pre">TracerTerm</span></code></a></p>
<p>Production and destruction terms of the Psi equation <a class="reference internal" href="#equation-turb-psi-eq">(19)</a></p>
<div class="math notranslate nohighlight">
\[F_\psi = \frac{\psi}{k} (c_1 P + c_3 B - c_2 \varepsilon f_{wall})\]</div>
<p>To ensure positivity we use Patankar-type time discretization: all source
terms are treated explicitly and sink terms are treated implicitly.
To this end the buoyancy production term <span class="math notranslate nohighlight">\(c_3 B\)</span> is split in two:</p>
<div class="math notranslate nohighlight">
\[F_\psi = \frac{\psi^n}{k^n} (c_1 P + B_{source})
    + \frac{\psi^{n+1}}{k^n} (B_{sink} - c_2 \varepsilon f_{wall})\]</div>
<p>with <span class="math notranslate nohighlight">\(B_{source} \ge 0\)</span> and <span class="math notranslate nohighlight">\(B_{sink} &lt; 0\)</span>.</p>
<p>Also implements Neumann boundary condition at top and bottom [7]</p>
<div class="math notranslate nohighlight">
\[\left( \frac{\nu}{\sigma_\psi} \frac{\psi}{z} \right)\Big|_{\Gamma_b} =
n_z \frac{\nu}{\sigma_\psi} (c_\mu^0)^p k^m \kappa^n (z_b + z_0)^{n-1}\]</div>
<p>where <span class="math notranslate nohighlight">\(z_b\)</span> is the distance from boundary, and <span class="math notranslate nohighlight">\(z_0\)</span> is the
roughness length.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>function_space</strong> – <code class="xref py py-class docutils literal notranslate"><span class="pre">FunctionSpace</span></code> where the solution belongs</p></li>
<li><p><strong>gls_model</strong> – <a class="reference internal" href="#thetis.turbulence.GenericLengthScaleModel" title="thetis.turbulence.GenericLengthScaleModel"><code class="xref py py-class docutils literal notranslate"><span class="pre">GenericLengthScaleModel</span></code></a> object</p></li>
<li><p><strong>bathymetry</strong> (3D <code class="xref py py-class docutils literal notranslate"><span class="pre">Function</span></code> or <code class="xref py py-class docutils literal notranslate"><span class="pre">Constant</span></code>) – bathymetry of the domain</p></li>
<li><p><strong>v_elem_size</strong> – scalar <code class="xref py py-class docutils literal notranslate"><span class="pre">Function</span></code> that defines the vertical
element size</p></li>
<li><p><strong>h_elem_size</strong> – scalar <code class="xref py py-class docutils literal notranslate"><span class="pre">Function</span></code> that defines the horizontal
element size</p></li>
</ul>
</dd>
</dl>
<dl class="py method">
<dt class="sig sig-object py" id="thetis.turbulence.PsiSourceTerm.residual">
<span class="sig-name descname"><span class="pre">residual</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">solution</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">solution_old</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fields</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fields_old</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">bnd_conditions</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/turbulence.html#PsiSourceTerm.residual"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#thetis.turbulence.PsiSourceTerm.residual" title="Link to this definition">¶</a></dt>
<dd><p>Returns an UFL form of the term.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>solution</strong> – solution <code class="xref py py-class docutils literal notranslate"><span class="pre">Function</span></code> of the corresponding equation</p></li>
<li><p><strong>solution_old</strong> – a time lagged solution <code class="xref py py-class docutils literal notranslate"><span class="pre">Function</span></code></p></li>
<li><p><strong>fields</strong> – a dictionary that provides all the remaining fields that the term depends on.
The keys of the dictionary should standard field names in <cite>field_metadata</cite></p></li>
<li><p><strong>fields_old</strong> – Time lagged dictionary of fields</p></li>
<li><p><strong>bnd_conditions</strong> – A dictionary describing boundary conditions.
E.g. {3: {‘elev_2d’: Constant(1.0)}} replaces elev_2d function by a constant on boundary ID 3.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="thetis.turbulence.ShearFrequencySolver">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">thetis.turbulence.</span></span><span class="sig-name descname"><span class="pre">ShearFrequencySolver</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">uv</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">m2</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mu</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mv</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mu_tmp</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">relaxation</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">minval</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1e-12</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/turbulence.html#ShearFrequencySolver"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#thetis.turbulence.ShearFrequencySolver" title="Link to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference external" href="https://docs.python.org/2.7/library/functions.html#object" title="(in Python v2.7)"><code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></a></p>
<p>Computes vertical shear frequency squared form the given horizontal
velocity field.</p>
<div class="math notranslate nohighlight">
\[M^2 = \left(\frac{\partial u}{\partial z}\right)^2
    + \left(\frac{\partial v}{\partial z}\right)^2\]</div>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>uv</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">Function</span></code>) – horizontal velocity field</p></li>
<li><p><strong>m2</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">Function</span></code>) – <span class="math notranslate nohighlight">\(M^2\)</span> field</p></li>
<li><p><strong>mu</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">Function</span></code>) – field for x component of <span class="math notranslate nohighlight">\(M^2\)</span></p></li>
<li><p><strong>mv</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">Function</span></code>) – field for y component of <span class="math notranslate nohighlight">\(M^2\)</span></p></li>
<li><p><strong>mu_tmp</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">Function</span></code>) – temporary field</p></li>
<li><p><strong>relaxation</strong> (<a class="reference external" href="https://docs.python.org/2.7/library/functions.html#float" title="(in Python v2.7)"><em>float</em></a>) – relaxation coefficient for mixing old and new values
M2 = relaxation*M2_new + (1-relaxation)*M2_old</p></li>
<li><p><strong>minval</strong> (<a class="reference external" href="https://docs.python.org/2.7/library/functions.html#float" title="(in Python v2.7)"><em>float</em></a>) – minimum value for <span class="math notranslate nohighlight">\(M^2\)</span></p></li>
</ul>
</dd>
</dl>
<dl class="py method">
<dt class="sig sig-object py" id="thetis.turbulence.ShearFrequencySolver.solve">
<span class="sig-name descname"><span class="pre">solve</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">init_solve</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/turbulence.html#ShearFrequencySolver.solve"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#thetis.turbulence.ShearFrequencySolver.solve" title="Link to this definition">¶</a></dt>
<dd><p>Computes buoyancy frequency</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>init_solve</strong> (<a class="reference external" href="https://docs.python.org/2.7/library/functions.html#bool" title="(in Python v2.7)"><em>bool</em></a>) – Set to True if solving for the first time, skips
relaxation</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="thetis.turbulence.TKEEquation">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">thetis.turbulence.</span></span><span class="sig-name descname"><span class="pre">TKEEquation</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">function_space</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">gls_model</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">bathymetry</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">v_elem_size</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">h_elem_size</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/turbulence.html#TKEEquation"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#thetis.turbulence.TKEEquation" title="Link to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#thetis.equation.Equation" title="thetis.equation.Equation"><code class="xref py py-class docutils literal notranslate"><span class="pre">Equation</span></code></a></p>
<p>Turbulent kinetic energy equation <a class="reference internal" href="#equation-turb-tke-eq">(18)</a> without advection terms.</p>
<p>Advection of TKE is implemented using the standard tracer equation.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>function_space</strong> – <code class="xref py py-class docutils literal notranslate"><span class="pre">FunctionSpace</span></code> where the solution belongs</p></li>
<li><p><strong>gls_model</strong> – <a class="reference internal" href="#thetis.turbulence.GenericLengthScaleModel" title="thetis.turbulence.GenericLengthScaleModel"><code class="xref py py-class docutils literal notranslate"><span class="pre">GenericLengthScaleModel</span></code></a> object</p></li>
<li><p><strong>bathymetry</strong> (3D <code class="xref py py-class docutils literal notranslate"><span class="pre">Function</span></code> or <code class="xref py py-class docutils literal notranslate"><span class="pre">Constant</span></code>) – bathymetry of the domain</p></li>
<li><p><strong>v_elem_size</strong> – scalar <code class="xref py py-class docutils literal notranslate"><span class="pre">Function</span></code> that defines the vertical
element size</p></li>
<li><p><strong>h_elem_size</strong> – scalar <code class="xref py py-class docutils literal notranslate"><span class="pre">Function</span></code> that defines the horizontal
element size</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="thetis.turbulence.TKESourceTerm">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">thetis.turbulence.</span></span><span class="sig-name descname"><span class="pre">TKESourceTerm</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">function_space</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">gls_model</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">bathymetry</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">v_elem_size</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">h_elem_size</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/turbulence.html#TKESourceTerm"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#thetis.turbulence.TKESourceTerm" title="Link to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#thetis.tracer_eq.TracerTerm" title="thetis.tracer_eq.TracerTerm"><code class="xref py py-class docutils literal notranslate"><span class="pre">TracerTerm</span></code></a></p>
<p>Production and destruction terms of the TKE equation <a class="reference internal" href="#equation-turb-tke-eq">(18)</a></p>
<div class="math notranslate nohighlight">
\[F_k = P + B - \varepsilon\]</div>
<p>To ensure positivity we use Patankar-type time discretization: all source
terms are treated explicitly and sink terms are treated implicitly.
To this end the buoyancy production term <span class="math notranslate nohighlight">\(B\)</span> is split in two:</p>
<div class="math notranslate nohighlight">
\[F_k = P + B_{source} + \frac{k^{n+1}}{k^n}(B_{sink} - \varepsilon)\]</div>
<p>with <span class="math notranslate nohighlight">\(B_{source} \ge 0\)</span> and <span class="math notranslate nohighlight">\(B_{sink} &lt; 0\)</span>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>function_space</strong> – <code class="xref py py-class docutils literal notranslate"><span class="pre">FunctionSpace</span></code> where the solution belongs</p></li>
<li><p><strong>gls_model</strong> – <a class="reference internal" href="#thetis.turbulence.GenericLengthScaleModel" title="thetis.turbulence.GenericLengthScaleModel"><code class="xref py py-class docutils literal notranslate"><span class="pre">GenericLengthScaleModel</span></code></a> object</p></li>
<li><p><strong>bathymetry</strong> (3D <code class="xref py py-class docutils literal notranslate"><span class="pre">Function</span></code> or <code class="xref py py-class docutils literal notranslate"><span class="pre">Constant</span></code>) – bathymetry of the domain</p></li>
<li><p><strong>v_elem_size</strong> – scalar <code class="xref py py-class docutils literal notranslate"><span class="pre">Function</span></code> that defines the vertical
element size</p></li>
<li><p><strong>h_elem_size</strong> – scalar <code class="xref py py-class docutils literal notranslate"><span class="pre">Function</span></code> that defines the horizontal
element size</p></li>
</ul>
</dd>
</dl>
<dl class="py method">
<dt class="sig sig-object py" id="thetis.turbulence.TKESourceTerm.residual">
<span class="sig-name descname"><span class="pre">residual</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">solution</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">solution_old</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fields</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fields_old</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">bnd_conditions</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/turbulence.html#TKESourceTerm.residual"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#thetis.turbulence.TKESourceTerm.residual" title="Link to this definition">¶</a></dt>
<dd><p>Returns an UFL form of the term.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>solution</strong> – solution <code class="xref py py-class docutils literal notranslate"><span class="pre">Function</span></code> of the corresponding equation</p></li>
<li><p><strong>solution_old</strong> – a time lagged solution <code class="xref py py-class docutils literal notranslate"><span class="pre">Function</span></code></p></li>
<li><p><strong>fields</strong> – a dictionary that provides all the remaining fields that the term depends on.
The keys of the dictionary should standard field names in <cite>field_metadata</cite></p></li>
<li><p><strong>fields_old</strong> – Time lagged dictionary of fields</p></li>
<li><p><strong>bnd_conditions</strong> – A dictionary describing boundary conditions.
E.g. {3: {‘elev_2d’: Constant(1.0)}} replaces elev_2d function by a constant on boundary ID 3.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="thetis.turbulence.TurbulenceModel">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">thetis.turbulence.</span></span><span class="sig-name descname"><span class="pre">TurbulenceModel</span></span><a class="reference internal" href="_modules/thetis/turbulence.html#TurbulenceModel"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#thetis.turbulence.TurbulenceModel" title="Link to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">ABC</span></code></p>
<p>Base class for all vertical turbulence models</p>
<dl class="py method">
<dt class="sig sig-object py" id="thetis.turbulence.TurbulenceModel.initialize">
<em class="property"><span class="pre">abstract</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">initialize</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/turbulence.html#TurbulenceModel.initialize"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#thetis.turbulence.TurbulenceModel.initialize" title="Link to this definition">¶</a></dt>
<dd><p>Initialize all turbulence fields</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="thetis.turbulence.TurbulenceModel.postprocess">
<em class="property"><span class="pre">abstract</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">postprocess</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/turbulence.html#TurbulenceModel.postprocess"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#thetis.turbulence.TurbulenceModel.postprocess" title="Link to this definition">¶</a></dt>
<dd><p>Updates all diagnostic variables that depend on the turbulence state
variables.</p>
<p>To be called after updating the turbulence PDEs.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="thetis.turbulence.TurbulenceModel.preprocess">
<em class="property"><span class="pre">abstract</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">preprocess</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">init_solve</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/turbulence.html#TurbulenceModel.preprocess"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#thetis.turbulence.TurbulenceModel.preprocess" title="Link to this definition">¶</a></dt>
<dd><p>Computes all diagnostic variables that depend on the mean flow model
variables.</p>
<p>To be called before updating the turbulence PDEs.</p>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="thetis.turbulence.VerticalGradSolver">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">thetis.turbulence.</span></span><span class="sig-name descname"><span class="pre">VerticalGradSolver</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">source</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">solution</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">solver_parameters</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/turbulence.html#VerticalGradSolver"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#thetis.turbulence.VerticalGradSolver" title="Link to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference external" href="https://docs.python.org/2.7/library/functions.html#object" title="(in Python v2.7)"><code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></a></p>
<p>Computes vertical gradient in the weak sense.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>source</strong> – A <code class="xref py py-class docutils literal notranslate"><span class="pre">Function</span></code> or expression to differentiate.</p></li>
<li><p><strong>solution</strong> – A <code class="xref py py-class docutils literal notranslate"><span class="pre">Function</span></code> where the solution will be stored.
Must be in P0 space.</p></li>
<li><p><strong>solver_parameters</strong> (<a class="reference external" href="https://docs.python.org/2.7/library/stdtypes.html#dict" title="(in Python v2.7)"><em>dict</em></a>) – PETSc solver options</p></li>
</ul>
</dd>
</dl>
<dl class="py method">
<dt class="sig sig-object py" id="thetis.turbulence.VerticalGradSolver.solve">
<span class="sig-name descname"><span class="pre">solve</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/turbulence.html#VerticalGradSolver.solve"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#thetis.turbulence.VerticalGradSolver.solve" title="Link to this definition">¶</a></dt>
<dd><p>Computes the gradient</p>
</dd></dl>

</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="thetis.turbulence.set_func_max_val">
<span class="sig-prename descclassname"><span class="pre">thetis.turbulence.</span></span><span class="sig-name descname"><span class="pre">set_func_max_val</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">f</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">maxval</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/turbulence.html#set_func_max_val"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#thetis.turbulence.set_func_max_val" title="Link to this definition">¶</a></dt>
<dd><p>Sets a minimum value to a <code class="xref py py-class docutils literal notranslate"><span class="pre">Function</span></code></p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="thetis.turbulence.set_func_min_val">
<span class="sig-prename descclassname"><span class="pre">thetis.turbulence.</span></span><span class="sig-name descname"><span class="pre">set_func_min_val</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">f</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">minval</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/turbulence.html#set_func_min_val"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#thetis.turbulence.set_func_min_val" title="Link to this definition">¶</a></dt>
<dd><p>Sets a minimum value to a <code class="xref py py-class docutils literal notranslate"><span class="pre">Function</span></code></p>
</dd></dl>

</section>
<section id="module-thetis.utility">
<span id="thetis-utility-module"></span><h2>thetis.utility module<a class="headerlink" href="#module-thetis.utility" title="Link to this heading">¶</a></h2>
<p>Utility functions and classes for 2D and 3D ocean models</p>
<dl class="py class">
<dt class="sig sig-object py" id="thetis.utility.AttrDict">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">thetis.utility.</span></span><span class="sig-name descname"><span class="pre">AttrDict</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/utility.html#AttrDict"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#thetis.utility.AttrDict" title="Link to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference external" href="https://docs.python.org/2.7/library/stdtypes.html#dict" title="(in Python v2.7)"><code class="xref py py-class docutils literal notranslate"><span class="pre">dict</span></code></a></p>
<p>Dictionary that provides both self[‘key’] and self.key access to members.</p>
<p><a class="reference external" href="http://stackoverflow.com/questions/4984647/accessing-dict-keys-like-an-attribute-in-python">http://stackoverflow.com/questions/4984647/accessing-dict-keys-like-an-attribute-in-python</a></p>
</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="thetis.utility.DepthExpression">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">thetis.utility.</span></span><span class="sig-name descname"><span class="pre">DepthExpression</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">bathymetry_2d</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">use_nonlinear_equations</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">use_wetting_and_drying</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">wetting_and_drying_alpha</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.5</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/utility.html#DepthExpression"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#thetis.utility.DepthExpression" title="Link to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference external" href="https://docs.python.org/2.7/library/functions.html#object" title="(in Python v2.7)"><code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></a></p>
<blockquote>
<div><p>Construct expression for depth depending on options</p>
<p>If <cite>not use_nonlinear_equations</cite>, then the depth is simply the bathymetry:</p>
</div></blockquote>
<dl>
<dt>..math::</dt><dd><blockquote>
<div><p>H = h</p>
</div></blockquote>
<p>Otherwise we include the free surface elevation:</p>
</dd>
<dt>..math::</dt><dd><blockquote>
<div><p>H = h + eta</p>
</div></blockquote>
<p>and if <cite>use_wetting_and_drying</cite>, includes a bathymetry displacement term
to ensure a positive depth (see Karna et al. 2011):</p>
</dd>
<dt>..math::</dt><dd><blockquote>
<div><p>H = h + f(h+eta) + eta</p>
</div></blockquote>
<p>where</p>
</dd>
<dt>..math::</dt><dd><blockquote>
<div><p>f(h+eta) = (sqrt{(h+eta)^2 +alpha^2} - (h+eta))/2</p>
</div></blockquote>
<p>This introduces a wetting-drying parameter <span class="math notranslate nohighlight">\(\alpha\)</span>, with dimensions
of length. The value for <span class="math notranslate nohighlight">\(\alpha\)</span> is specified by
<code class="xref py py-attr docutils literal notranslate"><span class="pre">ModelOptions.wetting_and_drying_alpha</span></code>, in units of meters. The
default value is 0.5, but the appropriate value is problem specific and
should be set by the user.</p>
</dd>
</dl>
<dl class="py method">
<dt class="sig sig-object py" id="thetis.utility.DepthExpression.get_total_depth">
<span class="sig-name descname"><span class="pre">get_total_depth</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">eta</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/utility.html#DepthExpression.get_total_depth"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#thetis.utility.DepthExpression.get_total_depth" title="Link to this definition">¶</a></dt>
<dd><p>Returns total water column depth based on options
:arg eta: current elevation as UFL expression</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="thetis.utility.DepthExpression.wd_bathymetry_displacement">
<span class="sig-name descname"><span class="pre">wd_bathymetry_displacement</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">eta</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/utility.html#DepthExpression.wd_bathymetry_displacement"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#thetis.utility.DepthExpression.wd_bathymetry_displacement" title="Link to this definition">¶</a></dt>
<dd><p>Returns wetting and drying bathymetry displacement as described in:
Karna et al.,  2011.
:arg eta: current elevation as UFL expression</p>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="thetis.utility.DepthIntegratedPoissonSolver">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">thetis.utility.</span></span><span class="sig-name descname"><span class="pre">DepthIntegratedPoissonSolver</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">q_2d</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">uv_2d</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">w_2d</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">elev_2d</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">depth</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dt</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">bnd_functions</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">solver_parameters</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/utility.html#DepthIntegratedPoissonSolver"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#thetis.utility.DepthIntegratedPoissonSolver" title="Link to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference external" href="https://docs.python.org/2.7/library/functions.html#object" title="(in Python v2.7)"><code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></a></p>
<p>Construct solvers for Poisson equation and updating velocities</p>
<p>Poisson equation is related to 2d NH SWE system</p>
<p>Non-hydrostatic pressure <span class="math notranslate nohighlight">\(q\)</span> is obtained from the generic form of equation</p>
<div class="math notranslate nohighlight">
\[\nabla \cdot \nabla q^{n+1/2} + A \cdot \nabla q^{n+1/2} + B q^{n+1/2} + C = 0\]</div>
<p>The parameter terms A, B and C are defined as</p>
<div class="math notranslate nohighlight">
\[A = \frac{\nabla (\eta^* - d)}{H^*}
B = \nabla A - \frac{4}{(H^*)^2}
C = -2 \frac{\rho_0}{\Delta t} ( \nabla \cdot \bar{\textbf{u}}^* + 2 \frac{\bar{w} - w_b}{H^*} )\]</div>
<p>where the <span class="math notranslate nohighlight">\(H = \eta + d\)</span> denotes the water depth
and the superscript star symbol represents the intermediate level of terms.</p>
<dl class="py method">
<dt class="sig sig-object py" id="thetis.utility.DepthIntegratedPoissonSolver.solve">
<span class="sig-name descname"><span class="pre">solve</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">solve_w</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/utility.html#DepthIntegratedPoissonSolver.solve"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#thetis.utility.DepthIntegratedPoissonSolver.solve" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="thetis.utility.ElementContinuity">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">thetis.utility.</span></span><span class="sig-name descname"><span class="pre">ElementContinuity</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">horizontal</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">vertical</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#thetis.utility.ElementContinuity" title="Link to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">tuple</span></code></p>
<p>A named tuple describing the continuity of an element in the horizontal/vertical direction.</p>
<p>The field value is one of “cg”, “hdiv”, or “dg”.</p>
<dl class="py attribute">
<dt class="sig sig-object py" id="thetis.utility.ElementContinuity.horizontal">
<span class="sig-name descname"><span class="pre">horizontal</span></span><a class="headerlink" href="#thetis.utility.ElementContinuity.horizontal" title="Link to this definition">¶</a></dt>
<dd><p>Alias for field number 0</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="thetis.utility.ElementContinuity.vertical">
<span class="sig-name descname"><span class="pre">vertical</span></span><a class="headerlink" href="#thetis.utility.ElementContinuity.vertical" title="Link to this definition">¶</a></dt>
<dd><p>Alias for field number 1</p>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="thetis.utility.ExtrudedFunction">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">thetis.utility.</span></span><span class="sig-name descname"><span class="pre">ExtrudedFunction</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/utility.html#ExtrudedFunction"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#thetis.utility.ExtrudedFunction" title="Link to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference external" href="https://www.firedrakeproject.org/firedrake.html#firedrake.function.Function" title="(in Firedrake v0.12)"><code class="xref py py-class docutils literal notranslate"><span class="pre">Function</span></code></a></p>
<p>A 2D <code class="xref py py-class docutils literal notranslate"><span class="pre">Function</span></code> that provides a 3D view on the extruded domain.</p>
<p>The 3D function can be accessed as <cite>ExtrudedFunction.view_3d</cite>.
The 3D function resides in V x R function space, where V is the function
space of the source function. The 3D function shares the data of the 2D
function.</p>
<p>Create a 2D <code class="xref py py-class docutils literal notranslate"><span class="pre">Function</span></code> with a 3D view on extruded mesh.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>mesh_3d</strong> – Extruded 3D mesh where the function will be extended to.</p>
</dd>
</dl>
</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="thetis.utility.FieldDict">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">thetis.utility.</span></span><span class="sig-name descname"><span class="pre">FieldDict</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/utility.html#FieldDict"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#thetis.utility.FieldDict" title="Link to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#thetis.utility.AttrDict" title="thetis.utility.AttrDict"><code class="xref py py-class docutils literal notranslate"><span class="pre">AttrDict</span></code></a></p>
<p>AttrDict that checks that all added fields have proper meta data.</p>
<p>Values can be either Function or Constant objects.</p>
</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="thetis.utility.FrozenClass">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">thetis.utility.</span></span><span class="sig-name descname"><span class="pre">FrozenClass</span></span><a class="reference internal" href="_modules/thetis/utility.html#FrozenClass"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#thetis.utility.FrozenClass" title="Link to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference external" href="https://docs.python.org/2.7/library/functions.html#object" title="(in Python v2.7)"><code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></a></p>
<p>A class where creating a new attribute will raise an exception if
<code class="xref py py-attr docutils literal notranslate"><span class="pre">_isfrozen</span></code> is <code class="docutils literal notranslate"><span class="pre">True</span></code>.</p>
<p><code class="xref py py-attr docutils literal notranslate"><span class="pre">_unfreezedepth</span></code> allows for multiple applications of the
<code class="docutils literal notranslate"><span class="pre">unfrozen</span></code> decorator.</p>
</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="thetis.utility.SubdomainProjector">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">thetis.utility.</span></span><span class="sig-name descname"><span class="pre">SubdomainProjector</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">v</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">v_out</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">subdomain_id</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">solver_parameters</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">constant_jacobian</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/utility.html#SubdomainProjector"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#thetis.utility.SubdomainProjector" title="Link to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference external" href="https://docs.python.org/2.7/library/functions.html#object" title="(in Python v2.7)"><code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></a></p>
<p>Projector that projects the restriction of an expression to the specified subdomain.</p>
<dl class="py method">
<dt class="sig sig-object py" id="thetis.utility.SubdomainProjector.project">
<span class="sig-name descname"><span class="pre">project</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/utility.html#SubdomainProjector.project"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#thetis.utility.SubdomainProjector.project" title="Link to this definition">¶</a></dt>
<dd><p>Apply the projection.</p>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="thetis.utility.SumFunction">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">thetis.utility.</span></span><span class="sig-name descname"><span class="pre">SumFunction</span></span><a class="reference internal" href="_modules/thetis/utility.html#SumFunction"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#thetis.utility.SumFunction" title="Link to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference external" href="https://docs.python.org/2.7/library/functions.html#object" title="(in Python v2.7)"><code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></a></p>
<p>Helper class to keep track of sum of Coefficients.</p>
<p>Initialize empty sum.</p>
<p>get operation returns Constant(0)</p>
<dl class="py method">
<dt class="sig sig-object py" id="thetis.utility.SumFunction.add">
<span class="sig-name descname"><span class="pre">add</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">coeff</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/utility.html#SumFunction.add"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#thetis.utility.SumFunction.add" title="Link to this definition">¶</a></dt>
<dd><p>Adds a coefficient to self</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="thetis.utility.SumFunction.get_sum">
<span class="sig-name descname"><span class="pre">get_sum</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/utility.html#SumFunction.get_sum"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#thetis.utility.SumFunction.get_sum" title="Link to this definition">¶</a></dt>
<dd><p>Returns a sum of all added Coefficients</p>
</dd></dl>

</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="thetis.utility.anisotropic_cell_size">
<span class="sig-prename descclassname"><span class="pre">thetis.utility.</span></span><span class="sig-name descname"><span class="pre">anisotropic_cell_size</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">mesh</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/utility.html#anisotropic_cell_size"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#thetis.utility.anisotropic_cell_size" title="Link to this definition">¶</a></dt>
<dd><p>Measure of cell size for anisotropic meshes, as described in
Micheletti et al. (2003).</p>
<p>This is used in the SUPG formulation for the 2D tracer model.</p>
<p>Micheletti, Perotto and Picasso (2003). Stabilized finite
elements on anisotropic meshes: a priori error estimates for
the advection-diffusion and the Stokes problems. SIAM Journal
on Numerical Analysis 41.3: 1131-1162.</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="thetis.utility.beta_plane_coriolis_function">
<span class="sig-prename descclassname"><span class="pre">thetis.utility.</span></span><span class="sig-name descname"><span class="pre">beta_plane_coriolis_function</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">latitude</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">out_function</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y_offset</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.0</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/utility.html#beta_plane_coriolis_function"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#thetis.utility.beta_plane_coriolis_function" title="Link to this definition">¶</a></dt>
<dd><p>Interpolates beta plane Coriolis function to a field</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>latitude</strong> (<a class="reference external" href="https://docs.python.org/2.7/library/functions.html#float" title="(in Python v2.7)"><em>float</em></a>) – latitude in degrees</p></li>
<li><p><strong>out_function</strong> – <code class="xref py py-class docutils literal notranslate"><span class="pre">Function</span></code> where to interpolate</p></li>
<li><p><strong>y_offset</strong> (<a class="reference external" href="https://docs.python.org/2.7/library/functions.html#float" title="(in Python v2.7)"><em>float</em></a>) – offset (y - y_0) used in Beta-plane approximation.
A constant in mesh coordinates.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="thetis.utility.beta_plane_coriolis_params">
<span class="sig-prename descclassname"><span class="pre">thetis.utility.</span></span><span class="sig-name descname"><span class="pre">beta_plane_coriolis_params</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">latitude</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/utility.html#beta_plane_coriolis_params"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#thetis.utility.beta_plane_coriolis_params" title="Link to this definition">¶</a></dt>
<dd><p>Computes beta plane parameters <span class="math notranslate nohighlight">\(f_0,\beta\)</span> based on latitude</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>latitude</strong> (<a class="reference external" href="https://docs.python.org/2.7/library/functions.html#float" title="(in Python v2.7)"><em>float</em></a>) – latitude in degrees</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>f_0, beta</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference external" href="https://docs.python.org/2.7/library/functions.html#float" title="(in Python v2.7)">float</a></p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="thetis.utility.comp_tracer_mass_2d">
<span class="sig-prename descclassname"><span class="pre">thetis.utility.</span></span><span class="sig-name descname"><span class="pre">comp_tracer_mass_2d</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">scalar_func</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">total_depth</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/utility.html#comp_tracer_mass_2d"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#thetis.utility.comp_tracer_mass_2d" title="Link to this definition">¶</a></dt>
<dd><p>Computes total tracer mass in the 2D domain
:arg scalar_func: depth-averaged scalar <code class="xref py py-class docutils literal notranslate"><span class="pre">Function</span></code> to integrate
:arg total_depth: scalar UFL expression (e.g. from get_total_depth())</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="thetis.utility.comp_tracer_mass_3d">
<span class="sig-prename descclassname"><span class="pre">thetis.utility.</span></span><span class="sig-name descname"><span class="pre">comp_tracer_mass_3d</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">scalar_func</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/utility.html#comp_tracer_mass_3d"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#thetis.utility.comp_tracer_mass_3d" title="Link to this definition">¶</a></dt>
<dd><p>Computes total tracer mass in the 3D domain</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>scalar_func</strong> – scalar <code class="xref py py-class docutils literal notranslate"><span class="pre">Function</span></code> to integrate</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="thetis.utility.comp_volume_2d">
<span class="sig-prename descclassname"><span class="pre">thetis.utility.</span></span><span class="sig-name descname"><span class="pre">comp_volume_2d</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">eta</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">bath</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/utility.html#comp_volume_2d"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#thetis.utility.comp_volume_2d" title="Link to this definition">¶</a></dt>
<dd><p>Computes volume of the 2D domain as an integral of the elevation field</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="thetis.utility.comp_volume_3d">
<span class="sig-prename descclassname"><span class="pre">thetis.utility.</span></span><span class="sig-name descname"><span class="pre">comp_volume_3d</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">mesh</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/utility.html#comp_volume_3d"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#thetis.utility.comp_volume_3d" title="Link to this definition">¶</a></dt>
<dd><p>Computes volume of the 3D domain as an integral</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="thetis.utility.compute_baroclinic_head">
<span class="sig-prename descclassname"><span class="pre">thetis.utility.</span></span><span class="sig-name descname"><span class="pre">compute_baroclinic_head</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">solver</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/utility.html#compute_baroclinic_head"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#thetis.utility.compute_baroclinic_head" title="Link to this definition">¶</a></dt>
<dd><p>Computes the baroclinic head <span class="math notranslate nohighlight">\(r\)</span> from the density field</p>
<div class="math notranslate nohighlight">
\[r = \frac{1}{\rho_0} \int_{z}^\eta  \rho' d\zeta.\]</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="thetis.utility.compute_boundary_length">
<span class="sig-prename descclassname"><span class="pre">thetis.utility.</span></span><span class="sig-name descname"><span class="pre">compute_boundary_length</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">mesh2d</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/utility.html#compute_boundary_length"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#thetis.utility.compute_boundary_length" title="Link to this definition">¶</a></dt>
<dd><p>Computes the length of the boundary segments in given 2d mesh</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="thetis.utility.compute_elem_height">
<span class="sig-prename descclassname"><span class="pre">thetis.utility.</span></span><span class="sig-name descname"><span class="pre">compute_elem_height</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">zcoord</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">output</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/utility.html#compute_elem_height"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#thetis.utility.compute_elem_height" title="Link to this definition">¶</a></dt>
<dd><p>Computes the element height on an extruded mesh.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>zcoord</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">Function</span></code>) – field that contains the z coordinates of the mesh</p></li>
<li><p><strong>output</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">Function</span></code>) – field where element height is stored</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="thetis.utility.create_directory">
<span class="sig-prename descclassname"><span class="pre">thetis.utility.</span></span><span class="sig-name descname"><span class="pre">create_directory</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">path</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">comm=&lt;mpi4py.MPI.Intracomm</span> <span class="pre">object&gt;</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/utility.html#create_directory"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#thetis.utility.create_directory" title="Link to this definition">¶</a></dt>
<dd><p>Create a directory on disk</p>
<p>Raises IOError if a file with the same name already exists.</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="thetis.utility.domain_constant">
<span class="sig-prename descclassname"><span class="pre">thetis.utility.</span></span><span class="sig-name descname"><span class="pre">domain_constant</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">value</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mesh</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/utility.html#domain_constant"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#thetis.utility.domain_constant" title="Link to this definition">¶</a></dt>
<dd><p>Create constant over a domain</p>
<p>Returns what used to be Constant(value, domain=mesh)</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="thetis.utility.element_continuity">
<span class="sig-prename descclassname"><span class="pre">thetis.utility.</span></span><span class="sig-name descname"><span class="pre">element_continuity</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">ufl_element</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/utility.html#element_continuity"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#thetis.utility.element_continuity" title="Link to this definition">¶</a></dt>
<dd><p>Return an <a class="reference internal" href="#thetis.utility.ElementContinuity" title="thetis.utility.ElementContinuity"><code class="xref py py-class docutils literal notranslate"><span class="pre">ElementContinuity</span></code></a> instance with the
continuity of a given element.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>ufl_element</strong> – The UFL element to determine the continuity
of.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>A new <a class="reference internal" href="#thetis.utility.ElementContinuity" title="thetis.utility.ElementContinuity"><code class="xref py py-class docutils literal notranslate"><span class="pre">ElementContinuity</span></code></a> instance.</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="thetis.utility.extend_function_to_3d">
<span class="sig-prename descclassname"><span class="pre">thetis.utility.</span></span><span class="sig-name descname"><span class="pre">extend_function_to_3d</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">func</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mesh_extruded</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/utility.html#extend_function_to_3d"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#thetis.utility.extend_function_to_3d" title="Link to this definition">¶</a></dt>
<dd><p>Returns a 3D view of a 2D <code class="xref py py-class docutils literal notranslate"><span class="pre">Function</span></code> on the extruded domain.</p>
<p>The 3D function resides in V x R function space, where V is the function
space of the source function. The 3D function shares the data of the 2D
function.</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="thetis.utility.extrude_mesh_sigma">
<span class="sig-prename descclassname"><span class="pre">thetis.utility.</span></span><span class="sig-name descname"><span class="pre">extrude_mesh_sigma</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">mesh2d</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n_layers</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">bathymetry_2d</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">z_stretch_fact</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">min_depth</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/utility.html#extrude_mesh_sigma"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#thetis.utility.extrude_mesh_sigma" title="Link to this definition">¶</a></dt>
<dd><p>Extrudes a 2d surface mesh with bathymetry data defined in a 2d field.</p>
<p>Generates a uniform terrain following mesh.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>mesh2d</strong> – 2D mesh</p></li>
<li><p><strong>n_layers</strong> – number of vertical layers</p></li>
<li><p><strong>bathymetry</strong> – 2D <code class="xref py py-class docutils literal notranslate"><span class="pre">Function</span></code> of the bathymetry
(the depth of the domain; positive downwards)</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="thetis.utility.form2indicator">
<span class="sig-prename descclassname"><span class="pre">thetis.utility.</span></span><span class="sig-name descname"><span class="pre">form2indicator</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">F</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/utility.html#form2indicator"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#thetis.utility.form2indicator" title="Link to this definition">¶</a></dt>
<dd><p>Deduce the cell-wise contributions to a functional.</p>
<p>Given a 0-form, multiply the integrand of each of its integrals by a
<span class="math notranslate nohighlight">\(\mathbb P0\)</span> test function and reassemble to give an element-wise error
indicator.</p>
<p>Note that a 0-form does not contain any <code class="xref py py-class docutils literal notranslate"><span class="pre">firedrake.ufl_expr.TestFunction</span></code>s
or <code class="xref py py-class docutils literal notranslate"><span class="pre">firedrake.ufl_expr.TrialFunction</span></code>s.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>F</strong> – the 0-form</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>the corresponding error indicator field</p>
</dd>
</dl>
<p>Modified code based on
<a class="reference external" href="https://github.com/pyroteus/goalie/blob/main/goalie/error_estimation.py">https://github.com/pyroteus/goalie/blob/main/goalie/error_estimation.py</a></p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="thetis.utility.get_cell_widths_2d">
<span class="sig-prename descclassname"><span class="pre">thetis.utility.</span></span><span class="sig-name descname"><span class="pre">get_cell_widths_2d</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">mesh2d</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/utility.html#get_cell_widths_2d"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#thetis.utility.get_cell_widths_2d" title="Link to this definition">¶</a></dt>
<dd><p>Compute widths of mesh elements in each coordinate direction as the maximum distance
between components of vertex coordinates.</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="thetis.utility.get_extruded_base_element">
<span class="sig-prename descclassname"><span class="pre">thetis.utility.</span></span><span class="sig-name descname"><span class="pre">get_extruded_base_element</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">ufl_element</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/utility.html#get_extruded_base_element"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#thetis.utility.get_extruded_base_element" title="Link to this definition">¶</a></dt>
<dd><p>Return UFL TensorProductElement of an extruded UFL element.</p>
<p>In case of a non-extruded mesh, returns the element itself.</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="thetis.utility.get_facet_areas">
<span class="sig-prename descclassname"><span class="pre">thetis.utility.</span></span><span class="sig-name descname"><span class="pre">get_facet_areas</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">mesh</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/utility.html#get_facet_areas"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#thetis.utility.get_facet_areas" title="Link to this definition">¶</a></dt>
<dd><p>Compute area of each facet of <cite>mesh</cite>. The facet areas are stored as a HDiv trace field.</p>
<dl class="simple">
<dt>NOTES:</dt><dd><ul class="simple">
<li><p>In the 2D case, this gives edge lengths.</p></li>
<li><p>The plus sign is arbitrary and could equally well be chosen as minus.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="thetis.utility.get_facet_mask">
<span class="sig-prename descclassname"><span class="pre">thetis.utility.</span></span><span class="sig-name descname"><span class="pre">get_facet_mask</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">function_space</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">facet</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'bottom'</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/utility.html#get_facet_mask"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#thetis.utility.get_facet_mask" title="Link to this definition">¶</a></dt>
<dd><p>Returns the top/bottom nodes of extruded 3D elements.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>function_space</strong> – Firedrake <code class="xref py py-class docutils literal notranslate"><span class="pre">FunctionSpace</span></code> object</p></li>
<li><p><strong>facet</strong> (<a class="reference external" href="https://docs.python.org/2.7/library/functions.html#str" title="(in Python v2.7)"><em>str</em></a>) – ‘top’ or ‘bottom’</p></li>
</ul>
</dd>
</dl>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>The definition of top/bottom depends on the direction of the extrusion.
Here we assume that the mesh has been extruded upwards (along positive
z axis).</p>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="thetis.utility.get_functionspace">
<span class="sig-prename descclassname"><span class="pre">thetis.utility.</span></span><span class="sig-name descname"><span class="pre">get_functionspace</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">mesh</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">h_family</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">h_degree</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">v_family</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">v_degree</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">vector</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">tensor</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">hdiv</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">variant</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">v_variant</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/utility.html#get_functionspace"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#thetis.utility.get_functionspace" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="thetis.utility.get_horizontal_elem_size_2d">
<span class="sig-prename descclassname"><span class="pre">thetis.utility.</span></span><span class="sig-name descname"><span class="pre">get_horizontal_elem_size_2d</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">sol2d</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/utility.html#get_horizontal_elem_size_2d"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#thetis.utility.get_horizontal_elem_size_2d" title="Link to this definition">¶</a></dt>
<dd><p>Computes horizontal element size from the 2D mesh</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>sol2d</strong> – 2D <code class="xref py py-class docutils literal notranslate"><span class="pre">Function</span></code> where result is stored</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="thetis.utility.get_minimum_angles_2d">
<span class="sig-prename descclassname"><span class="pre">thetis.utility.</span></span><span class="sig-name descname"><span class="pre">get_minimum_angles_2d</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">mesh2d</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/utility.html#get_minimum_angles_2d"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#thetis.utility.get_minimum_angles_2d" title="Link to this definition">¶</a></dt>
<dd><p>Compute the minimum angle in each element of a triangular mesh, <cite>mesh2d</cite>, using the
cosine rule. The minimum angles are outputted as a P0 field.</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="thetis.utility.get_zcoord_from_mesh">
<span class="sig-prename descclassname"><span class="pre">thetis.utility.</span></span><span class="sig-name descname"><span class="pre">get_zcoord_from_mesh</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">zcoord</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">solver_parameters</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/utility.html#get_zcoord_from_mesh"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#thetis.utility.get_zcoord_from_mesh" title="Link to this definition">¶</a></dt>
<dd><p>Evaluates z coordinates from the 3D mesh</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>zcoord</strong> – scalar <code class="xref py py-class docutils literal notranslate"><span class="pre">Function</span></code> where coordinates will be stored</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="thetis.utility.print_function_value_range">
<span class="sig-prename descclassname"><span class="pre">thetis.utility.</span></span><span class="sig-name descname"><span class="pre">print_function_value_range</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">f</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">comm=&lt;mpi4py.MPI.Intracomm</span> <span class="pre">object&gt;</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">name=None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">prefix=None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">format='2.3g'</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/utility.html#print_function_value_range"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#thetis.utility.print_function_value_range" title="Link to this definition">¶</a></dt>
<dd><p>Prints the min/max DOF values of a function.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">print_function_value_range</span><span class="p">(</span><span class="n">f</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="s1">&#39;myfunc&#39;</span><span class="p">,</span> <span class="n">prefix</span><span class="o">=</span><span class="s1">&#39;Initial&#39;</span><span class="p">)</span>
</pre></div>
</div>
<p>Prints <cite>Initial myfunc 0.00 .. 0.00</cite>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>comm</strong> – MPI communicator to use for the reduction</p></li>
<li><p><strong>name</strong> – Optional function name. By default uses <cite>f.name()</cite></p></li>
<li><p><strong>prefix</strong> – Optional prefix for the output string</p></li>
<li><p><strong>format</strong> – Value formatting string</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="thetis.utility.read_mesh_from_checkpoint">
<span class="sig-prename descclassname"><span class="pre">thetis.utility.</span></span><span class="sig-name descname"><span class="pre">read_mesh_from_checkpoint</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">filename_or_outputdir</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mesh_name</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/utility.html#read_mesh_from_checkpoint"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#thetis.utility.read_mesh_from_checkpoint" title="Link to this definition">¶</a></dt>
<dd><p>Read mesh from a hdf5 checkpoint file.
:arg filename_or_outputdir: file name of the hdf5 checkpoint file,</p>
<blockquote>
<div><p>or the output directory used in the previous run that create the
checkpoint. In the latter case the mesh will be read from the
first file that’s found in outputdir/hdf5/<a href="#id1"><span class="problematic" id="id2">*</span></a>.h5</p>
</div></blockquote>
<p>When loading fields from a checkpoint file in a run, the mesh used in that
run needs to be read from that same checkpoint file.</p>
<p>When multiple checkpoint files are used as model inputs which have
been created in separate runs/scripts, make sure that only one of those
scripts created the original mesh (by reading a .msh file or using a mesh
creation utility like RectangleMesh) and all other script read their mesh
from the checkpoint created by that first script.  For example, a
preprocessing script might read in a .msh file and interpolate and smoothen
the bathymetry on that mesh and write out the result in a checkpoint. A
first Thetis run should read its mesh from that checkpoint, and may then
save a series of hdf5 files.  A second Thetis run can then read in the mesh
and bathymetry from the checkpoint of the preprocessing script, and call
load_state() to pick up from the previous run.</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="thetis.utility.select_and_move_detectors">
<span class="sig-prename descclassname"><span class="pre">thetis.utility.</span></span><span class="sig-name descname"><span class="pre">select_and_move_detectors</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">mesh</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">detector_locations</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">detector_names</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">maximum_distance</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.0</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/utility.html#select_and_move_detectors"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#thetis.utility.select_and_move_detectors" title="Link to this definition">¶</a></dt>
<dd><p>Select those detectors that are within the domain and/or move them to
the nearest cell centre within the domain</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>mesh</strong> – Defines the domain in which detectors are to be located</p></li>
<li><p><strong>detector_locations</strong> – List of x, y locations</p></li>
<li><p><strong>detector_names</strong> – List of detector names (optional). If provided, a list
of selected locations and a list of selected detector names are returned,
otherwise only a list of selected locations is returned</p></li>
<li><p><strong>maximum_distance</strong> – Detectors whose initial locations is outside the domain,
but for which the nearest cell centre is within the specified distance, are
moved to this location. By default a maximum distance of 0.0 is used, i.e
no detectors are moved.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="thetis.utility.tensor_jump">
<span class="sig-prename descclassname"><span class="pre">thetis.utility.</span></span><span class="sig-name descname"><span class="pre">tensor_jump</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">v</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/utility.html#tensor_jump"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#thetis.utility.tensor_jump" title="Link to this definition">¶</a></dt>
<dd><p>Jump term for vector functions based on the tensor product</p>
<div class="math notranslate nohighlight">
\[\text{jump}(\mathbf{u}, \mathbf{n}) = (\mathbf{u}^+ \mathbf{n}^+) +
(\mathbf{u}^- \mathbf{n}^-)\]</div>
<p>This is the discrete equivalent of grad(u) as opposed to the
vectorial UFL jump operator <span class="math notranslate nohighlight">\(ufl.jump\)</span> which represents div(u).</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="thetis.utility.unfrozen">
<span class="sig-prename descclassname"><span class="pre">thetis.utility.</span></span><span class="sig-name descname"><span class="pre">unfrozen</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">method</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/utility.html#unfrozen"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#thetis.utility.unfrozen" title="Link to this definition">¶</a></dt>
<dd><p>Decorator to temporarily unfreeze an object
whilst one of its methods is being called.</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="thetis.utility.vom_interpolator_functions">
<span class="sig-prename descclassname"><span class="pre">thetis.utility.</span></span><span class="sig-name descname"><span class="pre">vom_interpolator_functions</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">solver_obj</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">field_names</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">locations</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/utility.html#vom_interpolator_functions"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#thetis.utility.vom_interpolator_functions" title="Link to this definition">¶</a></dt>
<dd><p>Creates function spaces and associated Functions for interpolation
on a VertexOnlyMesh (VOM) and returns them for reuse.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>solver_obj</strong> – Thetis solver object</p></li>
<li><p><strong>field_names</strong> – List of field names to create functions for.</p></li>
<li><p><strong>locations</strong> – List of locations for interpolation.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>A dictionary mapping field names to a tuple of (f_at_points, f_at_input_points)
which are Functions for interpolation.</p>
</dd>
</dl>
</dd></dl>

</section>
<section id="module-thetis.utility3d">
<span id="thetis-utility3d-module"></span><h2>thetis.utility3d module<a class="headerlink" href="#module-thetis.utility3d" title="Link to this heading">¶</a></h2>
<p>Utility solvers and calculators for 3D hydrostatic ocean model</p>
<dl class="py class">
<dt class="sig sig-object py" id="thetis.utility3d.ALEMeshUpdater">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">thetis.utility3d.</span></span><span class="sig-name descname"><span class="pre">ALEMeshUpdater</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">solver</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/utility3d.html#ALEMeshUpdater"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#thetis.utility3d.ALEMeshUpdater" title="Link to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference external" href="https://docs.python.org/2.7/library/functions.html#object" title="(in Python v2.7)"><code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></a></p>
<p>Class that handles vertically moving ALE mesh</p>
<p>Mesh geometry is updated to match the elevation field
(<code class="docutils literal notranslate"><span class="pre">solver.fields.elev_2d</span></code>). First the discontinuous elevation field is
projected to continuous space, and this field is used to update the mesh
coordinates.</p>
<p>This class stores the reference coordinate field and keeps track of the
updated mesh coordinates. It also provides a method for computing the mesh
velocity from two adjacent elevation fields.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>solver</strong> – <code class="xref py py-class docutils literal notranslate"><span class="pre">FlowSolver</span></code> object</p>
</dd>
</dl>
<dl class="py method">
<dt class="sig sig-object py" id="thetis.utility3d.ALEMeshUpdater.compute_mesh_velocity_begin">
<span class="sig-name descname"><span class="pre">compute_mesh_velocity_begin</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/utility3d.html#ALEMeshUpdater.compute_mesh_velocity_begin"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#thetis.utility3d.ALEMeshUpdater.compute_mesh_velocity_begin" title="Link to this definition">¶</a></dt>
<dd><p>Stores the current 2D elevation state as the “old” field</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="thetis.utility3d.ALEMeshUpdater.compute_mesh_velocity_finalize">
<span class="sig-name descname"><span class="pre">compute_mesh_velocity_finalize</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">c</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">w_mesh_surf_expr</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/utility3d.html#ALEMeshUpdater.compute_mesh_velocity_finalize"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#thetis.utility3d.ALEMeshUpdater.compute_mesh_velocity_finalize" title="Link to this definition">¶</a></dt>
<dd><p>Computes mesh velocity from the elevation difference</p>
<p>Stores the current 2D elevation state as the “new” field,
and computes w_mesh using the given time step factor <code class="docutils literal notranslate"><span class="pre">c</span></code>.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="thetis.utility3d.ALEMeshUpdater.initialize">
<span class="sig-name descname"><span class="pre">initialize</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/utility3d.html#ALEMeshUpdater.initialize"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#thetis.utility3d.ALEMeshUpdater.initialize" title="Link to this definition">¶</a></dt>
<dd><p>Set values for initial mesh (elevation at rest)</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="thetis.utility3d.ALEMeshUpdater.update_elem_height">
<span class="sig-name descname"><span class="pre">update_elem_height</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/utility3d.html#ALEMeshUpdater.update_elem_height"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#thetis.utility3d.ALEMeshUpdater.update_elem_height" title="Link to this definition">¶</a></dt>
<dd><p>Updates vertical element size fields</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="thetis.utility3d.ALEMeshUpdater.update_mesh_coordinates">
<span class="sig-name descname"><span class="pre">update_mesh_coordinates</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/utility3d.html#ALEMeshUpdater.update_mesh_coordinates"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#thetis.utility3d.ALEMeshUpdater.update_mesh_coordinates" title="Link to this definition">¶</a></dt>
<dd><p>Updates 3D mesh coordinates to match current elev_2d field</p>
<p>elev_2d is first projected to continous space</p>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="thetis.utility3d.DensitySolver">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">thetis.utility3d.</span></span><span class="sig-name descname"><span class="pre">DensitySolver</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">salinity</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">temperature</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">density</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">eos_class</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/utility3d.html#DensitySolver"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#thetis.utility3d.DensitySolver" title="Link to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference external" href="https://docs.python.org/2.7/library/functions.html#object" title="(in Python v2.7)"><code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></a></p>
<p>Computes density from salinity and temperature using the equation of state.</p>
<p>Water density is defined as</p>
<div class="math notranslate nohighlight">
\[\rho = \rho'(T, S, p) + \rho_0\]</div>
<p>This method computes the density anomaly <span class="math notranslate nohighlight">\(\rho'\)</span>.</p>
<p>Density is computed point-wise assuming that temperature, salinity and
density are in the same function space.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>salinity</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">Function</span></code>) – water salinity field</p></li>
<li><p><strong>temperature</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">Function</span></code>) – water temperature field</p></li>
<li><p><strong>density</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">Function</span></code>) – water density field</p></li>
<li><p><strong>eos_class</strong> (<a class="reference internal" href="#thetis.utility3d.EquationOfState" title="thetis.utility3d.EquationOfState"><code class="xref py py-class docutils literal notranslate"><span class="pre">EquationOfState</span></code></a>) – equation of state that defines water density</p></li>
</ul>
</dd>
</dl>
<dl class="py method">
<dt class="sig sig-object py" id="thetis.utility3d.DensitySolver.solve">
<span class="sig-name descname"><span class="pre">solve</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/utility3d.html#DensitySolver.solve"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#thetis.utility3d.DensitySolver.solve" title="Link to this definition">¶</a></dt>
<dd><p>Compute density</p>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="thetis.utility3d.DensitySolverWeak">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">thetis.utility3d.</span></span><span class="sig-name descname"><span class="pre">DensitySolverWeak</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">salinity</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">temperature</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">density</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">eos_class</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/utility3d.html#DensitySolverWeak"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#thetis.utility3d.DensitySolverWeak" title="Link to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference external" href="https://docs.python.org/2.7/library/functions.html#object" title="(in Python v2.7)"><code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></a></p>
<p>Computes density from salinity and temperature using the equation of state.</p>
<p>Water density is defined as</p>
<div class="math notranslate nohighlight">
\[\rho = \rho'(T, S, p) + \rho_0\]</div>
<p>This method computes the density anomaly <span class="math notranslate nohighlight">\(\rho'\)</span>.</p>
<p>Density is computed in a weak sense by projecting the analytical expression
on the density field.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>salinity</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">Function</span></code>) – water salinity field</p></li>
<li><p><strong>temperature</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">Function</span></code>) – water temperature field</p></li>
<li><p><strong>density</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">Function</span></code>) – water density field</p></li>
<li><p><strong>eos_class</strong> (<a class="reference internal" href="#thetis.utility3d.EquationOfState" title="thetis.utility3d.EquationOfState"><code class="xref py py-class docutils literal notranslate"><span class="pre">EquationOfState</span></code></a>) – equation of state that defines water density</p></li>
</ul>
</dd>
</dl>
<dl class="py method">
<dt class="sig sig-object py" id="thetis.utility3d.DensitySolverWeak.ensure_positive_salinity">
<span class="sig-name descname"><span class="pre">ensure_positive_salinity</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/utility3d.html#DensitySolverWeak.ensure_positive_salinity"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#thetis.utility3d.DensitySolverWeak.ensure_positive_salinity" title="Link to this definition">¶</a></dt>
<dd><p>make sure salinity is not negative</p>
<p>some EOS depend on sqrt(salt).</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="thetis.utility3d.DensitySolverWeak.solve">
<span class="sig-name descname"><span class="pre">solve</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/utility3d.html#DensitySolverWeak.solve"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#thetis.utility3d.DensitySolverWeak.solve" title="Link to this definition">¶</a></dt>
<dd><p>Compute density</p>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="thetis.utility3d.EquationOfState">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">thetis.utility3d.</span></span><span class="sig-name descname"><span class="pre">EquationOfState</span></span><a class="reference internal" href="_modules/thetis/utility3d.html#EquationOfState"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#thetis.utility3d.EquationOfState" title="Link to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">ABC</span></code></p>
<p>Base class of all equation of state objects</p>
<dl class="py method">
<dt class="sig sig-object py" id="thetis.utility3d.EquationOfState.compute_rho">
<em class="property"><span class="pre">abstract</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">compute_rho</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">s</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">th</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">p</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">rho0</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.0</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/utility3d.html#EquationOfState.compute_rho"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#thetis.utility3d.EquationOfState.compute_rho" title="Link to this definition">¶</a></dt>
<dd><p>Compute sea water density.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>s</strong> (<a class="reference external" href="https://docs.python.org/2.7/library/functions.html#float" title="(in Python v2.7)"><em>float</em></a><em> or </em><em>numpy.array</em>) – Salinity expressed on the Practical Salinity Scale 1978</p></li>
<li><p><strong>th</strong> (<a class="reference external" href="https://docs.python.org/2.7/library/functions.html#float" title="(in Python v2.7)"><em>float</em></a><em> or </em><em>numpy.array</em>) – Potential temperature in Celsius, referenced to pressure
p_r = 0 dbar.</p></li>
<li><p><strong>p</strong> (<a class="reference external" href="https://docs.python.org/2.7/library/functions.html#float" title="(in Python v2.7)"><em>float</em></a><em> or </em><em>numpy.array</em>) – Pressure in decibars (1 dbar = 1e4 Pa)</p></li>
<li><p><strong>rho0</strong> (<a class="reference external" href="https://docs.python.org/2.7/library/functions.html#float" title="(in Python v2.7)"><em>float</em></a>) – Optional reference density. If provided computes
<span class="math notranslate nohighlight">\(\rho' = \rho(S, Th, p) - \rho_0\)</span></p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>water density</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference external" href="https://docs.python.org/2.7/library/functions.html#float" title="(in Python v2.7)">float</a> or numpy.array</p>
</dd>
</dl>
<p>All pressures are gauge pressures: they are the absolute pressures minus standard atmosperic
pressure 10.1325 dbar.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="thetis.utility3d.EquationOfState.eval">
<em class="property"><span class="pre">abstract</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">eval</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">s</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">th</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">p</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">rho0</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.0</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/utility3d.html#EquationOfState.eval"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#thetis.utility3d.EquationOfState.eval" title="Link to this definition">¶</a></dt>
<dd><p>Compute sea water density.</p>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="thetis.utility3d.ExpandFunctionTo3d">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">thetis.utility3d.</span></span><span class="sig-name descname"><span class="pre">ExpandFunctionTo3d</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">input_2d</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">output_3d</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">elem_height</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/utility3d.html#ExpandFunctionTo3d"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#thetis.utility3d.ExpandFunctionTo3d" title="Link to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference external" href="https://docs.python.org/2.7/library/functions.html#object" title="(in Python v2.7)"><code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></a></p>
<p>Copy a 2D field to 3D</p>
<p>Copies a field from 2D mesh to 3D mesh, assigning the same value over the
vertical dimension. Horizontal function spaces must be the same.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">U</span> <span class="o">=</span> <span class="n">FunctionSpace</span><span class="p">(</span><span class="n">mesh</span><span class="p">,</span> <span class="s1">&#39;DG&#39;</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
<span class="n">U_2d</span> <span class="o">=</span> <span class="n">FunctionSpace</span><span class="p">(</span><span class="n">mesh2d</span><span class="p">,</span> <span class="s1">&#39;DG&#39;</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
<span class="n">func2d</span> <span class="o">=</span> <span class="n">Function</span><span class="p">(</span><span class="n">U_2d</span><span class="p">)</span>
<span class="n">func3d</span> <span class="o">=</span> <span class="n">Function</span><span class="p">(</span><span class="n">U</span><span class="p">)</span>
<span class="n">ex</span> <span class="o">=</span> <span class="n">ExpandFunctionTo3d</span><span class="p">(</span><span class="n">func2d</span><span class="p">,</span> <span class="n">func3d</span><span class="p">)</span>
<span class="n">ex</span><span class="o">.</span><span class="n">solve</span><span class="p">()</span>
</pre></div>
</div>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>input_2d</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">Function</span></code>) – 2D source field</p></li>
<li><p><strong>output_3d</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">Function</span></code>) – 3D target field</p></li>
<li><p><strong>elem_height</strong> – scalar <code class="xref py py-class docutils literal notranslate"><span class="pre">Function</span></code> in 3D mesh that defines
the vertical element size. Needed only in the case of HDiv function
spaces.</p></li>
</ul>
</dd>
</dl>
<dl class="py method">
<dt class="sig sig-object py" id="thetis.utility3d.ExpandFunctionTo3d.solve">
<span class="sig-name descname"><span class="pre">solve</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/utility3d.html#ExpandFunctionTo3d.solve"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#thetis.utility3d.ExpandFunctionTo3d.solve" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="thetis.utility3d.JackettEquationOfState">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">thetis.utility3d.</span></span><span class="sig-name descname"><span class="pre">JackettEquationOfState</span></span><a class="reference internal" href="_modules/thetis/utility3d.html#JackettEquationOfState"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#thetis.utility3d.JackettEquationOfState" title="Link to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#thetis.utility3d.EquationOfState" title="thetis.utility3d.EquationOfState"><code class="xref py py-class docutils literal notranslate"><span class="pre">EquationOfState</span></code></a></p>
<p>Equation of State according of Jackett et al. (2006) for computing sea
water density.</p>
<div class="math notranslate nohighlight" id="equation-equation-of-state">
<span class="eqno">(20)<a class="headerlink" href="#equation-equation-of-state" title="Link to this equation">¶</a></span>\[\rho = \rho'(T, S, p) + \rho_0\]</div>
<p><span class="math notranslate nohighlight">\(\rho'(T, S, p)\)</span> is a nonlinear rational function.</p>
<p>Jackett et al. (2006). Algorithms for Density, Potential Temperature,
Conservative Temperature, and the Freezing Temperature of Seawater.
Journal of Atmospheric and Oceanic Technology, 23(12):1709-1728.
<a class="reference external" href="http://dx.doi.org/10.1175/JTECH1946.1">http://dx.doi.org/10.1175/JTECH1946.1</a></p>
<dl class="py attribute">
<dt class="sig sig-object py" id="thetis.utility3d.JackettEquationOfState.a">
<span class="sig-name descname"><span class="pre">a</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">array([</span> <span class="pre">9.99840854e+02,</span>&#160; <span class="pre">7.34716259e+00,</span> <span class="pre">-5.32112318e-02,</span>&#160; <span class="pre">3.64924391e-04,</span>&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; <span class="pre">2.58805710e+00,</span> <span class="pre">-6.71682828e-03,</span>&#160; <span class="pre">1.92032021e-03,</span>&#160; <span class="pre">1.17982637e-02,</span>&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; <span class="pre">9.89202193e-08,</span>&#160; <span class="pre">4.69966428e-06,</span> <span class="pre">-2.58621871e-08,</span> <span class="pre">-3.29214140e-12])</span></em><a class="headerlink" href="#thetis.utility3d.JackettEquationOfState.a" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="thetis.utility3d.JackettEquationOfState.b">
<span class="sig-name descname"><span class="pre">b</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">array([</span> <span class="pre">1.00000000e+00,</span>&#160; <span class="pre">7.28152101e-03,</span> <span class="pre">-4.47872655e-05,</span>&#160; <span class="pre">3.38510030e-07,</span>&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; <span class="pre">1.36512024e-10,</span>&#160; <span class="pre">1.76321267e-03,</span> <span class="pre">-8.80665833e-06,</span> <span class="pre">-1.88326894e-10,</span>&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; <span class="pre">5.74637767e-06,</span>&#160; <span class="pre">1.47162755e-09,</span>&#160; <span class="pre">6.71032463e-06,</span> <span class="pre">-2.44616980e-17,</span>&#160;&#160;&#160;&#160;&#160;&#160;&#160; <span class="pre">-9.15344176e-18])</span></em><a class="headerlink" href="#thetis.utility3d.JackettEquationOfState.b" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="thetis.utility3d.JackettEquationOfState.compute_rho">
<span class="sig-name descname"><span class="pre">compute_rho</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">s</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">th</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">p</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">rho0</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.0</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/utility3d.html#JackettEquationOfState.compute_rho"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#thetis.utility3d.JackettEquationOfState.compute_rho" title="Link to this definition">¶</a></dt>
<dd><p>Compute sea water density.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>s</strong> (<a class="reference external" href="https://docs.python.org/2.7/library/functions.html#float" title="(in Python v2.7)"><em>float</em></a><em> or </em><em>numpy.array</em>) – Salinity expressed on the Practical Salinity Scale 1978</p></li>
<li><p><strong>th</strong> (<a class="reference external" href="https://docs.python.org/2.7/library/functions.html#float" title="(in Python v2.7)"><em>float</em></a><em> or </em><em>numpy.array</em>) – Potential temperature in Celsius, referenced to pressure
p_r = 0 dbar.</p></li>
<li><p><strong>p</strong> (<a class="reference external" href="https://docs.python.org/2.7/library/functions.html#float" title="(in Python v2.7)"><em>float</em></a><em> or </em><em>numpy.array</em>) – Pressure in decibars (1 dbar = 1e4 Pa)</p></li>
<li><p><strong>rho0</strong> (<a class="reference external" href="https://docs.python.org/2.7/library/functions.html#float" title="(in Python v2.7)"><em>float</em></a>) – Optional reference density. If provided computes
<span class="math notranslate nohighlight">\(\rho' = \rho(S, Th, p) - \rho_0\)</span></p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>water density</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference external" href="https://docs.python.org/2.7/library/functions.html#float" title="(in Python v2.7)">float</a> or numpy.array</p>
</dd>
</dl>
<p>All pressures are gauge pressures: they are the absolute pressures minus standard atmosperic
pressure 10.1325 dbar.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="thetis.utility3d.JackettEquationOfState.eval">
<span class="sig-name descname"><span class="pre">eval</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">s</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">th</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">p</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">rho0</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.0</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/utility3d.html#JackettEquationOfState.eval"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#thetis.utility3d.JackettEquationOfState.eval" title="Link to this definition">¶</a></dt>
<dd><p>Compute sea water density.</p>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="thetis.utility3d.LinearEquationOfState">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">thetis.utility3d.</span></span><span class="sig-name descname"><span class="pre">LinearEquationOfState</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">rho_ref</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">alpha</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">beta</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">th_ref</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">s_ref</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/utility3d.html#LinearEquationOfState"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#thetis.utility3d.LinearEquationOfState" title="Link to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#thetis.utility3d.EquationOfState" title="thetis.utility3d.EquationOfState"><code class="xref py py-class docutils literal notranslate"><span class="pre">EquationOfState</span></code></a></p>
<p>Linear Equation of State for computing sea water density</p>
<div class="math notranslate nohighlight">
\[\rho = \rho_{ref} - \alpha (T - T_{ref}) + \beta (S - S_{ref})\]</div>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>rho_ref</strong> (<a class="reference external" href="https://docs.python.org/2.7/library/functions.html#float" title="(in Python v2.7)"><em>float</em></a>) – reference density</p></li>
<li><p><strong>alpha</strong> (<a class="reference external" href="https://docs.python.org/2.7/library/functions.html#float" title="(in Python v2.7)"><em>float</em></a>) – thermal expansion coefficient</p></li>
<li><p><strong>beta</strong> (<a class="reference external" href="https://docs.python.org/2.7/library/functions.html#float" title="(in Python v2.7)"><em>float</em></a>) – haline contraction coefficient</p></li>
<li><p><strong>th_ref</strong> (<a class="reference external" href="https://docs.python.org/2.7/library/functions.html#float" title="(in Python v2.7)"><em>float</em></a>) – reference temperature</p></li>
<li><p><strong>s_ref</strong> (<a class="reference external" href="https://docs.python.org/2.7/library/functions.html#float" title="(in Python v2.7)"><em>float</em></a>) – reference salinity</p></li>
</ul>
</dd>
</dl>
<dl class="py method">
<dt class="sig sig-object py" id="thetis.utility3d.LinearEquationOfState.compute_rho">
<span class="sig-name descname"><span class="pre">compute_rho</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">s</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">th</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">p</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">rho0</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.0</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/utility3d.html#LinearEquationOfState.compute_rho"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#thetis.utility3d.LinearEquationOfState.compute_rho" title="Link to this definition">¶</a></dt>
<dd><p>Compute sea water density.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>s</strong> (<a class="reference external" href="https://docs.python.org/2.7/library/functions.html#float" title="(in Python v2.7)"><em>float</em></a><em> or </em><em>numpy.array</em>) – Salinity expressed on the Practical Salinity Scale 1978</p></li>
<li><p><strong>th</strong> (<a class="reference external" href="https://docs.python.org/2.7/library/functions.html#float" title="(in Python v2.7)"><em>float</em></a><em> or </em><em>numpy.array</em>) – Potential temperature in Celsius</p></li>
<li><p><strong>p</strong> (<a class="reference external" href="https://docs.python.org/2.7/library/functions.html#float" title="(in Python v2.7)"><em>float</em></a><em> or </em><em>numpy.array</em>) – Pressure in decibars (1 dbar = 1e4 Pa)</p></li>
<li><p><strong>rho0</strong> (<a class="reference external" href="https://docs.python.org/2.7/library/functions.html#float" title="(in Python v2.7)"><em>float</em></a>) – Optional reference density. If provided computes
<span class="math notranslate nohighlight">\(\rho' = \rho(S, Th, p) - \rho_0\)</span></p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>water density</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference external" href="https://docs.python.org/2.7/library/functions.html#float" title="(in Python v2.7)">float</a> or numpy.array</p>
</dd>
</dl>
<p>Pressure is ingored in this equation of state.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="thetis.utility3d.LinearEquationOfState.eval">
<span class="sig-name descname"><span class="pre">eval</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">s</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">th</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">p</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">rho0</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.0</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/utility3d.html#LinearEquationOfState.eval"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#thetis.utility3d.LinearEquationOfState.eval" title="Link to this definition">¶</a></dt>
<dd><p>Compute sea water density.</p>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="thetis.utility3d.Mesh3DConsistencyCalculator">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">thetis.utility3d.</span></span><span class="sig-name descname"><span class="pre">Mesh3DConsistencyCalculator</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">solver_obj</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/utility3d.html#Mesh3DConsistencyCalculator"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#thetis.utility3d.Mesh3DConsistencyCalculator" title="Link to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference external" href="https://docs.python.org/2.7/library/functions.html#object" title="(in Python v2.7)"><code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></a></p>
<p>Computes a hydrostatic consistency criterion metric on the 3D mesh.</p>
<p>Let <span class="math notranslate nohighlight">\(\Delta x\)</span> and <span class="math notranslate nohighlight">\(\Delta z\)</span> denote the horizontal and vertical
element sizes. The hydrostatic consistency criterion (HCC) can then be
expressed as</p>
<div class="math notranslate nohighlight">
\[R = \frac{|\nabla h| \Delta x}{\Delta z} &lt; 1\]</div>
<p>where <span class="math notranslate nohighlight">\(\nabla h\)</span> is the bathymetry gradient (or gradient of the
internal horizontal facet).</p>
<p>Violating the hydrostatic consistency criterion leads to internal pressure
gradient errors.
In practice one can violate the <span class="math notranslate nohighlight">\(R &lt; 1\)</span> condition without
jeopardizing numerical stability; typically <span class="math notranslate nohighlight">\(R &lt; 5\)</span>.
Mesh consistency can be improved by coarsening the vertical
mesh, refining the horizontal mesh, or smoothing the bathymetry.</p>
<p>For a 3D prism, let <span class="math notranslate nohighlight">\(\delta z_t,\delta z_b\)</span> denote the maximal
<span class="math notranslate nohighlight">\(z\)</span> coordinate difference in the surface and bottom facets,
respectively, and <span class="math notranslate nohighlight">\(\Delta z\)</span> the height of the prism.
We can then compute <span class="math notranslate nohighlight">\(R\)</span> for the two facets as</p>
<div class="math notranslate nohighlight">
\[\begin{split}R_t &amp;= \frac{\delta z_t}{\Delta z} \\
R_b &amp;= \frac{\delta z_b}{\Delta z}\end{split}\]</div>
<p>For a straight prism we have <span class="math notranslate nohighlight">\(R = 0\)</span>, and <span class="math notranslate nohighlight">\(R = 1\)</span> in
the case where the highest bottom node is at the same level as the lowest
surface node.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>solver_obj</strong> – <code class="xref py py-class docutils literal notranslate"><span class="pre">FlowSolver</span></code> object</p>
</dd>
</dl>
<dl class="py method">
<dt class="sig sig-object py" id="thetis.utility3d.Mesh3DConsistencyCalculator.solve">
<span class="sig-name descname"><span class="pre">solve</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/utility3d.html#Mesh3DConsistencyCalculator.solve"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#thetis.utility3d.Mesh3DConsistencyCalculator.solve" title="Link to this definition">¶</a></dt>
<dd><p>Compute the HCC metric</p>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="thetis.utility3d.SmagorinskyViscosity">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">thetis.utility3d.</span></span><span class="sig-name descname"><span class="pre">SmagorinskyViscosity</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">uv</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">output</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">c_s</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">h_elem_size</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">max_val</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">min_val</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1e-10</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">weak_form</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">solver_parameters</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/utility3d.html#SmagorinskyViscosity"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#thetis.utility3d.SmagorinskyViscosity" title="Link to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference external" href="https://docs.python.org/2.7/library/functions.html#object" title="(in Python v2.7)"><code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></a></p>
<p>Computes Smagorinsky subgrid scale horizontal viscosity</p>
<p>This formulation is according to Ilicak et al. (2012) and
Griffies and Hallberg (2000).</p>
<div class="math notranslate nohighlight">
\[\nu = (C_s \Delta x)^2 |S|\]</div>
<p>with the deformation rate</p>
<div class="math notranslate nohighlight">
\[\begin{split}|S| &amp;= \sqrt{D_T^2 + D_S^2} \\
D_T &amp;= \frac{\partial u}{\partial x} - \frac{\partial v}{\partial y} \\
D_S &amp;= \frac{\partial u}{\partial y} + \frac{\partial v}{\partial x}\end{split}\]</div>
<p><span class="math notranslate nohighlight">\(\Delta x\)</span> is the horizontal element size and <span class="math notranslate nohighlight">\(C_s\)</span> is the
Smagorinsky coefficient.</p>
<p>To match a certain mesh Reynolds number <span class="math notranslate nohighlight">\(Re_h\)</span> set
<span class="math notranslate nohighlight">\(C_s = 1/\sqrt{Re_h}\)</span>.</p>
<p>Ilicak et al. (2012). Spurious dianeutral mixing and the role of
momentum closure. Ocean Modelling, 45-46(0):37-58.
<a class="reference external" href="http://dx.doi.org/10.1016/j.ocemod.2011.10.003">http://dx.doi.org/10.1016/j.ocemod.2011.10.003</a></p>
<p>Griffies and Hallberg (2000). Biharmonic friction with a
Smagorinsky-like viscosity for use in large-scale eddy-permitting
ocean models. Monthly Weather Review, 128(8):2935-2946.
<a class="reference external" href="http://dx.doi.org/10.1175/1520-0493(2000)128%3C2935:BFWASL%3E2.0.CO;2">http://dx.doi.org/10.1175/1520-0493(2000)128%3C2935:BFWASL%3E2.0.CO;2</a></p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>uv_3d</strong> (3D vector <code class="xref py py-class docutils literal notranslate"><span class="pre">Function</span></code>) – horizontal velocity</p></li>
<li><p><strong>output</strong> (3D scalar <code class="xref py py-class docutils literal notranslate"><span class="pre">Function</span></code>) – Smagorinsky viscosity field</p></li>
<li><p><strong>c_s</strong> (float or <code class="xref py py-class docutils literal notranslate"><span class="pre">Constant</span></code>) – Smagorinsky coefficient</p></li>
<li><p><strong>h_elem_size</strong> (3D scalar <code class="xref py py-class docutils literal notranslate"><span class="pre">Function</span></code> or <code class="xref py py-class docutils literal notranslate"><span class="pre">Constant</span></code>) – field that defines the horizontal element size</p></li>
<li><p><strong>max_val</strong> (<a class="reference external" href="https://docs.python.org/2.7/library/functions.html#float" title="(in Python v2.7)"><em>float</em></a>) – Maximum allowed viscosity. Viscosity will be clipped at
this value.</p></li>
<li><p><strong>min_val</strong> (<a class="reference external" href="https://docs.python.org/2.7/library/functions.html#float" title="(in Python v2.7)"><em>float</em></a>) – Minimum allowed viscosity. Viscosity will be clipped at
this value.</p></li>
<li><p><strong>weak_form</strong> (<a class="reference external" href="https://docs.python.org/2.7/library/functions.html#bool" title="(in Python v2.7)"><em>bool</em></a>) – Compute velocity shear by integrating by parts.
Necessary for some function spaces (e.g. P0).</p></li>
<li><p><strong>solver_parameters</strong> (<a class="reference external" href="https://docs.python.org/2.7/library/stdtypes.html#dict" title="(in Python v2.7)"><em>dict</em></a>) – PETSc solver options</p></li>
</ul>
</dd>
</dl>
<dl class="py method">
<dt class="sig sig-object py" id="thetis.utility3d.SmagorinskyViscosity.solve">
<span class="sig-name descname"><span class="pre">solve</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/utility3d.html#SmagorinskyViscosity.solve"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#thetis.utility3d.SmagorinskyViscosity.solve" title="Link to this definition">¶</a></dt>
<dd><p>Compute viscosity</p>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="thetis.utility3d.SubFunctionExtractor">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">thetis.utility3d.</span></span><span class="sig-name descname"><span class="pre">SubFunctionExtractor</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">input_3d</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">output_2d</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">boundary</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'top'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">elem_facet</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">elem_height</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/utility3d.html#SubFunctionExtractor"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#thetis.utility3d.SubFunctionExtractor" title="Link to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference external" href="https://docs.python.org/2.7/library/functions.html#object" title="(in Python v2.7)"><code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></a></p>
<p>Extract a 2D sub-function from a 3D function in an extruded mesh</p>
<p>Given 2D and 3D functions,</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">U</span> <span class="o">=</span> <span class="n">FunctionSpace</span><span class="p">(</span><span class="n">mesh</span><span class="p">,</span> <span class="s1">&#39;DG&#39;</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
<span class="n">U_2d</span> <span class="o">=</span> <span class="n">FunctionSpace</span><span class="p">(</span><span class="n">mesh2d</span><span class="p">,</span> <span class="s1">&#39;DG&#39;</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
<span class="n">func2d</span> <span class="o">=</span> <span class="n">Function</span><span class="p">(</span><span class="n">U_2d</span><span class="p">)</span>
<span class="n">func3d</span> <span class="o">=</span> <span class="n">Function</span><span class="p">(</span><span class="n">U</span><span class="p">)</span>
</pre></div>
</div>
<p>Get surface value:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">ex</span> <span class="o">=</span> <span class="n">SubFunctionExtractor</span><span class="p">(</span><span class="n">func3d</span><span class="p">,</span> <span class="n">func2d</span><span class="p">,</span>
    <span class="n">boundary</span><span class="o">=</span><span class="s1">&#39;top&#39;</span><span class="p">,</span> <span class="n">elem_facet</span><span class="o">=</span><span class="s1">&#39;top&#39;</span><span class="p">)</span>
<span class="n">ex</span><span class="o">.</span><span class="n">solve</span><span class="p">()</span>
</pre></div>
</div>
<p>Get bottom value:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">ex</span> <span class="o">=</span> <span class="n">SubFunctionExtractor</span><span class="p">(</span><span class="n">func3d</span><span class="p">,</span> <span class="n">func2d</span><span class="p">,</span>
    <span class="n">boundary</span><span class="o">=</span><span class="s1">&#39;bottom&#39;</span><span class="p">,</span> <span class="n">elem_facet</span><span class="o">=</span><span class="s1">&#39;bottom&#39;</span><span class="p">)</span>
<span class="n">ex</span><span class="o">.</span><span class="n">solve</span><span class="p">()</span>
</pre></div>
</div>
<p>Get value at the top of bottom element:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">ex</span> <span class="o">=</span> <span class="n">SubFunctionExtractor</span><span class="p">(</span><span class="n">func3d</span><span class="p">,</span> <span class="n">func2d</span><span class="p">,</span>
    <span class="n">boundary</span><span class="o">=</span><span class="s1">&#39;bottom&#39;</span><span class="p">,</span> <span class="n">elem_facet</span><span class="o">=</span><span class="s1">&#39;top&#39;</span><span class="p">)</span>
<span class="n">ex</span><span class="o">.</span><span class="n">solve</span><span class="p">()</span>
</pre></div>
</div>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>input_3d</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">Function</span></code>) – 3D source field</p></li>
<li><p><strong>output_2d</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">Function</span></code>) – 2D target field</p></li>
<li><p><strong>boundary</strong> (<a class="reference external" href="https://docs.python.org/2.7/library/functions.html#str" title="(in Python v2.7)"><em>str</em></a>) – ‘top’|’bottom’
Defines whether to extract from the surface or bottom 3D elements</p></li>
<li><p><strong>elem_facet</strong> (<a class="reference external" href="https://docs.python.org/2.7/library/functions.html#str" title="(in Python v2.7)"><em>str</em></a>) – ‘top’|’bottom’|’average’
Defines which facet of the 3D element is extracted. The ‘average’
computes mean of the top and bottom facets of the 3D element.</p></li>
<li><p><strong>elem_height</strong> – scalar <code class="xref py py-class docutils literal notranslate"><span class="pre">Function</span></code> in 2D mesh that defines
the vertical element size. Needed only in the case of HDiv function
spaces.</p></li>
</ul>
</dd>
</dl>
<dl class="py method">
<dt class="sig sig-object py" id="thetis.utility3d.SubFunctionExtractor.solve">
<span class="sig-name descname"><span class="pre">solve</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/utility3d.html#SubFunctionExtractor.solve"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#thetis.utility3d.SubFunctionExtractor.solve" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="thetis.utility3d.VelocityMagnitudeSolver">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">thetis.utility3d.</span></span><span class="sig-name descname"><span class="pre">VelocityMagnitudeSolver</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">solution</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">u</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">w</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">min_val</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1e-06</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">solver_parameters</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/utility3d.html#VelocityMagnitudeSolver"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#thetis.utility3d.VelocityMagnitudeSolver" title="Link to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference external" href="https://docs.python.org/2.7/library/functions.html#object" title="(in Python v2.7)"><code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></a></p>
<p>Computes magnitude of (u[0],u[1],w) and stores it in solution</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>solution</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">Function</span></code>) – scalar field for velocity magnitude scalar <code class="xref py py-class docutils literal notranslate"><span class="pre">Function</span></code></p></li>
<li><p><strong>u</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">Function</span></code>) – horizontal velocity</p></li>
<li><p><strong>w</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">Function</span></code>) – vertical velocity</p></li>
<li><p><strong>min_val</strong> (<a class="reference external" href="https://docs.python.org/2.7/library/functions.html#float" title="(in Python v2.7)"><em>float</em></a>) – minimum value of magnitude. Minimum value of solution
will be clipped to this value</p></li>
<li><p><strong>solver_parameters</strong> (<a class="reference external" href="https://docs.python.org/2.7/library/stdtypes.html#dict" title="(in Python v2.7)"><em>dict</em></a>) – PETSc solver options</p></li>
</ul>
</dd>
</dl>
<p>If <code class="docutils literal notranslate"><span class="pre">u</span></code> is None computes magnitude of (0,0,w).</p>
<p>If <code class="docutils literal notranslate"><span class="pre">w</span></code> is None computes magnitude of (u[0],u[1],0).</p>
<dl class="py method">
<dt class="sig sig-object py" id="thetis.utility3d.VelocityMagnitudeSolver.solve">
<span class="sig-name descname"><span class="pre">solve</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/utility3d.html#VelocityMagnitudeSolver.solve"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#thetis.utility3d.VelocityMagnitudeSolver.solve" title="Link to this definition">¶</a></dt>
<dd><p>Compute the magnitude</p>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="thetis.utility3d.VerticalIntegrator">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">thetis.utility3d.</span></span><span class="sig-name descname"><span class="pre">VerticalIntegrator</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">input</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">output</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">bottom_to_top</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">bnd_value</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">Constant([0.],</span> <span class="pre">name='constant_5',</span> <span class="pre">count=5)</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">average</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">bathymetry</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">elevation</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">solver_parameters</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/utility3d.html#VerticalIntegrator"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#thetis.utility3d.VerticalIntegrator" title="Link to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference external" href="https://docs.python.org/2.7/library/functions.html#object" title="(in Python v2.7)"><code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></a></p>
<p>Computes vertical integral (or average) of a field.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>input</strong> – 3D field to integrate</p></li>
<li><p><strong>output</strong> – 3D field where the integral is stored</p></li>
<li><p><strong>bottom_to_top</strong> – Defines the integration direction: If True integration is performed along the z axis, from bottom surface to top surface.</p></li>
<li><p><strong>bnd_value</strong> – Value of the integral at the bottom (top) boundary if bottom_to_top is True (False)</p></li>
<li><p><strong>average</strong> – If True computes the vertical average instead. Requires bathymetry and elevation fields</p></li>
<li><p><strong>bathymetry</strong> – 3D field defining the bathymetry</p></li>
<li><p><strong>elevation</strong> – 3D field defining the free surface elevation</p></li>
<li><p><strong>solver_parameters</strong> (<a class="reference external" href="https://docs.python.org/2.7/library/stdtypes.html#dict" title="(in Python v2.7)"><em>dict</em></a>) – PETSc solver options</p></li>
</ul>
</dd>
</dl>
<dl class="py method">
<dt class="sig sig-object py" id="thetis.utility3d.VerticalIntegrator.solve">
<span class="sig-name descname"><span class="pre">solve</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/utility3d.html#VerticalIntegrator.solve"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#thetis.utility3d.VerticalIntegrator.solve" title="Link to this definition">¶</a></dt>
<dd><p>Computes the integral and stores it in the output field.</p>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="thetis.utility3d.VerticalVelocitySolver">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">thetis.utility3d.</span></span><span class="sig-name descname"><span class="pre">VerticalVelocitySolver</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">solution</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">uv</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">bathymetry</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">boundary_funcs</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">{}</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">solver_parameters</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/utility3d.html#VerticalVelocitySolver"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#thetis.utility3d.VerticalVelocitySolver" title="Link to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference external" href="https://docs.python.org/2.7/library/functions.html#object" title="(in Python v2.7)"><code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></a></p>
<p>Computes vertical velocity diagnostically from the continuity equation</p>
<p>Vertical velocity is obtained from the continuity equation</p>
<div class="math notranslate nohighlight" id="equation-continuity-eq-3d">
<span class="eqno">(21)<a class="headerlink" href="#equation-continuity-eq-3d" title="Link to this equation">¶</a></span>\[\frac{\partial w}{\partial z} = -\nabla_h \cdot \textbf{u}\]</div>
<p>and the bottom impermeability condition (<span class="math notranslate nohighlight">\(h\)</span> denotes the bathymetry)</p>
<div class="math notranslate nohighlight">
\[\begin{split}\textbf{n}_h \cdot \textbf{u} + w n_z &amp;= 0 \quad \forall \mathbf{x} \in \Gamma_{b} \\
\Leftrightarrow w &amp;= -\nabla_h h \cdot \mathbf{u} \quad \forall \mathbf{x} \in \Gamma_{b}\end{split}\]</div>
<p><span class="math notranslate nohighlight">\(w\)</span> can be solved with the weak form</p>
<div class="math notranslate nohighlight">
\[\begin{split}\int_{\Gamma_s} w n_z \varphi dS
+ \int_{\mathcal{I}_h} \text{avg}(w) \text{jump}(\varphi n_z) dS
- \int_{\Omega} w \frac{\partial \varphi}{\partial z} dx
= \\
\int_{\Omega} \mathbf{u} \cdot \nabla_h \varphi dx
- \int_{\mathcal{I}_h \cup \mathcal{I}_v} \text{avg}(\mathbf{u}) \cdot \text{jump}(\varphi \mathbf{n}_h) dS
- \int_{\Gamma_s} \mathbf{u} \cdot \varphi \mathbf{n}_h dS\end{split}\]</div>
<p>where the <span class="math notranslate nohighlight">\(\Gamma_b\)</span> terms vanish due to the bottom impermeability
condition.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>solution</strong> – w <code class="xref py py-class docutils literal notranslate"><span class="pre">Function</span></code></p></li>
<li><p><strong>uv</strong> – horizontal velocity <code class="xref py py-class docutils literal notranslate"><span class="pre">Function</span></code></p></li>
<li><p><strong>bathymetry</strong> – bathymetry <code class="xref py py-class docutils literal notranslate"><span class="pre">Function</span></code></p></li>
<li><p><strong>boundary_funcs</strong> (<a class="reference external" href="https://docs.python.org/2.7/library/stdtypes.html#dict" title="(in Python v2.7)"><em>dict</em></a>) – boundary conditions used in the 3D momentum
equation. Provides external values of uv (if any).</p></li>
<li><p><strong>solver_parameters</strong> (<a class="reference external" href="https://docs.python.org/2.7/library/stdtypes.html#dict" title="(in Python v2.7)"><em>dict</em></a>) – PETSc solver options</p></li>
</ul>
</dd>
</dl>
<dl class="py method">
<dt class="sig sig-object py" id="thetis.utility3d.VerticalVelocitySolver.solve">
<span class="sig-name descname"><span class="pre">solve</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/utility3d.html#VerticalVelocitySolver.solve"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#thetis.utility3d.VerticalVelocitySolver.solve" title="Link to this definition">¶</a></dt>
<dd><p>Compute w</p>
</dd></dl>

</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="thetis.utility3d.get_horizontal_elem_size_3d">
<span class="sig-prename descclassname"><span class="pre">thetis.utility3d.</span></span><span class="sig-name descname"><span class="pre">get_horizontal_elem_size_3d</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">sol2d</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sol3d</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/thetis/utility3d.html#get_horizontal_elem_size_3d"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#thetis.utility3d.get_horizontal_elem_size_3d" title="Link to this definition">¶</a></dt>
<dd><p>Computes horizontal element size from the 2D mesh, then copies it on a 3D
field</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>sol2d</strong> – 2D <code class="xref py py-class docutils literal notranslate"><span class="pre">Function</span></code> for the element size field</p></li>
<li><p><strong>sol3d</strong> – 3D <code class="xref py py-class docutils literal notranslate"><span class="pre">Function</span></code> for the element size field</p></li>
</ul>
</dd>
</dl>
</dd></dl>

</section>
<section id="module-thetis">
<span id="module-contents"></span><h2>Module contents<a class="headerlink" href="#module-thetis" title="Link to this heading">¶</a></h2>
</section>
</section>


            <div class="clearer"></div>
          </div>
        </div>
      </div>
    </div>
      <div class="clearer"></div>
    </div>
    <div class="footer" role="contentinfo">
    &#169; Copyright 2016-2025, Tuomas Kärnä et al..
      Created using <a href="https://www.sphinx-doc.org/">Sphinx</a> 8.1.3.
    </div>
  </body>
</html>