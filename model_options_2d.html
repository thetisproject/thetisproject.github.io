<!DOCTYPE html>

<html lang="en" data-content_root="./">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="viewport" content="width=device-width, initial-scale=1" />

    <title>2D model options &#8212; Thetis 0+untagged.2082.gf1a0bbb documentation</title>
    <link rel="stylesheet" type="text/css" href="_static/pygments.css?v=03e43079" />
    <link rel="stylesheet" type="text/css" href="_static/thetis.css?v=0f3339d6" />
    <script src="_static/documentation_options.js?v=ccd1159c"></script>
    <script src="_static/doctools.js?v=9bcbadda"></script>
    <script src="_static/sphinx_highlight.js?v=dc90522c"></script>
    <script async="async" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
<!--[if lte IE 6]>
<link rel="stylesheet" href="_static/ie6.css" type="text/css" media="screen" charset="utf-8" />
<![endif]-->

<!-- <link rel="stylesheet" href="_static/featured.css"> -->


<link rel="shortcut icon" href="_static/icon_thetis.ico" />


  </head><body>
<div class="wrapper">
  <a href="index.html"><img src="_static/banner.jpg" height="180px" alt="Thetis Project Banner" /></a>
  <div id="access">
    <div class="menu">
      <ul>
        <li class="page_item"><a href="documentation.html" title="Thetis documentation">Documentation</a></li>
        <li class="page_item"><a href="download.html" title="Install Thetis">Download</a></li>
        <li class="page_item"><a href="team.html" title="Development team">Team</a></li>
        <li class="page_item"><a href="publications.html" title="Publications">Publications</a></li>
        <li class="page_item"><a href="funding.html" title="Our financial supporters">Funding</a></li>
        <li class="page_item"><a href="contact.html" title="Getting in touch">Contact</a></li>
        <li class="page_item"><a href="https://github.com/thetisproject/thetis" title="Thetis source on GitHub">GitHub</a></li>
      </ul>
    </div><!-- .menu -->
  </div><!-- #access -->
</div><!-- #wrapper -->


    <div class="document">
    <div class="model_options_2d">
      
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body" role="main">
            
  <section id="d-model-options">
<span id="model-options-2d"></span><h1>2D model options<a class="headerlink" href="#d-model-options" title="Link to this heading">¶</a></h1>
<p>This page lists all available options for the 2D model.</p>
<dl>
<dt>CommonModelOptions.<strong>atmospheric_pressure</strong><span class="classifier">FiredrakeScalarExpression</span></dt><dd><p>Atmospheric pressure at free surface, in pascals</p>
<p>Default:</p>
<p>UFL scalar expression</p>
</dd>
<dt>CommonModelOptions.<strong>cfl_2d</strong><span class="classifier">PositiveFloat</span></dt><dd><p>Factor to scale the 2d time step OBSOLETE</p>
<p>Default:</p>
<p>1.0</p>
</dd>
<dt>CommonModelOptions.<strong>cfl_3d</strong><span class="classifier">PositiveFloat</span></dt><dd><p>Factor to scale the 2d time step OBSOLETE</p>
<p>Default:</p>
<p>1.0</p>
</dd>
<dt>CommonModelOptions.<strong>check_volume_conservation_2d</strong><span class="classifier">Bool</span></dt><dd><p>Compute volume of the 2D mode at every export</p>
<blockquote>
<div><p>2D volume is defined as the integral of the water elevation field.
Prints deviation from the initial volume to stdout.</p>
</div></blockquote>
<p>Default:</p>
<p>False</p>
</dd>
<dt>CommonModelOptions.<strong>coriolis_frequency</strong><span class="classifier">FiredrakeScalarExpression</span></dt><dd><p>2D Coriolis parameter</p>
<p>Default:</p>
<p>UFL scalar expression</p>
</dd>
<dt>CommonModelOptions.<strong>element_family</strong><span class="classifier">‘dg-dg’|’rt-dg’|’bdm-dg’|’dg-cg’</span></dt><dd><p>Finite element family</p>
<blockquote>
<div><p>2D solver supports ‘dg-dg’, ‘rt-dg’, ‘bdm-dg’, or ‘dg-cg’ velocity-pressure pairs.
3D solver supports ‘dg-dg’, ‘rt-dg’, or ‘bdm-dg’ velocity-pressure pairs.</p>
</div></blockquote>
<p>Default:</p>
<p>‘dg-dg’</p>
</dd>
<dt>CommonModelOptions.<strong>export_diagnostics</strong><span class="classifier">Bool</span></dt><dd><p>Store diagnostic variables to disk in HDF5 format</p>
<p>Default:</p>
<p>True</p>
</dd>
<dt>CommonModelOptions.<strong>fields_to_export</strong><span class="classifier">List</span></dt><dd><p>Fields to export in VTK format</p>
<p>Default:</p>
<p>[‘elev_2d’, ‘uv_2d’, ‘uv_3d’, ‘w_3d’]</p>
</dd>
<dt>CommonModelOptions.<strong>fields_to_export_hdf5</strong><span class="classifier">List</span></dt><dd><p>Fields to export in HDF5 format</p>
<p>Default:</p>
<p>[]</p>
</dd>
<dt>CommonModelOptions.<strong>horizontal_diffusivity_scale</strong><span class="classifier">FiredrakeConstantTraitlet</span></dt><dd><p>Maximum horizontal diffusivity</p>
<blockquote>
<div><p>Used to compute the mesh Peclet number in
the 2D tracer SUPG stabilization scheme.</p>
</div></blockquote>
<p>Default:</p>
<p>Constant(1.0)</p>
</dd>
<dt>CommonModelOptions.<strong>horizontal_velocity_scale</strong><span class="classifier">FiredrakeConstantTraitlet</span></dt><dd><p>Maximum horizontal velocity magnitude</p>
<blockquote>
<div><p>Used to compute max stable advection time step.</p>
</div></blockquote>
<p>Default:</p>
<p>Constant(0.1)</p>
</dd>
<dt>CommonModelOptions.<strong>horizontal_viscosity</strong><span class="classifier">FiredrakeScalarExpression</span></dt><dd><p>Horizontal viscosity</p>
<p>Default:</p>
<p>UFL scalar expression</p>
</dd>
<dt>CommonModelOptions.<strong>horizontal_viscosity_scale</strong><span class="classifier">FiredrakeConstantTraitlet</span></dt><dd><p>Maximum horizontal viscosity</p>
<blockquote>
<div><p>Used to compute max stable diffusion time step.</p>
</div></blockquote>
<p>Default:</p>
<p>Constant(1.0)</p>
</dd>
<dt>CommonModelOptions.<strong>lax_friedrichs_tracer_scaling_factor</strong><span class="classifier">FiredrakeConstantTraitlet</span></dt><dd><p>Scaling factor for tracer Lax Friedrichs stability term.</p>
<p>Default:</p>
<p>Constant(1.0)</p>
</dd>
<dt>CommonModelOptions.<strong>lax_friedrichs_velocity_scaling_factor</strong><span class="classifier">FiredrakeConstantTraitlet</span></dt><dd><p>Scaling factor for Lax Friedrichs stabilisation term in horizontal momentum advection.</p>
<p>Default:</p>
<p>Constant(1.0)</p>
</dd>
<dt>CommonModelOptions.<strong>linear_drag_coefficient</strong><span class="classifier">FiredrakeScalarExpression</span></dt><dd><p>2D linear drag parameter <span class="math notranslate nohighlight">\(L\)</span></p>
<blockquote>
<div><p>Bottom stress is <span class="math notranslate nohighlight">\(\tau_b/\rho_0 = -L \mathbf{u} H\)</span></p>
</div></blockquote>
<p>Default:</p>
<p>UFL scalar expression</p>
</dd>
<dt>CommonModelOptions.<strong>log_output</strong><span class="classifier">Bool</span></dt><dd><p>Redirect all output to log file in output directory</p>
<p>Default:</p>
<p>True</p>
</dd>
<dt>CommonModelOptions.<strong>manning_drag_coefficient</strong><span class="classifier">FiredrakeScalarExpression</span></dt><dd><p>Manning-Strickler 2D quadratic drag parameter <span class="math notranslate nohighlight">\(\mu\)</span></p>
<blockquote>
<div><p>Bottom stress is <span class="math notranslate nohighlight">\(\tau_b/\rho_0 = -g \mu^2 |\mathbf{u}|\mathbf{u}/H^{1/3}\)</span></p>
</div></blockquote>
<p>Default:</p>
<p>UFL scalar expression</p>
</dd>
<dt>CommonModelOptions.<strong>momentum_source_2d</strong><span class="classifier">FiredrakeVectorExpression</span></dt><dd><p>Source term for 2D momentum equation</p>
<p>Default:</p>
<p>UFL vector expression</p>
</dd>
<dt>CommonModelOptions.<strong>nh_model_options</strong><span class="classifier">Instance</span></dt><dd><p>No description</p>
<p>Default:</p>
<p>&lt;thetis.options.NonhydrostaticModelOptions object at 0x739c38102a50&gt;</p>
</dd>
<dt>CommonModelOptions.<strong>nikuradse_bed_roughness</strong><span class="classifier">FiredrakeScalarExpression</span></dt><dd><p>Nikuradse bed roughness length used to construct the 2D quadratic drag parameter <span class="math notranslate nohighlight">\(C_D\)</span>.</p>
<blockquote>
<div><p>In sediment transport this term is usually three times the average sediment diameter size.</p>
</div></blockquote>
<p>Default:</p>
<p>UFL scalar expression</p>
</dd>
<dt>CommonModelOptions.<strong>no_exports</strong><span class="classifier">Bool</span></dt><dd><p>Do not store any outputs to disk</p>
<blockquote>
<div><p>Disables VTK and HDF5 field outputs. and HDF5 diagnostic outputs.
Used in CI test suite.</p>
</div></blockquote>
<p>Default:</p>
<p>False</p>
</dd>
<dt>CommonModelOptions.<strong>norm_smoother</strong><span class="classifier">FiredrakeConstantTraitlet</span></dt><dd><dl class="simple">
<dt>Coefficient used to avoid non-differentiable functions in the continuous formulation of the velocity norm in</dt><dd><p>the quadratic bottom drag term in the momentum equation. This replaces the velocity norm in the quadratic
bottom drag term with <span class="math notranslate nohighlight">\(\|u\| \approx \sqrt{\|u\|^2 + \alpha^2}\)</span></p>
</dd>
</dl>
<p>Default:</p>
<p>Constant(0.0)</p>
</dd>
<dt>CommonModelOptions.<strong>output_directory</strong><span class="classifier">Unicode</span></dt><dd><p>Directory where model output files are stored</p>
<p>Default:</p>
<p>‘outputs’</p>
</dd>
<dt>CommonModelOptions.<strong>polynomial_degree</strong><span class="classifier">NonNegativeInteger</span></dt><dd><p>Polynomial degree of elements</p>
<p>Default:</p>
<p>1</p>
</dd>
<dt>CommonModelOptions.<strong>quadratic_drag_coefficient</strong><span class="classifier">FiredrakeScalarExpression</span></dt><dd><p>Dimensionless 2D quadratic drag parameter <span class="math notranslate nohighlight">\(C_D\)</span></p>
<blockquote>
<div><p>Bottom stress is <span class="math notranslate nohighlight">\(\tau_b/\rho_0 = -C_D |\mathbf{u}|\mathbf{u}\)</span></p>
</div></blockquote>
<p>Default:</p>
<p>UFL scalar expression</p>
</dd>
<dt>CommonModelOptions.<strong>simulation_end_date</strong><span class="classifier">DatetimeTraitlet</span></dt><dd><p>Simulation end date</p>
<p>Default:</p>
<p>None</p>
</dd>
<dt>CommonModelOptions.<strong>simulation_end_time</strong><span class="classifier">PositiveFloat</span></dt><dd><p>Simulation duration in seconds</p>
<p>Default:</p>
<p>None</p>
</dd>
<dt>CommonModelOptions.<strong>simulation_export_time</strong><span class="classifier">PositiveFloat</span></dt><dd><p>Export interval in seconds</p>
<blockquote>
<div><p>All fields in fields_to_export list will be stored to disk and
diagnostics will be computed</p>
</div></blockquote>
<p>Default:</p>
<p>100.0</p>
</dd>
<dt>CommonModelOptions.<strong>simulation_initial_date</strong><span class="classifier">DatetimeTraitlet</span></dt><dd><p>Model initialization date. Corresponds to zero in simulation time.</p>
<p>Default:</p>
<p>None</p>
</dd>
<dt>CommonModelOptions.<strong>sipg_factor</strong><span class="classifier">FiredrakeScalarExpression</span></dt><dd><p>Penalty parameter scaling factor for horizontal viscosity terms.</p>
<p>Default:</p>
<p>Constant(1.0)</p>
</dd>
<dt>CommonModelOptions.<strong>sipg_factor_tracer</strong><span class="classifier">FiredrakeScalarExpression</span></dt><dd><p>Penalty parameter scaling factor for horizontal diffusivity terms.</p>
<p>Default:</p>
<p>Constant(1.0)</p>
</dd>
<dt>CommonModelOptions.<strong>timestep</strong><span class="classifier">PositiveFloat</span></dt><dd><p>Time step</p>
<p>Default:</p>
<p>10.0</p>
</dd>
<dt>CommonModelOptions.<strong>use_grad_depth_viscosity_term</strong><span class="classifier">Bool</span></dt><dd><p>Include <span class="math notranslate nohighlight">\(\nabla H\)</span> term in the depth-averaged viscosity</p>
<blockquote>
<div><p>See <a class="reference internal" href="thetis.html#thetis.shallowwater_eq.HorizontalViscosityTerm" title="thetis.shallowwater_eq.HorizontalViscosityTerm"><code class="xref py py-class docutils literal notranslate"><span class="pre">shallowwater_eq.HorizontalViscosityTerm</span></code></a> for details.</p>
</div></blockquote>
<p>Default:</p>
<p>True</p>
</dd>
<dt>CommonModelOptions.<strong>use_grad_div_viscosity_term</strong><span class="classifier">Bool</span></dt><dd><p>Include <span class="math notranslate nohighlight">\(\nabla (\nu_h \nabla \cdot \bar{\textbf{u}})\)</span> term in the depth-averaged viscosity</p>
<blockquote>
<div><p>See <a class="reference internal" href="thetis.html#thetis.shallowwater_eq.HorizontalViscosityTerm" title="thetis.shallowwater_eq.HorizontalViscosityTerm"><code class="xref py py-class docutils literal notranslate"><span class="pre">shallowwater_eq.HorizontalViscosityTerm</span></code></a> for details.</p>
</div></blockquote>
<p>Default:</p>
<p>False</p>
</dd>
<dt>CommonModelOptions.<strong>use_lax_friedrichs_tracer</strong><span class="classifier">Bool</span></dt><dd><p>Use Lax Friedrichs stabilisation in tracer advection.</p>
<p>Default:</p>
<p>False</p>
</dd>
<dt>CommonModelOptions.<strong>use_lax_friedrichs_velocity</strong><span class="classifier">Bool</span></dt><dd><p>use Lax Friedrichs stabilisation in horizontal momentum advection.</p>
<p>Default:</p>
<p>True</p>
</dd>
<dt>CommonModelOptions.<strong>use_limiter_for_tracers</strong><span class="classifier">Bool</span></dt><dd><p>Apply P1DG limiter for tracer fields</p>
<p>Default:</p>
<p>True</p>
</dd>
<dt>CommonModelOptions.<strong>use_nonlinear_equations</strong><span class="classifier">Bool</span></dt><dd><p>Use nonlinear shallow water equations</p>
<p>Default:</p>
<p>True</p>
</dd>
<dt>CommonModelOptions.<strong>verbose</strong><span class="classifier">Int</span></dt><dd><p>Verbosity level</p>
<p>Default:</p>
<p>0</p>
</dd>
<dt>CommonModelOptions.<strong>volume_source_2d</strong><span class="classifier">FiredrakeScalarExpression</span></dt><dd><p>Source term for 2D continuity equation</p>
<p>Default:</p>
<p>UFL scalar expression</p>
</dd>
<dt>CommonModelOptions.<strong>wind_stress</strong><span class="classifier">FiredrakeVectorExpression</span></dt><dd><p>Stress at free surface (2D vector function)</p>
<p>Default:</p>
<p>UFL vector expression</p>
</dd>
<dt>ModelOptions2d.<strong>check_tracer_conservation</strong><span class="classifier">Bool</span></dt><dd><p>Compute total tracer mass at every export</p>
<blockquote>
<div><p>Prints deviation from the initial mass to stdout.</p>
</div></blockquote>
<p>Default:</p>
<p>False</p>
</dd>
<dt>ModelOptions2d.<strong>check_tracer_overshoot</strong><span class="classifier">Bool</span></dt><dd><p>Compute tracer overshoots at every export</p>
<blockquote>
<div><p>Prints overshoot values that exceed the initial range to stdout.</p>
</div></blockquote>
<p>Default:</p>
<p>False</p>
</dd>
<dt>ModelOptions2d.<strong>sediment_model_options</strong><span class="classifier">Instance</span></dt><dd><p>No description</p>
<p>Default:</p>
<p>&lt;thetis.options.SedimentModelOptions object at 0x739c381021e0&gt;</p>
</dd>
<dt>ModelOptions2d.<strong>swe_timestepper_type</strong><span class="classifier">‘SSPRK33’|’ForwardEuler’|’BackwardEuler’|’CrankNicolson’|’DIRK22’|’DIRK33’|’SteadyState’|’PressureProjectionPicard’|’SSPIMEX’</span></dt><dd><p>Name of the time integrator</p>
<p>Default:</p>
<p>‘CrankNicolson’</p>
<p>Setting value implies configuration of sub-tree ModelOptions2d.swe_timestepper_options:</p>
<p>‘SSPRK33’:</p>
<blockquote>
<div><dl>
<dt>ModelOptions2d.swe_timestepper_options.<strong>solver_parameters</strong><span class="classifier">PETScSolverParameters</span></dt><dd><p>No description</p>
<p>Default:</p>
<p>{‘snes_type’: ‘ksponly’, ‘ksp_type’: ‘cg’, ‘pc_type’: ‘bjacobi’, ‘sub_ksp_type’: ‘preonly’, ‘sub_pc_type’: ‘ilu’, ‘mat_type’: ‘aij’}</p>
</dd>
</dl>
</div></blockquote>
<p>‘ForwardEuler’:</p>
<blockquote>
<div><dl>
<dt>ModelOptions2d.swe_timestepper_options.<strong>solver_parameters</strong><span class="classifier">PETScSolverParameters</span></dt><dd><p>No description</p>
<p>Default:</p>
<p>{‘snes_type’: ‘ksponly’, ‘ksp_type’: ‘cg’, ‘pc_type’: ‘bjacobi’, ‘sub_ksp_type’: ‘preonly’, ‘sub_pc_type’: ‘ilu’, ‘mat_type’: ‘aij’}</p>
</dd>
</dl>
</div></blockquote>
<p>‘BackwardEuler’:</p>
<blockquote>
<div><dl>
<dt>ModelOptions2d.swe_timestepper_options.<strong>solver_parameters</strong><span class="classifier">PETScSolverParameters</span></dt><dd><p>No description</p>
<p>Default:</p>
<p>{‘ksp_type’: ‘gmres’, ‘pc_type’: ‘fieldsplit’, ‘pc_fieldsplit_type’: ‘multiplicative’}</p>
</dd>
</dl>
</div></blockquote>
<p>‘CrankNicolson’:</p>
<blockquote>
<div><dl>
<dt>ModelOptions2d.swe_timestepper_options.<strong>implicitness_theta</strong><span class="classifier">BoundedFloat</span></dt><dd><p>implicitness parameter theta. Value 0.5 implies Crank-Nicolson scheme, 1.0 implies fully implicit formulation.</p>
<p>Default:</p>
<p>0.5</p>
</dd>
</dl>
</div></blockquote>
<p>‘DIRK22’:</p>
<blockquote>
<div><dl>
<dt>ModelOptions2d.swe_timestepper_options.<strong>solver_parameters</strong><span class="classifier">PETScSolverParameters</span></dt><dd><p>No description</p>
<p>Default:</p>
<p>{‘ksp_type’: ‘gmres’, ‘pc_type’: ‘fieldsplit’, ‘pc_fieldsplit_type’: ‘multiplicative’}</p>
</dd>
</dl>
</div></blockquote>
<p>‘DIRK33’:</p>
<blockquote>
<div><dl>
<dt>ModelOptions2d.swe_timestepper_options.<strong>solver_parameters</strong><span class="classifier">PETScSolverParameters</span></dt><dd><p>No description</p>
<p>Default:</p>
<p>{‘ksp_type’: ‘gmres’, ‘pc_type’: ‘fieldsplit’, ‘pc_fieldsplit_type’: ‘multiplicative’}</p>
</dd>
</dl>
</div></blockquote>
<p>‘SteadyState’:</p>
<blockquote>
<div><dl>
<dt>ModelOptions2d.swe_timestepper_options.<strong>solver_parameters</strong><span class="classifier">PETScSolverParameters</span></dt><dd><p>No description</p>
<p>Default:</p>
<p>{‘ksp_type’: ‘preonly’, ‘pc_type’: ‘lu’, ‘pc_factor_mat_solver_type’: ‘mumps’, ‘mat_type’: ‘aij’}</p>
</dd>
</dl>
</div></blockquote>
<p>‘PressureProjectionPicard’:</p>
<blockquote>
<div><dl>
<dt>ModelOptions2d.swe_timestepper_options.<strong>implicitness_theta</strong><span class="classifier">BoundedFloat</span></dt><dd><p>implicitness parameter theta. Value 0.5 implies Crank-Nicolson scheme, 1.0 implies fully implicit formulation.</p>
<p>Default:</p>
<p>0.5</p>
</dd>
<dt>ModelOptions2d.swe_timestepper_options.<strong>solver_parameters_momentum</strong><span class="classifier">PETScSolverParameters</span></dt><dd><p>No description</p>
<p>Default:</p>
<p>{‘ksp_type’: ‘gmres’, ‘pc_type’: ‘bjacobi’, ‘sub_ksp_type’: ‘preonly’, ‘sub_pc_type’: ‘sor’}</p>
</dd>
<dt>ModelOptions2d.swe_timestepper_options.<strong>solver_parameters_pressure</strong><span class="classifier">PETScSolverParameters</span></dt><dd><p>No description</p>
<p>Default:</p>
<p>{‘ksp_type’: ‘preonly’, ‘mat_type’: ‘matfree’, ‘pc_type’: ‘fieldsplit’, ‘pc_fieldsplit_type’: ‘schur’, ‘pc_fieldsplit_schur_fact_type’: ‘full’, ‘fieldsplit_U_2d’: {‘ksp_type’: ‘gmres’, ‘pc_type’: ‘python’, ‘pc_python_type’: ‘firedrake.AssembledPC’, ‘assembled_ksp_type’: ‘preonly’, ‘assembled_pc_type’: ‘bjacobi’, ‘assembled_sub_pc_type’: ‘ilu’}, ‘fieldsplit_H_2d’: {‘ksp_type’: ‘preonly’, ‘pc_type’: ‘python’, ‘pc_python_type’: ‘thetis.AssembledSchurPC’, ‘schur_ksp_type’: ‘gmres’, ‘schur_ksp_max_it’: 100, ‘schur_pc_type’: ‘gamg’}}</p>
</dd>
<dt>ModelOptions2d.swe_timestepper_options.<strong>use_semi_implicit_linearization</strong><span class="classifier">Bool</span></dt><dd><p>Use linearized semi-implicit time integration</p>
<p>Default:</p>
<p>True</p>
</dd>
</dl>
</div></blockquote>
<p>‘SSPIMEX’:</p>
<blockquote>
<div><dl>
<dt>ModelOptions2d.swe_timestepper_options.<strong>solver_parameters</strong><span class="classifier">PETScSolverParameters</span></dt><dd><p>No description</p>
<p>Default:</p>
<p>{‘ksp_type’: ‘gmres’, ‘pc_type’: ‘fieldsplit’, ‘pc_fieldsplit_type’: ‘multiplicative’}</p>
</dd>
</dl>
</div></blockquote>
</dd>
<dt>ModelOptions2d.<strong>tracer_advective_velocity_factor</strong><span class="classifier">FiredrakeScalarExpression</span></dt><dd><p>Custom factor multiplied to the velocity variable in tracer advection equation.</p>
<blockquote>
<div><p>Used to account for mismatch between depth-averaged product of velocity with tracer
and product of depth-averaged velocity with depth-averaged tracer</p>
</div></blockquote>
<p>Default:</p>
<p>Constant(1.0)</p>
</dd>
<dt>ModelOptions2d.<strong>tracer_element_family</strong><span class="classifier">‘dg’|’cg’</span></dt><dd><p>Finite element family for tracer transport</p>
<blockquote>
<div><p>2D solver supports ‘dg’ or ‘cg’.</p>
</div></blockquote>
<p>Default:</p>
<p>‘dg’</p>
</dd>
<dt>ModelOptions2d.<strong>tracer_only</strong><span class="classifier">Bool</span></dt><dd><p>Hold shallow water variables in initial state</p>
<blockquote>
<div><p>Advects tracer in the associated (constant) velocity field.</p>
</div></blockquote>
<p>Default:</p>
<p>False</p>
</dd>
<dt>ModelOptions2d.<strong>tracer_picard_iterations</strong><span class="classifier">PositiveInteger</span></dt><dd><p>Number of Picard iterations taken for tracer equations.</p>
<p>Default:</p>
<p>1</p>
</dd>
<dt>ModelOptions2d.<strong>tracer_timestepper_type</strong><span class="classifier">‘SSPRK33’|’ForwardEuler’|’BackwardEuler’|’CrankNicolson’|’DIRK22’|’DIRK33’|’SteadyState’</span></dt><dd><p>Name of the tracer time integrator</p>
<p>Default:</p>
<p>‘CrankNicolson’</p>
<p>Setting value implies configuration of sub-tree ModelOptions2d.tracer_timestepper_options:</p>
<p>‘SSPRK33’:</p>
<blockquote>
<div><dl>
<dt>ModelOptions2d.tracer_timestepper_options.<strong>solver_parameters</strong><span class="classifier">PETScSolverParameters</span></dt><dd><p>No description</p>
<p>Default:</p>
<p>{‘ksp_type’: ‘gmres’, ‘pc_type’: ‘sor’}</p>
</dd>
</dl>
</div></blockquote>
<p>‘ForwardEuler’:</p>
<blockquote>
<div><dl>
<dt>ModelOptions2d.tracer_timestepper_options.<strong>solver_parameters</strong><span class="classifier">PETScSolverParameters</span></dt><dd><p>No description</p>
<p>Default:</p>
<p>{‘ksp_type’: ‘gmres’, ‘pc_type’: ‘sor’}</p>
</dd>
</dl>
</div></blockquote>
<p>‘BackwardEuler’:</p>
<blockquote>
<div><dl>
<dt>ModelOptions2d.tracer_timestepper_options.<strong>solver_parameters</strong><span class="classifier">PETScSolverParameters</span></dt><dd><p>No description</p>
<p>Default:</p>
<p>{‘ksp_type’: ‘gmres’, ‘pc_type’: ‘sor’}</p>
</dd>
</dl>
</div></blockquote>
<p>‘CrankNicolson’:</p>
<blockquote>
<div><dl>
<dt>ModelOptions2d.tracer_timestepper_options.<strong>implicitness_theta</strong><span class="classifier">BoundedFloat</span></dt><dd><p>implicitness parameter theta. Value 0.5 implies Crank-Nicolson scheme, 1.0 implies fully implicit formulation.</p>
<p>Default:</p>
<p>0.5</p>
</dd>
</dl>
</div></blockquote>
<p>‘DIRK22’:</p>
<blockquote>
<div><dl>
<dt>ModelOptions2d.tracer_timestepper_options.<strong>solver_parameters</strong><span class="classifier">PETScSolverParameters</span></dt><dd><p>No description</p>
<p>Default:</p>
<p>{‘ksp_type’: ‘gmres’, ‘pc_type’: ‘sor’}</p>
</dd>
</dl>
</div></blockquote>
<p>‘DIRK33’:</p>
<blockquote>
<div><dl>
<dt>ModelOptions2d.tracer_timestepper_options.<strong>solver_parameters</strong><span class="classifier">PETScSolverParameters</span></dt><dd><p>No description</p>
<p>Default:</p>
<p>{‘ksp_type’: ‘gmres’, ‘pc_type’: ‘sor’}</p>
</dd>
</dl>
</div></blockquote>
<p>‘SteadyState’:</p>
<blockquote>
<div><dl>
<dt>ModelOptions2d.tracer_timestepper_options.<strong>solver_parameters</strong><span class="classifier">PETScSolverParameters</span></dt><dd><p>No description</p>
<p>Default:</p>
<p>{‘ksp_type’: ‘preonly’, ‘pc_type’: ‘lu’, ‘pc_factor_mat_solver_type’: ‘mumps’, ‘mat_type’: ‘aij’}</p>
</dd>
</dl>
</div></blockquote>
</dd>
<dt>ModelOptions2d.<strong>use_automatic_wetting_and_drying_alpha</strong><span class="classifier">Bool</span></dt><dd><p>Toggle automatic computation of the alpha parameter used in wetting and drying schemes.</p>
<blockquote>
<div><p>By default, this parameter is set to 0.5.</p>
<p>For problems whose bathymetry varies wildly in coastal regions, it is advisable to use the
automatic wetting and drying parameter, rather than the default.</p>
</div></blockquote>
<p>Default:</p>
<p>False</p>
</dd>
<dt>ModelOptions2d.<strong>use_supg_tracer</strong><span class="classifier">Bool</span></dt><dd><p>Use SUPG stabilisation in tracer advection</p>
<p>Default:</p>
<p>False</p>
</dd>
<dt>ModelOptions2d.<strong>use_tracer_conservative_form</strong><span class="classifier">Bool</span></dt><dd><p>Solve 2D tracer transport in the conservative form</p>
<p>Default:</p>
<p>False</p>
</dd>
<dt>ModelOptions2d.<strong>use_wetting_and_drying</strong><span class="classifier">Bool</span></dt><dd><p>bool: Turn on wetting and drying</p>
<blockquote>
<div><p>Uses the wetting and drying scheme from Karna et al (2011).
If <code class="docutils literal notranslate"><span class="pre">True</span></code>, one should also set <code class="xref py py-attr docutils literal notranslate"><span class="pre">wetting_and_drying_alpha</span></code> to control the bathymetry displacement.</p>
</div></blockquote>
<p>Default:</p>
<p>False</p>
</dd>
<dt>ModelOptions2d.<strong>wetting_and_drying_alpha</strong><span class="classifier">FiredrakeScalarExpression</span></dt><dd><p>Coefficient: Wetting and drying parameter <span class="math notranslate nohighlight">\(\alpha\)</span>.</p>
<blockquote>
<div><p>Used in bathymetry displacement function that ensures positive water depths. Unit is meters.</p>
</div></blockquote>
<p>Default:</p>
<p>Constant(0.5)</p>
</dd>
<dt>ModelOptions2d.<strong>wetting_and_drying_alpha_max</strong><span class="classifier">FiredrakeScalarExpression</span></dt><dd><p>Maximum value to be taken by wetting and drying parameter <span class="math notranslate nohighlight">\(\alpha\)</span>.</p>
<blockquote>
<div><p>Note this is only relevant if <cite>use_automatic_wetting_and_drying_alpha</cite> is set to <code class="docutils literal notranslate"><span class="pre">True</span></code>.</p>
</div></blockquote>
<p>Default:</p>
<p>Constant(2.0)</p>
</dd>
<dt>ModelOptions2d.<strong>wetting_and_drying_alpha_min</strong><span class="classifier">FiredrakeScalarExpression</span></dt><dd><p>Minimum value to be taken by wetting and drying parameter <span class="math notranslate nohighlight">\(\alpha\)</span>.</p>
<blockquote>
<div><p>Note this is only relevant if <cite>use_automatic_wetting_and_drying_alpha</cite> is set to <code class="docutils literal notranslate"><span class="pre">True</span></code>.</p>
</div></blockquote>
<p>Default:</p>
<p>UFL scalar expression</p>
</dd>
</dl>
</section>


            <div class="clearer"></div>
          </div>
        </div>
      </div>
    </div>
      <div class="clearer"></div>
    </div>
    <div class="footer" role="contentinfo">
    &#169; Copyright 2016-2025, Tuomas Kärnä et al..
      Created using <a href="https://www.sphinx-doc.org/">Sphinx</a> 8.1.3.
    </div>
  </body>
</html>